"use strict";(()=>{var Im=Object.create;var da=Object.defineProperty,Pm=Object.defineProperties,km=Object.getOwnPropertyDescriptor,Vm=Object.getOwnPropertyDescriptors,Lm=Object.getOwnPropertyNames,$c=Object.getOwnPropertySymbols,Hm=Object.getPrototypeOf,jc=Object.prototype.hasOwnProperty,Wm=Object.prototype.propertyIsEnumerable;var fa=Math.pow,Qc=(o,n,e)=>n in o?da(o,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[n]=e,k=(o,n)=>{for(var e in n||={})jc.call(n,e)&&Qc(o,e,n[e]);if($c)for(var e of $c(n))Wm.call(n,e)&&Qc(o,e,n[e]);return o},Y=(o,n)=>Pm(o,Vm(n)),c=(o,n)=>da(o,"name",{value:n,configurable:!0});var gt=(o,n)=>()=>(n||o((n={exports:{}}).exports,n),n.exports);var Gm=(o,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of Lm(n))!jc.call(o,i)&&i!==e&&da(o,i,{get:()=>n[i],enumerable:!(r=km(n,i))||r.enumerable});return o};var ce=(o,n,e)=>(e=o!=null?Im(Hm(o)):{},Gm(n||!o||!o.__esModule?da(e,"default",{value:o,enumerable:!0}):e,o));var wo=(o,n,e)=>new Promise((r,i)=>{var s=l=>{try{u(e.next(l))}catch(p){i(p)}},a=l=>{try{u(e.throw(l))}catch(p){i(p)}},u=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,a);u((e=e.apply(o,n)).next())});var ma=gt((ul,ll)=>{(function(o,n){typeof define=="function"&&define.amd?define([],n):typeof ul<"u"?n():(n(),o.FileSaver={})})(ul,function(){"use strict";function o(u,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}c(o,"b");function n(u,l,p){var d=new XMLHttpRequest;d.open("GET",u),d.responseType="blob",d.onload=function(){a(d.response,l,p)},d.onerror=function(){console.error("could not download file")},d.send()}c(n,"c");function e(u){var l=new XMLHttpRequest;l.open("HEAD",u,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}c(e,"d");function r(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(l)}}c(r,"e");var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,s=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(u,l,p){var d=i.URL||i.webkitURL,f=document.createElement("a");l=l||u.name||"download",f.download=l,f.rel="noopener",typeof u=="string"?(f.href=u,f.origin===location.origin?r(f):e(f.href)?n(u,l,p):r(f,f.target="_blank")):(f.href=d.createObjectURL(u),setTimeout(function(){d.revokeObjectURL(f.href)},4e4),setTimeout(function(){r(f)},0))}:"msSaveOrOpenBlob"in navigator?function(u,l,p){if(l=l||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(o(u,p),l);else if(e(u))n(u,l,p);else{var d=document.createElement("a");d.href=u,d.target="_blank",setTimeout(function(){r(d)})}}:function(u,l,p,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof u=="string")return n(u,l,p);var f=u.type==="application/octet-stream",m=/constructor/i.test(i.HTMLElement)||i.safari,h=/CriOS\/[\d]+/.test(navigator.userAgent);if((h||f&&m||s)&&typeof FileReader<"u"){var v=new FileReader;v.onloadend=function(){var C=v.result;C=h?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=C:location=C,d=null},v.readAsDataURL(u)}else{var D=i.URL||i.webkitURL,b=D.createObjectURL(u);d?d.location=b:location.href=b,d=null,setTimeout(function(){D.revokeObjectURL(b)},4e4)}});i.saveAs=a.saveAs=a,typeof ll<"u"&&(ll.exports=a)})});var Vr=gt((cl,pl)=>{(function(o,n){typeof cl=="object"&&typeof pl<"u"?pl.exports=n():typeof define=="function"&&define.amd?define(n):o.JSON5=n()})(cl,function(){"use strict";function o(E,B){return B={exports:{}},E(B,B.exports),B.exports}c(o,"createCommonjsModule");var n=o(function(E){var B=E.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=B)}),e=o(function(E){var B=E.exports={version:"2.6.5"};typeof __e=="number"&&(__e=B)}),r=e.version,i=c(function(E){return typeof E=="object"?E!==null:typeof E=="function"},"_isObject"),s=c(function(E){if(!i(E))throw TypeError(E+" is not an object!");return E},"_anObject"),a=c(function(E){try{return!!E()}catch{return!0}},"_fails"),u=!a(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),l=n.document,p=i(l)&&i(l.createElement),d=c(function(E){return p?l.createElement(E):{}},"_domCreate"),f=!u&&!a(function(){return Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a!=7}),m=c(function(E,B){if(!i(E))return E;var te,J;if(B&&typeof(te=E.toString)=="function"&&!i(J=te.call(E))||typeof(te=E.valueOf)=="function"&&!i(J=te.call(E))||!B&&typeof(te=E.toString)=="function"&&!i(J=te.call(E)))return J;throw TypeError("Can't convert object to primitive value")},"_toPrimitive"),h=Object.defineProperty,v=u?Object.defineProperty:c(function(B,te,J){if(s(B),te=m(te,!0),s(J),f)try{return h(B,te,J)}catch{}if("get"in J||"set"in J)throw TypeError("Accessors not supported!");return"value"in J&&(B[te]=J.value),B},"defineProperty"),D={f:v},b=c(function(E,B){return{enumerable:!(E&1),configurable:!(E&2),writable:!(E&4),value:B}},"_propertyDesc"),C=u?function(E,B,te){return D.f(E,B,b(1,te))}:function(E,B,te){return E[B]=te,E},A={}.hasOwnProperty,M=c(function(E,B){return A.call(E,B)},"_has"),w=0,T=Math.random(),R=c(function(E){return"Symbol(".concat(E===void 0?"":E,")_",(++w+T).toString(36))},"_uid"),S=!1,F=o(function(E){var B="__core-js_shared__",te=n[B]||(n[B]={});(E.exports=function(J,le){return te[J]||(te[J]=le!==void 0?le:{})})("versions",[]).push({version:e.version,mode:S?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),O=F("native-function-to-string",Function.toString),L=o(function(E){var B=R("src"),te="toString",J=(""+O).split(te);e.inspectSource=function(le){return O.call(le)},(E.exports=function(le,be,Se,Zt){var Ct=typeof Se=="function";Ct&&(M(Se,"name")||C(Se,"name",be)),le[be]!==Se&&(Ct&&(M(Se,B)||C(Se,B,le[be]?""+le[be]:J.join(String(be)))),le===n?le[be]=Se:Zt?le[be]?le[be]=Se:C(le,be,Se):(delete le[be],C(le,be,Se)))})(Function.prototype,te,c(function(){return typeof this=="function"&&this[B]||O.call(this)},"toString"))}),W=c(function(E){if(typeof E!="function")throw TypeError(E+" is not a function!");return E},"_aFunction"),se=c(function(E,B,te){if(W(E),B===void 0)return E;switch(te){case 1:return function(J){return E.call(B,J)};case 2:return function(J,le){return E.call(B,J,le)};case 3:return function(J,le,be){return E.call(B,J,le,be)}}return function(){return E.apply(B,arguments)}},"_ctx"),ae="prototype",oe=c(function(E,B,te){var J=E&oe.F,le=E&oe.G,be=E&oe.S,Se=E&oe.P,Zt=E&oe.B,Ct=le?n:be?n[B]||(n[B]={}):(n[B]||{})[ae],bo=le?e:e[B]||(e[B]={}),ni=bo[ae]||(bo[ae]={}),In,Jn,en,ri;le&&(te=B);for(In in te)Jn=!J&&Ct&&Ct[In]!==void 0,en=(Jn?Ct:te)[In],ri=Zt&&Jn?se(en,n):Se&&typeof en=="function"?se(Function.call,en):en,Ct&&L(Ct,In,en,E&oe.U),bo[In]!=en&&C(bo,In,ri),Se&&ni[In]!=en&&(ni[In]=en)},"$export");n.core=e,oe.F=1,oe.G=2,oe.S=4,oe.P=8,oe.B=16,oe.W=32,oe.U=64,oe.R=128;var Fe=oe,He=Math.ceil,it=Math.floor,ht=c(function(E){return isNaN(E=+E)?0:(E>0?it:He)(E)},"_toInteger"),st=c(function(E){if(E==null)throw TypeError("Can't call method on  "+E);return E},"_defined"),bt=c(function(E){return function(B,te){var J=String(st(B)),le=ht(te),be=J.length,Se,Zt;return le<0||le>=be?E?"":void 0:(Se=J.charCodeAt(le),Se<55296||Se>56319||le+1===be||(Zt=J.charCodeAt(le+1))<56320||Zt>57343?E?J.charAt(le):Se:E?J.slice(le,le+2):(Se-55296<<10)+(Zt-56320)+65536)}},"_stringAt"),Pt=bt(!1);Fe(Fe.P,"String",{codePointAt:c(function(B){return Pt(this,B)},"codePointAt")});var Kt=e.String.codePointAt,Cn=Math.max,Jt=Math.min,je=c(function(E,B){return E=ht(E),E<0?Cn(E+B,0):Jt(E,B)},"_toAbsoluteIndex"),We=String.fromCharCode,X=String.fromCodePoint;Fe(Fe.S+Fe.F*(!!X&&X.length!=1),"String",{fromCodePoint:c(function(B){for(var te=arguments,J=[],le=arguments.length,be=0,Se;le>be;){if(Se=+te[be++],je(Se,1114111)!==Se)throw RangeError(Se+" is not a valid code point");J.push(Se<65536?We(Se):We(((Se-=65536)>>10)+55296,Se%1024+56320))}return J.join("")},"fromCodePoint")});var ee=e.String.fromCodePoint,Ge=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,Ie=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,Te=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,Gt={Space_Separator:Ge,ID_Start:Ie,ID_Continue:Te},Xe={isSpaceSeparator:c(function(B){return typeof B=="string"&&Gt.Space_Separator.test(B)},"isSpaceSeparator"),isIdStartChar:c(function(B){return typeof B=="string"&&(B>="a"&&B<="z"||B>="A"&&B<="Z"||B==="$"||B==="_"||Gt.ID_Start.test(B))},"isIdStartChar"),isIdContinueChar:c(function(B){return typeof B=="string"&&(B>="a"&&B<="z"||B>="A"&&B<="Z"||B>="0"&&B<="9"||B==="$"||B==="_"||B==="\u200C"||B==="\u200D"||Gt.ID_Continue.test(B))},"isIdContinueChar"),isDigit:c(function(B){return typeof B=="string"&&/[0-9]/.test(B)},"isDigit"),isHexDigit:c(function(B){return typeof B=="string"&&/[0-9A-Fa-f]/.test(B)},"isHexDigit")},mr,kt,un,Do,Bn,ln,St,nl,ts,Cm=c(function(B,te){mr=String(B),kt="start",un=[],Do=0,Bn=1,ln=0,St=void 0,nl=void 0,ts=void 0;do St=xm(),Tm[kt]();while(St.type!=="eof");return typeof te=="function"?rl({"":ts},"",te):ts},"parse");function rl(E,B,te){var J=E[B];if(J!=null&&typeof J=="object")if(Array.isArray(J))for(var le=0;le<J.length;le++){var be=String(le),Se=rl(J,be,te);Se===void 0?delete J[be]:Object.defineProperty(J,be,{value:Se,writable:!0,enumerable:!0,configurable:!0})}else for(var Zt in J){var Ct=rl(J,Zt,te);Ct===void 0?delete J[Zt]:Object.defineProperty(J,Zt,{value:Ct,writable:!0,enumerable:!0,configurable:!0})}return te.call(E,B,J)}c(rl,"internalize");var ge,de,ns,hr,Ee;function xm(){for(ge="default",de="",ns=!1,hr=1;;){Ee=gr();var E=qc[ge]();if(E)return E}}c(xm,"lex");function gr(){if(mr[Do])return String.fromCodePoint(mr.codePointAt(Do))}c(gr,"peek");function V(){var E=gr();return E===`
`?(Bn++,ln=0):E?ln+=E.length:ln++,E&&(Do+=E.length),E}c(V,"read");var qc={default:c(function(){switch(Ee){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":V();return;case"/":V(),ge="comment";return;case void 0:return V(),Ze("eof")}if(Xe.isSpaceSeparator(Ee)){V();return}return qc[kt]()},"default$1"),comment:c(function(){switch(Ee){case"*":V(),ge="multiLineComment";return;case"/":V(),ge="singleLineComment";return}throw et(V())},"comment"),multiLineComment:c(function(){switch(Ee){case"*":V(),ge="multiLineCommentAsterisk";return;case void 0:throw et(V())}V()},"multiLineComment"),multiLineCommentAsterisk:c(function(){switch(Ee){case"*":V();return;case"/":V(),ge="default";return;case void 0:throw et(V())}V(),ge="multiLineComment"},"multiLineCommentAsterisk"),singleLineComment:c(function(){switch(Ee){case`
`:case"\r":case"\u2028":case"\u2029":V(),ge="default";return;case void 0:return V(),Ze("eof")}V()},"singleLineComment"),value:c(function(){switch(Ee){case"{":case"[":return Ze("punctuator",V());case"n":return V(),vo("ull"),Ze("null",null);case"t":return V(),vo("rue"),Ze("boolean",!0);case"f":return V(),vo("alse"),Ze("boolean",!1);case"-":case"+":V()==="-"&&(hr=-1),ge="sign";return;case".":de=V(),ge="decimalPointLeading";return;case"0":de=V(),ge="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":de=V(),ge="decimalInteger";return;case"I":return V(),vo("nfinity"),Ze("numeric",1/0);case"N":return V(),vo("aN"),Ze("numeric",NaN);case'"':case"'":ns=V()==='"',de="",ge="string";return}throw et(V())},"value"),identifierNameStartEscape:c(function(){if(Ee!=="u")throw et(V());V();var B=ol();switch(B){case"$":case"_":break;default:if(!Xe.isIdStartChar(B))throw Xc();break}de+=B,ge="identifierName"},"identifierNameStartEscape"),identifierName:c(function(){switch(Ee){case"$":case"_":case"\u200C":case"\u200D":de+=V();return;case"\\":V(),ge="identifierNameEscape";return}if(Xe.isIdContinueChar(Ee)){de+=V();return}return Ze("identifier",de)},"identifierName"),identifierNameEscape:c(function(){if(Ee!=="u")throw et(V());V();var B=ol();switch(B){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!Xe.isIdContinueChar(B))throw Xc();break}de+=B,ge="identifierName"},"identifierNameEscape"),sign:c(function(){switch(Ee){case".":de=V(),ge="decimalPointLeading";return;case"0":de=V(),ge="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":de=V(),ge="decimalInteger";return;case"I":return V(),vo("nfinity"),Ze("numeric",hr*(1/0));case"N":return V(),vo("aN"),Ze("numeric",NaN)}throw et(V())},"sign$1"),zero:c(function(){switch(Ee){case".":de+=V(),ge="decimalPoint";return;case"e":case"E":de+=V(),ge="decimalExponent";return;case"x":case"X":de+=V(),ge="hexadecimal";return}return Ze("numeric",hr*0)},"zero"),decimalInteger:c(function(){switch(Ee){case".":de+=V(),ge="decimalPoint";return;case"e":case"E":de+=V(),ge="decimalExponent";return}if(Xe.isDigit(Ee)){de+=V();return}return Ze("numeric",hr*Number(de))},"decimalInteger"),decimalPointLeading:c(function(){if(Xe.isDigit(Ee)){de+=V(),ge="decimalFraction";return}throw et(V())},"decimalPointLeading"),decimalPoint:c(function(){switch(Ee){case"e":case"E":de+=V(),ge="decimalExponent";return}if(Xe.isDigit(Ee)){de+=V(),ge="decimalFraction";return}return Ze("numeric",hr*Number(de))},"decimalPoint"),decimalFraction:c(function(){switch(Ee){case"e":case"E":de+=V(),ge="decimalExponent";return}if(Xe.isDigit(Ee)){de+=V();return}return Ze("numeric",hr*Number(de))},"decimalFraction"),decimalExponent:c(function(){switch(Ee){case"+":case"-":de+=V(),ge="decimalExponentSign";return}if(Xe.isDigit(Ee)){de+=V(),ge="decimalExponentInteger";return}throw et(V())},"decimalExponent"),decimalExponentSign:c(function(){if(Xe.isDigit(Ee)){de+=V(),ge="decimalExponentInteger";return}throw et(V())},"decimalExponentSign"),decimalExponentInteger:c(function(){if(Xe.isDigit(Ee)){de+=V();return}return Ze("numeric",hr*Number(de))},"decimalExponentInteger"),hexadecimal:c(function(){if(Xe.isHexDigit(Ee)){de+=V(),ge="hexadecimalInteger";return}throw et(V())},"hexadecimal"),hexadecimalInteger:c(function(){if(Xe.isHexDigit(Ee)){de+=V();return}return Ze("numeric",hr*Number(de))},"hexadecimalInteger"),string:c(function(){switch(Ee){case"\\":V(),de+=wm();return;case'"':if(ns)return V(),Ze("string",de);de+=V();return;case"'":if(!ns)return V(),Ze("string",de);de+=V();return;case`
`:case"\r":throw et(V());case"\u2028":case"\u2029":Em(Ee);break;case void 0:throw et(V())}de+=V()},"string"),start:c(function(){switch(Ee){case"{":case"[":return Ze("punctuator",V())}ge="value"},"start"),beforePropertyName:c(function(){switch(Ee){case"$":case"_":de=V(),ge="identifierName";return;case"\\":V(),ge="identifierNameStartEscape";return;case"}":return Ze("punctuator",V());case'"':case"'":ns=V()==='"',ge="string";return}if(Xe.isIdStartChar(Ee)){de+=V(),ge="identifierName";return}throw et(V())},"beforePropertyName"),afterPropertyName:c(function(){if(Ee===":")return Ze("punctuator",V());throw et(V())},"afterPropertyName"),beforePropertyValue:c(function(){ge="value"},"beforePropertyValue"),afterPropertyValue:c(function(){switch(Ee){case",":case"}":return Ze("punctuator",V())}throw et(V())},"afterPropertyValue"),beforeArrayValue:c(function(){if(Ee==="]")return Ze("punctuator",V());ge="value"},"beforeArrayValue"),afterArrayValue:c(function(){switch(Ee){case",":case"]":return Ze("punctuator",V())}throw et(V())},"afterArrayValue"),end:c(function(){throw et(V())},"end")};function Ze(E,B){return{type:E,value:B,line:Bn,column:ln}}c(Ze,"newToken");function vo(E){for(var B=0,te=E;B<te.length;B+=1){var J=te[B],le=gr();if(le!==J)throw et(V());V()}}c(vo,"literal");function wm(){var E=gr();switch(E){case"b":return V(),"\b";case"f":return V(),"\f";case"n":return V(),`
`;case"r":return V(),"\r";case"t":return V(),"	";case"v":return V(),"\v";case"0":if(V(),Xe.isDigit(gr()))throw et(V());return"\0";case"x":return V(),Am();case"u":return V(),ol();case`
`:case"\u2028":case"\u2029":return V(),"";case"\r":return V(),gr()===`
`&&V(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw et(V());case void 0:throw et(V())}return V()}c(wm,"escape");function Am(){var E="",B=gr();if(!Xe.isHexDigit(B)||(E+=V(),B=gr(),!Xe.isHexDigit(B)))throw et(V());return E+=V(),String.fromCodePoint(parseInt(E,16))}c(Am,"hexEscape");function ol(){for(var E="",B=4;B-- >0;){var te=gr();if(!Xe.isHexDigit(te))throw et(V());E+=V()}return String.fromCodePoint(parseInt(E,16))}c(ol,"unicodeEscape");var Tm={start:c(function(){if(St.type==="eof")throw yo();il()},"start"),beforePropertyName:c(function(){switch(St.type){case"identifier":case"string":nl=St.value,kt="afterPropertyName";return;case"punctuator":ua();return;case"eof":throw yo()}},"beforePropertyName"),afterPropertyName:c(function(){if(St.type==="eof")throw yo();kt="beforePropertyValue"},"afterPropertyName"),beforePropertyValue:c(function(){if(St.type==="eof")throw yo();il()},"beforePropertyValue"),beforeArrayValue:c(function(){if(St.type==="eof")throw yo();if(St.type==="punctuator"&&St.value==="]"){ua();return}il()},"beforeArrayValue"),afterPropertyValue:c(function(){if(St.type==="eof")throw yo();switch(St.value){case",":kt="beforePropertyName";return;case"}":ua()}},"afterPropertyValue"),afterArrayValue:c(function(){if(St.type==="eof")throw yo();switch(St.value){case",":kt="beforeArrayValue";return;case"]":ua()}},"afterArrayValue"),end:c(function(){},"end")};function il(){var E;switch(St.type){case"punctuator":switch(St.value){case"{":E={};break;case"[":E=[];break}break;case"null":case"boolean":case"numeric":case"string":E=St.value;break}if(ts===void 0)ts=E;else{var B=un[un.length-1];Array.isArray(B)?B.push(E):Object.defineProperty(B,nl,{value:E,writable:!0,enumerable:!0,configurable:!0})}if(E!==null&&typeof E=="object")un.push(E),Array.isArray(E)?kt="beforeArrayValue":kt="beforePropertyName";else{var te=un[un.length-1];te==null?kt="end":Array.isArray(te)?kt="afterArrayValue":kt="afterPropertyValue"}}c(il,"push");function ua(){un.pop();var E=un[un.length-1];E==null?kt="end":Array.isArray(E)?kt="afterArrayValue":kt="afterPropertyValue"}c(ua,"pop");function et(E){return la(E===void 0?"JSON5: invalid end of input at "+Bn+":"+ln:"JSON5: invalid character '"+Yc(E)+"' at "+Bn+":"+ln)}c(et,"invalidChar");function yo(){return la("JSON5: invalid end of input at "+Bn+":"+ln)}c(yo,"invalidEOF");function Xc(){return ln-=5,la("JSON5: invalid identifier character at "+Bn+":"+ln)}c(Xc,"invalidIdentifier");function Em(E){console.warn("JSON5: '"+Yc(E)+"' in strings is not valid ECMAScript; consider escaping")}c(Em,"separatorChar");function Yc(E){var B={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if(B[E])return B[E];if(E<" "){var te=E.charCodeAt(0).toString(16);return"\\x"+("00"+te).substring(te.length)}return E}c(Yc,"formatChar");function la(E){var B=new SyntaxError(E);return B.lineNumber=Bn,B.columnNumber=ln,B}c(la,"syntaxError");var Sm=c(function(B,te,J){var le=[],be="",Se,Zt,Ct="",bo;if(te!=null&&typeof te=="object"&&!Array.isArray(te)&&(J=te.space,bo=te.quote,te=te.replacer),typeof te=="function")Zt=te;else if(Array.isArray(te)){Se=[];for(var ni=0,In=te;ni<In.length;ni+=1){var Jn=In[ni],en=void 0;typeof Jn=="string"?en=Jn:(typeof Jn=="number"||Jn instanceof String||Jn instanceof Number)&&(en=String(Jn)),en!==void 0&&Se.indexOf(en)<0&&Se.push(en)}}return J instanceof Number?J=Number(J):J instanceof String&&(J=String(J)),typeof J=="number"?J>0&&(J=Math.min(10,Math.floor(J)),Ct="          ".substr(0,J)):typeof J=="string"&&(Ct=J.substr(0,10)),ri("",{"":B});function ri(Ye,Ut){var fe=Ut[Ye];switch(fe!=null&&(typeof fe.toJSON5=="function"?fe=fe.toJSON5(Ye):typeof fe.toJSON=="function"&&(fe=fe.toJSON(Ye))),Zt&&(fe=Zt.call(Ut,Ye,fe)),fe instanceof Number?fe=Number(fe):fe instanceof String?fe=String(fe):fe instanceof Boolean&&(fe=fe.valueOf()),fe){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof fe=="string")return ca(fe,!1);if(typeof fe=="number")return String(fe);if(typeof fe=="object")return Array.isArray(fe)?Fm(fe):Om(fe)}c(ri,"serializeProperty");function ca(Ye){for(var Ut={"'":.1,'"':.2},fe={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},Vt="",Pn=0;Pn<Ye.length;Pn++){var zt=Ye[Pn];switch(zt){case"'":case'"':Ut[zt]++,Vt+=zt;continue;case"\0":if(Xe.isDigit(Ye[Pn+1])){Vt+="\\x00";continue}}if(fe[zt]){Vt+=fe[zt];continue}if(zt<" "){var Co=zt.charCodeAt(0).toString(16);Vt+="\\x"+("00"+Co).substring(Co.length);continue}Vt+=zt}var Dr=bo||Object.keys(Ut).reduce(function(kr,xo){return Ut[kr]<Ut[xo]?kr:xo});return Vt=Vt.replace(new RegExp(Dr,"g"),fe[Dr]),Dr+Vt+Dr}c(ca,"quoteString");function Om(Ye){if(le.indexOf(Ye)>=0)throw TypeError("Converting circular structure to JSON5");le.push(Ye);var Ut=be;be=be+Ct;for(var fe=Se||Object.keys(Ye),Vt=[],Pn=0,zt=fe;Pn<zt.length;Pn+=1){var Co=zt[Pn],Dr=ri(Co,Ye);if(Dr!==void 0){var kr=Nm(Co)+":";Ct!==""&&(kr+=" "),kr+=Dr,Vt.push(kr)}}var xo;if(Vt.length===0)xo="{}";else{var pa;if(Ct==="")pa=Vt.join(","),xo="{"+pa+"}";else{var Bm=`,
`+be;pa=Vt.join(Bm),xo=`{
`+be+pa+`,
`+Ut+"}"}}return le.pop(),be=Ut,xo}c(Om,"serializeObject");function Nm(Ye){if(Ye.length===0)return ca(Ye,!0);var Ut=String.fromCodePoint(Ye.codePointAt(0));if(!Xe.isIdStartChar(Ut))return ca(Ye,!0);for(var fe=Ut.length;fe<Ye.length;fe++)if(!Xe.isIdContinueChar(String.fromCodePoint(Ye.codePointAt(fe))))return ca(Ye,!0);return Ye}c(Nm,"serializeKey");function Fm(Ye){if(le.indexOf(Ye)>=0)throw TypeError("Converting circular structure to JSON5");le.push(Ye);var Ut=be;be=be+Ct;for(var fe=[],Vt=0;Vt<Ye.length;Vt++){var Pn=ri(String(Vt),Ye);fe.push(Pn!==void 0?Pn:"null")}var zt;if(fe.length===0)zt="[]";else if(Ct===""){var Co=fe.join(",");zt="["+Co+"]"}else{var Dr=`,
`+be,kr=fe.join(Dr);zt=`[
`+be+kr+`,
`+Ut+"]"}return le.pop(),be=Ut,zt}c(Fm,"serializeArray")},"stringify"),_m={parse:Cm,stringify:Sm},Mm=_m,Rm=Mm;return Rm})});var dp=gt((q4,ha)=>{var pp=function(){var o=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={};function i(a,u){if(!r[a]){r[a]={};for(var l=0;l<a.length;l++)r[a][a.charAt(l)]=l}return r[a][u]}c(i,"getBaseValue");var s={compressToBase64:function(a){if(a==null)return"";var u=s._compress(a,6,function(l){return n.charAt(l)});switch(u.length%4){default:case 0:return u;case 1:return u+"===";case 2:return u+"==";case 3:return u+"="}},decompressFromBase64:function(a){return a==null?"":a==""?null:s._decompress(a.length,32,function(u){return i(n,a.charAt(u))})},compressToUTF16:function(a){return a==null?"":s._compress(a,15,function(u){return o(u+32)})+" "},decompressFromUTF16:function(a){return a==null?"":a==""?null:s._decompress(a.length,16384,function(u){return a.charCodeAt(u)-32})},compressToUint8Array:function(a){for(var u=s.compress(a),l=new Uint8Array(u.length*2),p=0,d=u.length;p<d;p++){var f=u.charCodeAt(p);l[p*2]=f>>>8,l[p*2+1]=f%256}return l},decompressFromUint8Array:function(a){if(a==null)return s.decompress(a);for(var u=new Array(a.length/2),l=0,p=u.length;l<p;l++)u[l]=a[l*2]*256+a[l*2+1];var d=[];return u.forEach(function(f){d.push(o(f))}),s.decompress(d.join(""))},compressToEncodedURIComponent:function(a){return a==null?"":s._compress(a,6,function(u){return e.charAt(u)})},decompressFromEncodedURIComponent:function(a){return a==null?"":a==""?null:(a=a.replace(/ /g,"+"),s._decompress(a.length,32,function(u){return i(e,a.charAt(u))}))},compress:function(a){return s._compress(a,16,function(u){return o(u)})},_compress:function(a,u,l){if(a==null)return"";var p,d,f={},m={},h="",v="",D="",b=2,C=3,A=2,M=[],w=0,T=0,R;for(R=0;R<a.length;R+=1)if(h=a.charAt(R),Object.prototype.hasOwnProperty.call(f,h)||(f[h]=C++,m[h]=!0),v=D+h,Object.prototype.hasOwnProperty.call(f,v))D=v;else{if(Object.prototype.hasOwnProperty.call(m,D)){if(D.charCodeAt(0)<256){for(p=0;p<A;p++)w=w<<1,T==u-1?(T=0,M.push(l(w)),w=0):T++;for(d=D.charCodeAt(0),p=0;p<8;p++)w=w<<1|d&1,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=d>>1}else{for(d=1,p=0;p<A;p++)w=w<<1|d,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=0;for(d=D.charCodeAt(0),p=0;p<16;p++)w=w<<1|d&1,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=d>>1}b--,b==0&&(b=Math.pow(2,A),A++),delete m[D]}else for(d=f[D],p=0;p<A;p++)w=w<<1|d&1,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=d>>1;b--,b==0&&(b=Math.pow(2,A),A++),f[v]=C++,D=String(h)}if(D!==""){if(Object.prototype.hasOwnProperty.call(m,D)){if(D.charCodeAt(0)<256){for(p=0;p<A;p++)w=w<<1,T==u-1?(T=0,M.push(l(w)),w=0):T++;for(d=D.charCodeAt(0),p=0;p<8;p++)w=w<<1|d&1,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=d>>1}else{for(d=1,p=0;p<A;p++)w=w<<1|d,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=0;for(d=D.charCodeAt(0),p=0;p<16;p++)w=w<<1|d&1,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=d>>1}b--,b==0&&(b=Math.pow(2,A),A++),delete m[D]}else for(d=f[D],p=0;p<A;p++)w=w<<1|d&1,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=d>>1;b--,b==0&&(b=Math.pow(2,A),A++)}for(d=2,p=0;p<A;p++)w=w<<1|d&1,T==u-1?(T=0,M.push(l(w)),w=0):T++,d=d>>1;for(;;)if(w=w<<1,T==u-1){M.push(l(w));break}else T++;return M.join("")},decompress:function(a){return a==null?"":a==""?null:s._decompress(a.length,32768,function(u){return a.charCodeAt(u)})},_decompress:function(a,u,l){var p=[],d,f=4,m=4,h=3,v="",D=[],b,C,A,M,w,T,R,S={val:l(0),position:u,index:1};for(b=0;b<3;b+=1)p[b]=b;for(A=0,w=Math.pow(2,2),T=1;T!=w;)M=S.val&S.position,S.position>>=1,S.position==0&&(S.position=u,S.val=l(S.index++)),A|=(M>0?1:0)*T,T<<=1;switch(d=A){case 0:for(A=0,w=Math.pow(2,8),T=1;T!=w;)M=S.val&S.position,S.position>>=1,S.position==0&&(S.position=u,S.val=l(S.index++)),A|=(M>0?1:0)*T,T<<=1;R=o(A);break;case 1:for(A=0,w=Math.pow(2,16),T=1;T!=w;)M=S.val&S.position,S.position>>=1,S.position==0&&(S.position=u,S.val=l(S.index++)),A|=(M>0?1:0)*T,T<<=1;R=o(A);break;case 2:return""}for(p[3]=R,C=R,D.push(R);;){if(S.index>a)return"";for(A=0,w=Math.pow(2,h),T=1;T!=w;)M=S.val&S.position,S.position>>=1,S.position==0&&(S.position=u,S.val=l(S.index++)),A|=(M>0?1:0)*T,T<<=1;switch(R=A){case 0:for(A=0,w=Math.pow(2,8),T=1;T!=w;)M=S.val&S.position,S.position>>=1,S.position==0&&(S.position=u,S.val=l(S.index++)),A|=(M>0?1:0)*T,T<<=1;p[m++]=o(A),R=m-1,f--;break;case 1:for(A=0,w=Math.pow(2,16),T=1;T!=w;)M=S.val&S.position,S.position>>=1,S.position==0&&(S.position=u,S.val=l(S.index++)),A|=(M>0?1:0)*T,T<<=1;p[m++]=o(A),R=m-1,f--;break;case 2:return D.join("")}if(f==0&&(f=Math.pow(2,h),h++),p[R])v=p[R];else if(R===m)v=C+C.charAt(0);else return null;D.push(v),p[m++]=C+v.charAt(0),f--,C=v,f==0&&(f=Math.pow(2,h),h++)}}};return s}();typeof define=="function"&&define.amd?define(function(){return pp}):typeof ha<"u"&&ha!=null&&(ha.exports=pp)});var mp=gt(dl=>{var fp;(function(o){typeof DO_NOT_EXPORT_CRC>"u"?typeof dl=="object"?o(dl):typeof define=="function"&&define.amd?define(function(){var n={};return o(n),n}):o(fp={}):o(fp={})})(function(o){o.version="1.2.0";function n(){for(var u=0,l=new Array(256),p=0;p!=256;++p)u=p,u=u&1?-306674912^u>>>1:u>>>1,u=u&1?-306674912^u>>>1:u>>>1,u=u&1?-306674912^u>>>1:u>>>1,u=u&1?-306674912^u>>>1:u>>>1,u=u&1?-306674912^u>>>1:u>>>1,u=u&1?-306674912^u>>>1:u>>>1,u=u&1?-306674912^u>>>1:u>>>1,u=u&1?-306674912^u>>>1:u>>>1,l[p]=u;return typeof Int32Array<"u"?new Int32Array(l):l}c(n,"signed_crc_table");var e=n();function r(u,l){for(var p=l^-1,d=u.length-1,f=0;f<d;)p=p>>>8^e[(p^u.charCodeAt(f++))&255],p=p>>>8^e[(p^u.charCodeAt(f++))&255];return f===d&&(p=p>>>8^e[(p^u.charCodeAt(f))&255]),p^-1}c(r,"crc32_bstr");function i(u,l){if(u.length>1e4)return s(u,l);for(var p=l^-1,d=u.length-3,f=0;f<d;)p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255];for(;f<d+3;)p=p>>>8^e[(p^u[f++])&255];return p^-1}c(i,"crc32_buf");function s(u,l){for(var p=l^-1,d=u.length-7,f=0;f<d;)p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255],p=p>>>8^e[(p^u[f++])&255];for(;f<d+7;)p=p>>>8^e[(p^u[f++])&255];return p^-1}c(s,"crc32_buf_8");function a(u,l){for(var p=l^-1,d=0,f=u.length,m,h;d<f;)m=u.charCodeAt(d++),m<128?p=p>>>8^e[(p^m)&255]:m<2048?(p=p>>>8^e[(p^(192|m>>6&31))&255],p=p>>>8^e[(p^(128|m&63))&255]):m>=55296&&m<57344?(m=(m&1023)+64,h=u.charCodeAt(d++)&1023,p=p>>>8^e[(p^(240|m>>8&7))&255],p=p>>>8^e[(p^(128|m>>2&63))&255],p=p>>>8^e[(p^(128|h>>6&15|(m&3)<<4))&255],p=p>>>8^e[(p^(128|h&63))&255]):(p=p>>>8^e[(p^(224|m>>12&15))&255],p=p>>>8^e[(p^(128|m>>6&63))&255],p=p>>>8^e[(p^(128|m&63))&255]);return p^-1}c(a,"crc32_str"),o.table=e,o.bstr=r,o.buf=i,o.str=a})});var Tp=gt((Q4,Ap)=>{var Dp=mp(),_t=new Uint8Array(4),vp=new Int32Array(_t.buffer),yp=new Uint32Array(_t.buffer),Qm={UNDEFINED:0,METERS:1,INCHES:2};function jm(o,n,e){var r=[],i=o.length;if(i===0)return r;var s=n<0?Math.max(0,n+i):n||0;for(e!==void 0&&(i=e<0?e+i:e);i-- >s;)r[i-s]=o[i];return r}c(jm,"sliced");function bp(o,n,e="tEXt"){if(o=String(o),n=String(n),n.length&&(!/^[\x00-\xFF]+$/.test(o)||!/^[\x00-\xFF]+$/.test(n)))throw new Error("Only Latin-1 characters are permitted in PNG tEXt chunks. You might want to consider base64 encoding and/or zEXt compression");if(o.length>=80)throw new Error('Keyword "'+o+'" is longer than the 79-character limit imposed by the PNG specification');let r=o.length+n.length+1,i=new Uint8Array(r),s=0,a;for(let u=0;u<o.length;u++){if(!(a=o.charCodeAt(u)))throw new Error("0x00 character is not permitted in tEXt keywords");i[s++]=a}i[s++]=0;for(let u=0;u<n.length;u++){if(!(a=n.charCodeAt(u)))throw new Error("0x00 character is not permitted in tEXt content");i[s++]=a}return{name:e,data:i}}c(bp,"textEncode");function Cp(o){o.data&&o.name&&(o=o.data);let n=!0,e="",r="";for(let i=0;i<o.length;i++){let s=o[i];if(n)s?r+=String.fromCharCode(s):n=!1;else if(s)e+=String.fromCharCode(s);else throw new Error("Invalid NULL character found. 0x00 character is not permitted in tEXt content")}return{keyword:r,text:e}}c(Cp,"textDecode");function fl(o){if(o[0]!==137)throw new Error("Invalid .png file header");if(o[1]!==80)throw new Error("Invalid .png file header");if(o[2]!==78)throw new Error("Invalid .png file header");if(o[3]!==71)throw new Error("Invalid .png file header");if(o[4]!==13)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(o[5]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");if(o[6]!==26)throw new Error("Invalid .png file header");if(o[7]!==10)throw new Error("Invalid .png file header: possibly caused by DOS-Unix line ending conversion?");let n=!1,e=[],r=8;for(;r<o.length;){_t[3]=o[r++],_t[2]=o[r++],_t[1]=o[r++],_t[0]=o[r++];let i=yp[0]+4,s=new Uint8Array(i);s[0]=o[r++],s[1]=o[r++],s[2]=o[r++],s[3]=o[r++];let a=String.fromCharCode(s[0])+String.fromCharCode(s[1])+String.fromCharCode(s[2])+String.fromCharCode(s[3]);if(!e.length&&a!=="IHDR")throw new Error("IHDR header missing");if(a==="IEND"){n=!0,e.push({name:a,data:new Uint8Array(0)});break}for(let d=4;d<i;d++)s[d]=o[r++];_t[3]=o[r++],_t[2]=o[r++],_t[1]=o[r++],_t[0]=o[r++];let u=vp[0];if(Dp.buf(s)!==u)throw new Error("CRC values for "+a+" header do not match, PNG file is likely corrupted");let p=new Uint8Array(s.buffer.slice(4));e.push({name:a,data:p})}if(!n)throw new Error(".png file ended prematurely: no IEND header was found");return e}c(fl,"extractChunks");function xp(o){let n=8,e=n,r;for(r=0;r<o.length;r++)n+=o[r].data.length,n+=12;let i=new Uint8Array(n);for(i[0]=137,i[1]=80,i[2]=78,i[3]=71,i[4]=13,i[5]=10,i[6]=26,i[7]=10,r=0;r<o.length;r++){let s=o[r],a=s.name,u=s.data,l=u.length,p=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)];yp[0]=l,i[e++]=_t[3],i[e++]=_t[2],i[e++]=_t[1],i[e++]=_t[0],i[e++]=p[0],i[e++]=p[1],i[e++]=p[2],i[e++]=p[3];for(let f=0;f<l;)i[e++]=u[f++];let d=p.concat(jm(u));vp[0]=Dp.buf(d),i[e++]=_t[3],i[e++]=_t[2],i[e++]=_t[1],i[e++]=_t[0]}return i}c(xp,"encodeChunks");function hp(o,n){let e,r,i,s;return e=o[n++],r=o[n++],i=o[n++],s=o[n],0|e<<24|r<<16|i<<8|s}c(hp,"readUint32");function gp(o,n,e){o[e]=(n&4278190080)>>24,o[e+1]=(n&16711680)>>16,o[e+2]=(n&65280)>>8,o[e+3]=n&255}c(gp,"writeUInt32");function Km(o){let n={};return fl(o).forEach(r=>{switch(r.name){case"tEXt":n.tEXt||(n.tEXt={});let i=Cp(r.data);n.tEXt[i.keyword]=i.text;break;case"pHYs":n.pHYs={x:hp(r.data,0),y:hp(r.data,4),unit:r.data[8]};break;case"gAMA":case"cHRM":case"sRGB":case"IHDR":case"iCCP":default:n[r.name]=!0}}),n}c(Km,"readMetadata");function Jm(o,n){let e=fl(o);return wp(e,n),new Buffer.from(xp(e))}c(Jm,"writeMetadata");function wp(o,n){if(n.clear)for(let r=o.length-1;r--;)switch(o[r].name){case"IHDR":case"IDAT":case"IEND":break;default:o.splice(r,1)}if(n.tEXt)for(var e in n.tEXt)o.splice(-1,0,bp(e,n.tEXt[e]));if(n.pHYs){let r=new Uint8Array(9);gp(r,n.pHYs.x,0),gp(r,n.pHYs.y,4),r[8]=n.pHYs.units;let i=o.find(s=>s.name==="pHYs");i?i.data=r:o.splice(1,0,{name:"pHYs",data:r})}}c(wp,"insertMetadata");Ap.exports={RESOLUTION_UNITS:Qm,insertMetadata:wp,readMetadata:Km,writeMetadata:Jm,textEncode:bp,textDecode:Cp,extractChunks:fl,encodeChunks:xp}});var To=gt(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.getEndomorphismMonoid=re.not=re.SK=re.hole=re.pipe=re.untupled=re.tupled=re.absurd=re.decrement=re.increment=re.tuple=re.flow=re.flip=re.constVoid=re.constUndefined=re.constNull=re.constFalse=re.constTrue=re.constant=re.unsafeCoerce=re.identity=re.apply=re.getRing=re.getSemiring=re.getMonoid=re.getSemigroup=re.getBooleanAlgebra=void 0;var Zm=c(function(o){return function(){return{meet:function(n,e){return function(r){return o.meet(n(r),e(r))}},join:function(n,e){return function(r){return o.join(n(r),e(r))}},zero:function(){return o.zero},one:function(){return o.one},implies:function(n,e){return function(r){return o.implies(n(r),e(r))}},not:function(n){return function(e){return o.not(n(e))}}}}},"getBooleanAlgebra");re.getBooleanAlgebra=Zm;var eh=c(function(o){return function(){return{concat:function(n,e){return function(r){return o.concat(n(r),e(r))}}}}},"getSemigroup");re.getSemigroup=eh;var th=c(function(o){var n=(0,re.getSemigroup)(o);return function(){return{concat:n().concat,empty:function(){return o.empty}}}},"getMonoid");re.getMonoid=th;var nh=c(function(o){return{add:function(n,e){return function(r){return o.add(n(r),e(r))}},zero:function(){return o.zero},mul:function(n,e){return function(r){return o.mul(n(r),e(r))}},one:function(){return o.one}}},"getSemiring");re.getSemiring=nh;var rh=c(function(o){var n=(0,re.getSemiring)(o);return{add:n.add,mul:n.mul,one:n.one,zero:n.zero,sub:function(e,r){return function(i){return o.sub(e(i),r(i))}}}},"getRing");re.getRing=rh;var oh=c(function(o){return function(n){return n(o)}},"apply");re.apply=oh;function ml(o){return o}c(ml,"identity");re.identity=ml;re.unsafeCoerce=ml;function os(o){return function(){return o}}c(os,"constant");re.constant=os;re.constTrue=os(!0);re.constFalse=os(!1);re.constNull=os(null);re.constUndefined=os(void 0);re.constVoid=re.constUndefined;function ih(o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.length>1?o(n[1],n[0]):function(r){return o(r)(n[0])}}}c(ih,"flip");re.flip=ih;function Ep(o,n,e,r,i,s,a,u,l){switch(arguments.length){case 1:return o;case 2:return function(){return n(o.apply(this,arguments))};case 3:return function(){return e(n(o.apply(this,arguments)))};case 4:return function(){return r(e(n(o.apply(this,arguments))))};case 5:return function(){return i(r(e(n(o.apply(this,arguments)))))};case 6:return function(){return s(i(r(e(n(o.apply(this,arguments))))))};case 7:return function(){return a(s(i(r(e(n(o.apply(this,arguments)))))))};case 8:return function(){return u(a(s(i(r(e(n(o.apply(this,arguments))))))))};case 9:return function(){return l(u(a(s(i(r(e(n(o.apply(this,arguments)))))))))}}}c(Ep,"flow");re.flow=Ep;function sh(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];return o}c(sh,"tuple");re.tuple=sh;function ah(o){return o+1}c(ah,"increment");re.increment=ah;function uh(o){return o-1}c(uh,"decrement");re.decrement=uh;function Sp(o){throw new Error("Called `absurd` function which should be uncallable")}c(Sp,"absurd");re.absurd=Sp;function lh(o){return function(n){return o.apply(void 0,n)}}c(lh,"tupled");re.tupled=lh;function ch(o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return o(n)}}c(ch,"untupled");re.untupled=ch;function ph(o,n,e,r,i,s,a,u,l){switch(arguments.length){case 1:return o;case 2:return n(o);case 3:return e(n(o));case 4:return r(e(n(o)));case 5:return i(r(e(n(o))));case 6:return s(i(r(e(n(o)))));case 7:return a(s(i(r(e(n(o))))));case 8:return u(a(s(i(r(e(n(o)))))));case 9:return l(u(a(s(i(r(e(n(o))))))));default:{for(var p=arguments[0],d=1;d<arguments.length;d++)p=arguments[d](p);return p}}}c(ph,"pipe");re.pipe=ph;re.hole=Sp;var dh=c(function(o,n){return n},"SK");re.SK=dh;function fh(o){return function(n){return!o(n)}}c(fh,"not");re.not=fh;var mh=c(function(){return{concat:function(o,n){return Ep(o,n)},empty:ml}},"getEndomorphismMonoid");re.getEndomorphismMonoid=mh});var is=gt(_e=>{"use strict";var hh=_e&&_e.__spreadArray||function(o,n,e){if(e||arguments.length===2)for(var r=0,i=n.length,s;r<i;r++)(s||!(r in n))&&(s||(s=Array.prototype.slice.call(n,0,r)),s[r]=n[r]);return o.concat(s||Array.prototype.slice.call(n))};Object.defineProperty(_e,"__esModule",{value:!0});_e.fromReadonlyNonEmptyArray=_e.has=_e.emptyRecord=_e.emptyReadonlyArray=_e.tail=_e.head=_e.isNonEmpty=_e.singleton=_e.right=_e.left=_e.isRight=_e.isLeft=_e.some=_e.none=_e.isSome=_e.isNone=void 0;var gh=c(function(o){return o._tag==="None"},"isNone");_e.isNone=gh;var Dh=c(function(o){return o._tag==="Some"},"isSome");_e.isSome=Dh;_e.none={_tag:"None"};var vh=c(function(o){return{_tag:"Some",value:o}},"some");_e.some=vh;var yh=c(function(o){return o._tag==="Left"},"isLeft");_e.isLeft=yh;var bh=c(function(o){return o._tag==="Right"},"isRight");_e.isRight=bh;var Ch=c(function(o){return{_tag:"Left",left:o}},"left");_e.left=Ch;var xh=c(function(o){return{_tag:"Right",right:o}},"right");_e.right=xh;var wh=c(function(o){return[o]},"singleton");_e.singleton=wh;var Ah=c(function(o){return o.length>0},"isNonEmpty");_e.isNonEmpty=Ah;var Th=c(function(o){return o[0]},"head");_e.head=Th;var Eh=c(function(o){return o.slice(1)},"tail");_e.tail=Eh;_e.emptyReadonlyArray=[];_e.emptyRecord={};_e.has=Object.prototype.hasOwnProperty;var Sh=c(function(o){return hh([o[0]],o.slice(1),!0)},"fromReadonlyNonEmptyArray");_e.fromReadonlyNonEmptyArray=Sh});var Dl=gt(ut=>{"use strict";var _h=ut&&ut.__createBinding||(Object.create?function(o,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(o,r,i)}:function(o,n,e,r){r===void 0&&(r=e),o[r]=n[e]}),Mh=ut&&ut.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),Rh=ut&&ut.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var e in o)e!=="default"&&Object.prototype.hasOwnProperty.call(o,e)&&_h(n,o,e);return Mh(n,o),n};Object.defineProperty(ut,"__esModule",{value:!0});ut.sequenceS=ut.sequenceT=ut.getApplySemigroup=ut.apS=ut.apSecond=ut.apFirst=ut.ap=void 0;var Oh=To(),Nh=Rh(is());function Fh(o,n){return function(e){return function(r){return o.ap(o.map(r,function(i){return function(s){return n.ap(i,s)}}),e)}}}c(Fh,"ap");ut.ap=Fh;function Bh(o){return function(n){return function(e){return o.ap(o.map(e,function(r){return function(){return r}}),n)}}}c(Bh,"apFirst");ut.apFirst=Bh;function Ih(o){return function(n){return function(e){return o.ap(o.map(e,function(){return function(r){return r}}),n)}}}c(Ih,"apSecond");ut.apSecond=Ih;function Ph(o){return function(n,e){return function(r){return o.ap(o.map(r,function(i){return function(s){var a;return Object.assign({},i,(a={},a[n]=s,a))}}),e)}}}c(Ph,"apS");ut.apS=Ph;function kh(o){return function(n){return{concat:function(e,r){return o.ap(o.map(e,function(i){return function(s){return n.concat(i,s)}}),r)}}}}c(kh,"getApplySemigroup");ut.getApplySemigroup=kh;function gl(o,n,e){return function(r){for(var i=Array(e.length+1),s=0;s<e.length;s++)i[s]=e[s];return i[e.length]=r,n===0?o.apply(null,i):gl(o,n-1,i)}}c(gl,"curried");var hl={1:function(o){return[o]},2:function(o){return function(n){return[o,n]}},3:function(o){return function(n){return function(e){return[o,n,e]}}},4:function(o){return function(n){return function(e){return function(r){return[o,n,e,r]}}}},5:function(o){return function(n){return function(e){return function(r){return function(i){return[o,n,e,r,i]}}}}}};function Vh(o){return Nh.has.call(hl,o)||(hl[o]=gl(Oh.tuple,o-1,[])),hl[o]}c(Vh,"getTupleConstructor");function Lh(o){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var r=n.length,i=Vh(r),s=o.map(n[0],i),a=1;a<r;a++)s=o.ap(s,n[a]);return s}}c(Lh,"sequenceT");ut.sequenceT=Lh;function Hh(o){var n=o.length;switch(n){case 1:return function(e){var r;return r={},r[o[0]]=e,r};case 2:return function(e){return function(r){var i;return i={},i[o[0]]=e,i[o[1]]=r,i}};case 3:return function(e){return function(r){return function(i){var s;return s={},s[o[0]]=e,s[o[1]]=r,s[o[2]]=i,s}}};case 4:return function(e){return function(r){return function(i){return function(s){var a;return a={},a[o[0]]=e,a[o[1]]=r,a[o[2]]=i,a[o[3]]=s,a}}}};case 5:return function(e){return function(r){return function(i){return function(s){return function(a){var u;return u={},u[o[0]]=e,u[o[1]]=r,u[o[2]]=i,u[o[3]]=s,u[o[4]]=a,u}}}}};default:return gl(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var i={},s=0;s<n;s++)i[o[s]]=e[s];return i},n-1,[])}}c(Hh,"getRecordConstructor");function Wh(o){return function(n){for(var e=Object.keys(n),r=e.length,i=Hh(e),s=o.map(n[e[0]],i),a=1;a<r;a++)s=o.ap(s,n[e[a]]);return s}}c(Wh,"sequenceS");ut.sequenceS=Wh});var ga=gt(xn=>{"use strict";Object.defineProperty(xn,"__esModule",{value:!0});xn.getFunctorComposition=xn.let=xn.bindTo=xn.flap=xn.map=void 0;var Gh=To();function _p(o,n){return function(e){return function(r){return o.map(r,function(i){return n.map(i,e)})}}}c(_p,"map");xn.map=_p;function Uh(o){return function(n){return function(e){return o.map(e,function(r){return r(n)})}}}c(Uh,"flap");xn.flap=Uh;function zh(o){return function(n){return function(e){return o.map(e,function(r){var i;return i={},i[n]=r,i})}}}c(zh,"bindTo");xn.bindTo=zh;function qh(o){return function(n,e){return function(r){return o.map(r,function(i){var s;return Object.assign({},i,(s={},s[n]=e(i),s))})}}}c(qh,"let_");xn.let=qh;function Xh(o,n){var e=_p(o,n);return{map:function(r,i){return(0,Gh.pipe)(r,e(i))}}}c(Xh,"getFunctorComposition");xn.getFunctorComposition=Xh});var Rp=gt(ii=>{"use strict";Object.defineProperty(ii,"__esModule",{value:!0});ii.getApplicativeComposition=ii.getApplicativeMonoid=void 0;var Mp=Dl(),Yh=To(),$h=ga();function Qh(o){var n=(0,Mp.getApplySemigroup)(o);return function(e){return{concat:n(e).concat,empty:o.of(e.empty)}}}c(Qh,"getApplicativeMonoid");ii.getApplicativeMonoid=Qh;function jh(o,n){var e=(0,$h.getFunctorComposition)(o,n).map,r=(0,Mp.ap)(o,n);return{map:e,of:function(i){return o.of(n.of(i))},ap:function(i,s){return(0,Yh.pipe)(i,r(s))}}}c(jh,"getApplicativeComposition");ii.getApplicativeComposition=jh});var vl=gt(si=>{"use strict";Object.defineProperty(si,"__esModule",{value:!0});si.bind=si.chainFirst=void 0;function Kh(o){return function(n){return function(e){return o.chain(e,function(r){return o.map(n(r),function(){return r})})}}}c(Kh,"chainFirst");si.chainFirst=Kh;function Jh(o){return function(n,e){return function(r){return o.chain(r,function(i){return o.map(e(i),function(s){var a;return Object.assign({},i,(a={},a[n]=s,a))})})}}}c(Jh,"bind");si.bind=Jh});var Op=gt(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.tailRec=void 0;var Zh=c(function(o,n){for(var e=n(o);e._tag==="Left";)e=n(e.left);return e.right},"tailRec");Da.tailRec=Zh});var Bp=gt(rt=>{"use strict";var e2=rt&&rt.__createBinding||(Object.create?function(o,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(o,r,i)}:function(o,n,e,r){r===void 0&&(r=e),o[r]=n[e]}),t2=rt&&rt.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),n2=rt&&rt.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var e in o)e!=="default"&&Object.prototype.hasOwnProperty.call(o,e)&&e2(n,o,e);return t2(n,o),n};Object.defineProperty(rt,"__esModule",{value:!0});rt.filterOrElse=rt.chainFirstEitherK=rt.chainEitherK=rt.fromEitherK=rt.chainOptionK=rt.fromOptionK=rt.fromPredicate=rt.fromOption=void 0;var r2=vl(),yl=To(),Eo=n2(is());function Np(o){return function(n){return function(e){return o.fromEither(Eo.isNone(e)?Eo.left(n()):Eo.right(e.value))}}}c(Np,"fromOption");rt.fromOption=Np;function o2(o){return function(n,e){return function(r){return o.fromEither(n(r)?Eo.right(r):Eo.left(e(r)))}}}c(o2,"fromPredicate");rt.fromPredicate=o2;function Fp(o){var n=Np(o);return function(e){var r=n(e);return function(i){return(0,yl.flow)(i,r)}}}c(Fp,"fromOptionK");rt.fromOptionK=Fp;function i2(o,n){var e=Fp(o);return function(r){var i=e(r);return function(s){return function(a){return n.chain(a,i(s))}}}}c(i2,"chainOptionK");rt.chainOptionK=i2;function bl(o){return function(n){return(0,yl.flow)(n,o.fromEither)}}c(bl,"fromEitherK");rt.fromEitherK=bl;function s2(o,n){var e=bl(o);return function(r){return function(i){return n.chain(i,e(r))}}}c(s2,"chainEitherK");rt.chainEitherK=s2;function a2(o,n){return(0,yl.flow)(bl(o),(0,r2.chainFirst)(n))}c(a2,"chainFirstEitherK");rt.chainFirstEitherK=a2;function u2(o,n){return function(e,r){return function(i){return n.chain(i,function(s){return o.fromEither(e(s)?Eo.right(s):Eo.left(r(s)))})}}}c(u2,"filterOrElse");rt.filterOrElse=u2});var Ip=gt(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.right=xe.left=xe.flap=xe.Functor=xe.Bifunctor=xe.URI=xe.bimap=xe.mapLeft=xe.map=xe.separated=void 0;var Cl=To(),l2=ga(),c2=c(function(o,n){return{left:o,right:n}},"separated");xe.separated=c2;var p2=c(function(o,n){return(0,Cl.pipe)(o,(0,xe.map)(n))},"_map"),d2=c(function(o,n){return(0,Cl.pipe)(o,(0,xe.mapLeft)(n))},"_mapLeft"),f2=c(function(o,n,e){return(0,Cl.pipe)(o,(0,xe.bimap)(n,e))},"_bimap"),m2=c(function(o){return function(n){return(0,xe.separated)((0,xe.left)(n),o((0,xe.right)(n)))}},"map");xe.map=m2;var h2=c(function(o){return function(n){return(0,xe.separated)(o((0,xe.left)(n)),(0,xe.right)(n))}},"mapLeft");xe.mapLeft=h2;var g2=c(function(o,n){return function(e){return(0,xe.separated)(o((0,xe.left)(e)),n((0,xe.right)(e)))}},"bimap");xe.bimap=g2;xe.URI="Separated";xe.Bifunctor={URI:xe.URI,mapLeft:d2,bimap:f2};xe.Functor={URI:xe.URI,map:p2};xe.flap=(0,l2.flap)(xe.Functor);var D2=c(function(o){return o.left},"left");xe.left=D2;var v2=c(function(o){return o.right},"right");xe.right=v2});var kp=gt(cn=>{"use strict";var y2=cn&&cn.__createBinding||(Object.create?function(o,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(o,r,i)}:function(o,n,e,r){r===void 0&&(r=e),o[r]=n[e]}),b2=cn&&cn.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),C2=cn&&cn.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var e in o)e!=="default"&&Object.prototype.hasOwnProperty.call(o,e)&&y2(n,o,e);return b2(n,o),n};Object.defineProperty(cn,"__esModule",{value:!0});cn.filterE=cn.witherDefault=cn.wiltDefault=void 0;var Pp=C2(is());function x2(o,n){return function(e){var r=o.traverse(e);return function(i,s){return e.map(r(i,s),n.separate)}}}c(x2,"wiltDefault");cn.wiltDefault=x2;function w2(o,n){return function(e){var r=o.traverse(e);return function(i,s){return e.map(r(i,s),n.compact)}}}c(w2,"witherDefault");cn.witherDefault=w2;function A2(o){return function(n){var e=o.wither(n);return function(r){return function(i){return e(i,function(s){return n.map(r(s),function(a){return a?Pp.some(s):Pp.none})})}}}}c(A2,"filterE");cn.filterE=A2});var ya=gt(g=>{"use strict";var T2=g&&g.__createBinding||(Object.create?function(o,n,e,r){r===void 0&&(r=e);var i=Object.getOwnPropertyDescriptor(n,e);(!i||("get"in i?!n.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return n[e]}}),Object.defineProperty(o,r,i)}:function(o,n,e,r){r===void 0&&(r=e),o[r]=n[e]}),E2=g&&g.__setModuleDefault||(Object.create?function(o,n){Object.defineProperty(o,"default",{enumerable:!0,value:n})}:function(o,n){o.default=n}),S2=g&&g.__importStar||function(o){if(o&&o.__esModule)return o;var n={};if(o!=null)for(var e in o)e!=="default"&&Object.prototype.hasOwnProperty.call(o,e)&&T2(n,o,e);return E2(n,o),n};Object.defineProperty(g,"__esModule",{value:!0});g.fold=g.match=g.foldW=g.matchW=g.isRight=g.isLeft=g.fromOption=g.fromPredicate=g.FromEither=g.MonadThrow=g.throwError=g.ChainRec=g.Extend=g.extend=g.Alt=g.alt=g.altW=g.Bifunctor=g.mapLeft=g.bimap=g.Traversable=g.sequence=g.traverse=g.Foldable=g.reduceRight=g.foldMap=g.reduce=g.Monad=g.Chain=g.chain=g.chainW=g.Applicative=g.Apply=g.ap=g.apW=g.Pointed=g.of=g.Functor=g.map=g.getAltValidation=g.getApplicativeValidation=g.getWitherable=g.getFilterable=g.getCompactable=g.getSemigroup=g.getEq=g.getShow=g.URI=g.right=g.left=void 0;g.getValidation=g.getValidationMonoid=g.getValidationSemigroup=g.getApplyMonoid=g.getApplySemigroup=g.either=g.stringifyJSON=g.parseJSON=g.sequenceArray=g.traverseArray=g.traverseArrayWithIndex=g.traverseReadonlyArrayWithIndex=g.traverseReadonlyNonEmptyArrayWithIndex=g.ApT=g.apSW=g.apS=g.bindW=g.bind=g.let=g.bindTo=g.Do=g.exists=g.elem=g.toError=g.toUnion=g.chainNullableK=g.fromNullableK=g.tryCatchK=g.tryCatch=g.fromNullable=g.orElse=g.orElseW=g.swap=g.filterOrElseW=g.filterOrElse=g.chainOptionK=g.fromOptionK=g.duplicate=g.flatten=g.flattenW=g.chainFirstW=g.chainFirst=g.apSecondW=g.apSecond=g.apFirstW=g.apFirst=g.flap=g.getOrElse=g.getOrElseW=void 0;var Lp=Rp(),ss=Dl(),Hp=vl(),_2=Op(),as=Bp(),Mt=To(),xl=ga(),Lr=S2(is()),vr=Ip(),Vp=kp();g.left=Lr.left;g.right=Lr.right;var qt=c(function(o,n){return(0,Mt.pipe)(o,(0,g.map)(n))},"_map"),So=c(function(o,n){return(0,Mt.pipe)(o,(0,g.ap)(n))},"_ap"),ai=c(function(o,n){return(0,Mt.pipe)(o,(0,g.chain)(n))},"_chain"),us=c(function(o,n,e){return(0,Mt.pipe)(o,(0,g.reduce)(n,e))},"_reduce"),ls=c(function(o){return function(n,e){var r=(0,g.foldMap)(o);return(0,Mt.pipe)(n,r(e))}},"_foldMap"),cs=c(function(o,n,e){return(0,Mt.pipe)(o,(0,g.reduceRight)(n,e))},"_reduceRight"),va=c(function(o){var n=(0,g.traverse)(o);return function(e,r){return(0,Mt.pipe)(e,n(r))}},"_traverse"),wl=c(function(o,n,e){return(0,Mt.pipe)(o,(0,g.bimap)(n,e))},"_bimap"),Al=c(function(o,n){return(0,Mt.pipe)(o,(0,g.mapLeft)(n))},"_mapLeft"),Wp=c(function(o,n){return(0,Mt.pipe)(o,(0,g.alt)(n))},"_alt"),Tl=c(function(o,n){return(0,Mt.pipe)(o,(0,g.extend)(n))},"_extend"),El=c(function(o,n){return(0,_2.tailRec)(n(o),function(e){return(0,g.isLeft)(e)?(0,g.right)((0,g.left)(e.left)):(0,g.isLeft)(e.right)?(0,g.left)(n(e.right.left)):(0,g.right)((0,g.right)(e.right.right))})},"_chainRec");g.URI="Either";var M2=c(function(o,n){return{show:function(e){return(0,g.isLeft)(e)?"left(".concat(o.show(e.left),")"):"right(".concat(n.show(e.right),")")}}},"getShow");g.getShow=M2;var R2=c(function(o,n){return{equals:function(e,r){return e===r||((0,g.isLeft)(e)?(0,g.isLeft)(r)&&o.equals(e.left,r.left):(0,g.isRight)(r)&&n.equals(e.right,r.right))}}},"getEq");g.getEq=R2;var O2=c(function(o){return{concat:function(n,e){return(0,g.isLeft)(e)?n:(0,g.isLeft)(n)?e:(0,g.right)(o.concat(n.right,e.right))}}},"getSemigroup");g.getSemigroup=O2;var N2=c(function(o){var n=(0,g.left)(o.empty);return{URI:g.URI,_E:void 0,compact:function(e){return(0,g.isLeft)(e)?e:e.right._tag==="None"?n:(0,g.right)(e.right.value)},separate:function(e){return(0,g.isLeft)(e)?(0,vr.separated)(e,e):(0,g.isLeft)(e.right)?(0,vr.separated)((0,g.right)(e.right.left),n):(0,vr.separated)(n,(0,g.right)(e.right.right))}}},"getCompactable");g.getCompactable=N2;var F2=c(function(o){var n=(0,g.left)(o.empty),e=(0,g.getCompactable)(o),r=e.compact,i=e.separate,s=c(function(u,l){return(0,g.isLeft)(u)||l(u.right)?u:n},"filter"),a=c(function(u,l){return(0,g.isLeft)(u)?(0,vr.separated)(u,u):l(u.right)?(0,vr.separated)(n,(0,g.right)(u.right)):(0,vr.separated)((0,g.right)(u.right),n)},"partition");return{URI:g.URI,_E:void 0,map:qt,compact:r,separate:i,filter:s,filterMap:function(u,l){if((0,g.isLeft)(u))return u;var p=l(u.right);return p._tag==="None"?n:(0,g.right)(p.value)},partition:a,partitionMap:function(u,l){if((0,g.isLeft)(u))return(0,vr.separated)(u,u);var p=l(u.right);return(0,g.isLeft)(p)?(0,vr.separated)((0,g.right)(p.left),n):(0,vr.separated)(n,(0,g.right)(p.right))}}},"getFilterable");g.getFilterable=F2;var B2=c(function(o){var n=(0,g.getFilterable)(o),e=(0,g.getCompactable)(o);return{URI:g.URI,_E:void 0,map:qt,compact:n.compact,separate:n.separate,filter:n.filter,filterMap:n.filterMap,partition:n.partition,partitionMap:n.partitionMap,traverse:va,sequence:g.sequence,reduce:us,foldMap:ls,reduceRight:cs,wither:(0,Vp.witherDefault)(g.Traversable,e),wilt:(0,Vp.wiltDefault)(g.Traversable,e)}},"getWitherable");g.getWitherable=B2;var I2=c(function(o){return{URI:g.URI,_E:void 0,map:qt,ap:function(n,e){return(0,g.isLeft)(n)?(0,g.isLeft)(e)?(0,g.left)(o.concat(n.left,e.left)):n:(0,g.isLeft)(e)?e:(0,g.right)(n.right(e.right))},of:g.of}},"getApplicativeValidation");g.getApplicativeValidation=I2;var P2=c(function(o){return{URI:g.URI,_E:void 0,map:qt,alt:function(n,e){if((0,g.isRight)(n))return n;var r=e();return(0,g.isLeft)(r)?(0,g.left)(o.concat(n.left,r.left)):r}}},"getAltValidation");g.getAltValidation=P2;var k2=c(function(o){return function(n){return(0,g.isLeft)(n)?n:(0,g.right)(o(n.right))}},"map");g.map=k2;g.Functor={URI:g.URI,map:qt};g.of=g.right;g.Pointed={URI:g.URI,of:g.of};var V2=c(function(o){return function(n){return(0,g.isLeft)(n)?n:(0,g.isLeft)(o)?o:(0,g.right)(n.right(o.right))}},"apW");g.apW=V2;g.ap=g.apW;g.Apply={URI:g.URI,map:qt,ap:So};g.Applicative={URI:g.URI,map:qt,ap:So,of:g.of};var L2=c(function(o){return function(n){return(0,g.isLeft)(n)?n:o(n.right)}},"chainW");g.chainW=L2;g.chain=g.chainW;g.Chain={URI:g.URI,map:qt,ap:So,chain:ai};g.Monad={URI:g.URI,map:qt,ap:So,of:g.of,chain:ai};var H2=c(function(o,n){return function(e){return(0,g.isLeft)(e)?o:n(o,e.right)}},"reduce");g.reduce=H2;var W2=c(function(o){return function(n){return function(e){return(0,g.isLeft)(e)?o.empty:n(e.right)}}},"foldMap");g.foldMap=W2;var G2=c(function(o,n){return function(e){return(0,g.isLeft)(e)?o:n(e.right,o)}},"reduceRight");g.reduceRight=G2;g.Foldable={URI:g.URI,reduce:us,foldMap:ls,reduceRight:cs};var U2=c(function(o){return function(n){return function(e){return(0,g.isLeft)(e)?o.of((0,g.left)(e.left)):o.map(n(e.right),g.right)}}},"traverse");g.traverse=U2;var z2=c(function(o){return function(n){return(0,g.isLeft)(n)?o.of((0,g.left)(n.left)):o.map(n.right,g.right)}},"sequence");g.sequence=z2;g.Traversable={URI:g.URI,map:qt,reduce:us,foldMap:ls,reduceRight:cs,traverse:va,sequence:g.sequence};var q2=c(function(o,n){return function(e){return(0,g.isLeft)(e)?(0,g.left)(o(e.left)):(0,g.right)(n(e.right))}},"bimap");g.bimap=q2;var X2=c(function(o){return function(n){return(0,g.isLeft)(n)?(0,g.left)(o(n.left)):n}},"mapLeft");g.mapLeft=X2;g.Bifunctor={URI:g.URI,bimap:wl,mapLeft:Al};var Y2=c(function(o){return function(n){return(0,g.isLeft)(n)?o():n}},"altW");g.altW=Y2;g.alt=g.altW;g.Alt={URI:g.URI,map:qt,alt:Wp};var $2=c(function(o){return function(n){return(0,g.isLeft)(n)?n:(0,g.right)(o(n))}},"extend");g.extend=$2;g.Extend={URI:g.URI,map:qt,extend:Tl};g.ChainRec={URI:g.URI,map:qt,ap:So,chain:ai,chainRec:El};g.throwError=g.left;g.MonadThrow={URI:g.URI,map:qt,ap:So,of:g.of,chain:ai,throwError:g.throwError};g.FromEither={URI:g.URI,fromEither:Mt.identity};g.fromPredicate=(0,as.fromPredicate)(g.FromEither);g.fromOption=(0,as.fromOption)(g.FromEither);g.isLeft=Lr.isLeft;g.isRight=Lr.isRight;var Q2=c(function(o,n){return function(e){return(0,g.isLeft)(e)?o(e.left):n(e.right)}},"matchW");g.matchW=Q2;g.foldW=g.matchW;g.match=g.matchW;g.fold=g.match;var j2=c(function(o){return function(n){return(0,g.isLeft)(n)?o(n.left):n.right}},"getOrElseW");g.getOrElseW=j2;g.getOrElse=g.getOrElseW;g.flap=(0,xl.flap)(g.Functor);g.apFirst=(0,ss.apFirst)(g.Apply);g.apFirstW=g.apFirst;g.apSecond=(0,ss.apSecond)(g.Apply);g.apSecondW=g.apSecond;g.chainFirst=(0,Hp.chainFirst)(g.Chain);g.chainFirstW=g.chainFirst;g.flattenW=(0,g.chainW)(Mt.identity);g.flatten=g.flattenW;g.duplicate=(0,g.extend)(Mt.identity);g.fromOptionK=(0,as.fromOptionK)(g.FromEither);g.chainOptionK=(0,as.chainOptionK)(g.FromEither,g.Chain);g.filterOrElse=(0,as.filterOrElse)(g.FromEither,g.Chain);g.filterOrElseW=g.filterOrElse;var K2=c(function(o){return(0,g.isLeft)(o)?(0,g.right)(o.left):(0,g.left)(o.right)},"swap");g.swap=K2;var J2=c(function(o){return function(n){return(0,g.isLeft)(n)?o(n.left):n}},"orElseW");g.orElseW=J2;g.orElse=g.orElseW;var Z2=c(function(o){return function(n){return n==null?(0,g.left)(o):(0,g.right)(n)}},"fromNullable");g.fromNullable=Z2;var eg=c(function(o,n){try{return(0,g.right)(o())}catch(e){return(0,g.left)(n(e))}},"tryCatch");g.tryCatch=eg;var tg=c(function(o,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return(0,g.tryCatch)(function(){return o.apply(void 0,e)},n)}},"tryCatchK");g.tryCatchK=tg;var ng=c(function(o){var n=(0,g.fromNullable)(o);return function(e){return(0,Mt.flow)(e,n)}},"fromNullableK");g.fromNullableK=ng;var rg=c(function(o){var n=(0,g.fromNullableK)(o);return function(e){return(0,g.chain)(n(e))}},"chainNullableK");g.chainNullableK=rg;g.toUnion=(0,g.foldW)(Mt.identity,Mt.identity);function og(o){return o instanceof Error?o:new Error(String(o))}c(og,"toError");g.toError=og;function Gp(o){return function(n,e){if(e===void 0){var r=Gp(o);return function(i){return r(n,i)}}return(0,g.isLeft)(e)?!1:o.equals(n,e.right)}}c(Gp,"elem");g.elem=Gp;var ig=c(function(o){return function(n){return(0,g.isLeft)(n)?!1:o(n.right)}},"exists");g.exists=ig;g.Do=(0,g.of)(Lr.emptyRecord);g.bindTo=(0,xl.bindTo)(g.Functor);var sg=(0,xl.let)(g.Functor);g.let=sg;g.bind=(0,Hp.bind)(g.Chain);g.bindW=g.bind;g.apS=(0,ss.apS)(g.Apply);g.apSW=g.apS;g.ApT=(0,g.of)(Lr.emptyReadonlyArray);var ag=c(function(o){return function(n){var e=o(0,Lr.head(n));if((0,g.isLeft)(e))return e;for(var r=[e.right],i=1;i<n.length;i++){var s=o(i,n[i]);if((0,g.isLeft)(s))return s;r.push(s.right)}return(0,g.right)(r)}},"traverseReadonlyNonEmptyArrayWithIndex");g.traverseReadonlyNonEmptyArrayWithIndex=ag;var ug=c(function(o){var n=(0,g.traverseReadonlyNonEmptyArrayWithIndex)(o);return function(e){return Lr.isNonEmpty(e)?n(e):g.ApT}},"traverseReadonlyArrayWithIndex");g.traverseReadonlyArrayWithIndex=ug;g.traverseArrayWithIndex=g.traverseReadonlyArrayWithIndex;var lg=c(function(o){return(0,g.traverseReadonlyArrayWithIndex)(function(n,e){return o(e)})},"traverseArray");g.traverseArray=lg;g.sequenceArray=(0,g.traverseArray)(Mt.identity);function cg(o,n){return(0,g.tryCatch)(function(){return JSON.parse(o)},n)}c(cg,"parseJSON");g.parseJSON=cg;var pg=c(function(o,n){return(0,g.tryCatch)(function(){var e=JSON.stringify(o);if(typeof e!="string")throw new Error("Converting unsupported structure to JSON");return e},n)},"stringifyJSON");g.stringifyJSON=pg;g.either={URI:g.URI,map:qt,of:g.of,ap:So,chain:ai,reduce:us,foldMap:ls,reduceRight:cs,traverse:va,sequence:g.sequence,bimap:wl,mapLeft:Al,alt:Wp,extend:Tl,chainRec:El,throwError:g.throwError};g.getApplySemigroup=(0,ss.getApplySemigroup)(g.Apply);g.getApplyMonoid=(0,Lp.getApplicativeMonoid)(g.Applicative);var dg=c(function(o,n){return(0,ss.getApplySemigroup)((0,g.getApplicativeValidation)(o))(n)},"getValidationSemigroup");g.getValidationSemigroup=dg;var fg=c(function(o,n){return(0,Lp.getApplicativeMonoid)((0,g.getApplicativeValidation)(o))(n)},"getValidationMonoid");g.getValidationMonoid=fg;function mg(o){var n=(0,g.getApplicativeValidation)(o).ap,e=(0,g.getAltValidation)(o).alt;return{URI:g.URI,_E:void 0,map:qt,of:g.of,chain:ai,bimap:wl,mapLeft:Al,reduce:us,foldMap:ls,reduceRight:cs,extend:Tl,traverse:va,sequence:g.sequence,chainRec:El,throwError:g.throwError,ap:n,alt:e}}c(mg,"getValidation");g.getValidation=mg});var Me=gt(y=>{"use strict";var Ve=y&&y.__extends||function(){var o=c(function(n,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(r[s]=i[s])},o(n,e)},"extendStatics");return function(n,e){o(n,e);function r(){this.constructor=n}c(r,"__"),n.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}(),ui=y&&y.__assign||function(){return ui=Object.assign||function(o){for(var n,e=1,r=arguments.length;e<r;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o[i]=n[i])}return o},ui.apply(this,arguments)},hg=y&&y.__spreadArrays||function(){for(var o=0,n=0,e=arguments.length;n<e;n++)o+=arguments[n].length;for(var r=Array(o),i=0,n=0;n<e;n++)for(var s=arguments[n],a=0,u=s.length;a<u;a++,i++)r[i]=s[a];return r};Object.defineProperty(y,"__esModule",{value:!0});y.partial=y.PartialType=y.type=y.InterfaceType=y.array=y.ArrayType=y.recursion=y.RecursiveType=y.Int=y.brand=y.RefinementType=y.keyof=y.KeyofType=y.literal=y.LiteralType=y.void=y.undefined=y.null=y.UnknownRecord=y.AnyDictionaryType=y.UnknownArray=y.AnyArrayType=y.boolean=y.BooleanType=y.bigint=y.BigIntType=y.number=y.NumberType=y.string=y.StringType=y.unknown=y.UnknownType=y.voidType=y.VoidType=y.UndefinedType=y.nullType=y.NullType=y.getIndex=y.getTags=y.emptyTags=y.mergeAll=y.getDomainKeys=y.appendContext=y.getContextEntry=y.getFunctionName=y.identity=y.Type=y.success=y.failure=y.failures=void 0;y.alias=y.clean=y.StrictType=y.dictionary=y.Integer=y.refinement=y.object=y.ObjectType=y.Dictionary=y.any=y.AnyType=y.never=y.NeverType=y.getDefaultContext=y.getValidationError=y.interface=y.Array=y.taggedUnion=y.TaggedUnionType=y.Function=y.FunctionType=y.exact=y.ExactType=y.strict=y.readonlyArray=y.ReadonlyArrayType=y.readonly=y.ReadonlyType=y.tuple=y.TupleType=y.intersection=y.IntersectionType=y.union=y.UnionType=y.record=y.DictionaryType=void 0;var lt=ya();y.failures=lt.left;var gg=c(function(o,n,e){return y.failures([{value:o,context:n,message:e}])},"failure");y.failure=gg;y.success=lt.right;var Le=function(){function o(n,e,r,i){this.name=n,this.is=e,this.validate=r,this.encode=i,this.decode=this.decode.bind(this)}return c(o,"Type"),o.prototype.pipe=function(n,e){var r=this;return e===void 0&&(e="pipe("+this.name+", "+n.name+")"),new o(e,n.is,function(i,s){var a=r.validate(i,s);return lt.isLeft(a)?a:n.validate(a.right,s)},this.encode===y.identity&&n.encode===y.identity?y.identity:function(i){return r.encode(n.encode(i))})},o.prototype.asDecoder=function(){return this},o.prototype.asEncoder=function(){return this},o.prototype.decode=function(n){return this.validate(n,[{key:"",type:this,actual:n}])},o}();y.Type=Le;var Dg=c(function(o){return o},"identity");y.identity=Dg;function qp(o){return o.displayName||o.name||"<function"+o.length+">"}c(qp,"getFunctionName");y.getFunctionName=qp;function vg(o,n){return{key:o,type:n}}c(vg,"getContextEntry");y.getContextEntry=vg;function kn(o,n,e,r){for(var i=o.length,s=Array(i+1),a=0;a<i;a++)s[a]=o[a];return s[i]={key:n,type:e,actual:r},s}c(kn,"appendContext");y.appendContext=kn;function yr(o,n){for(var e=n.length,r=0;r<e;r++)o.push(n[r])}c(yr,"pushAll");var ba=Object.prototype.hasOwnProperty;function _l(o){return Object.keys(o).map(function(n){return n+": "+o[n].name}).join(", ")}c(_l,"getNameFromProps");function ps(o){for(var n=0;n<o.length;n++)if(o[n].encode!==y.identity)return!1;return!0}c(ps,"useIdentity");function Xp(o){return"{ "+_l(o)+" }"}c(Xp,"getInterfaceTypeName");function Yp(o){return"Partial<"+o+">"}c(Yp,"getPartialTypeName");function yg(o,n,e,r){r===void 0&&(r="{ [K in "+n.name+"]: "+e.name+" }");var i=o.length;return new Bl(r,function(s){return y.UnknownRecord.is(s)&&o.every(function(a){return e.is(s[a])})},function(s,a){var u=y.UnknownRecord.validate(s,a);if(lt.isLeft(u))return u;for(var l=u.right,p={},d=[],f=!1,m=0;m<i;m++){var h=o[m],v=l[h],D=e.validate(v,kn(a,h,e,v));if(lt.isLeft(D))yr(d,D.left);else{var b=D.right;f=f||b!==v,p[h]=b}}return d.length>0?y.failures(d):y.success(f||Object.keys(l).length!==i?p:l)},e.encode===y.identity?y.identity:function(s){for(var a={},u=0;u<i;u++){var l=o[u];a[l]=e.encode(s[l])}return a},n,e)}c(yg,"enumerableRecord");function Ol(o){var n;if(jp(o)){var e=o.value;if(y.string.is(e))return n={},n[e]=null,n}else{if(Tg(o))return o.keys;if(Jp(o)){var r=o.types.map(function(i){return Ol(i)});return r.some(Ca.is)?void 0:Object.assign.apply(Object,hg([{}],r))}}}c(Ol,"getDomainKeys");y.getDomainKeys=Ol;function bg(o,n,e){return e===void 0&&(e="{ [K in "+o.name+"]: "+n.name+" }"),new Bl(e,function(r){return y.UnknownRecord.is(r)?Object.keys(r).every(function(i){return o.is(i)&&n.is(r[i])}):zp(n)&&Array.isArray(r)},function(r,i){if(y.UnknownRecord.is(r)){for(var s={},a=[],u=Object.keys(r),l=u.length,p=!1,d=0;d<l;d++){var f=u[d],m=r[f],h=o.validate(f,kn(i,f,o,f));if(lt.isLeft(h))yr(a,h.left);else{var v=h.right;p=p||v!==f,f=v;var D=n.validate(m,kn(i,f,n,m));if(lt.isLeft(D))yr(a,D.left);else{var b=D.right;p=p||b!==m,s[f]=b}}}return a.length>0?y.failures(a):y.success(p?s:r)}return zp(n)&&Array.isArray(r)?y.success(r):y.failure(r,i)},o.encode===y.identity&&n.encode===y.identity?y.identity:function(r){for(var i={},s=Object.keys(r),a=s.length,u=0;u<a;u++){var l=s[u];i[String(o.encode(l))]=n.encode(r[l])}return i},o,n)}c(bg,"nonEnumerableRecord");function $p(o){return"("+o.map(function(n){return n.name}).join(" | ")+")"}c($p,"getUnionName");function Ml(o,n){for(var e=!0,r=!0,i=!y.UnknownRecord.is(o),s=0,a=n;s<a.length;s++){var u=a[s];u!==o&&(e=!1),y.UnknownRecord.is(u)&&(r=!1)}if(e)return o;if(r)return n[n.length-1];for(var l={},p=0,d=n;p<d.length;p++){var u=d[p];for(var f in u)(!l.hasOwnProperty(f)||i||u[f]!==o[f])&&(l[f]=u[f])}return l}c(Ml,"mergeAll");y.mergeAll=Ml;function Rl(o){switch(o._tag){case"RefinementType":case"ReadonlyType":return Rl(o.type);case"InterfaceType":case"StrictType":case"PartialType":return o.props;case"IntersectionType":return o.types.reduce(function(n,e){return Object.assign(n,Rl(e))},{})}}c(Rl,"getProps");function Up(o,n){for(var e=Object.getOwnPropertyNames(o),r=!1,i={},s=0;s<e.length;s++){var a=e[s];ba.call(n,a)?i[a]=o[a]:r=!0}return r?i:o}c(Up,"stripKeys");function Cg(o){return Kp(o)?"{| "+_l(o.props)+" |}":Eg(o)?Yp("{| "+_l(o.props)+" |}"):"Exact<"+o.name+">"}c(Cg,"getExactTypeName");function xg(o){return o.length>0}c(xg,"isNonEmpty");y.emptyTags={};function Qp(o,n){for(var e=[],r=0,i=o;r<i.length;r++){var s=i[r];n.indexOf(s)!==-1&&e.push(s)}return e}c(Qp,"intersect");function wg(o,n){if(o===y.emptyTags)return n;if(n===y.emptyTags)return o;var e=Object.assign({},o);for(var r in n)if(o.hasOwnProperty(r)){var i=Qp(o[r],n[r]);if(xg(i))e[r]=i;else{e=y.emptyTags;break}}else e[r]=n[r];return e}c(wg,"mergeTags");function Ag(o,n){if(o===y.emptyTags||n===y.emptyTags)return y.emptyTags;var e=y.emptyTags;for(var r in o)if(n.hasOwnProperty(r)){var i=Qp(o[r],n[r]);i.length===0&&(e===y.emptyTags&&(e={}),e[r]=o[r].concat(n[r]))}return e}c(Ag,"intersectTags");function zp(o){return o._tag==="AnyType"}c(zp,"isAnyC");function jp(o){return o._tag==="LiteralType"}c(jp,"isLiteralC");function Tg(o){return o._tag==="KeyofType"}c(Tg,"isKeyofC");function Kp(o){return o._tag==="InterfaceType"}c(Kp,"isTypeC");function Eg(o){return o._tag==="PartialType"}c(Eg,"isPartialC");function Sg(o){return o._tag==="StrictType"}c(Sg,"isStrictC");function _g(o){return o._tag==="ExactType"}c(_g,"isExactC");function Mg(o){return o._tag==="RefinementType"}c(Mg,"isRefinementC");function Rg(o){return o._tag==="IntersectionType"}c(Rg,"isIntersectionC");function Jp(o){return o._tag==="UnionType"}c(Jp,"isUnionC");function Og(o){return o._tag==="RecursiveType"}c(Og,"isRecursiveC");var Sl=[];function Hr(o){if(Sl.indexOf(o)!==-1)return y.emptyTags;if(Kp(o)||Sg(o)){var n=y.emptyTags;for(var e in o.props){var r=o.props[e];jp(r)&&(n===y.emptyTags&&(n={}),n[e]=[r.value])}return n}else{if(_g(o)||Mg(o))return Hr(o.type);if(Rg(o))return o.types.reduce(function(s,a){return wg(s,Hr(a))},y.emptyTags);if(Jp(o))return o.types.slice(1).reduce(function(s,a){return Ag(s,Hr(a))},Hr(o.types[0]));if(Og(o)){Sl.push(o);var i=Hr(o.type);return Sl.pop(),i}}return y.emptyTags}c(Hr,"getTags");y.getTags=Hr;function Zp(o){var n=Hr(o[0]),e=Object.keys(n),r=o.length,i=c(function(p){for(var d=n[p].slice(),f=[n[p]],m=1;m<r;m++){var h=o[m],v=Hr(h),D=v[p];if(D===void 0)return"continue-keys";if(D.some(function(b){return d.indexOf(b)!==-1}))return"continue-keys";d.push.apply(d,D),f.push(D)}return{value:[p,f]}},"_loop_1");e:for(var s=0,a=e;s<a.length;s++){var u=a[s],l=i(u);if(typeof l=="object")return l.value;switch(l){case"continue-keys":continue e}}}c(Zp,"getIndex");y.getIndex=Zp;var e0=function(o){Ve(n,o);function n(){var e=o.call(this,"null",function(r){return r===null},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="NullType",e}return c(n,"NullType"),n}(Le);y.NullType=e0;y.nullType=new e0;y.null=y.nullType;var t0=function(o){Ve(n,o);function n(){var e=o.call(this,"undefined",function(r){return r===void 0},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="UndefinedType",e}return c(n,"UndefinedType"),n}(Le);y.UndefinedType=t0;var Ca=new t0;y.undefined=Ca;var n0=function(o){Ve(n,o);function n(){var e=o.call(this,"void",Ca.is,Ca.validate,y.identity)||this;return e._tag="VoidType",e}return c(n,"VoidType"),n}(Le);y.VoidType=n0;y.voidType=new n0;y.void=y.voidType;var r0=function(o){Ve(n,o);function n(){var e=o.call(this,"unknown",function(r){return!0},y.success,y.identity)||this;return e._tag="UnknownType",e}return c(n,"UnknownType"),n}(Le);y.UnknownType=r0;y.unknown=new r0;var o0=function(o){Ve(n,o);function n(){var e=o.call(this,"string",function(r){return typeof r=="string"},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="StringType",e}return c(n,"StringType"),n}(Le);y.StringType=o0;y.string=new o0;var i0=function(o){Ve(n,o);function n(){var e=o.call(this,"number",function(r){return typeof r=="number"},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="NumberType",e}return c(n,"NumberType"),n}(Le);y.NumberType=i0;y.number=new i0;var s0=function(o){Ve(n,o);function n(){var e=o.call(this,"bigint",function(r){return typeof r=="bigint"},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="BigIntType",e}return c(n,"BigIntType"),n}(Le);y.BigIntType=s0;y.bigint=new s0;var a0=function(o){Ve(n,o);function n(){var e=o.call(this,"boolean",function(r){return typeof r=="boolean"},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="BooleanType",e}return c(n,"BooleanType"),n}(Le);y.BooleanType=a0;y.boolean=new a0;var u0=function(o){Ve(n,o);function n(){var e=o.call(this,"UnknownArray",Array.isArray,function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="AnyArrayType",e}return c(n,"AnyArrayType"),n}(Le);y.AnyArrayType=u0;y.UnknownArray=new u0;y.Array=y.UnknownArray;var l0=function(o){Ve(n,o);function n(){var e=o.call(this,"UnknownRecord",function(r){var i=Object.prototype.toString.call(r);return i==="[object Object]"||i==="[object Window]"},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="AnyDictionaryType",e}return c(n,"AnyDictionaryType"),n}(Le);y.AnyDictionaryType=l0;y.UnknownRecord=new l0;var c0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.value=a,u._tag="LiteralType",u}return c(n,"LiteralType"),n}(Le);y.LiteralType=c0;function Ng(o,n){n===void 0&&(n=JSON.stringify(o));var e=c(function(r){return r===o},"is");return new c0(n,e,function(r,i){return e(r)?y.success(o):y.failure(r,i)},y.identity,o)}c(Ng,"literal");y.literal=Ng;var p0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.keys=a,u._tag="KeyofType",u}return c(n,"KeyofType"),n}(Le);y.KeyofType=p0;function Fg(o,n){n===void 0&&(n=Object.keys(o).map(function(r){return JSON.stringify(r)}).join(" | "));var e=c(function(r){return y.string.is(r)&&ba.call(o,r)},"is");return new p0(n,e,function(r,i){return e(r)?y.success(r):y.failure(r,i)},y.identity,o)}c(Fg,"keyof");y.keyof=Fg;var d0=function(o){Ve(n,o);function n(e,r,i,s,a,u){var l=o.call(this,e,r,i,s)||this;return l.type=a,l.predicate=u,l._tag="RefinementType",l}return c(n,"RefinementType"),n}(Le);y.RefinementType=d0;function f0(o,n,e){return Pl(o,n,e)}c(f0,"brand");y.brand=f0;y.Int=f0(y.number,function(o){return Number.isInteger(o)},"Int");var Nl=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.runDefinition=a,u._tag="RecursiveType",u}return c(n,"RecursiveType"),n}(Le);y.RecursiveType=Nl;Object.defineProperty(Nl.prototype,"type",{get:function(){return this.runDefinition()},enumerable:!0,configurable:!0});function Bg(o,n){var e,r=c(function(){return e||(e=n(i),e.name=o),e},"runDefinition"),i=new Nl(o,function(s){return r().is(s)},function(s,a){return r().validate(s,a)},function(s){return r().encode(s)},r);return i}c(Bg,"recursion");y.recursion=Bg;var m0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.type=a,u._tag="ArrayType",u}return c(n,"ArrayType"),n}(Le);y.ArrayType=m0;function h0(o,n){return n===void 0&&(n="Array<"+o.name+">"),new m0(n,function(e){return y.UnknownArray.is(e)&&e.every(o.is)},function(e,r){var i=y.UnknownArray.validate(e,r);if(lt.isLeft(i))return i;for(var s=i.right,a=s.length,u=s,l=[],p=0;p<a;p++){var d=s[p],f=o.validate(d,kn(r,String(p),o,d));if(lt.isLeft(f))yr(l,f.left);else{var m=f.right;m!==d&&(u===s&&(u=s.slice()),u[p]=m)}}return l.length>0?y.failures(l):y.success(u)},o.encode===y.identity?y.identity:function(e){return e.map(o.encode)},o)}c(h0,"array");y.array=h0;var g0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.props=a,u._tag="InterfaceType",u}return c(n,"InterfaceType"),n}(Le);y.InterfaceType=g0;function Fl(o,n){n===void 0&&(n=Xp(o));var e=Object.keys(o),r=e.map(function(s){return o[s]}),i=e.length;return new g0(n,function(s){if(y.UnknownRecord.is(s)){for(var a=0;a<i;a++){var u=e[a],l=s[u];if(l===void 0&&!ba.call(s,u)||!r[a].is(l))return!1}return!0}return!1},function(s,a){var u=y.UnknownRecord.validate(s,a);if(lt.isLeft(u))return u;for(var l=u.right,p=l,d=[],f=0;f<i;f++){var m=e[f],h=p[m],v=r[f],D=v.validate(h,kn(a,m,v,h));if(lt.isLeft(D))yr(d,D.left);else{var b=D.right;(b!==h||b===void 0&&!ba.call(p,m))&&(p===l&&(p=ui({},l)),p[m]=b)}}return d.length>0?y.failures(d):y.success(p)},ps(r)?y.identity:function(s){for(var a=ui({},s),u=0;u<i;u++){var l=e[u],p=r[u].encode;p!==y.identity&&(a[l]=p(s[l]))}return a},o)}c(Fl,"type");y.type=Fl;y.interface=Fl;var D0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.props=a,u._tag="PartialType",u}return c(n,"PartialType"),n}(Le);y.PartialType=D0;function Ig(o,n){n===void 0&&(n=Yp(Xp(o)));var e=Object.keys(o),r=e.map(function(s){return o[s]}),i=e.length;return new D0(n,function(s){if(y.UnknownRecord.is(s)){for(var a=0;a<i;a++){var u=e[a],l=s[u];if(l!==void 0&&!o[u].is(l))return!1}return!0}return!1},function(s,a){var u=y.UnknownRecord.validate(s,a);if(lt.isLeft(u))return u;for(var l=u.right,p=l,d=[],f=0;f<i;f++){var m=e[f],h=p[m],v=o[m],D=v.validate(h,kn(a,m,v,h));if(lt.isLeft(D))h!==void 0&&yr(d,D.left);else{var b=D.right;b!==h&&(p===l&&(p=ui({},l)),p[m]=b)}}return d.length>0?y.failures(d):y.success(p)},ps(r)?y.identity:function(s){for(var a=ui({},s),u=0;u<i;u++){var l=e[u],p=s[l];p!==void 0&&(a[l]=r[u].encode(p))}return a},o)}c(Ig,"partial");y.partial=Ig;var Bl=function(o){Ve(n,o);function n(e,r,i,s,a,u){var l=o.call(this,e,r,i,s)||this;return l.domain=a,l.codomain=u,l._tag="DictionaryType",l}return c(n,"DictionaryType"),n}(Le);y.DictionaryType=Bl;function v0(o,n,e){var r=Ol(o);return r?yg(Object.keys(r),o,n,e):bg(o,n,e)}c(v0,"record");y.record=v0;var Il=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.types=a,u._tag="UnionType",u}return c(n,"UnionType"),n}(Le);y.UnionType=Il;function y0(o,n){n===void 0&&(n=$p(o));var e=Zp(o);if(e!==void 0&&o.length>0){var r=e[0],i=e[1],s=i.length,a=c(function(u){for(var l=0;l<s;l++)if(i[l].indexOf(u)!==-1)return l},"find_1");return new xa(n,function(u){if(y.UnknownRecord.is(u)){var l=a(u[r]);return l!==void 0?o[l].is(u):!1}return!1},function(u,l){var p=y.UnknownRecord.validate(u,l);if(lt.isLeft(p))return p;var d=p.right,f=a(d[r]);if(f===void 0)return y.failure(u,l);var m=o[f];return m.validate(d,kn(l,String(f),m,d))},ps(o)?y.identity:function(u){var l=a(u[r]);if(l===void 0)throw new Error("no codec found to encode value in union codec "+n);return o[l].encode(u)},o,r)}else return new Il(n,function(u){return o.some(function(l){return l.is(u)})},function(u,l){for(var p=[],d=0;d<o.length;d++){var f=o[d],m=f.validate(u,kn(l,String(d),f,u));if(lt.isLeft(m))yr(p,m.left);else return y.success(m.right)}return y.failures(p)},ps(o)?y.identity:function(u){for(var l=0,p=o;l<p.length;l++){var d=p[l];if(d.is(u))return d.encode(u)}throw new Error("no codec found to encode value in union type "+n)},o)}c(y0,"union");y.union=y0;var b0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.types=a,u._tag="IntersectionType",u}return c(n,"IntersectionType"),n}(Le);y.IntersectionType=b0;function Pg(o,n){n===void 0&&(n="("+o.map(function(r){return r.name}).join(" & ")+")");var e=o.length;return new b0(n,function(r){return o.every(function(i){return i.is(r)})},o.length===0?y.success:function(r,i){for(var s=[],a=[],u=0;u<e;u++){var l=o[u],p=l.validate(r,kn(i,String(u),l,r));lt.isLeft(p)?yr(a,p.left):s.push(p.right)}return a.length>0?y.failures(a):y.success(Ml(r,s))},o.length===0?y.identity:function(r){return Ml(r,o.map(function(i){return i.encode(r)}))},o)}c(Pg,"intersection");y.intersection=Pg;var C0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.types=a,u._tag="TupleType",u}return c(n,"TupleType"),n}(Le);y.TupleType=C0;function kg(o,n){n===void 0&&(n="["+o.map(function(r){return r.name}).join(", ")+"]");var e=o.length;return new C0(n,function(r){return y.UnknownArray.is(r)&&r.length===e&&o.every(function(i,s){return i.is(r[s])})},function(r,i){var s=y.UnknownArray.validate(r,i);if(lt.isLeft(s))return s;for(var a=s.right,u=a.length>e?a.slice(0,e):a,l=[],p=0;p<e;p++){var d=a[p],f=o[p],m=f.validate(d,kn(i,String(p),f,d));if(lt.isLeft(m))yr(l,m.left);else{var h=m.right;h!==d&&(u===a&&(u=a.slice()),u[p]=h)}}return l.length>0?y.failures(l):y.success(u)},ps(o)?y.identity:function(r){return o.map(function(i,s){return i.encode(r[s])})},o)}c(kg,"tuple");y.tuple=kg;var x0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.type=a,u._tag="ReadonlyType",u}return c(n,"ReadonlyType"),n}(Le);y.ReadonlyType=x0;function Vg(o,n){return n===void 0&&(n="Readonly<"+o.name+">"),new x0(n,o.is,o.validate,o.encode,o)}c(Vg,"readonly");y.readonly=Vg;var w0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.type=a,u._tag="ReadonlyArrayType",u}return c(n,"ReadonlyArrayType"),n}(Le);y.ReadonlyArrayType=w0;function Lg(o,n){n===void 0&&(n="ReadonlyArray<"+o.name+">");var e=h0(o);return new w0(n,e.is,e.validate,e.encode,o)}c(Lg,"readonlyArray");y.readonlyArray=Lg;var Hg=c(function(o,n){return T0(Fl(o),n)},"strict");y.strict=Hg;var A0=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.type=a,u._tag="ExactType",u}return c(n,"ExactType"),n}(Le);y.ExactType=A0;function T0(o,n){n===void 0&&(n=Cg(o));var e=Rl(o);return new A0(n,o.is,function(r,i){var s=y.UnknownRecord.validate(r,i);if(lt.isLeft(s))return s;var a=o.validate(r,i);return lt.isLeft(a)?a:lt.right(Up(a.right,e))},function(r){return o.encode(Up(r,e))},o)}c(T0,"exact");y.exact=T0;var E0=function(o){Ve(n,o);function n(){var e=o.call(this,"Function",function(r){return typeof r=="function"},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="FunctionType",e}return c(n,"FunctionType"),n}(Le);y.FunctionType=E0;y.Function=new E0;var xa=function(o){Ve(n,o);function n(e,r,i,s,a,u){var l=o.call(this,e,r,i,s,a)||this;return l.tag=u,l}return c(n,"TaggedUnionType"),n}(Il);y.TaggedUnionType=xa;var Wg=c(function(o,n,e){e===void 0&&(e=$p(n));var r=y0(n,e);return r instanceof xa?r:(console.warn("[io-ts] Cannot build a tagged union for "+e+", returning a de-optimized union"),new xa(e,r.is,r.validate,r.encode,n,o))},"taggedUnion");y.taggedUnion=Wg;var Gg=c(function(o,n){return{value:o,context:n}},"getValidationError");y.getValidationError=Gg;var Ug=c(function(o){return[{key:"",type:o}]},"getDefaultContext");y.getDefaultContext=Ug;var S0=function(o){Ve(n,o);function n(){var e=o.call(this,"never",function(r){return!1},function(r,i){return y.failure(r,i)},function(){throw new Error("cannot encode never")})||this;return e._tag="NeverType",e}return c(n,"NeverType"),n}(Le);y.NeverType=S0;y.never=new S0;var _0=function(o){Ve(n,o);function n(){var e=o.call(this,"any",function(r){return!0},y.success,y.identity)||this;return e._tag="AnyType",e}return c(n,"AnyType"),n}(Le);y.AnyType=_0;y.any=new _0;y.Dictionary=y.UnknownRecord;var M0=function(o){Ve(n,o);function n(){var e=o.call(this,"object",function(r){return r!==null&&typeof r=="object"},function(r,i){return e.is(r)?y.success(r):y.failure(r,i)},y.identity)||this;return e._tag="ObjectType",e}return c(n,"ObjectType"),n}(Le);y.ObjectType=M0;y.object=new M0;function Pl(o,n,e){return e===void 0&&(e="("+o.name+" | "+qp(n)+")"),new d0(e,function(r){return o.is(r)&&n(r)},function(r,i){var s=o.validate(r,i);if(lt.isLeft(s))return s;var a=s.right;return n(a)?y.success(a):y.failure(a,i)},o.encode,o,n)}c(Pl,"refinement");y.refinement=Pl;y.Integer=Pl(y.number,Number.isInteger,"Integer");y.dictionary=v0;var zg=function(o){Ve(n,o);function n(e,r,i,s,a){var u=o.call(this,e,r,i,s)||this;return u.props=a,u._tag="StrictType",u}return c(n,"StrictType"),n}(Le);y.StrictType=zg;function qg(o){return o}c(qg,"clean");y.clean=qg;function Xg(o){return function(){return o}}c(Xg,"alias");y.alias=Xg});var R0=gt((C6,wa)=>{wa.exports.Space_Separator=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/;wa.exports.ID_Start=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/;wa.exports.ID_Continue=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/});var N0=gt((x6,O0)=>{var kl=R0();O0.exports={isSpaceSeparator(o){return typeof o=="string"&&kl.Space_Separator.test(o)},isIdStartChar(o){return typeof o=="string"&&(o>="a"&&o<="z"||o>="A"&&o<="Z"||o==="$"||o==="_"||kl.ID_Start.test(o))},isIdContinueChar(o){return typeof o=="string"&&(o>="a"&&o<="z"||o>="A"&&o<="Z"||o>="0"&&o<="9"||o==="$"||o==="_"||o==="\u200C"||o==="\u200D"||kl.ID_Continue.test(o))},isDigit(o){return typeof o=="string"&&/[0-9]/.test(o)},isHexDigit(o){return typeof o=="string"&&/[0-9A-Fa-f]/.test(o)}}});var I0=gt(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.PathReporter=Wr.success=Wr.failure=void 0;var Yg=Me(),$g=ya();function Qg(o){return typeof o=="function"?Yg.getFunctionName(o):typeof o=="number"&&!isFinite(o)?isNaN(o)?"NaN":o>0?"Infinity":"-Infinity":JSON.stringify(o)}c(Qg,"stringify");function jg(o){return o.map(function(n){var e=n.key,r=n.type;return e+": "+r.name}).join("/")}c(jg,"getContextPath");function Kg(o){return o.message!==void 0?o.message:"Invalid value "+Qg(o.value)+" supplied to "+jg(o.context)}c(Kg,"getMessage");function F0(o){return o.map(Kg)}c(F0,"failure");Wr.failure=F0;function B0(){return["No errors!"]}c(B0,"success");Wr.success=B0;Wr.PathReporter={report:$g.fold(F0,B0)}});

var oi=window.CustomEvent;(!oi||typeof oi=="object")&&(oi=c(function(n,e){e=e||{};var r=document.createEvent("CustomEvent");return r.initCustomEvent(n,!!e.bubbles,!!e.cancelable,e.detail||null),r},"CustomEvent"),oi.prototype=window.Event.prototype);function ip(o,n){var e="on"+n.type.toLowerCase();return typeof o[e]=="function"&&o[e](n),o.dispatchEvent(n)}c(ip,"safeDispatchEvent");function Xm(o){for(;o&&o!==document.body;){var n=window.getComputedStyle(o),e=c(function(r,i){return!(n[r]===void 0||n[r]===i)},"invalid");if(n.opacity<1||e("zIndex","auto")||e("transform","none")||e("mixBlendMode","normal")||e("filter","none")||e("perspective","none")||n.isolation==="isolate"||n.position==="fixed"||n.webkitOverflowScrolling==="touch")return!0;o=o.parentElement}return!1}c(Xm,"createsStackingContext");function rs(o){for(;o;){if(o.localName==="dialog")return o;o.parentElement?o=o.parentElement:o.parentNode?o=o.parentNode.host:o=null}return null}c(rs,"findNearestDialog");function sp(o){for(;o&&o.shadowRoot&&o.shadowRoot.activeElement;)o=o.shadowRoot.activeElement;o&&o.blur&&o!==document.body&&o.blur()}c(sp,"safeBlur");function Ym(o,n){for(var e=0;e<o.length;++e)if(o[e]===n)return!0;return!1}c(Ym,"inNodeList");function sl(o){return!o||!o.hasAttribute("method")?!1:o.getAttribute("method").toLowerCase()==="dialog"}c(sl,"isFormMethodDialog");function ap(o){var n=["button","input","keygen","select","textarea"],e=n.map(function(a){return a+":not([disabled])"});e.push('[tabindex]:not([disabled]):not([tabindex=""])');var r=o.querySelector(e.join(", "));if(!r&&"attachShadow"in Element.prototype)for(var i=o.querySelectorAll("*"),s=0;s<i.length&&!(i[s].tagName&&i[s].shadowRoot&&(r=ap(i[s].shadowRoot),r));s++);return r}c(ap,"findFocusableElementWithin");function ep(o){return o.isConnected||document.body.contains(o)}c(ep,"isConnected");function up(o){if(o.submitter)return o.submitter;var n=o.target;if(!(n instanceof HTMLFormElement))return null;var e=Be.formSubmitter;if(!e){var r=o.target,i="getRootNode"in r&&r.getRootNode()||document;e=i.activeElement}return!e||e.form!==n?null:e}c(up,"findFormSubmitter");function $m(o){if(!o.defaultPrevented){var n=o.target,e=Be.imagemapUseValue,r=up(o);e===null&&r&&(e=r.value);var i=rs(n);if(i){var s=r&&r.getAttribute("formmethod")||n.getAttribute("method");s==="dialog"&&(o.preventDefault(),e!=null?i.close(e):i.close())}}}c($m,"maybeHandleSubmit");function lp(o){if(this.dialog_=o,this.replacedStyleTop_=!1,this.openAsModal_=!1,o.hasAttribute("role")||o.setAttribute("role","dialog"),o.show=this.show.bind(this),o.showModal=this.showModal.bind(this),o.close=this.close.bind(this),o.addEventListener("submit",$m,!1),"returnValue"in o||(o.returnValue=""),"MutationObserver"in window){var n=new MutationObserver(this.maybeHideModal.bind(this));n.observe(o,{attributes:!0,attributeFilter:["open"]})}else{var e=!1,r=function(){e?this.downgradeModal():this.maybeHideModal(),e=!1}.bind(this),i,s=c(function(a){if(a.target===o){var u="DOMNodeRemoved";e|=a.type.substr(0,u.length)===u,window.clearTimeout(i),i=window.setTimeout(r,0)}},"delayModel");["DOMAttrModified","DOMNodeRemoved","DOMNodeRemovedFromDocument"].forEach(function(a){o.addEventListener(a,s)})}Object.defineProperty(o,"open",{set:this.setOpen.bind(this),get:o.hasAttribute.bind(o,"open")}),this.backdrop_=document.createElement("div"),this.backdrop_.className="backdrop",this.backdrop_.addEventListener("mouseup",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("mousedown",this.backdropMouseEvent_.bind(this)),this.backdrop_.addEventListener("click",this.backdropMouseEvent_.bind(this))}c(lp,"dialogPolyfillInfo");lp.prototype={get dialog(){return this.dialog_},maybeHideModal:function(){this.dialog_.hasAttribute("open")&&ep(this.dialog_)||this.downgradeModal()},downgradeModal:function(){this.openAsModal_&&(this.openAsModal_=!1,this.dialog_.style.zIndex="",this.replacedStyleTop_&&(this.dialog_.style.top="",this.replacedStyleTop_=!1),this.backdrop_.parentNode&&this.backdrop_.parentNode.removeChild(this.backdrop_),Be.dm.removeDialog(this))},setOpen:function(o){o?this.dialog_.hasAttribute("open")||this.dialog_.setAttribute("open",""):(this.dialog_.removeAttribute("open"),this.maybeHideModal())},backdropMouseEvent_:function(o){if(this.dialog_.hasAttribute("tabindex"))this.dialog_.focus();else{var n=document.createElement("div");this.dialog_.insertBefore(n,this.dialog_.firstChild),n.tabIndex=-1,n.focus(),this.dialog_.removeChild(n)}var e=document.createEvent("MouseEvents");e.initMouseEvent(o.type,o.bubbles,o.cancelable,window,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget),this.dialog_.dispatchEvent(e),o.stopPropagation()},focus_:function(){var o=this.dialog_.querySelector("[autofocus]:not([disabled])");!o&&this.dialog_.tabIndex>=0&&(o=this.dialog_),o||(o=ap(this.dialog_)),sp(document.activeElement),o&&o.focus()},updateZIndex:function(o,n){if(o<n)throw new Error("dialogZ should never be < backdropZ");this.dialog_.style.zIndex=o,this.backdrop_.style.zIndex=n},show:function(){this.dialog_.open||(this.setOpen(!0),this.focus_())},showModal:function(){if(this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'showModal' on dialog: The element is already open, and therefore cannot be opened modally.");if(!ep(this.dialog_))throw new Error("Failed to execute 'showModal' on dialog: The element is not in a Document.");if(!Be.dm.pushDialog(this))throw new Error("Failed to execute 'showModal' on dialog: There are too many open modal dialogs.");Xm(this.dialog_.parentElement)&&console.warn("A dialog is being shown inside a stacking context. This may cause it to be unusable. For more information, see this link: https://github.com/GoogleChrome/dialog-polyfill/#stacking-context"),this.setOpen(!0),this.openAsModal_=!0,Be.needsCentering(this.dialog_)?(Be.reposition(this.dialog_),this.replacedStyleTop_=!0):this.replacedStyleTop_=!1,this.dialog_.parentNode.insertBefore(this.backdrop_,this.dialog_.nextSibling),this.focus_()},close:function(o){if(!this.dialog_.hasAttribute("open"))throw new Error("Failed to execute 'close' on dialog: The element does not have an 'open' attribute, and therefore cannot be closed.");this.setOpen(!1),o!==void 0&&(this.dialog_.returnValue=o);var n=new oi("close",{bubbles:!1,cancelable:!1});ip(this.dialog_,n)}};var Be={};Be.reposition=function(o){var n=document.body.scrollTop||document.documentElement.scrollTop,e=n+(window.innerHeight-o.offsetHeight)/2;o.style.top=Math.max(n,e)+"px"};Be.isInlinePositionSetByStylesheet=function(o){for(var n=0;n<document.styleSheets.length;++n){var e=document.styleSheets[n],r=null;try{r=e.cssRules}catch{}if(r)for(var i=0;i<r.length;++i){var s=r[i],a=null;try{a=document.querySelectorAll(s.selectorText)}catch{}if(!(!a||!Ym(a,o))){var u=s.style.getPropertyValue("top"),l=s.style.getPropertyValue("bottom");if(u&&u!=="auto"||l&&l!=="auto")return!0}}}return!1};Be.needsCentering=function(o){var n=window.getComputedStyle(o);return n.position!=="absolute"||o.style.top!=="auto"&&o.style.top!==""||o.style.bottom!=="auto"&&o.style.bottom!==""?!1:!Be.isInlinePositionSetByStylesheet(o)};Be.forceRegisterDialog=function(o){if((window.HTMLDialogElement||o.showModal)&&console.warn("This browser already supports <dialog>, the polyfill may not work correctly",o),o.localName!=="dialog")throw new Error("Failed to register dialog: The element is not a dialog.");new lp(o)};Be.registerDialog=function(o){o.showModal||Be.forceRegisterDialog(o)};Be.DialogManager=function(){this.pendingDialogStack=[];var o=this.checkDOM_.bind(this);this.overlay=document.createElement("div"),this.overlay.className="_dialog_overlay",this.overlay.addEventListener("click",function(n){this.forwardTab_=void 0,n.stopPropagation(),o([])}.bind(this)),this.handleKey_=this.handleKey_.bind(this),this.handleFocus_=this.handleFocus_.bind(this),this.zIndexLow_=1e5,this.zIndexHigh_=1e5+150,this.forwardTab_=void 0,"MutationObserver"in window&&(this.mo_=new MutationObserver(function(n){var e=[];n.forEach(function(r){for(var i=0,s;s=r.removedNodes[i];++i){if(s instanceof Element)s.localName==="dialog"&&e.push(s);else continue;e=e.concat(s.querySelectorAll("dialog"))}}),e.length&&o(e)}))};Be.DialogManager.prototype.blockDocument=function(){document.documentElement.addEventListener("focus",this.handleFocus_,!0),document.addEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.observe(document,{childList:!0,subtree:!0})};Be.DialogManager.prototype.unblockDocument=function(){document.documentElement.removeEventListener("focus",this.handleFocus_,!0),document.removeEventListener("keydown",this.handleKey_),this.mo_&&this.mo_.disconnect()};Be.DialogManager.prototype.updateStacking=function(){for(var o=this.zIndexHigh_,n=0,e;e=this.pendingDialogStack[n];++n)e.updateZIndex(--o,--o),n===0&&(this.overlay.style.zIndex=--o);var r=this.pendingDialogStack[0];if(r){var i=r.dialog.parentNode||document.body;i.appendChild(this.overlay)}else this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)};Be.DialogManager.prototype.containedByTopDialog_=function(o){for(;o=rs(o);){for(var n=0,e;e=this.pendingDialogStack[n];++n)if(e.dialog===o)return n===0;o=o.parentElement}return!1};Be.DialogManager.prototype.handleFocus_=function(o){var n=o.composedPath?o.composedPath()[0]:o.target;if(!this.containedByTopDialog_(n)&&document.activeElement!==document.documentElement&&(o.preventDefault(),o.stopPropagation(),sp(n),this.forwardTab_!==void 0)){var e=this.pendingDialogStack[0],r=e.dialog,i=r.compareDocumentPosition(n);return i&Node.DOCUMENT_POSITION_PRECEDING&&(this.forwardTab_?e.focus_():n!==document.documentElement&&document.documentElement.focus()),!1}};Be.DialogManager.prototype.handleKey_=function(o){if(this.forwardTab_=void 0,o.keyCode===27){o.preventDefault(),o.stopPropagation();var n=new oi("cancel",{bubbles:!1,cancelable:!0}),e=this.pendingDialogStack[0];e&&ip(e.dialog,n)&&e.dialog.close()}else o.keyCode===9&&(this.forwardTab_=!o.shiftKey)};Be.DialogManager.prototype.checkDOM_=function(o){var n=this.pendingDialogStack.slice();n.forEach(function(e){o.indexOf(e.dialog)!==-1?e.downgradeModal():e.maybeHideModal()})};Be.DialogManager.prototype.pushDialog=function(o){var n=(this.zIndexHigh_-this.zIndexLow_)/2-1;return this.pendingDialogStack.length>=n?!1:(this.pendingDialogStack.unshift(o)===1&&this.blockDocument(),this.updateStacking(),!0)};Be.DialogManager.prototype.removeDialog=function(o){var n=this.pendingDialogStack.indexOf(o);n!==-1&&(this.pendingDialogStack.splice(n,1),this.pendingDialogStack.length===0&&this.unblockDocument(),this.updateStacking())};Be.dm=new Be.DialogManager;Be.formSubmitter=null;Be.imagemapUseValue=null;window.HTMLDialogElement===void 0&&(al=document.createElement("form"),al.setAttribute("method","dialog"),al.method!=="dialog"&&(Ao=Object.getOwnPropertyDescriptor(HTMLFormElement.prototype,"method"),Ao&&(tp=Ao.get,Ao.get=function(){return sl(this)?"dialog":tp.call(this)},np=Ao.set,Ao.set=function(o){return typeof o=="string"&&o.toLowerCase()==="dialog"?this.setAttribute("method",o):np.call(this,o)},Object.defineProperty(HTMLFormElement.prototype,"method",Ao))),document.addEventListener("click",function(o){if(Be.formSubmitter=null,Be.imagemapUseValue=null,!o.defaultPrevented){var n=o.target;if("composedPath"in o){var e=o.composedPath();n=e.shift()||n}if(!(!n||!sl(n.form))){var r=n.type==="submit"&&["button","input"].indexOf(n.localName)>-1;if(!r){if(!(n.localName==="input"&&n.type==="image"))return;Be.imagemapUseValue=o.offsetX+","+o.offsetY}var i=rs(n);i&&(Be.formSubmitter=n)}}},!1),document.addEventListener("submit",function(o){var n=o.target,e=rs(n);if(!e){var r=up(o),i=r&&r.getAttribute("formmethod")||n.getAttribute("method");i==="dialog"&&o.preventDefault()}}),rp=HTMLFormElement.prototype.submit,op=c(function(){if(!sl(this))return rp.call(this);var o=rs(this);o&&o.close()},"replacementFormSubmit"),HTMLFormElement.prototype.submit=op);var al,Ao,tp,np,rp,op,cp=Be;var ym=ce(ma()),bm=ce(Vr()),aa=ce(dp()),go=ce(Tp());var Xd=ce(Me()),Sc=ce(Vr());var gc=ce(ma()),ou=ce(Vr()),wi=ce(N0());var P0=ce(ya()),ot=ce(Me()),k0=ce(I0()),Vl=ce(Vr());function ds(o){return Object.keys(o)}c(ds,"keysOf");var xt=class{constructor(n){this.props=n;this._values=ds(n);for(let e=0;e<this._values.length;e++)this[e]=this._values[e]}static withProps(){return function(n){return new xt(n)}}get type(){throw new Error}get values(){return this._values}get length(){return this._values.length}get definitions(){let n=[];for(let e of this._values)n.push([e,this.props[e]]);return n}includes(n){return this.values.includes(n)}indexOf(n){return this.values.indexOf(n)}*[Symbol.iterator](){for(let n of this._values)yield n}};c(xt,"RichStringEnum");function N(...o){return o}c(N,"tuple");function Ll(o,n){let e=k({},o);for(let[r,i]of Object.entries(n))i!==void 0&&(e[r]=i);return e}c(Ll,"mergeWhereDefined");function V0(){return o=>o}c(V0,"brand");function Jg(o,n){return k(k({},n),o)}c(Jg,"defineADTStatics");function Re(o){return typeof o=="string"}c(Re,"isString");function pe(o){return Array.isArray(o)}c(pe,"isArray");function gn(o){return typeof o=="number"}c(gn,"isNumber");function _o(o){return typeof o=="boolean"}c(_o,"isBoolean");function Vn(o){return typeof o=="object"&&o!==null}c(Vn,"isRecord");function $(o,n){return Array(n).fill(o)}c($,"ArrayFillWith");function wt(o,n){let e=Array(n);for(let r=0;r<n;r++)e[r]=o(r);return e}c(wt,"ArrayFillUsing");function Hl(o,n,e){let r=n-o.length;if(r>0)for(let i=0;i<r;i++)o.push(e);else r<0&&o.splice(n,-r);return o}c(Hl,"ArrayClampOrPad");function Dn(o,n){return $(o,n)}c(Dn,"FixedArrayFillWith");function L0(o,n){return o.map(n)}c(L0,"FixedArrayMap");function H0(o){let n=Vl.default.parse(o);if(Vn(n))return n;throw new Error("JSONParseObject: not an object")}c(H0,"JSONParseObject");function Wl(o){return o!=null&&(o==="1"||o.toLowerCase()==="true")}c(Wl,"isTruthyString");function Aa(o){return o!=null&&(o==="0"||o.toLowerCase()==="false")}c(Aa,"isFalsyString");function Gl(o,n){let r=window.location.search.substring(1).split("&");for(let i of r){let s=i.split("=");if(s[0]===o)return s[1]}return n}c(Gl,"getURLParameter");function W0(){try{return window.self!==window.top}catch(o){return!0}}c(W0,"isEmbeddedInIframe");function Ul(o,n){n?o.removeAttribute("disabled"):o.setAttribute("disabled","disabled")}c(Ul,"setEnabled");function Dt(o,n){if(n){let e=o.getAttribute("data-prev-display");e===null?o.style.display==="none"&&o.style.removeProperty("display"):(o.removeAttribute("data-prev-display"),o.style.display=e)}else{let e=o.style.display;e.length!==0&&e!=="none"&&o.setAttribute("data-prev-display",e),o.style.display="none"}}c(Dt,"setVisible");function G0(o){if(typeof o.showModal=="function"){o.style.display="initial",o.showModal();let n=c(()=>{o.style.display="none",o.removeEventListener("close",n)},"listener");return o.addEventListener("close",n),!0}return!1}c(G0,"showModal");var Zg={NoChange:{_tag:"NoChange",isChange:!1},SimpleChange:{_tag:"SimpleChange",isChange:!0},RepeatableChange:o=>({_tag:"RepeatableChange",isChange:!0,repeat:o})},Z=Jg(Zg,{fromBoolean:o=>o?Z.SimpleChange:Z.NoChange,merge:(o,n)=>o._tag==="NoChange"?n:o._tag==="RepeatableChange"?o:n._tag==="RepeatableChange"?n:o}),$e={rising:"rising",falling:"falling"};function U0(o,n){return Array(n+1).join(o)}c(U0,"repeatString");function z0(o,...n){if(n.length){let e=typeof n[0],r=e==="string"||e==="number"?Array.prototype.slice.call(n):n[0];for(let i in r)o=o.replace(new RegExp("\\{"+i+"\\}","gi"),r[i])}return o}c(z0,"formatString");function q0(o,n){let e=Object.keys(o),r=Object.keys(n);if(e.length!==r.length)return!1;for(let i of e)if(!fs(o[i],n[i]))return!1;return!0}c(q0,"deepObjectEquals");function fs(o,n){if(pe(o)&&pe(n)){if(o.length!==n.length)return!1;for(let e=0;e<o.length;e++)if(o[e]!==n[e])return!1;return!0}else return o===n}c(fs,"deepEquals");var P=c(o=>ot.union([o,ot.undefined],o.name+" | undefined"),"typeOrUndefined"),X0=c(o=>ot.union([o,ot.null],o.name+" | null"),"typeOrNull");function br(o,n,e){let r=n.decode(o);if((0,P0.isLeft)(r)){console.warn(`ERROR while parsing ${e} from %o -> %s: `,o,k0.PathReporter.report(r).join("; "));return}return r.right}c(br,"validateJson");var Pe="Z";function me(o){return o===Pe}c(me,"isHighImpedance");var I="?";function U(o){return o===I}c(U,"isUnknown");var T6=new ot.Type("Unknown",U,(o,n)=>U(o)?ot.success(o):ot.failure(o,n),ot.identity),Ue={invert(o){return U(o)||me(o)?o:!o},filterHighZ(o){return me(o)?I:o}},Gr=new ot.Type("0|1|?|Z",o=>U(o)||me(o)||o===1||o===0,(o,n)=>U(o)?ot.success(o):me(o)?ot.success(o):o===1?ot.success(1):o===0?ot.success(0):ot.failure(o,n),ot.identity);function tt(o){switch(o){case!0:return 1;case!1:return 0;case I:return I;case Pe:return Pe;case void 0:return}}c(tt,"toLogicValueRepr");function Zn(o){switch(o){case 1:return!0;case 0:return!1;case I:return I;case Pe:return Pe;case void 0:return}}c(Zn,"toLogicValue");function zl(o){switch(o){case"1":return!0;case"0":return!1;case I:return I;case Pe:return Pe;default:return I}}c(zl,"toLogicValueFromChar");function Ta(o){for(let n of o)if(n!==!0&&n!==!1)return!1;return!0}c(Ta,"allBooleans");function li(o){for(let n of o)if(n!=="0")return!1;return!0}c(li,"isAllZeros");function Mo(o){return o.map(tt).reverse().join("")}c(Mo,"binaryStringRepr");function Ea(o,n){let e=Mo(o);return parseInt(e,2).toString(16).toUpperCase().padStart(n,"0")}c(Ea,"hexStringRepr");function Sa(o,n){let i=o.length===n?o:parseInt(o,16).toString(2).padStart(n,"0"),s=Array(n);for(let a=0;a<n;a++)s[a]=zl(i[n-a-1]);return s}c(Sa,"wordFromBinaryOrHexRepr");function ql(o){function n(){return navigator.userAgent.match(/ipad|iphone/i)}c(n,"isOS");let e=document.createElement("textarea");if(e.readOnly=!0,e.contentEditable="true",e.value=o,document.body.appendChild(e),n()){let i=document.createRange();i.selectNodeContents(e);let s=window.getSelection();s!==null&&(s.removeAllRanges(),s.addRange(i),e.setSelectionRange(0,999999))}else e.select();let r=document.execCommand("copy");return document.body.removeChild(e),r}c(ql,"copyToClipboard");function Ro(o){let n=o.composedPath(),e,r;return n.length!==0&&(e=n[0])instanceof HTMLElement&&((r=e.tagName)==="INPUT"||r==="SELECT")}c(Ro,"targetIsFieldOrOtherInput");function Y0(o){let n=getComputedStyle(o),e=n.position==="absolute",r=/(?:auto|scroll)/;if(n.position==="fixed")return document;let i;for(i=o;i=i.parentElement;)if(n=getComputedStyle(i),!(e&&n.position==="static")&&r.test(n.overflow+n.overflowY+n.overflowX))return i;return document}c(Y0,"getScrollParent");var E6=(o=>n=>new Promise(e=>{let r=document.createElement("script"),i=`_jsonp_${o++}`;n.match(/\?/)?n+=`&callback=${i}`:n+=`?callback=${i}`,r.src=n,window[i]=s=>{r.remove(),delete window[i],e(Vl.default.stringify(s))},document.body.appendChild(r)}))(0);var ci=6;function Xl(o){var s;let r=Number((s=o.v)!=null?s:0),i=r;if(i>ci)throw new Error(`Data format v${i} is newer than what this editor can load (v \u2264 ${ci}`);for(;r<ci;){let a=e3[++r];a(o);let u=o.defs;if(pe(u))for(let l of u){let p=l.circuit;Vn(p)&&a(p)}o.v=r}r!==i&&console.log(`Migrated data format from v${i} to v${r}, consider upgrading the source`)}c(Xl,"migrateData");var e3={6:o=>{let n={in:"in",out:"out",gates:"gate",ic:"ic",labels:"label",layout:"layout"},e={in:"in","in.clock":"clock","in.random":"rand",out:"out","out.display":"display","out.7seg":"7seg","out.16seg":"16seg","out.ascii":"ascii","out.bar":"bar","out.shift-buffer":"shift-display","ic.switched-inverter":"cnot-array","ic.gate-array":"{gatetype}-array","ic.tristate-array":"tristate-array",label:"label","label.rect":"rect","layout.pass":"pass","ic.halfadder":"halfadder","ic.adder":"adder","ic.comparator":"comp","ic.adder-array":"adder-array","ic.alu":"alu","ic.mux":"mux","ic.demux":"demux","ic.latch-sr":"latch-sr","ic.flipflop-jk":"ff-jk","ic.flipflop-t":"ff-t","ic.flipflop-d":"ff-d","ic.register":"reg","ic.shift-register":"shift-reg","ic.counter":"counter","ic.ram":"ram","ic.rom":"rom","ic.decoder":"dec","ic.decoder-7seg":"dec-7seg","ic.decoder-16seg":"dec-16seg","ic.decoder-bcd4":"dec-bcd4"};function r(s,a){if(s==="gate"){if(!Re(a.type))return console.warn("Gate with no type found, assuming AND",a),"and";let u=a.type.toLowerCase();return u==="tri"?"tristate":u}else{let u=Re(a.type)?`${s}.${a.type}`:s;if(u==="ic.gate-array"){let l;return Re(a.subtype)?l=a.subtype.toLowerCase():(console.warn("Gate array with no subtype found, assuming AND",a),l="and"),delete a.subtype,`${l}-array`}else return u in e?e[u]:u.startsWith("ic.custom-")?u.substring(3):(console.error(`Unknown component type: ${u}`),u)}}c(r,"newTypeFor");let i=[];for(let[s,a]of Object.entries(n)){let u=o[s];if(pe(u)){for(let l of u)if(Vn(l)){let p=r(a,l);l.type=p,i.push(l),p==="NOT"&&console.log(l)}}delete o[s]}o.components=i},5:o=>{var l,p,d,f,m,h,v,D,b,C,A,M,w,T;let n,e,r=o.in;if(pe(r))for(let R of r)Re(n=R.type)&&(n==="nibble"?(delete R.type,R.bits=4):n==="byte"&&(delete R.type,R.bits=8));let i=o.out;if(pe(i))for(let R of i)Re(n=R.type)&&(n==="nibble"?(delete R.type,R.bits=4):n==="byte"?(delete R.type,R.bits=8):n==="nibble-display"?(R.type="display",R.bits=4):n==="byte-display"?(R.type="display",R.bits=8):n==="shiftbuffer"&&(R.type="shift-buffer"));let s=o.gates;if(pe(s)){for(let R of s)if(Re(n=R.type)){let S=n[n.length-1],F=parseInt(S);isNaN(F)||(R.bits=F,R.type=n.slice(0,-1))}}let a=o.components;if(pe(a)){let R=new RegExp("^ram-(?<lines>\\d+)x(?<bits>\\d+)$"),S=new RegExp("^mux-(?<from>\\d+)to(?<to>\\d+)$"),F=new RegExp("^demux-(?<from>\\d+)to(?<to>\\d+)$");for(let O of a)if(Re(n=O.type))if(n==="register"){let L;if(pe(L=O.state)){let W=Mo(L.map(Zn));li(W)||(O.content=W),delete O.state}}else n==="quad-gate"?O.type="gate-array":n==="quad-tristate"?O.type="tristate-array":(e=R.exec(n))!==null?(O.type="ram",O.bits=parseInt((p=(l=e.groups)==null?void 0:l.bits)!=null?p:"4"),O.lines=parseInt((f=(d=e.groups)==null?void 0:d.lines)!=null?f:"16")):(e=S.exec(n))!==null?(O.type="mux",O.from=parseInt((h=(m=e.groups)==null?void 0:m.from)!=null?h:"8"),O.to=parseInt((D=(v=e.groups)==null?void 0:v.to)!=null?D:"4")):(e=F.exec(n))!==null&&(O.type="demux",O.from=parseInt((C=(b=e.groups)==null?void 0:b.from)!=null?C:"4"),O.to=parseInt((M=(A=e.groups)==null?void 0:A.to)!=null?M:"8"));o.ic=a,delete o.components}let u=o.layout;if(pe(u)){let R=new RegExp("^pass-(?<bits>\\d+)$");for(let S of u)Re(n=S.type)&&(e=R.exec(n))!==null&&(S.type="pass",S.bits=parseInt((T=(w=e.groups)==null?void 0:w.bits)!=null?T:"1"))}},4:o=>{let n=$0(o),e=o.out;if(pe(e))for(let i of e)i.type==="nibble"&&(i.type="nibble-display");let r=o.components;if(pe(r)){for(let i of r)if(i.type==="alu"&&pe(i.out)){i.out.push(n++);let s=i.out[4];i.out[4]=i.out[6],i.out[6]=s}}},3:o=>{let n=$0(o),e=o.components;if(pe(e))for(let r of e)r.type==="alu"&&pe(r.in)&&r.in.push(n++)},2:o=>{let n=o.wires;if(pe(n)){for(let e of n)if(pe(e)&&e.length===3){let r=e[2];"waypoints"in r&&(r.via=r.waypoints,delete r.waypoints)}}},1:o=>{if("displays"in o){let e=o.displays;if(delete o.displays,"out"in o||(o.out=[]),pe(e)&&pe(o.out))for(let r of e)o.out.push(r)}if("clocks"in o){let e=o.clocks;if(delete o.clocks,"in"in o||(o.in=[]),pe(e)&&pe(o.in))for(let r of e)r.type="clock",o.in.push(r)}let n=o.components;if(pe(n))for(let e of n){let r;if(Re(r=e.type)&&r.startsWith("flipflop")){let i=e.in,s=i.splice(-3);e.in=[...s,...i]}}}};function $0(o){let n=-1;function e(i){for(let s of["id","in","out"])r(i[s])}c(e,"inspectComponentDef");function r(i){if(i!==void 0)if(typeof i=="number")!isNaN(i)&&isFinite(i)&&(n=Math.max(n,i));else if(typeof i=="string")for(let s of i.split("-"))r(parseInt(s));else if(pe(i))for(let s of i)r(s);else typeof i=="object"&&i!==null&&r(i.id)}c(r,"inspectValue");for(let i of Object.keys(o)){let s=o[i];if(s!==void 0&&pe(s))for(let a of s)e(a)}return n+1}c($0,"findFirstFreeId");var{abs:ms,cos:Cr,sin:pi,acos:t3,atan2:hs,sqrt:Ur,pow:wn}=Math;function gs(o){return o<0?-wn(-o,1/3):wn(o,1/3)}c(gs,"crt");var Q0=Math.PI,_a=2*Q0,zr=Q0/2,n3=1e-6,Yl=Number.MAX_SAFE_INTEGER||9007199254740991,$l=Number.MIN_SAFE_INTEGER||-9007199254740991,r3={x:0,y:0,z:0},G={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(o,n){let e=n(o),r=e.x*e.x+e.y*e.y;return typeof e.z<"u"&&(r+=e.z*e.z),Ur(r)},compute:function(o,n,e){if(o===0)return n[0].t=0,n[0];let r=n.length-1;if(o===1)return n[r].t=1,n[r];let i=1-o,s=n;if(r===0)return n[0].t=o,n[0];if(r===1){let u={x:i*s[0].x+o*s[1].x,y:i*s[0].y+o*s[1].y,t:o};return e&&(u.z=i*s[0].z+o*s[1].z),u}if(r<4){let u=i*i,l=o*o,p,d,f,m=0;r===2?(s=[s[0],s[1],s[2],r3],p=u,d=i*o*2,f=l):r===3&&(p=u*i,d=u*o*3,f=i*l*3,m=o*l);let h={x:p*s[0].x+d*s[1].x+f*s[2].x+m*s[3].x,y:p*s[0].y+d*s[1].y+f*s[2].y+m*s[3].y,t:o};return e&&(h.z=p*s[0].z+d*s[1].z+f*s[2].z+m*s[3].z),h}let a=JSON.parse(JSON.stringify(n));for(;a.length>1;){for(let u=0;u<a.length-1;u++)a[u]={x:a[u].x+(a[u+1].x-a[u].x)*o,y:a[u].y+(a[u+1].y-a[u].y)*o},typeof a[u].z<"u"&&(a[u]=a[u].z+(a[u+1].z-a[u].z)*o);a.splice(a.length-1,1)}return a[0].t=o,a[0]},computeWithRatios:function(o,n,e,r){let i=1-o,s=e,a=n,u=s[0],l=s[1],p=s[2],d=s[3],f;if(u*=i,l*=o,a.length===2)return f=u+l,{x:(u*a[0].x+l*a[1].x)/f,y:(u*a[0].y+l*a[1].y)/f,z:r?(u*a[0].z+l*a[1].z)/f:!1,t:o};if(u*=i,l*=2*i,p*=o*o,a.length===3)return f=u+l+p,{x:(u*a[0].x+l*a[1].x+p*a[2].x)/f,y:(u*a[0].y+l*a[1].y+p*a[2].y)/f,z:r?(u*a[0].z+l*a[1].z+p*a[2].z)/f:!1,t:o};if(u*=i,l*=1.5*i,p*=3*i,d*=o*o*o,a.length===4)return f=u+l+p+d,{x:(u*a[0].x+l*a[1].x+p*a[2].x+d*a[3].x)/f,y:(u*a[0].y+l*a[1].y+p*a[2].y+d*a[3].y)/f,z:r?(u*a[0].z+l*a[1].z+p*a[2].z+d*a[3].z)/f:!1,t:o}},derive:function(o,n){let e=[];for(let r=o,i=r.length,s=i-1;i>1;i--,s--){let a=[];for(let u=0,l;u<s;u++)l={x:s*(r[u+1].x-r[u].x),y:s*(r[u+1].y-r[u].y)},n&&(l.z=s*(r[u+1].z-r[u].z)),a.push(l);e.push(a),r=a}return e},between:function(o,n,e){return n<=o&&o<=e||G.approximately(o,n)||G.approximately(o,e)},approximately:function(o,n,e){return ms(o-n)<=(e||n3)},length:function(o){let e=G.Tvalues.length,r=0;for(let i=0,s;i<e;i++)s=.5*G.Tvalues[i]+.5,r+=G.Cvalues[i]*G.arcfn(s,o);return .5*r},map:function(o,n,e,r,i){let s=e-n,a=i-r,u=o-n,l=u/s;return r+a*l},lerp:function(o,n,e){let r={x:n.x+o*(e.x-n.x),y:n.y+o*(e.y-n.y)};return n.z!==void 0&&e.z!==void 0&&(r.z=n.z+o*(e.z-n.z)),r},pointToString:function(o){let n=o.x+"/"+o.y;return typeof o.z<"u"&&(n+="/"+o.z),n},pointsToString:function(o){return"["+o.map(G.pointToString).join(", ")+"]"},copy:function(o){return JSON.parse(JSON.stringify(o))},angle:function(o,n,e){let r=n.x-o.x,i=n.y-o.y,s=e.x-o.x,a=e.y-o.y,u=r*a-i*s,l=r*s+i*a;return hs(u,l)},round:function(o,n){let e=""+o,r=e.indexOf(".");return parseFloat(e.substring(0,r+1+n))},dist:function(o,n){let e=o.x-n.x,r=o.y-n.y;return Ur(e*e+r*r)},closest:function(o,n){let e=wn(2,63),r,i;return o.forEach(function(s,a){i=G.dist(n,s),i<e&&(e=i,r=a)}),{mdist:e,mpos:r}},abcratio:function(o,n){if(n!==2&&n!==3)return!1;if(typeof o>"u")o=.5;else if(o===0||o===1)return o;let e=wn(o,n)+wn(1-o,n),r=e-1;return ms(r/e)},projectionratio:function(o,n){if(n!==2&&n!==3)return!1;if(typeof o>"u")o=.5;else if(o===0||o===1)return o;let e=wn(1-o,n),r=wn(o,n)+e;return e/r},lli8:function(o,n,e,r,i,s,a,u){let l=(o*r-n*e)*(i-a)-(o-e)*(i*u-s*a),p=(o*r-n*e)*(s-u)-(n-r)*(i*u-s*a),d=(o-e)*(s-u)-(n-r)*(i-a);return d==0?!1:{x:l/d,y:p/d}},lli4:function(o,n,e,r){let i=o.x,s=o.y,a=n.x,u=n.y,l=e.x,p=e.y,d=r.x,f=r.y;return G.lli8(i,s,a,u,l,p,d,f)},lli:function(o,n){return G.lli4(o,o.c,n,n.c)},makeline:function(o,n){return new ze(o.x,o.y,(o.x+n.x)/2,(o.y+n.y)/2,n.x,n.y)},findbbox:function(o){let n=Yl,e=Yl,r=$l,i=$l;return o.forEach(function(s){let a=s.bbox();n>a.x.min&&(n=a.x.min),e>a.y.min&&(e=a.y.min),r<a.x.max&&(r=a.x.max),i<a.y.max&&(i=a.y.max)}),{x:{min:n,mid:(n+r)/2,max:r,size:r-n},y:{min:e,mid:(e+i)/2,max:i,size:i-e}}},shapeintersections:function(o,n,e,r,i){if(!G.bboxoverlap(n,r))return[];let s=[],a=[o.startcap,o.forward,o.back,o.endcap],u=[e.startcap,e.forward,e.back,e.endcap];return a.forEach(function(l){l.virtual||u.forEach(function(p){if(p.virtual)return;let d=l.intersects(p,i);d.length>0&&(d.c1=l,d.c2=p,d.s1=o,d.s2=e,s.push(d))})}),s},makeshape:function(o,n,e){let r=n.points.length,i=o.points.length,s=G.makeline(n.points[r-1],o.points[0]),a=G.makeline(o.points[i-1],n.points[0]),u={startcap:s,forward:o,back:n,endcap:a,bbox:G.findbbox([s,o,n,a])};return u.intersections=function(l){return G.shapeintersections(u,u.bbox,l,l.bbox,e)},u},getminmax:function(o,n,e){if(!e)return{min:0,max:0};let r=Yl,i=$l,s,a;e.indexOf(0)===-1&&(e=[0].concat(e)),e.indexOf(1)===-1&&e.push(1);for(let u=0,l=e.length;u<l;u++)s=e[u],a=o.get(s),a[n]<r&&(r=a[n]),a[n]>i&&(i=a[n]);return{min:r,mid:(r+i)/2,max:i,size:i-r}},align:function(o,n){let e=n.p1.x,r=n.p1.y,i=-hs(n.p2.y-r,n.p2.x-e),s=c(function(a){return{x:(a.x-e)*Cr(i)-(a.y-r)*pi(i),y:(a.x-e)*pi(i)+(a.y-r)*Cr(i)}},"d");return o.map(s)},roots:function(o,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};let e=o.length-1,r=G.align(o,n),i=c(function(S){return 0<=S&&S<=1},"reduce");if(e===2){let S=r[0].y,F=r[1].y,O=r[2].y,L=S-2*F+O;if(L!==0){let W=-Ur(F*F-S*O),se=-S+F,ae=-(W+se)/L,oe=-(-W+se)/L;return[ae,oe].filter(i)}else if(F!==O&&L===0)return[(2*F-O)/(2*F-2*O)].filter(i);return[]}let s=r[0].y,a=r[1].y,u=r[2].y,l=r[3].y,p=-s+3*a-3*u+l,d=3*s-6*a+3*u,f=-3*s+3*a,m=s;if(G.approximately(p,0)){if(G.approximately(d,0))return G.approximately(f,0)?[]:[-m/f].filter(i);let S=Ur(f*f-4*d*m),F=2*d;return[(S-f)/F,(-f-S)/F].filter(i)}d/=p,f/=p,m/=p;let h=(3*f-d*d)/3,v=h/3,D=(2*d*d*d-9*d*f+27*m)/27,b=D/2,C=b*b+v*v*v,A,M,w,T,R;if(C<0){let S=-h/3,F=S*S*S,O=Ur(F),L=-D/(2*O),W=L<-1?-1:L>1?1:L,se=t3(W),ae=gs(O),oe=2*ae;return w=oe*Cr(se/3)-d/3,T=oe*Cr((se+_a)/3)-d/3,R=oe*Cr((se+2*_a)/3)-d/3,[w,T,R].filter(i)}else{if(C===0)return A=b<0?gs(-b):-gs(b),w=2*A-d/3,T=-A-d/3,[w,T].filter(i);{let S=Ur(C);return A=gs(-b+S),M=gs(b+S),[A-M-d/3].filter(i)}}},droots:function(o){if(o.length===3){let n=o[0],e=o[1],r=o[2],i=n-2*e+r;if(i!==0){let s=-Ur(e*e-n*r),a=-n+e,u=-(s+a)/i,l=-(-s+a)/i;return[u,l]}else if(e!==r&&i===0)return[(2*e-r)/(2*(e-r))];return[]}if(o.length===2){let n=o[0],e=o[1];return n!==e?[n/(n-e)]:[]}return[]},curvature:function(o,n,e,r,i){let s,a,u,l,p=0,d=0,f=G.compute(o,n),m=G.compute(o,e),h=f.x*f.x+f.y*f.y;if(r?(s=Ur(wn(f.y*m.z-m.y*f.z,2)+wn(f.z*m.x-m.z*f.x,2)+wn(f.x*m.y-m.x*f.y,2)),a=wn(h+f.z*f.z,3/2)):(s=f.x*m.y-f.y*m.x,a=wn(h,3/2)),s===0||a===0)return{k:0,r:0};if(p=s/a,d=a/s,!i){let v=G.curvature(o-.001,n,e,r,!0).k,D=G.curvature(o+.001,n,e,r,!0).k;l=(D-p+(p-v))/2,u=(ms(D-p)+ms(p-v))/2}return{k:p,r:d,dk:l,adk:u}},inflections:function(o){if(o.length<4)return[];let n=G.align(o,{p1:o[0],p2:o.slice(-1)[0]}),e=n[2].x*n[1].y,r=n[3].x*n[1].y,i=n[1].x*n[2].y,s=n[3].x*n[2].y,a=18*(-3*e+2*r+3*i-s),u=18*(3*e-r-3*i),l=18*(i-e);if(G.approximately(a,0)){if(!G.approximately(u,0)){let m=-l/u;if(0<=m&&m<=1)return[m]}return[]}let p=2*a;if(G.approximately(p,0))return[];let d=u*u-4*a*l;if(d<0)return[];let f=Math.sqrt(d);return[(f-u)/p,-(u+f)/p].filter(function(m){return 0<=m&&m<=1})},bboxoverlap:function(o,n){let e=["x","y"],r=e.length;for(let i=0,s,a,u,l;i<r;i++)if(s=e[i],a=o[s].mid,u=n[s].mid,l=(o[s].size+n[s].size)/2,ms(a-u)>=l)return!1;return!0},expandbox:function(o,n){n.x.min<o.x.min&&(o.x.min=n.x.min),n.y.min<o.y.min&&(o.y.min=n.y.min),n.z&&n.z.min<o.z.min&&(o.z.min=n.z.min),n.x.max>o.x.max&&(o.x.max=n.x.max),n.y.max>o.y.max&&(o.y.max=n.y.max),n.z&&n.z.max>o.z.max&&(o.z.max=n.z.max),o.x.mid=(o.x.min+o.x.max)/2,o.y.mid=(o.y.min+o.y.max)/2,o.z&&(o.z.mid=(o.z.min+o.z.max)/2),o.x.size=o.x.max-o.x.min,o.y.size=o.y.max-o.y.min,o.z&&(o.z.size=o.z.max-o.z.min)},pairiteration:function(o,n,e){let r=o.bbox(),i=n.bbox(),s=1e5,a=e||.5;if(r.x.size+r.y.size<a&&i.x.size+i.y.size<a)return[(s*(o._t1+o._t2)/2|0)/s+"/"+(s*(n._t1+n._t2)/2|0)/s];let u=o.split(.5),l=n.split(.5),p=[{left:u.left,right:l.left},{left:u.left,right:l.right},{left:u.right,right:l.right},{left:u.right,right:l.left}];p=p.filter(function(f){return G.bboxoverlap(f.left.bbox(),f.right.bbox())});let d=[];return p.length===0||(p.forEach(function(f){d=d.concat(G.pairiteration(f.left,f.right,a))}),d=d.filter(function(f,m){return d.indexOf(f)===m})),d},getccenter:function(o,n,e){let r=n.x-o.x,i=n.y-o.y,s=e.x-n.x,a=e.y-n.y,u=r*Cr(zr)-i*pi(zr),l=r*pi(zr)+i*Cr(zr),p=s*Cr(zr)-a*pi(zr),d=s*pi(zr)+a*Cr(zr),f=(o.x+n.x)/2,m=(o.y+n.y)/2,h=(n.x+e.x)/2,v=(n.y+e.y)/2,D=f+u,b=m+l,C=h+p,A=v+d,M=G.lli8(f,m,D,b,h,v,C,A),w=G.dist(M,o),T=hs(o.y-M.y,o.x-M.x),R=hs(n.y-M.y,n.x-M.x),S=hs(e.y-M.y,e.x-M.x),F;return T<S?((T>R||R>S)&&(T+=_a),T>S&&(F=S,S=T,T=F)):S<R&&R<T?(F=S,S=T,T=F):S+=_a,M.s=T,M.e=S,M.r=w,M},numberSort:function(o,n){return o-n}};var xr=class{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return G.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,e){return n+e})}curve(n){return this.curves[n]}bbox(){let n=this.curves;for(var e=n[0].bbox(),r=1;r<n.length;r++)G.expandbox(e,n[r].bbox());return e}offset(n){let e=[];return this.curves.forEach(function(r){e.push(...r.offset(n))}),new xr(e)}};c(xr,"PolyBezier");var{abs:Ds,min:j0,max:K0,cos:o3,sin:i3,acos:s3,sqrt:vs}=Math,a3=Math.PI;var ze=class{constructor(n){let e=n&&n.forEach?n:Array.from(arguments).slice(),r=!1;if(typeof e[0]=="object"){r=e.length;let h=[];e.forEach(function(v){["x","y","z"].forEach(function(D){typeof v[D]<"u"&&h.push(v[D])})}),e=h}let i=!1,s=e.length;if(r){if(r>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");i=!0}}else if(s!==6&&s!==8&&s!==9&&s!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");let a=this._3d=!i&&(s===9||s===12)||n&&n[0]&&typeof n[0].z<"u",u=this.points=[];for(let h=0,v=a?3:2;h<s;h+=v){var l={x:e[h],y:e[h+1]};a&&(l.z=e[h+2]),u.push(l)}let p=this.order=u.length-1,d=this.dims=["x","y"];a&&d.push("z"),this.dimlen=d.length;let f=G.align(u,{p1:u[0],p2:u[p]}),m=G.dist(u[0],u[p]);this._linear=f.reduce((h,v)=>h+Ds(v.y),0)<m/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,e,r,i){if(typeof i>"u"&&(i=.5),i===0)return new ze(e,e,r);if(i===1)return new ze(n,e,e);let s=ze.getABC(2,n,e,r,i);return new ze(n,s.A,r)}static cubicFromPoints(n,e,r,i,s){typeof i>"u"&&(i=.5);let a=ze.getABC(3,n,e,r,i);typeof s>"u"&&(s=G.dist(e,a.C));let u=s*(1-i)/i,l=G.dist(n,r),p=(r.x-n.x)/l,d=(r.y-n.y)/l,f=s*p,m=s*d,h=u*p,v=u*d,D={x:e.x-f,y:e.y-m},b={x:e.x+h,y:e.y+v},C=a.A,A={x:C.x+(D.x-C.x)/(1-i),y:C.y+(D.y-C.y)/(1-i)},M={x:C.x+(b.x-C.x)/i,y:C.y+(b.y-C.y)/i},w={x:n.x+(A.x-n.x)/i,y:n.y+(A.y-n.y)/i},T={x:r.x+(M.x-r.x)/(1-i),y:r.y+(M.y-r.y)/(1-i)};return new ze(n,w,T,r)}static getUtils(){return G}getUtils(){return ze.getUtils()}static get PolyBezier(){return xr}valueOf(){return this.toString()}toString(){return G.pointsToString(this.points)}toSVG(){if(this._3d)return!1;let n=this.points,e=n[0].x,r=n[0].y,i=["M",e,r,this.order===2?"Q":"C"];for(let s=1,a=n.length;s<a;s++)i.push(n[s].x),i.push(n[s].y);return i.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){let n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,e){return""+e+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=G.derive(this.points,this._3d),this.computedirection()}computedirection(){let n=this.points,e=G.angle(n[0],n[this.order],n[1]);this.clockwise=e>0}length(){return G.length(this.derivative.bind(this))}static getABC(n=2,e,r,i,s=.5){let a=G.projectionratio(s,n),u=1-a,l={x:a*e.x+u*i.x,y:a*e.y+u*i.y},p=G.abcratio(s,n);return{A:{x:r.x+(r.x-l.x)/p,y:r.y+(r.y-l.y)/p},B:r,C:l,S:e,E:i}}getABC(n,e){e=e||this.get(n);let r=this.points[0],i=this.points[this.order];return ze.getABC(this.order,r,e,i,n)}getLUT(n){if(this.verify(),n=n||100,this._lut.length===n)return this._lut;this._lut=[],n++,this._lut=[];for(let e=0,r,i;e<n;e++)i=e/(n-1),r=this.compute(i),r.t=i,this._lut.push(r);return this._lut}on(n,e){e=e||5;let r=this.getLUT(),i=[];for(let s=0,a,u=0;s<r.length;s++)a=r[s],G.dist(a,n)<e&&(i.push(a),u+=s/r.length);return i.length?t/=i.length:!1}project(n){let e=this.getLUT(),r=e.length-1,i=G.closest(e,n),s=i.mpos,a=(s-1)/r,u=(s+1)/r,l=.1/r,p=i.mdist,d=a,f=d,m;p+=1;for(let h;d<u+l;d+=l)m=this.compute(d),h=G.dist(n,m),h<p&&(p=h,f=d);return f=f<0?0:f>1?1:f,m=this.compute(f),m.t=f,m.d=p,m}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?G.computeWithRatios(n,this.points,this.ratios,this._3d):G.compute(n,this.points,this._3d,this.ratios)}raise(){let n=this.points,e=[n[0]],r=n.length;for(let i=1,s,a;i<r;i++)s=n[i],a=n[i-1],e[i]={x:(r-i)/r*s.x+i/r*a.x,y:(r-i)/r*s.y+i/r*a.y};return e[r]=n[r-1],new ze(e)}derivative(n){return G.compute(n,this.dpoints[0],this._3d)}dderivative(n){return G.compute(n,this.dpoints[1],this._3d)}align(){let n=this.points;return new ze(G.align(n,{p1:n[0],p2:n[n.length-1]}))}curvature(n){return G.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return G.inflections(this.points)}normal(n){return this._3d?this.__normal3(n):this.__normal2(n)}__normal2(n){let e=this.derivative(n),r=vs(e.x*e.x+e.y*e.y);return{t:n,x:-e.y/r,y:e.x/r}}__normal3(n){let e=this.derivative(n),r=this.derivative(n+.01),i=vs(e.x*e.x+e.y*e.y+e.z*e.z),s=vs(r.x*r.x+r.y*r.y+r.z*r.z);e.x/=i,e.y/=i,e.z/=i,r.x/=s,r.y/=s,r.z/=s;let a={x:r.y*e.z-r.z*e.y,y:r.z*e.x-r.x*e.z,z:r.x*e.y-r.y*e.x},u=vs(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=u,a.y/=u,a.z/=u;let l=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:n,x:l[0]*e.x+l[1]*e.y+l[2]*e.z,y:l[3]*e.x+l[4]*e.y+l[5]*e.z,z:l[6]*e.x+l[7]*e.y+l[8]*e.z}}hull(n){let e=this.points,r=[],i=[],s=0;for(i[s++]=e[0],i[s++]=e[1],i[s++]=e[2],this.order===3&&(i[s++]=e[3]);e.length>1;){r=[];for(let a=0,u,l=e.length-1;a<l;a++)u=G.lerp(n,e[a],e[a+1]),i[s++]=u,r.push(u);e=r}return i}split(n,e){if(n===0&&e)return this.split(e).left;if(e===1)return this.split(n).right;let r=this.hull(n),i={left:this.order===2?new ze([r[0],r[3],r[5]]):new ze([r[0],r[4],r[7],r[9]]),right:this.order===2?new ze([r[5],r[4],r[2]]):new ze([r[9],r[8],r[6],r[3]]),span:r};return i.left._t1=G.map(0,0,1,this._t1,this._t2),i.left._t2=G.map(n,0,1,this._t1,this._t2),i.right._t1=G.map(n,0,1,this._t1,this._t2),i.right._t2=G.map(1,0,1,this._t1,this._t2),e?(e=G.map(e,n,1,0,1),i.right.split(e).left):i}extrema(){let n={},e=[];return this.dims.forEach(function(r){let i=c(function(a){return a[r]},"mfn"),s=this.dpoints[0].map(i);n[r]=G.droots(s),this.order===3&&(s=this.dpoints[1].map(i),n[r]=n[r].concat(G.droots(s))),n[r]=n[r].filter(function(a){return a>=0&&a<=1}),e=e.concat(n[r].sort(G.numberSort))}.bind(this)),n.values=e.sort(G.numberSort).filter(function(r,i){return e.indexOf(r)===i}),n}bbox(){let n=this.extrema(),e={};return this.dims.forEach(function(r){e[r]=G.getminmax(this,r,n[r])}.bind(this)),e}overlaps(n){let e=this.bbox(),r=n.bbox();return G.bboxoverlap(e,r)}offset(n,e){if(typeof e<"u"){let r=this.get(n),i=this.normal(n),s={c:r,n:i,x:r.x+i.x*e,y:r.y+i.y*e};return this._3d&&(s.z=r.z+i.z*e),s}if(this._linear){let r=this.normal(0),i=this.points.map(function(s){let a={x:s.x+n*r.x,y:s.y+n*r.y};return s.z&&r.z&&(a.z=s.z+n*r.z),a});return[new ze(i)]}return this.reduce().map(function(r){return r._linear?r.offset(n)[0]:r.scale(n)})}simple(){if(this.order===3){let i=G.angle(this.points[0],this.points[3],this.points[1]),s=G.angle(this.points[0],this.points[3],this.points[2]);if(i>0&&s<0||i<0&&s>0)return!1}let n=this.normal(0),e=this.normal(1),r=n.x*e.x+n.y*e.y;return this._3d&&(r+=n.z*e.z),Ds(s3(r))<a3/3}reduce(){let n,e=0,r=0,i=.01,s,a=[],u=[],l=this.extrema().values;for(l.indexOf(0)===-1&&(l=[0].concat(l)),l.indexOf(1)===-1&&l.push(1),e=l[0],n=1;n<l.length;n++)r=l[n],s=this.split(e,r),s._t1=e,s._t2=r,a.push(s),e=r;return a.forEach(function(p){for(e=0,r=0;r<=1;)for(r=e+i;r<=1+i;r+=i)if(s=p.split(e,r),!s.simple()){if(r-=i,Ds(e-r)<i)return[];s=p.split(e,r),s._t1=G.map(e,0,1,p._t1,p._t2),s._t2=G.map(r,0,1,p._t1,p._t2),u.push(s),e=r;break}e<1&&(s=p.split(e,1),s._t1=G.map(e,0,1,p._t1,p._t2),s._t2=p._t2,u.push(s))}),u}translate(n,e,r){r=typeof r=="number"?r:e;let i=this.order,s=this.points.map((a,u)=>(1-u/i)*e+u/i*r);return new ze(this.points.map((a,u)=>({x:a.x+n.x*s[u],y:a.y+n.y*s[u]})))}scale(n){let e=this.order,r=!1;if(typeof n=="function"&&(r=n),r&&e===2)return this.raise().scale(r);let i=this.clockwise,s=this.points;if(this._linear)return this.translate(this.normal(0),r?r(0):n,r?r(1):n);let a=r?r(0):n,u=r?r(1):n,l=[this.offset(0,10),this.offset(1,10)],p=[],d=G.lli4(l[0],l[0].c,l[1],l[1].c);if(!d)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(f){let m=p[f*e]=G.copy(s[f*e]);m.x+=(f?u:a)*l[f].n.x,m.y+=(f?u:a)*l[f].n.y}),r?([0,1].forEach(function(f){if(!(e===2&&f)){var m=s[f+1],h={x:m.x-d.x,y:m.y-d.y},v=r?r((f+1)/e):n;r&&!i&&(v=-v);var D=vs(h.x*h.x+h.y*h.y);h.x/=D,h.y/=D,p[f+1]={x:m.x+v*h.x,y:m.y+v*h.y}}}),new ze(p)):([0,1].forEach(f=>{if(e===2&&f)return;let m=p[f*e],h=this.derivative(f),v={x:m.x+h.x,y:m.y+h.y};p[f+1]=G.lli4(m,v,d,s[f+1])}),new ze(p))}outline(n,e,r,i){if(e=e===void 0?n:e,this._linear){let T=this.normal(0),R=this.points[0],S=this.points[this.points.length-1],F,O,L;r===void 0&&(r=n,i=e),F={x:R.x+T.x*n,y:R.y+T.y*n},L={x:S.x+T.x*r,y:S.y+T.y*r},O={x:(F.x+L.x)/2,y:(F.y+L.y)/2};let W=[F,O,L];F={x:R.x-T.x*e,y:R.y-T.y*e},L={x:S.x-T.x*i,y:S.y-T.y*i},O={x:(F.x+L.x)/2,y:(F.y+L.y)/2};let se=[L,O,F],ae=G.makeline(se[2],W[0]),oe=G.makeline(W[2],se[0]),Fe=[ae,new ze(W),oe,new ze(se)];return new xr(Fe)}let s=this.reduce(),a=s.length,u=[],l=[],p,d=0,f=this.length(),m=typeof r<"u"&&typeof i<"u";function h(T,R,S,F,O){return function(L){let W=F/S,se=(F+O)/S,ae=R-T;return G.map(L,0,1,T+W*ae,T+se*ae)}}c(h,"linearDistanceFunction"),s.forEach(function(T){let R=T.length();m?(u.push(T.scale(h(n,r,f,d,R))),l.push(T.scale(h(-e,-i,f,d,R)))):(u.push(T.scale(n)),l.push(T.scale(-e))),d+=R}),l=l.map(function(T){return p=T.points,p[3]?T.points=[p[3],p[2],p[1],p[0]]:T.points=[p[2],p[1],p[0]],T}).reverse();let v=u[0].points[0],D=u[a-1].points[u[a-1].points.length-1],b=l[a-1].points[l[a-1].points.length-1],C=l[0].points[0],A=G.makeline(b,v),M=G.makeline(D,C),w=[A].concat(u).concat([M]).concat(l);return new xr(w)}outlineshapes(n,e,r){e=e||n;let i=this.outline(n,e).curves,s=[];for(let a=1,u=i.length;a<u/2;a++){let l=G.makeshape(i[a],i[u-a],r);l.startcap.virtual=a>1,l.endcap.virtual=a<u/2-1,s.push(l)}return s}intersects(n,e){return n?n.p1&&n.p2?this.lineIntersects(n):(n instanceof ze&&(n=n.reduce()),this.curveintersects(this.reduce(),n,e)):this.selfintersects(e)}lineIntersects(n){let e=j0(n.p1.x,n.p2.x),r=j0(n.p1.y,n.p2.y),i=K0(n.p1.x,n.p2.x),s=K0(n.p1.y,n.p2.y);return G.roots(this.points,n).filter(a=>{var u=this.get(a);return G.between(u.x,e,i)&&G.between(u.y,r,s)})}selfintersects(n){let e=this.reduce(),r=e.length-2,i=[];for(let s=0,a,u,l;s<r;s++)u=e.slice(s,s+1),l=e.slice(s+2),a=this.curveintersects(u,l,n),i.push(...a);return i}curveintersects(n,e,r){let i=[];n.forEach(function(a){e.forEach(function(u){a.overlaps(u)&&i.push({left:a,right:u})})});let s=[];return i.forEach(function(a){let u=G.pairiteration(a.left,a.right,r);u.length>0&&(s=s.concat(u))}),s}arcs(n){return n=n||.5,this._iterate(n,[])}_error(n,e,r,i){let s=(i-r)/4,a=this.get(r+s),u=this.get(i-s),l=G.dist(n,e),p=G.dist(n,a),d=G.dist(n,u);return Ds(p-l)+Ds(d-l)}_iterate(n,e){let r=0,i=1,s;do{s=0,i=1;let a=this.get(r),u,l,p,d,f=!1,m=!1,h,v=i,D=1,b=0;do if(m=f,d=p,v=(r+i)/2,b++,u=this.get(v),l=this.get(i),p=G.getccenter(a,u,l),p.interval={start:r,end:i},f=this._error(p,a,r,i)<=n,h=m&&!f,h||(D=i),f){if(i>=1){if(p.interval.end=D=1,d=p,i>1){let A={x:p.x+p.r*o3(p.e),y:p.y+p.r*i3(p.e)};p.e+=G.angle({x:p.x,y:p.y},A,this.get(1))}break}i=i+(i-r)/2}else i=v;while(!h&&s++<100);if(s>=100)break;d=d||p,e.push(d),r=D}while(i<1);return e}};c(ze,"Bezier");var Ne=ce(Me());var De=ce(Me()),oc=ce(Vr());function u3(o){return typeof o.applyTo=="function"}c(u3,"isModifierObject");function l3(o){return typeof o=="object"&&"nodeType"in o}c(l3,"isNode");function di(o,n){if(l3(n))o.appendChild(n);else if(u3(n))n.applyTo(o);else{let e=""+n;o.appendChild(document.createTextNode(e))}}c(di,"applyModifierTo");function Ma(o,n){for(let e of n)di(o,e)}c(Ma,"applyModifiersTo");function dt(o){return(...n)=>({render:()=>{let e=document.createElement(o);return Ma(e,n),e},applyTo:function(e){e.appendChild(this.render())}})}c(dt,"elemBuilder");function Ln(o){let n=c(e=>({applyTo:r=>r.setAttribute(o,""+e)}),"builder");return n.attrName=o,n}c(Ln,"attrBuilder");function qr(o){return{applyTo:n=>n.insertAdjacentHTML("beforeend",o)}}c(qr,"raw");function q(...o){return{applyTo:n=>Ma(n,o)}}c(q,"mods");var At={applyTo:o=>{}};function Xt(o,n){return Ln(o)(n)}c(Xt,"attr");var z=dt("div"),Yt=dt("span"),fi=dt("a"),Hn=dt("b"),Y6=dt("i"),J0=dt("ul"),$6=dt("ol"),ys=dt("li"),Z0=dt("table"),ed=dt("thead"),td=dt("tbody"),Ql=dt("tr"),nd=dt("th"),rd=dt("td"),bs=dt("input"),od=dt("select"),Ra=dt("option"),mi=dt("button"),id=dt("label"),Q6=dt("img"),j6=dt("canvas"),ke=Ln("style"),wr=Ln("type"),at=Ln("class"),jl=Ln("href"),Kl=Ln("target"),vn=Ln("title"),K6=Ln("src"),J6=Ln("draggable")("true"),Jl=qr("<br>"),Oo=c(o=>Hn(U(o)||me(o)?I:String(Number(o))),"asValue");function Q(o,n,e=200){return z(ke(`max-width: ${e}px`),o===void 0?At:z(ke("padding-bottom: 3px; border-bottom: 1px solid grey;"),o),z(n))}c(Q,"tooltipContent");var Oa=class{constructor(n){this.templateString=n}expand(n){return this.templateString.replace(/\$\{(?:\w+)\}/g,e=>{var i;let r=e.slice(2,-1);return String((i=n[r])!=null?i:"<<"+r+">>")})}};c(Oa,"Template");function ne(o){return new Oa(o)}c(ne,"template");var c3={ComponentBar:{Labels:{More:"Plus",Less:"Moins"},SectionNames:{InputOutput:"Entr\xE9es/ sorties",Layout:"Dispo- sition",Gates:"Portes",Components:"Compo- sants",Custom:"Person- nalis\xE9"},Components:xt.withProps()({Input1:["Entr\xE9e","IN"],InputN:["Entr\xE9e multiple","IN mult."],Input8:["Entr\xE9e octet (8 bits)","IN 8 bits"],Clock:["G\xE9n\xE9rateur de signal d\u2019horloge","Horloge"],Random:["Entr\xE9e al\xE9atoire","Al\xE9atoire"],Output1:["Sortie","OUT"],OutputN:["Sortie multiple","OUT mult."],Output8:["Sortie octet (8 bits)","OUT 8 bits"],DisplayN:["Afficheur d\u2019une valeur","Afficheur"],Display8:["Affichage de 8 bits","Aff. 8 bits"],Display7Seg:["Afficheur \xE0 7 segments","7 segments"],Display16Seg:["Afficheur \xE0 16 segments","16 segments"],DisplayAscii:["Affichage d\u2019un caract\xE8re ASCII (sur 7 bits)","Caract\xE8re"],DisplayBar:["Affichage d\u2019un bit sous forme de segment lumineux","Segment"],ShiftDisplay:["Affichage avec buffer \xE0 d\xE9calage","Affichage \xE0 d\xE9calage"],Passthrough1:["Broche","Broche"],PassthroughN:["Broche \xE0 plusieurs entr\xE9es-sortes","Broche (n)"],Label:["\xC9tiquette","Label"],Rectangle:["Rectangle de regroupement","Groupe"],not:["Porte NON","NON"],buf:["Buffer (porte OUI)","OUI"],tri:["Sortie \xE0 3 \xE9tats","3 \xE9tats"],and:["Porte ET","ET"],or:["Porte OU","OU"],xor:["Porte OU-X","OU-X"],nand:["Porte NON-ET","NON-ET"],nor:["Porte NON-OU","NON-OU"],xnor:["Porte NON-OU-X","NON-OU-X"],imply:["Porte IMPLIQUE","IMPLIQUE"],nimply:["Porte NON-IMPLIQUE","NON-IMPL."],transfer:["Fausse porte TRANSFERT \xE0 deux entr\xE9es","TRANSF."],and3:["Porte ET \xE0 3 entr\xE9es","ET (3)"],or3:["Porte OU \xE0 3 entr\xE9es","OU (3)"],xor3:["Porte OU-X \xE0 3 entr\xE9es","OU-X (3)"],nand3:["Porte NON-ET \xE0 3 entr\xE9es","NON-ET (3)"],nor3:["Porte NON-OU \xE0 3 entr\xE9es","NON-OU (3)"],xnor3:["Porte NON-OU-X \xE0 3 entr\xE9es","NON-OU-X (3)"],and4:["Porte ET \xE0 4 entr\xE9es","ET (4)"],or4:["Porte OU \xE0 4 entr\xE9es","OU (4)"],xor4:["Porte OU-X \xE0 4 entr\xE9es","OU-X (4)"],nand4:["Porte NON-ET \xE0 4 entr\xE9es","NON-ET (4)"],nor4:["Porte NON-OU \xE0 4 entr\xE9es","NON-OU (4)"],xnor4:["Porte NON-OU-X \xE0 4 entr\xE9es","NON-OU-X (4)"],ControlledInverter:["Inverseur commut\xE9","Inv. comm."],GateArray:["Porte multiple","Porte mult."],TristateBufferArray:["Sortie \xE0 3 \xE9tats multiple","3 \xE9tats mult."],HalfAdder:["Demi-additionneur","Demi-add."],Adder:["Additionneur","Addit."],AdderArray:["Additionneur multiple","Add. mult."],ALU:["Unit\xE9 arithm\xE9tique et logique","ALU"],Mux:["Multiplexer","Mux"],Mux2to1:["Multiplexer 2-vers-1 (1 bit de contr\xF4le)","Mux 2-1"],Mux4to1:["Multiplexer 4-vers-1 (2 bits de contr\xF4le)","Mux 4-1"],Mux8to1:["Multiplexer 8-vers-1 (3 bits de contr\xF4le)","Mux 8-1"],Mux4to2:["Multiplexer 4-vers-2 (1 bit de contr\xF4le)","Mux 4-2"],Mux8to2:["Multiplexer 8-vers-2 (2 bits de contr\xF4le)","Mux 8-2"],Mux8to4:["Multiplexer 8-vers-4 (1 bit de contr\xF4le)","Mux 8-4"],Mux16to8:["Multiplexer 16-vers-8 (1 bit de contr\xF4le)","Mux 16-8"],Demux:["D\xE9multiplexer","Demux"],Demux1to2:["D\xE9multiplexer 1-vers-2 (1 bit de contr\xF4le)","Demux 1-2"],Demux1to4:["D\xE9multiplexer 1-vers-4 (2 bits de contr\xF4le)","Demux 1-4"],Demux1to8:["D\xE9multiplexer 1-vers-8 (3 bits de contr\xF4le)","Demux 1-8"],Demux2to4:["D\xE9multiplexer 2-vers-4 (1 bit de contr\xF4le)","Demux 2-4"],Demux2to8:["D\xE9multiplexer 2-vers-8 (2 bits de contr\xF4le)","Demux 2-8"],Demux4to8:["D\xE9multiplexer 4-vers-8 (1 bit de contr\xF4le)","Demux 4-8"],Demux8to16:["D\xE9multiplexer 8-vers-16 (1 bit de contr\xF4le)","Demux 8-16"],LatchSR:["Verrou SR","Verrou SR"],FlipflopJK:["Bascule JK","Basc. JK"],FlipflopT:["Bascule T","Basc. T"],FlipflopD:["Bascule D","Basc. D"],Register:["Registre","Registre"],ShiftRegister:["Registre \xE0 d\xE9calage","Reg. d\xE9c."],RAM:["RAM (m\xE9moire vive)","RAM"],ROM:["ROM (m\xE9moire morte)","ROM"],Counter:["Compteur 4 bits","Compteur"],Decoder:["D\xE9codeur binaire vers 1-sur-n","D\xE9codeur"],Decoder7Seg:["D\xE9codeur 7 segments","D\xE9c. 7 seg."],Decoder16Seg:["D\xE9codeur ASCII vers 16 segments","D\xE9c. 16 seg."],DecoderBCD4:["D\xE9codeur 4 bits vers BCD sur 5 bits","D\xE9c. BCD"],Comparator:["Comparateur","Compar."]})},Modes:{FULL:N("Admin","En plus du mode complet, ce mode permet de rendre les entr\xE9es, les sorties des portes, voire les portes elles-m\xEAmes ind\xE9termin\xE9es"),DESIGN:N("Complet","La totalit\xE9 des actions de conception d\u2019un circuit sont possible"),CONNECT:N("Connexion","Il est possible de d\xE9placer et de connecter des \xE9l\xE9ments d\xE9j\xE0 sur le canevas, mais pas d\u2019en rajouter (le menu de gauche ne serait pas actif)"),TRYOUT:N("Test","Il est seulement possible de changer les entr\xE9es pour tester un circuit pr\xE9\xE9tabli"),STATIC:N("Statique","Les \xE9l\xE9ments sont juste affich\xE9s; aucune interaction n\u2019est possible")},Orientations:{e:"Vers la droite (par d\xE9faut)",s:"Vers le bas",w:"Vers la gauche",n:"Vers le haut"},Settings:{Settings:"R\xE9glages",CircuitName:"Nom:",NameOfDownloadedFile:"Ceci sera le nom du fichier t\xE9l\xE9charg\xE9.",hideWireColors:N("Cacher l\u2019\xE9tat des fils","Si coch\xE9, les fils sont affich\xE9s avec une couleur neutre plut\xF4t que de montrer s\u2019ils v\xE9hiculent un 1 ou un 0."),hideInputColors:N("Cacher l\u2019\xE9tat des entr\xE9es","Si coch\xE9, les entr\xE9es sont affich\xE9es avec une couleur neutre, m\xEAme si elles livrent au circuit une valeur bien d\xE9termin\xE9e. S\u2019utilise volontiers en cachant aussi l\u2019\xE9tat des fils."),hideOutputColors:N("Cacher l\u2019\xE9tat des sorties","Si coch\xE9, les sorties sont affich\xE9es avec une couleur neutre. S\u2019utilise volontiers en cachant aussi l\u2019\xE9tat des fils."),hideMemoryContent:N("Cacher le contenu stock\xE9","Si coch\xE9, les verrous, bascules, registres et autres m\xE9moires ne montrent pas leur contenu."),showGateTypes:N("Montrer type des portes","Si coch\xE9, affiche sur les portes logique le nom de la fonction r\xE9alis\xE9e."),showDisconnectedPins:N("Toujours montrer les pattes","Si non coch\xE9, les pattes non connect\xE9es des composants sont masqu\xE9es dans les modes o\xF9 les connexions du circuit ne peuvent pas \xEAtre modifi\xE9es (et restent visibles sinon)."),hideTooltips:N("D\xE9sactiver tooltips","Si coch\xE9, les informations suppl\xE9mentaires des tooltips (comme les tables de v\xE9rit\xE9) ne seront pas affich\xE9es."),groupParallelWires:N("Grouper les fils parall\xE8les","Si coch\xE9, les fils parral\xE8les allant d'un composant \xE0 un autre seront regroup\xE9s en un seul fil plus \xE9pais."),propagationDelay:"Un 1 ou un 0 impos\xE9 sur une connexion sera r\xE9percut\xE9 \xE0 l\u2019autre bout de la connexion apr\xE8s ce d\xE9lai de propagation.",propagationDelayField:N("Propagation en","ms"),zoomLevel:"Le niveau de zoom sur les composants du circuit.",zoomLevelField:N("Zoom:","%"),showUserDataLink:N("Voir les","donn\xE9es li\xE9es"),userDataHeader:"Les donn\xE9es suivantes sont export\xE9es avec le circuit:",wireStyle:"Style des fils:",WireStyleAuto:"Auto",WireStyleLine:"Ligne",WireStyleCurve:"Courbe"},ControlBar:{TimelinePlay:N("Play","D\xE9marre l\u2019\xE9coulement du temps"),TimelinePause:N("Pause","Arr\xEAte l\u2019\xE9coulement du temps"),TimelineStep:N(void 0,"Avance au prochain \xE9v\xE9nement"),Undo:N(void 0,"Annule la derni\xE8re action"),Redo:N(void 0,"R\xE9tablit la derni\xE8re action annul\xE9e ou r\xE9p\xE8te l\u2019action pr\xE9c\xE9dente")},Messages:{NotImplemented:"Cette fonctionnalit\xE9 n\u2019est pas encore impl\xE9ment\xE9e.",ReallyCloseWindow:"Voulez-vous vraiment fermer la fen\xEAtre sans prendre en compte les derniers changements?",DevelopedBy:"D\xE9velopp\xE9 par "},Components:{Generic:{contextMenu:{Delete:"Supprimer",Reset:"R\xE9activer",MakeNewComponent:"Cr\xE9er un nouveau composant\u2026",MakeNewComponentFailed:"Impossible de cr\xE9er un nouveau composant.",SetIdentifier:"Attribuer un identifiant\u2026",ChangeIdentifier:N("Changer l\u2019identifiant (",")\u2026"),SetIdentifierPrompt:"Choisissez l\u2019identifiant unique \xE0 attribuer \xE0 ce composant:",IdentifierCannotBeEmpty:"L\u2019identifiant ne peut pas \xEAtre vide.",IdentifierAlreadyInUseShouldSwap:"L\u2019identifiant est d\xE9j\xE0 utilis\xE9 par un autre composant. Voulez-vous inverser les identifiants?",Orientation:"Orientation",ChangeOrientationDesc:"Changez l\u2019orientation avec Commande + double-clic sur le composant",LockPosition:"Verrouiller la position",ShowAsUnknown:"Afficher comme inconnu",ForceOutputSingle:"Forcer la sortie",ForceOutputMultiple:"Forcer une sortie",Output:"Sortie",NormalOutput:"Sortie normale",ForceAsUnknown:"Forcer comme \xE9tat inconnu",ForceAs1:"Forcer \xE0 1",ForceAs0:"Forcer \xE0 0",ForceAsZ:"Forcer \xE0 haute imp\xE9dance",ForceOutputDesc:"Forcez une sortie avec Option + double-clic sur la sortie",SetName:"Ajouter un nom\u2026",ChangeName:"Changer le nom\u2026",SetNamePrompt:"Choisissez le nom \xE0 afficher ou laissez vide pour le supprimer:",SetFontPrompt:N("Entrez une sp\xE9cification de police ou laissez vide pour la valeur par d\xE9faut (","):"),TriggerOn:"Stocker au",TriggerRisingEdge:"flanc montant",TriggerFallingEdge:"flanc descendant",ShowContent:"Montrer le contenu",ParamNumInputs:N("Nombre d\u2019entr\xE9es",ne("${val} entr\xE9es")),ParamNumBits:N("Nombre de bits",ne("${val} bits")),ParamNumWords:N("Nombre de lignes",ne("${val} lignes"))},InputCarryInDesc:"Cin (retenue pr\xE9c\xE9dente)",InputClockDesc:"Clock (horloge)",InputClearDesc:"C (Clear, mise \xE0 0)",InputPresetDesc:"P (Preset, mise \xE0 1)",InputSetDesc:"S (Set, mise \xE0 1)",InputResetDesc:"R (Reset, mise \xE0 0)",InputDataDesc:"D (Donn\xE9es)",InputWriteEnableDesc:"WE (\xE9criture activ\xE9e)",OutputSumDesc:"S (somme)",OutputCarryDesc:"C (retenue)",OutputCarryOutDesc:"Cout (retenue)",OutputQDesc:"Q (sortie normale)",OutputQBarDesc:"Q\u0305 (sortie invers\xE9e)"},Custom:{MenuButtonSuffix:" (composant personnalis\xE9)",contextMenu:{ChangeName:"Renommer\u2026",ChangeNamePrompt:"Choisissez le nom de ce composant personnalit\xE9:",ChangeNameEmpty:"Le nom ne peut pas \xEAtre vide.",ChangeCircuit:"Modifier le circuit\u2026",Delete:"Supprimer ce composant",CannotDeleteInUse:"Impossible de supprimer ce composant car il est utilis\xE9 dans le circuit.",CannotDeleteInUseBy:ne("Impossible de supprimer ce composant car il est utilis\xE9 dans la d\xE9finition d\u2019un autre composant (${caption})."),ConfirmDelete:"Voulez-vous vraiment supprimer ce composant personnalis\xE9?"},messages:{EmptySelection:"Aucun composant n\u2019est s\xE9lectionn\xE9.",NoInput:"Aucune entr\xE9e n\u2019est s\xE9lectionn\xE9e.",NoOutput:"Aucune sortie n\u2019est s\xE9lectionn\xE9e.",InputsOutputsMustHaveNames:"Toutes les entr\xE9es et sorties doivent avoir un nom.",MissingComponents:ne("Les composants suivants sont connect\xE9s \xE0 des sorties mais ne sont pas s\xE9lectionn\xE9s: ${list}."),UselessComponents:ne("Les composants suivants ne sont pas connect\xE9s \xE0 des sorties et sont inutiles: ${list}."),CannotIncludeClock:"Les horloges ne peuvent pas \xEAtre incluses dans les composants personnalis\xE9s. Ajoutez une entr\xE9e normale, qui pourra \xEAtre connect\xE9e \xE0 une horloge de l'ext\xE9rieur du composant.",EnterCaptionPrompt:"Entrez le nom (unique) du composant personnalis\xE9:",ComponentAlreadyExists:ne("Un composant personnalis\xE9 avec l\u2019identifiant '${id}' existe d\xE9j\xE0.")}},Adder:{tooltip:{title:"Additionneur",desc:"Additionne deux bits A et B et une retenue d\u2019entr\xE9e Cin, et fournit un bit de somme S et une retenue de sortie Cout."}},AdderArray:{tooltip:{title:ne("Additionneur \xE0 ${numBits} bits"),desc:"Additionne les deux nombres d'entr\xE9es A et B avec une retenue d\u2019entr\xE9e Cin, et fournit les bits de somme S et une retenue de sortie Cout."}},ALU:{"A+B":N("+","Addition"),"A-B":N("A\u2013B","Soustraction (A \u2013 B)"),"B-A":N("B\u2013A","Soustraction (B \u2013 A)"),"A+1":N("A+1","A + 1"),"A-1":N("A\u20131","A \u2013 1"),"-A":N("\u2013A","N\xE9gation d\u2019A"),"A*2":N("A\xD72","Addition d\u2019A \xE0 lui-m\xEAme (A \xD7 2)"),"A/2":N("A/2","D\xE9calage arithm\xE9tique \xE0 droite de 1 (A / 2)"),"A|B":N("OU","Disjonction (A OU B)"),"A&B":N("ET","Conjonction (A ET B)"),"A|~B":N("OU-n","A OU NON(B)"),"A&~B":N("ET-n","A ET NON(B)"),"~A":N("A\u0305","Inversion d\u2019A"),"A^B":N("OU-X","Disjonction excl. (A OU-X B)"),"A<<":N("<<","D\xE9calage logique \xE0 gauche de 1 de A"),"A>>":N(">>","D\xE9calage logique \xE0 droite de 1 de A"),InputCinDesc:"retenue d\u2019entr\xE9e",OutputCoutDesc:"retenue de sortie",tooltip:{title:"Unit\xE9 arithm\xE9tique et logique (ALU)",CurrentlyCarriesOut:"Effectue actuellement",SomeUnknownOperation:"une op\xE9ration inconnue",ThisOperation:"l\u2019op\xE9ration"},contextMenu:{toggleShowOp:"Afficher l\u2019op\xE9ration",ParamUseExtendedOpcode:"Utiliser op\xE9rations \xE9tendues"}},Clock:{tooltip:{title:"Horloge",period:N("P\xE9riode: "," ms"),dutycycle:N("Rapport cyclique: ","%"),phase:N("D\xE9phasage: "," ms")},contextMenu:{Period:"P\xE9riode",ReplaceWithInput:"Remplacer par entr\xE9e"},timeline:{NextRisingEdge:"Prochain flanc montant de l\u2019horloge",NextFallingEdge:"Prochain flanc descendant de l\u2019horloge"}},Comparator:{tooltip:{title:"Comparateur",desc:"Comparateur entre deux bits A et B, activ\xE9 par une entr\xE9e E."}},Counter:{tooltip:{title:"Compteur",desc:"Compteur \xE0 quatre bits."},contextMenu:{DisplayTempl:ne("Affichage ${desc}"),DisplayNone:"absent",DisplayDecimal:"d\xE9cimal",DisplayHex:"hexad\xE9cimal"}},Decoder:{tooltip:{title:"D\xE9codeur binaire",desc:ne("Ce d\xE9codeur prend en entr\xE9e un nombre binaire cod\xE9 sur ${numFrom} bits et active la sortie correspondante parmi ${numTo} (actuellement, ${n}).")}},Decoder7Seg:{tooltip:"D\xE9codeur 7 segments"},Decoder16Seg:{tooltip:"D\xE9codeur ASCII vers 16 segments"},DecoderBCD4:{tooltip:"D\xE9codeur 4 bits vers BCD (binary-coded decimal)"},Demux:{tooltip:ne("D\xE9multiplexeur ${from} vers ${to}")},FlipflopD:{tooltip:{title:"Bascule D",desc:"Stocke un bit."}},FlipflopJK:{InputJDesc:"J (Jump, mise \xE0 1)",InputKDesc:"K (Kill, mise \xE0 0)",tooltip:{title:"Bascule JK",desc:"Stocke un bit."}},FlipflopT:{InputTDesc:"T (Toggle, bascule)",tooltip:{title:"Bascule T",desc:"Stocke un bit."}},Gate:{not:N("NON","NON","La sortie est \xE9gale \xE0 l\u2019entr\xE9e invers\xE9e."),buf:N("OUI","OUI","La sortie est \xE9gale \xE0 l\u2019entr\xE9e."),and:N("ET","ET","La sortie vaut 1 lorsque toutes les entr\xE9es valent 1."),or:N("OU","OU","La sortie vaut 1 lorsqu\u2019au moins une des entr\xE9es vaut 1."),xor:N("OU-X","OU-X","La sortie vaut 1 lorsqu\u2019un nombre impair d\u2019entr\xE9es valent 1."),nand:N("NON-ET","N-ET","Porte ET invers\xE9e: la sortie vaut 1 \xE0 moins que toutes les entr\xE9es ne valent 1."),nor:N("NON-OU","N-OU","Porte OU invers\xE9e: la sortie vaut 1 lorsque toutes les entr\xE9es valent 0."),xnor:N("NON-OU-X","N-OU-X","Porte OU-X invers\xE9e: la sortie vaut 1 lorsqu\u2019un nombre pair d\u2019entr\xE9es valent 1."),imply:N("IMPLIQUE","IMPL","La sortie vaut 1 si la premi\xE8re entr\xE9e vaut 0 ou si les deux entr\xE9es valent 1."),rimply:N("IMPLIQUE (bis)","IMPL","La sortie vaut 1 si la seconde entr\xE9e vaut 0 ou si les deux entr\xE9es valent 1."),nimply:N("NON-IMPLIQUE","N-IMPL","Porte IMPLIQUE invers\xE9e: la sortie ne vaut 1 que lorsque la premi\xE8re entr\xE9e vaut 1 et la seconde 0."),rnimply:N("NON-IMPLIQUE (bis)","N-IMPL","Porte IMPLIQUE invers\xE9e: la sortie ne vaut 1 que lorsque la premi\xE8re entr\xE9e vaut 0 et la seconde 1."),txa:N("TRANSFERT-A",void 0,"La sortie est \xE9gale \xE0 la premi\xE8re entr\xE9e; la seconde entr\xE9e est ignor\xE9e."),txb:N("TRANSFERT-B",void 0,"La sortie est \xE9gale \xE0 la seconde entr\xE9e; la premi\xE8re entr\xE9e est ignor\xE9e."),txna:N("TRANSFERT-NON-A",void 0,"La sortie est \xE9gale \xE0 la premi\xE8re entr\xE9e invers\xE9e; la seconde entr\xE9e est ignor\xE9e."),txnb:N("TRANSFERT-NON-B",void 0,"La sortie est \xE9gale \xE0 la seconde entr\xE9e invers\xE9e; la premi\xE8re entr\xE9e est ignor\xE9e."),tooltip:{GateTitle:o=>q("Porte ",o),UnknownGate:"Porte inconnue",Input:"Entr\xE9e",Output:"Sortie",CurrentlyDelivers:"Actuellement, il livre",ShouldCurrentlyDeliver:"Actuellement, il devrait livrer",UndeterminedOutputBecauseInputUnknown:"une sortie ind\xE9termin\xE9e comme son entr\xE9e n\u2019est pas connue. Sa table de v\xE9rit\xE9 est:",UndeterminedOutputBecauseInputsUnknown:"une sortie ind\xE9termin\xE9e comme toutes ses entr\xE9es ne sont connues. Sa table de v\xE9rit\xE9 est:",ThisOutput:"une sortie de",BecauseInputIs:"car son entr\xE9e est",AccordingToTruthTable:"selon la table de v\xE9rit\xE9 suivante:",Inverter:N("Inverseur (porte ",")"),Buffer:N("Buffer (porte ",")")},contextMenu:{ReplaceBy:"Remplacer par",GateTempl:ne("Porte ${type}"),ShowAs:"Afficher comme",NormalGateTempl:ne("Porte ${type} normale"),UnknownGate:"Porte inconnue (avec \xAB?\xBB)",VariantChangeDesc:"Changez entre les variantes avec Majuscule + double-clic sur la porte"}},HalfAdder:{tooltip:{title:"Demi-additionneur",desc:"Additionne deux bits A et B et fournit un bit de somme S et une retenue de sortie C."}},Input:{tooltip:{title:ne("Entr\xE9e (${numBits} bits)")},contextMenu:{LockValue:"Verrouiller cette valeur",PushButton:"Poussoir",ToggleButton:"Commutateur",ReplaceWithClock:"Remplacer par horloge"}},Random:{tooltip:{title:"Valeur al\xE9atoire",desc:N("\xC0 chaque coup d\u2019horloge, la valeur de sortie sera 1 avec une probabilit\xE9 de ",".")},contextMenu:{ShowProb:"Montrer la probabilit\xE9"}},Rectangle:{contextMenu:{Size:"Taille",SizePrompt:"Entrez la taille de ce rectangle:",Rounded:"Arrondi",WithBackgroundColor:"Avec couleur de fond",SetTitle:"Ajouter un titre\u2026",ChangeTitle:"Changer le titre\u2026",SetTitlePrompt:"Entrez le titre \xE0 afficher ou laissez vide pour le supprimer:",InsideFrame:"\xC0 l\u2019int\xE9rieur du cadre",Font:"Police\u2026",Color:"Couleur",ColorYellow:"Jaune",ColorRed:"Rouge",ColorGreen:"Vert",ColorBlue:"Bleu",ColorTurquoise:"Turquoise",ColorGrey:"Gris",Border:"Bordure",BorderNone:"Aucune bordure",Border1px:"Fine (1 pixel)",Border2px:"Moyenne (2 pixels)",Border3px:"\xC9paisse (3 pixels)",Border5px:"Tr\xE8s \xE9paisse (5 pixels)",Border10px:"\xC9norme (10 pixels)",TitlePlacement:"Position du titre",PlacementTop:"En haut",PlacementTopLeft:"En haut \xE0 gauche",PlacementTopRight:"En haut \xE0 droite",PlacementBottom:"En bas",PlacementBottomLeft:"En bas \xE0 gauche",PlacementBottomRight:"En bas \xE0 droite",PlacementLeft:"\xC0 gauche",PlacementRight:"\xC0 droite",PlacementCenter:"Au centre"}},Label:{contextMenu:{ChangeText:"Changer le texte\u2026",ChangeTextPrompt:"Choisissez le texte \xE0 afficher:",Font:"Police\u2026"}},LatchSR:{tooltip:{title:"Verrou SR",desc:"Stocke un bit."}},Mux:{tooltip:ne("Multiplexeur ${from} vers ${to}")},MuxDemux:{contextMenu:{ShowWiring:"Afficher les connexions",UseZForDisconnected:"Utiliser Z pour sorties d\xE9connect\xE9es",ParamNumFrom:N("Nombre d\u2019entr\xE9es",ne("${val} entr\xE9es")),ParamNumTo:N("Nombre de sorties",ne("${val} sorties"))}},Output:{tooltip:{title:ne("Sortie (${numBits} bits)")}},Display7Seg:{tooltip:"Afficheur 7 segments"},Display16Seg:{tooltip:"Afficheur 16 segments"},DisplayAscii:{tooltip:{title:"Afficheur de caract\xE8re ASCII",desc:N("Affiche le caract\xE8re ASCII repr\xE9sent\xE9 par ses 7 entr\xE9es, actuellement ","."),CurrentlyUndefined:"Comme toutes ses entr\xE9es ne sont pas connues, ce caract\xE8re est actuellement ind\xE9fini.",CurrentlyThisCharacter:"Actuellement, c\u2019est le caract\xE8re num\xE9ro",WhichIsNotPrintable:" (un caract\xE8re non imprimable)."},contextMenu:{AdditionalDisplay:"Affichage suppl\xE9mentaire",DisplayNone:"Aucun",DisplayDecimal:"Valeur d\xE9cimale",DisplayHex:"Valeur hexad\xE9cimale",ChangeDisplayDesc:"Changez l\u2019affichage suppl\xE9mentaire avec un double-clic sur le composant"}},DisplayBar:{tooltip:{title:"Afficheur lumineux",ValueUnknown:"Son \xE9tat est ind\xE9termin\xE9 car son entr\xE9e n\u2019est pas connue.",ValueZ:"Son \xE9tat est ind\xE9termin\xE9 car son entr\xE9e est flottante (haute imp\xE9dance).",Value1:N("Il est actuellement allum\xE9 car son entr\xE9e est de ","."),Value0:N("Il est actuellement \xE9teint car son entr\xE9e est de ",".")},contextMenu:{TransparentWhenOff:"Transparent si \xE9teint",Display:"Affichage",DisplayVerticalBar:"Barre verticale",DisplayHorizontalBar:"Barre horizontale",DisplaySmallSquare:"Petit carr\xE9",DisplayLargeSquare:"Grand carr\xE9",DisplayChangeDesc:"Changez l\u2019affichage avec un double-clic sur le composant",Color:"Couleur",ColorGreen:"Vert",ColorRed:"Rouge",ColorYellow:"Jaune"}},Display:{tooltip:{title:ne("Afficheur ${numBits} bits"),desc:N(ne("Affiche la valeur ${radixStr} de ses ${numBits} entr\xE9es, actuellement "),"."),RadixBinary:"binaire",RadixDecimal:"d\xE9cimale",RadixSignedDecimal:"d\xE9cimale sign\xE9e",RadixHexadecimal:"hexad\xE9cimale",RadixGeneric:ne("en base ${radix}"),CurrentlyUndefined:"Comme toutes ses entr\xE9es ne sont pas connues, cette valeur est actuellement ind\xE9finie."},contextMenu:{DisplayAs:"Afficher",DisplayNone:"Aucun",DisplayAsBinary:"en binaire (base 2)",DisplayAsDecimal:"en d\xE9cimal (base 10)",DisplayAsSignedDecimal:"en d\xE9cimal sign\xE9",DisplayAsOctal:"en octal (base 8)",DisplayAsHexadecimal:"en hexad\xE9cimal (base 16)",DisplayAsUnknown:"comme inconnu"}},ShiftDisplay:{tooltip:"Affichage \xE0 d\xE9calage",contextMenu:{Decoding:"D\xE9codage",DecodingNone:"Aucun",DecodingOctal:"Octal",DecodingHex:"Hexad\xE9cimal",DecodingAscii7:"ASCII (7 bits)",DecodingAscii8:"ASCII (8 bits)",DecodingUint4:"Entier sur 4 bits",DecodingInt4:"Entier sign\xE9 sur 4 bits",DecodingUint8:"Entier sur 8 bits",DecodingInt8:"Entier sign\xE9 sur 8 bits",DecodingUint16:"Entier sur 16 bits",DecodingInt16:"Entier sign\xE9 sur 16 bits",DecodingChangeWarning:"Attention, changer le d\xE9codage peut tronquer la valeur stock\xE9e",Grouping:"Regrouper les donn\xE9es",GroupingNone:"Pas de regroupement",GroupBy:ne("Par ${n}")},EmptyCaption:"(vide)"},Passthrough:{tooltip:"Broche. Sert uniquement \xE0 arranger les connexions.",contextMenu:{Slant:"Inclinaison",SlantNone:"Aucune",SlantRight:"De 45\xB0 vers la droite",SlantLeft:"De 45\xB0 vers la gauche"}},GateArray:{tooltip:{title:"Porte multiple",desc:ne("Effectue plusieurs fois en parall\xE8le l\u2019op\xE9ration logique choisie; actuellement, ${op}.")},contextMenu:{Type:"Type",ShowAsUnknown:"Masquer le type"}},TristateBufferArray:{tooltip:{title:"Sortie \xE0 3 \xE9tats multiple",desc:"Repr\xE9sente plusieurs sorties \xE0 trois \xE9tats, contr\xF4l\xE9es par un seul bit de contr\xF4le."}},RAM:{tooltip:{title:"RAM (m\xE9moire vive)",desc:ne("Stocke ${numWords} lignes de ${numDataBits} bits.")},contextMenu:{SelectedDataDisplay:"Affichage des donn\xE9es address\xE9es",EditContent:"\xC9diter le contenu\u2026",EditContentPrompt:"Tapez le nouveau contenu de la m\xE9moire en s\xE9parant les lignes par des espaces. S\u2019il y a autant de caract\xE8res que de bits, les donn\xE9es sont lues comme \xE9tant du binaire, sinon, comme de l'hexad\xE9cimal.",SaveContent:"Sauvegarder le contenu",LoadContent:"Charger le contenu\u2026",SwapROMRAM:"\xC9changer ROM et RAM"}},ROM:{tooltip:{title:"ROM (m\xE9moire morte)",desc:ne("Stocke ${numWords} lignes de ${numDataBits} bits.")}},Register:{tooltip:{title:"Registre",desc:ne("Stocke ${numBits} bits.")},contextMenu:{ParamHasIncDec:"Avec incr\xE9mentaiton",Saturating:"Avec saturation"}},ShiftRegister:{tooltip:{title:"Registre \xE0 d\xE9calage",desc:ne("Stocke ${numBits} bits et les d\xE9cale \xE0 chaque activation.")}},ControlledInverter:{tooltip:{title:"Inverseur commut\xE9",desc:"Inverse ses entr\xE9es si le bit de contr\xF4le S vaut 1; sinon, les sorties sont \xE9gales aux entr\xE9es."}},TristateBuffer:{tooltip:"Sortie \xE0 3 \xE9tats"},Wire:{contextMenu:{AddMiddlePoint:"Ajouter un point interm\xE9diaire",AddPassthrough:"Ajouter une broche",CustomPropagationDelay:ne("D\xE9lai de propagation sp\xE9cifique${current}\u2026"),CustomPropagationDelayDesc:ne("D\xE9lai de propagation personnalis\xE9 en millisecondes pour cette connexion (laisser vide pour utiliser la valeur par d\xE9faut du circuit, actuellement de ${current} ms):"),WireColor:"Couleur du fil",WireColorBlack:"Noir (par d\xE9faut)",WireColorRed:"Rouge",WireColorBlue:"Bleu",WireColorYellow:"Jaune",WireColorGreen:"Vert",WireColorWhite:"Blanc",WireStyle:"Style",WireStyleDefault:"Par d\xE9faut",WireStyleAuto:"Automatique",WireStyleStraight:"Ligne droite",WireStyleCurved:"Courbe"},timeline:{PropagatingValue:ne("Propagation de la valeur ${val} sur le fil")}}},Palette:{Design:N("Concevoir","Compose ou modifie le circuit"),Delete:N("Supprimer","Supprime des \xE9l\xE9ments du circuit"),Move:N("D\xE9placer","D\xE9place tout le circuit"),Download:N("T\xE9l\xE9charger","T\xE9l\xE9charge le circuit (ou les composants personnalis\xE9s avec la touche Option/Alt)"),Screenshot:N("Screenshot","T\xE9l\xE9charge le circuit sous forme d\u2019image (PNG ou SVG avec touche Option/Alt)"),Open:N("Ouvrir","Ouvre un circuit pr\xE9c\xE9demment t\xE9l\xE9charg\xE9"),Reset:N("R\xE9initialiser","R\xE9initialise l\u2019\xE9tat de ce circuit")},Dialogs:{Generic:{Close:"Fermer"},Share:{title:"Partager ce circuit",URL:"URL:",EmbedInIframe:"Inclusion via <iframe>:",EmbedWithWebComp:"Inclusion via un web component:",EmbedInMarkdown:"Inclusion en Markdown/Myst:"}}},p3={ComponentBar:{SectionNames:{InputOutput:"Input/ Output",Gates:"Gates",Layout:"Layout",Components:"Compo- nents",Custom:"Custom"},Labels:{More:"More",Less:"Less"},Components:xt.withProps()({Input1:["Input","IN"],InputN:["Multiple Inputs","IN Mult."],Input8:["Byte (8-Bit) Input","IN (8-Bit)"],Clock:["Clock Generator","Clock"],Random:["Random Input","Random"],Output1:["Output","OUT"],OutputN:["Multiple Outputs","OUT Mult."],Output8:["Byte (8-Bit) Output","OUT (8-Bit)"],DisplayN:["Value Display","Display"],Display8:["Byte (8-Bit) Display","8-Bit Displ."],Display7Seg:["7-Segment Display","7-Segment"],Display16Seg:["16-Segment Display","16-Segment"],DisplayAscii:["ASCII Character (7-Bit) Display","Character"],DisplayBar:["Bit Display as a Light Bar","Bar"],ShiftDisplay:["Display with Shift Buffer","Shift Displ."],Passthrough1:["Passthrough","Passthrough"],PassthroughN:["Passthrough with multiple inputs-outputs","Passthr. (n)"],Label:["Label","Label"],Rectangle:["Grouping Rectangle","Group"],not:["NOT Gate","NOT"],buf:["Buffer","BUF"],tri:["Tristate Buffer","Tristate"],and:["AND Gate","AND"],or:["OR Gate","OR"],xor:["XOR Gate","XOR"],nand:["NAND Gate","NAND"],nor:["NOR Gate","NOR"],xnor:["XNOR Gate","XNOR"],imply:["IMPLY Gate","IMPLY"],nimply:["NIMPLY Gate","NIMPLY"],transfer:["Fake 2-Input TRANSFER Gate","TRANSF."],and3:["3-Input AND Gate","AND (3)"],or3:["3-Input OR Gate","OR (3)"],xor3:["3-Input XOR Gate","XOR (3)"],nand3:["3-Input NAND Gate","NAND (3)"],nor3:["3-Input NOR Gate","NOR (3)"],xnor3:["3-Input XNOR Gate","XNOR (3)"],and4:["4-Input AND Gate","AND (4)"],or4:["4-Input AND Gate","OR (4)"],xor4:["4-Input AND Gate","XOR (4)"],nand4:["4-Input AND Gate","NAND (4)"],nor4:["4-Input AND Gate","NOR (4)"],xnor4:["4-Input AND Gate","XNOR (4)"],ControlledInverter:["Switched Inverter","Switched Inv."],GateArray:["Gate Array","Gate Array"],TristateBufferArray:["Tristate Buffer Array","Tristate Arr."],HalfAdder:["Half Adder","Half Adder"],Adder:["Full Adder","Full Adder"],AdderArray:["Adder Array","Adder Arr."],ALU:["Arithmetic and Logic Unit","ALU"],Mux:["Multiplexer","Mux"],Mux2to1:["2-to-1 Multiplexer (1 Control Bit)","Mux 2-1"],Mux4to1:["4-to-1 Multiplexer (2 Control Bit)","Mux 4-1"],Mux8to1:["8-to-1 Multiplexer (3 Control Bit)","Mux 8-1"],Mux4to2:["4-to-2 Multiplexer (1 Control Bit)","Mux 4-2"],Mux8to2:["8-to-2 Multiplexer (2 Control Bit)","Mux 8-2"],Mux8to4:["8-to-4 Multiplexer (1 Control Bit)","Mux 8-4"],Mux16to8:["16-to-8 Multiplexer (1 Control Bit)","Mux 16-8"],Demux:["Demultiplexer","Demux"],Demux1to2:["1-to-2 Demultiplexer (1 Control Bit)","Demux 1-2"],Demux1to4:["1-to-4 Demultiplexer (2 Control Bit)","Demux 1-4"],Demux1to8:["1-to-8 Demultiplexer (3 Control Bit)","Demux 1-8"],Demux2to4:["2-to-4 Demultiplexer (1 Control Bit)","Demux 2-4"],Demux2to8:["2-to-8 Demultiplexer (2 Control Bit)","Demux 2-8"],Demux4to8:["4-to-8 Demultiplexer (1 Control Bit)","Demux 4-8"],Demux8to16:["8-to-16 Demultiplexer (1 Control Bit)","Demux 8-16"],LatchSR:["SR Latch","SR Latch"],FlipflopJK:["JK Flip-Flop","FF-JK"],FlipflopT:["T Flip-Flop","FF-T"],FlipflopD:["D Flip-Flop","FF-D"],Register:["Register","Register"],ShiftRegister:["Shift Register","Shift Reg."],RAM:["RAM Module","RAM"],ROM:["ROM Module","ROM"],Counter:["4-Bit Counter","Counter"],Decoder:["Binary to One-of-N Decoder","Decoder"],Decoder7Seg:["7-Segment Decoder","7-Seg. Dec."],Decoder16Seg:["ASCII-to-16-Segment Decoder","16-Seg. Dec."],DecoderBCD4:["4-Bit-to-BCD Decoder","BCD Dec."],Comparator:["Comparator","Compar."]})},Modes:{FULL:N("Admin","In addition to the full mode, this enables features like hiding wire colors, setting inputs and output to undetermined values, create faulty components, etc."),DESIGN:N("Full","All standard circuit-design features are enabled"),CONNECT:N("Connect","You can move and connect components already on the canvas, but not add more components (the left component bar is not shown)"),TRYOUT:N("Tryout","You can only change inputs to try out a already-designed circuit"),STATIC:N("Static","Components are displayed without any possible interaction")},Orientations:{e:"Right (default)",s:"Down",w:"Left",n:"Up"},Settings:{Settings:"Settings",CircuitName:"Name:",NameOfDownloadedFile:"This will be the name of the downloaded file.",hideWireColors:N("Hide wire colors","If checked, wires are shown with a neutral color instead of showing whether they carry a 1 or a 0."),hideInputColors:N("Hide input colors","If checked, inputs are shown with a neutral color, even if they still deliver a well determined value. Can be used together with hidden wire colors."),hideOutputColors:N("Hide output colors","If checked, outputs are shown with a neutral color. Can be used together with hidden wire colors."),hideMemoryContent:N("Hide stored values","If checked, latches, flip-flops, registers and other memory components don\u2019t show the content they store."),showGateTypes:N("Show gate types","If checked, gates types are displayed textually on top of the gate symbol."),showDisconnectedPins:N("Always show pins","If unchecked, disconnected component pins are hidden in modes where new connections can\u2019t be made (but stay visible otherwise)."),hideTooltips:N("Disable tooltips","If checked, additional information in component tooltips (such as truth tables) won\u2019t be shown."),groupParallelWires:N("Group parallel wires","If checked, parallel wires from one component to another will be grouped together as a thicker wire."),propagationDelay:"A 1 or 0 output on some wire will propagate to the other end of the wire after this propagation delay.",propagationDelayField:N("Propagation in","ms"),zoomLevel:"The zoom level on the circuit components.",zoomLevelField:N("Zoom:","%"),showUserDataLink:N("See ","linked data"),userDataHeader:"This data is exported with the circuit:",wireStyle:"Wire style:",WireStyleAuto:"Auto",WireStyleLine:"Line",WireStyleCurve:"Curve"},ControlBar:{TimelinePlay:N("Play","Starts logical time"),TimelinePause:N("Pause","Stops logical time"),TimelineStep:N(void 0,"Moves logical time to the next scheduled event"),Undo:N(void 0,"Undo the last action"),Redo:N(void 0,"Redo the last undone action or repeat the last action")},Messages:{NotImplemented:"This feature is not implemented yet.",ReallyCloseWindow:"Do you really want to close the window without saving the changes?",DevelopedBy:"Developed by"},Components:{Generic:{contextMenu:{Delete:"Delete",Reset:"Reset",MakeNewComponent:"Make New Component\u2026",MakeNewComponentFailed:"Cannot create new custom component.",SetIdentifier:"Set Identifier\u2026",ChangeIdentifier:N("Change Identifier (",")\u2026"),SetIdentifierPrompt:"Choose the unique identifier to use for this component:",IdentifierCannotBeEmpty:"The identifier cannot be empty.",IdentifierAlreadyInUseShouldSwap:"The identifier is already in use. Do you want to swap the component identifiers?",Orientation:"Orientation",ChangeOrientationDesc:"Change the orientation with Command + double click on the component",LockPosition:"Lock Position",ShowAsUnknown:"Show As Unknown",ForceOutputSingle:"Force Output",ForceOutputMultiple:"Force an Output",Output:"Output",NormalOutput:"Normal Output",ForceAsUnknown:"Force as Unkown",ForceAs1:"Force as 1",ForceAs0:"Force as 0",ForceAsZ:"Force as High Impedance",ForceOutputDesc:"Force an output with Option + click on an output node",SetName:"Set Name\u2026",ChangeName:"Change Name\u2026",SetNamePrompt:"Choose the name to display or leave empty to remove it:",SetFontPrompt:N("Enter a font specification or leave empty to use the default value (","):"),TriggerOn:"Trigger on",TriggerRisingEdge:"Rising Edge",TriggerFallingEdge:"Fallling Edge",ShowContent:"Show Content",ParamNumInputs:N("Number of Inputs",ne("${val} Inputs")),ParamNumBits:N("Number of Bits",ne("${val} Bits")),ParamNumWords:N("Number of Lines",ne("${val} Lines"))},InputCarryInDesc:"Cin (Previous Carry)",InputClockDesc:"Clock",InputClearDesc:"C (Clear, set to 0)",InputPresetDesc:"P (Preset, set to 1)",InputSetDesc:"S (Set, set to 1)",InputResetDesc:"R (Reset, set to 0)",InputDataDesc:"D (Data)",InputWriteEnableDesc:"WE (Write Enable)",OutputSumDesc:"S (Sum)",OutputCarryDesc:"C (Carry)",OutputCarryOutDesc:"Cout (Carry)",OutputQDesc:"Q (Normal Output)",OutputQBarDesc:"Q\u0305 (Inverted Output)"},Custom:{MenuButtonSuffix:" (custom component)",contextMenu:{ChangeName:"Rename\u2026",ChangeNamePrompt:"Enter the name of this custom component:",ChangeNameEmpty:"The name cannot be empty.",ChangeCircuit:"Change Circuit\u2026",Delete:"Delete Custom Component",CannotDeleteInUse:"Cannot delete this custom component because it is in use in the circuit.",CannotDeleteInUseBy:ne("Cannot delete this custom component because it is used to define another component (${caption})."),ConfirmDelete:"Are you sure you want to delete this custom component?"},messages:{EmptySelection:"No components are selected.",NoInput:"No input is selected.",NoOutput:"No output is selected.",InputsOutputsMustHaveNames:"All inputs and outputs must have unique (non-dynamic) names.",MissingComponents:ne("The following components are connected to outputs but are missing from selection: ${list}."),UselessComponents:ne("The following components are not connected to outputs and are useless: ${list}."),CannotIncludeClock:"Clocks cannot be included in custom components. Add a normal input, which can later be connected to an external clock.",EnterCaptionPrompt:"Entrez le nom (unique) du composant personnalis\xE9:",ComponentAlreadyExists:ne("A custom component definition with id '${id}' already exists.")}},Adder:{tooltip:{title:"Adder",desc:"Adds two bits A and B together with an input carry Cin, and outputs a sum bit S and an output carry Cout."}},AdderArray:{tooltip:{title:ne("${numBits}-Bit Adder Array"),desc:"Adds the two inputs numbers A et B together with an input carry Cin, and outputs sum bits S and an output carry Cout."}},ALU:{"A+B":N("+","Addition"),"A-B":N("A\u2013B","Subtraction (A \u2013 B)"),"B-A":N("B\u2013A","Subtraction (B \u2013 A)"),"A+1":N("A+1","A + 1"),"A-1":N("A\u20131","A \u2013 1"),"-A":N("\u2013A","Negation of A"),"A*2":N("A\xD72","Addition of A to itself (A \xD7 2)"),"A/2":N("A/2","Arithmetic right shift by 1 (A/2)"),"A|B":N("OR","Disjunction (A OR B)"),"A&B":N("AND","Conjunction (A AND B)"),"A|~B":N("ORn","A OR NOT(B)"),"A&~B":N("ANDn","A AND NOT(B)"),"~A":N("A\u0305","Inversion of A"),"A^B":N("XOR","Excl. Disjunction (A XOR B)"),"A<<":N("<<","Logical Left Shift by 1 of A"),"A>>":N(">>","Logical Right Shift by 1 of A"),InputCinDesc:"input carry",OutputCoutDesc:"output carry",tooltip:{title:"Arithmetic and Logic Unit (ALU)",CurrentlyCarriesOut:"Currently carries out",SomeUnknownOperation:"an unknown operation",ThisOperation:"operation"},contextMenu:{toggleShowOp:"Show Operation",ParamUseExtendedOpcode:"Use Extended Opcode"}},Clock:{tooltip:{title:"Clock",period:N("Period: "," ms"),dutycycle:N("Duty cycle: ","%"),phase:N("Phase: "," ms")},contextMenu:{Period:"Period",ReplaceWithInput:"Replace with Input"},timeline:{NextRisingEdge:"Next rising edge of the clock",NextFallingEdge:"Next falling edge of the clock"}},Comparator:{tooltip:{title:"Comparator",desc:"Comparator between two bits A and B, enabled by an input E."}},Counter:{tooltip:{title:"Counter",desc:"4-bit counter."},contextMenu:{DisplayTempl:ne("${desc} Display"),DisplayNone:"No",DisplayDecimal:"Decimal",DisplayHex:"Hexadecimal"}},Decoder:{tooltip:{title:"Binary Decoder",desc:ne("Takes as input a binary number coded on ${numFrom} bits and activates the corresponding output among ${numTo} (currently, ${n}).")}},Decoder7Seg:{tooltip:"7-Segment Decoder"},Decoder16Seg:{tooltip:"7-Bit ASCII to 16-Segment Decoder"},DecoderBCD4:{tooltip:"4-Bit to BCD (Binary-Coded Decimal) Decoder"},Demux:{tooltip:ne("${from}-to-${to} Demultiplexer")},FlipflopD:{tooltip:{title:"D Flip-Flop",desc:"Stores one bit."}},FlipflopJK:{InputJDesc:"J (Jump, set to 1)",InputKDesc:"K (Kill, set to 0)",tooltip:{title:"JK Flip-Flop",desc:"Stores one bit."}},FlipflopT:{InputTDesc:"T (Toggle)",tooltip:{title:"T Flip-Flop",desc:"Stores one bit."}},Gate:{not:N("NOT","NOT","The output is the inverted input."),buf:N("BUF","BUF","The output is the same as the input."),and:N("AND","AND","The output is 1 when all inputs are 1."),or:N("OR","OR","The output is 1 when at least one of the inputs is 1."),xor:N("XOR","XOR","The output is 1 when an odd number of inputs are 1."),nand:N("NAND","NAND","Inverted AND gate: the output is 1 unless all inputs are 1."),nor:N("NOR","NOR","Inverted OR gate: the output is 1 when all inputs are 0."),xnor:N("XNOR","XNOR","Inverted XOR gate: the output is 1 when an even number of inputs are 1."),imply:N("IMPLY","IMPL","The output is 1 if the first input is 0 or if both inputs are 1."),rimply:N("IMPLY (bis)","IMPL","The output is 1 if the second input is 0 or if both inputs are 1."),nimply:N("NIMPLY","N-IMPL","Inverted IMPLY gate: the output is only 1 if the first input is 1 and the second one 0."),rnimply:N("NIMPLY (bis)","N-IMPL","Inverted IMPLY gate: la sortie ne vaut 1 que lorsque la premi\xE8re entr\xE9e vaut 0 et la seconde 1."),txa:N("TRANSFER-A",void 0,"The output is the same as the first input; the second input is ignored."),txb:N("TRANSFER-B",void 0,"The output is the same as the second input; the first input is ignored."),txna:N("TRANSFER-NOT-A",void 0,"The output is the inverted first input; the second input is ignored."),txnb:N("TRANSFER-NOT-B",void 0,"The output is the inverted second input; the first input is ignored."),tooltip:{GateTitle:o=>q(o," Gate"),UnknownGate:"Unknown Gate",Input:"Input",Output:"Output",CurrentlyDelivers:"It currently delivers",ShouldCurrentlyDeliver:"it should currently deliver",UndeterminedOutputBecauseInputUnknown:"an unknown output as its input is unknown. Its truth table is:",UndeterminedOutputBecauseInputsUnknown:"an unknown output as not all inputs are known. Its truth table is:",ThisOutput:"the output",BecauseInputIs:"because its input is",AccordingToTruthTable:"according to the following truth table:",Inverter:N("Inverter ("," gate)"),Buffer:N("Buffer ("," gate)")},contextMenu:{ReplaceBy:"Replace By",GateTempl:ne("${type} Gate"),ShowAs:"Show As",NormalGateTempl:ne("Normal ${type} Gate"),UnknownGate:"Unknown Gate (with \u201C?\u201D)",VariantChangeDesc:"Switch to a variant with Shift + double-click on the gate"}},HalfAdder:{tooltip:{title:"Half Adder",desc:"Adds two bits A and B. Outputs a sum bit S and an output carry bit C."}},Input:{tooltip:{title:ne("Input (${numBits}-Bit)")},contextMenu:{LockValue:"Lock This Value",PushButton:"Push Button",ToggleButton:"Toggle Button",ReplaceWithClock:"Replace With Clock"}},Random:{tooltip:{title:"Random Input",desc:N("When triggered by the clock, the output value will be 1 with probability ",".")},contextMenu:{ShowProb:"Show Probability"}},Rectangle:{contextMenu:{Size:"Size",SizePrompt:"Enter the size of this rectangle:",Rounded:"Rounded",WithBackgroundColor:"With Background Color",SetTitle:"Add Title\u2026",ChangeTitle:"Change Title\u2026",SetTitlePrompt:"Enter the title to display or leave empty to remove it:",InsideFrame:"Inside Frame",Font:"Font",Color:"Color",ColorYellow:"Yellow",ColorRed:"Red",ColorGreen:"Green",ColorBlue:"Blue",ColorTurquoise:"Turquoise",ColorGrey:"Grey",Border:"Border",BorderNone:"None",Border1px:"Fine (1 pixel)",Border2px:"Medium (2 pixels)",Border3px:"Thick (3 pixels)",Border5px:"Very Thick (5 pixels)",Border10px:"Huge (10 pixels)",TitlePlacement:"Title Placement",PlacementTop:"Top",PlacementTopLeft:"Top Left",PlacementTopRight:"Top Right",PlacementBottom:"Bottom",PlacementBottomLeft:"Bottom Left",PlacementBottomRight:"Bottom Right",PlacementLeft:"Left",PlacementRight:"Right",PlacementCenter:"Center"}},Label:{contextMenu:{ChangeText:"Change Text\u2026",ChangeTextPrompt:"Type the text to display:",Font:"Font\u2026"}},LatchSR:{tooltip:{title:"SR Latch",desc:"Stores one bit."}},Mux:{tooltip:ne("${from}-to-${to} Multiplexer")},MuxDemux:{contextMenu:{ShowWiring:"Show Internal Wiring",UseZForDisconnected:"Use Z For Disconnected Pins",ParamNumFrom:N("Number of Inputs",ne("${val} Inputs")),ParamNumTo:N("Number of Outputs",ne("${val} Outputs"))}},Output:{tooltip:{title:ne("Output (${numBits}-Bit)")}},Display7Seg:{tooltip:"7-Segment Display"},Display16Seg:{tooltip:"16-Segment Display"},DisplayAscii:{tooltip:{title:"ASCII Character Display",desc:N("Displays the ASCII character represented by the 7 inputs, currently ","."),CurrentlyUndefined:"As not all inputs are known, this character is currently undefined.",CurrentlyThisCharacter:"Currently, this character is",WhichIsNotPrintable:" (a non-printable character)."},contextMenu:{AdditionalDisplay:"Additional Display",DisplayNone:"None",DisplayDecimal:"Decimal Value",DisplayHex:"Hexadecimal Value",ChangeDisplayDesc:"Change the additional display with a double-click on the component"}},DisplayBar:{tooltip:{title:"Bar/LED Display",ValueUnknown:"Its state is undefined because its input is unknown.",ValueZ:"Its state is undefined because its input is floating (high impedance).",Value1:N("It is currently on because its input is ","."),Value0:N("It is currently off because its input is ",".")},contextMenu:{TransparentWhenOff:"Transparent When Off",Display:"Display",DisplayVerticalBar:"Vertical Bar",DisplayHorizontalBar:"Horizontal Bar",DisplaySmallSquare:"Small Square",DisplayLargeSquare:"Large Square",DisplayChangeDesc:"Change display types with a double-click on the component",Color:"Color",ColorGreen:"Green",ColorRed:"Red",ColorYellow:"Yellow"}},Display:{tooltip:{title:ne("${numBits}-Bit Display"),desc:N(ne("Displays the ${radixStr} value of its ${numBits} inputs, which is currently "),"."),RadixBinary:"binary",RadixDecimal:"decimal",RadixSignedDecimal:"signed decimal",RadixHexadecimal:"hexadecimal",RadixGeneric:ne("base-${radix}"),CurrentlyUndefined:"As not all inputs are known, this value is currently undefined."},contextMenu:{DisplayAs:"Display as",DisplayNone:"None",DisplayAsBinary:"Binary (Base 2)",DisplayAsDecimal:"Decimal (Base 10)",DisplayAsSignedDecimal:"Signed Decimal",DisplayAsOctal:"Octal (Base 8)",DisplayAsHexadecimal:"Hexadecimal (Base 16)",DisplayAsUnknown:"Unkown"}},ShiftDisplay:{tooltip:"Shift Buffer Display",contextMenu:{Decoding:"Decoding",DecodingNone:"None",DecodingOctal:"Octal",DecodingHex:"Hexadecimal",DecodingAscii7:"ASCII (on 7 bits)",DecodingAscii8:"ASCII (on 8 bits)",DecodingUint4:"4-Bit Integer",DecodingInt4:"4-Bit Signed Integer",DecodingUint8:"8-Bit Integer",DecodingInt8:"8-Bit Signed Integer",DecodingUint16:"16-Bit Integer",DecodingInt16:"16-Bit Signed Integer",DecodingChangeWarning:"Changing the decoding may truncate the stored value.",Grouping:"Group Data",GroupingNone:"No Grouping",GroupBy:ne("By ${n}")},EmptyCaption:"(empty)"},Passthrough:{tooltip:"Passthrough. Only used to arrange wires.",contextMenu:{Slant:"Slant",SlantNone:"None",SlantRight:"Rightward By 45\xB0",SlantLeft:"Leftward By 45\xB0"}},GateArray:{tooltip:{title:"Gate Array",desc:ne("Computes in parallel several times the chosen logical operation, which currently is ${op}.")},contextMenu:{Type:"Type",ShowAsUnknown:"Hide Type"}},TristateBufferArray:{tooltip:{title:"Tristate Buffer Array",desc:"Represents multiple tristate buffers switched by a single control bit."}},RAM:{tooltip:{title:"RAM (Random-Access Memory)",desc:ne("Stores ${numWords} rows of ${numDataBits} bits.")},contextMenu:{SelectedDataDisplay:"Addressed Data Display",EditContent:"Edit Content\u2026",EditContentPrompt:"Type in the new memory content, separating lines with spaces. If there are as many characters as bits, the input is parsed as a binary string, and otherwise as a hexadecimal string.",SaveContent:"Save Content",LoadContent:"Load Content\u2026",SwapROMRAM:"Swap ROM/RAM"}},ROM:{tooltip:{title:"ROM (Read-Only Memory)",desc:ne("Stores ${numWords} rows of ${numDataBits} bits.")}},Register:{tooltip:{title:"Register",desc:ne("Stores ${numBits} bits.")},contextMenu:{ParamHasIncDec:"With Increment/Decrement",Saturating:"Saturating"}},ShiftRegister:{tooltip:{title:"Shift Register",desc:ne("Stores ${numBits} bits and shifts them left or right at each activation.")}},ControlledInverter:{tooltip:{title:"Switched Inverter",desc:"Inverts its inputs when the control bit S is on; otherwise, just outputs the inputs."}},TristateBuffer:{tooltip:"Tristate Buffer"},Wire:{contextMenu:{AddMiddlePoint:"Add Middle Point",AddPassthrough:"Add Passthrough",CustomPropagationDelay:ne("Specific Propagation Delay${current}\u2026"),CustomPropagationDelayDesc:ne("Specific propagation delay in milliseconds for this connection (leave empty to use the default value for the circuit, which currently is ${current} ms):"),WireColor:"Wire Color",WireColorBlack:"Black (default)",WireColorRed:"Red",WireColorGreen:"Green",WireColorBlue:"Blue",WireColorYellow:"Yellow",WireColorWhite:"White",WireStyle:"Style",WireStyleDefault:"By Default",WireStyleAuto:"Automatic",WireStyleStraight:"Straight Line",WireStyleCurved:"Curve"},timeline:{PropagatingValue:ne("Propagation of value ${val} on wire")}}},Palette:{Design:N("Design","Create or modify the circuit"),Delete:N("Delete","Delete elements from the circuit"),Move:N("Move","Move the whole circuit"),Download:N("Download","Download the circuit (or the custom components with Option/Alt key down)"),Screenshot:N("Screenshot","Download the circuit as an image (PNG or SVG with Option/Alt key down)"),Open:N("Open","Open a previously downloaded circuit"),Reset:N("Reset","Reset the state of this circuit")},Dialogs:{Generic:{Close:"Close"},Share:{title:"Share Circuit",URL:"URL:",EmbedInIframe:"Embed using <iframe>:",EmbedWithWebComp:"Embed with a web component:",EmbedInMarkdown:"Embed in Markdown/Myst:"}}},Zl={fr:c3,en:p3};function sd(o){return o in Zl}c(sd,"isLang");function ad(o){x=Zl[o],ld=o}c(ad,"setLang");function ud(){return ld}c(ud,"getLang");var Cs="en",x=Zl[Cs],ld=Cs;var tn=ce(Me());var _={sep(){return{_tag:"sep"}},text(o){return{_tag:"text",caption:o}},item(o,n,e,r,i){return{_tag:"item",icon:o,caption:n,action:e,shortcut:r,danger:i}},submenu(o,n,e){return{_tag:"submenu",icon:o,caption:n,items:e}}},Na=class{constructor(n,e,r,i,s){this.g=e;this.drawParams=r;this.isMouseOver=i;this.borderColor=s;this.entranceTransform=e.getTransform(),this.entranceTransformInv=this.entranceTransform.inverse(),n.applyDrawTransform(e),this.componentTransform=e.getTransform()}exit(){this.g.setTransform(this.entranceTransform)}inNonTransformedFrame(n){this.g.setTransform(this.entranceTransform),n(this),this.g.setTransform(this.componentTransform)}rotatePoint(n,e){return cd(this.entranceTransformInv,...cd(this.componentTransform,n,e))}};c(Na,"_DrawContextImpl");function cd(o,n,e){return[o.a*n+o.c*e+o.e,o.b*n+o.d*e+o.f]}c(cd,"mult");var Wn=class{constructor(n){this._ref=void 0;this.parent=n,this.setNeedsRedraw("newly created")}get ref(){return this._ref}doSetValidatedId(n){this._ref=n}setNeedsRedraw(n){var e;(e=this.parent.redrawMgr)==null||e.addReason(n,this)}get drawZIndex(){return 1}draw(n,e){var u,l;let r=(l=(u=e.currentSelection)==null?void 0:u.isSelected(this))!=null?l:!1,i=this===e.currentMouseOverComp||r,s=i?e.anythingMoving&&this.lockPos?ws:hi:K,a=new Na(this,n,e,i,s);try{this.doDraw(n,a)}finally{a.exit()}}applyDrawTransform(n){}get lockPos(){return!1}cursorWhenMouseover(n){}toString(){return`${this.constructor.name}(${this.toStringDetails()})`}toStringDetails(){return""}makeTooltip(){}makeContextMenu(){}makeSetIdContextMenuItem(){let n=this._ref,e=x.Components.Generic.contextMenu,r=n===void 0?e.SetIdentifier:Yt(e.ChangeIdentifier[0],Yt(ke("font-family: monospace; font-weight: bolder; font-size: 90%"),n),e.ChangeIdentifier[1]);return _.item("ref",r,()=>{this.runSetIdDialog()},"\u2325\u21A9\uFE0E")}runSetIdDialog(){let n=x.Components.Generic.contextMenu;for(;;){let e=this._ref,r=window.prompt(n.SetIdentifierPrompt,e);if(r===null||r===e)break;if(!(this instanceof he))this.doSetValidatedId(r.length===0?void 0:r);else{if(r.length===0){window.alert(n.IdentifierCannotBeEmpty);continue}let i=this.parent.components,s=i.get(r);if(s===void 0)i.changeIdOf(this,r);else if(window.confirm(n.IdentifierAlreadyInUseShouldSwap))i.swapIdsOf(s,this);else continue}this.setNeedsRedraw("ref changed");break}}mouseDown(n){return{wantsDragEvents:!0}}mouseDragged(n){}mouseUp(n){return Z.NoChange}mouseClicked(n){return Z.NoChange}mouseDoubleClicked(n){return Z.NoChange}keyDown(n){n.key==="Enter"&&n.altKey&&this.runSetIdDialog()}};c(Wn,"Drawable");var xs={e:{},s:{},w:{},n:{}},ec=xt.withProps()(xs),ue={default:"e",invert(o){switch(o){case"e":return"w";case"w":return"e";case"n":return"s";case"s":return"n"}},nextClockwise(o){switch(o){case"e":return"s";case"s":return"w";case"w":return"n";case"n":return"e"}},nextCounterClockwise(o){switch(o){case"e":return"n";case"n":return"w";case"w":return"s";case"s":return"e"}},isVertical(o){return o==="s"||o==="n"},add(o,n){switch(o){case"e":return n;case"w":return ue.invert(n);case"s":return ue.nextClockwise(n);case"n":return ue.nextCounterClockwise(n)}}},pd=tn.type({pos:tn.readonly(tn.tuple([tn.number,tn.number])),lockPos:P(tn.boolean),orient:P(tn.keyof(xs)),ref:P(tn.string)}),er=class extends Wn{constructor(e,r){var i,s;super(e);if(r!==void 0)this.doSetValidatedId(r.ref),this._posX=r.pos[0],this._posY=r.pos[1],this._lockPos=(i=r.lockPos)!=null?i:!1,this._orient=(s=r.orient)!=null?s:ue.default;else{let a=this.parent.editor;this._posX=Math.max(0,a.mouseX),this._posY=a.mouseY,this._lockPos=!1,this._orient=ue.default}}toJSONBase(){return{pos:[this.posX,this.posY],lockPos:this._lockPos?!0:void 0,orient:this.orient===ue.default?void 0:this.orient,ref:this.ref}}get posX(){return this._posX}get posY(){return this._posY}get lockPos(){return this._lockPos}isInRect(e){return this._posX>=e.left&&this._posX<=e.right&&this._posY>=e.top&&this._posY<=e.bottom}get orient(){return this._orient}canRotate(){return!0}canLockPos(){return!0}doSetLockPos(e){this._lockPos=e}doSetOrient(e){this._orient=e,this.setNeedsRedraw("orientation changed")}get width(){return ue.isVertical(this._orient)?this.unrotatedHeight:this.unrotatedWidth}get height(){return ue.isVertical(this._orient)?this.unrotatedWidth:this.unrotatedHeight}applyDrawTransform(e){let r=(()=>{switch(this._orient){case"e":return;case"s":return[0,1,-1,0];case"w":return[-1,0,0,-1];case"n":return[0,-1,1,0]}})();r!==void 0&&(e.translate(this.posX,this.posY),e.transform(...r,0,0),e.translate(-this.posX,-this.posY))}isOver(e,r){return this.parent.mode>=2&&Fa(this._posX,this._posY,this.width,this.height,e,r)}trySetPosition(e,r,i){let s=this.tryMakePosition(e,r,i);return s!==void 0&&this.doSetPosition(s[0],s[1]),s}tryMakePosition(e,r,i){let s=i?H/2:1;if(e=Math.round(e/s)*s,r=Math.round(r/s)*s,e!==this._posX||r!==this.posY)return[e,r]}doSetPosition(e,r){this._posX=e,this._posY=r,this.setNeedsRedraw("position changed")}makeOrientationAndPosMenuItems(){let e=x.Components.Generic.contextMenu,r={e:"\u2192",s:"\u2193",w:"\u2190",n:"\u2191"},i=this.canRotate()?[["start",_.submenu("direction",e.Orientation,[...ec.values.map(a=>{let u=this._orient===a,l=u?"check":"none",p=x.Orientations[a],d=u?()=>{}:()=>{this.doSetOrient(a)};return _.item(l,p,d,r[a])}),_.sep(),_.text(e.ChangeOrientationDesc)])]]:[],s=this.canLockPos()?[["start",_.item(this.lockPos?"check":"none",e.LockPosition,()=>{this.doSetLockPos(!this.lockPos)},"L")]]:[];return[...i,...s]}keyDown(e){if(this.canRotate()){if(e.key==="ArrowRight"){this.doSetOrient("e");return}else if(e.key==="ArrowDown"){this.doSetOrient("s");return}else if(e.key==="ArrowLeft"){this.doSetOrient("w");return}else if(e.key==="ArrowUp"){this.doSetOrient("n");return}}if(this.canLockPos()&&e.key==="l"){this.doSetLockPos(!this.lockPos);return}super.keyDown(e)}};c(er,"DrawableWithPosition");var No=class extends er{constructor(e,r){super(e,r);this._isMovingWithContext=void 0}get isMoving(){return this._isMovingWithContext!==void 0}tryStartMoving(e){if(!(this.lockPos||!this.parent.isMainEditor())&&this._isMovingWithContext===void 0){let[r,i]=this.parent.offsetXY(e);this._isMovingWithContext={mouseOffsetToPosX:r-this.posX,mouseOffsetToPosY:i-this.posY,lastAnchorX:this.posX,lastAnchorY:this.posY,createdClone:void 0}}}tryStopMoving(e){var i;let r=!1;return this._isMovingWithContext!==void 0&&(this._isMovingWithContext=void 0,r=!0),(i=this.parent.moveMgr)==null||i.setDrawableStoppedMoving(this,e),r}setPosition(e,r,i){let s=this.tryMakePosition(e,r,i);s!==void 0&&(this.doSetPosition(...s),this.positionChanged())}mouseDown(e){return this.parent.mode>=2&&this.tryStartMoving(e),{wantsDragEvents:!0}}mouseDragged(e){if(this.parent.mode>=2&&!this.lockPos&&this.parent.isMainEditor()){let[r,i]=this.parent.offsetXY(e),s=!e.metaKey;this.updateSelfPositionIfNeeded(r,i,s,e)!==void 0&&(this.positionChanged(),this.parent.moveMgr.setDrawableMoving(this,e))}}mouseUp(e){var i,s;(s=(i=this._isMovingWithContext)==null?void 0:i.createdClone)==null||s.mouseUp(e);let r=this.tryStopMoving(e);return Z.fromBoolean(r)}positionChanged(){}updateSelfPositionIfNeeded(e,r,i,s){if(this._isMovingWithContext===void 0)return;let{mouseOffsetToPosX:a,mouseOffsetToPosY:u,lastAnchorX:l,lastAnchorY:p,createdClone:d}=this._isMovingWithContext;if(d!==void 0){d.mouseDragged(s);return}let f=e-a,m=r-u;if(s.shiftKey){let v=Math.abs(l-f),D=Math.abs(p-m);v<=D?f=l:m=p}let h=this.tryMakePosition(f,m,i);if(h!==void 0){let v;s.altKey&&this.parent.mode>=3&&this.parent.isMainEditor()&&(v=this.makeClone(!0))!==void 0?(this._isMovingWithContext.createdClone=v,this.parent.cursorMovementMgr.setCurrentMouseOverComp(v)):this.doSetPosition(...h)}return h}makeClone(e){}};c(No,"DrawableWithDraggablePosition");var Gn={black:"black",red:"red",blue:"blue",yellow:"yellow",green:"green",white:"white"},tc=Gn.black,As=class extends er{constructor(e,r,i,s,a,u,l,p,d){super(e.parent);this.component=e;this.group=i;this.shortName=s;this.fullName=a;this._gridOffsetX=u;this._gridOffsetY=l;this.hasTriangle=p;this._isAlive=!0;this._value=!1;this._initialValue=void 0;this._color=tc;if(this.id=r.id,"force"in r&&(this._forceValue=Zn(r.force)),"color"in r&&r.color!==void 0&&(this._color=r.color),"initialValue"in r&&r.initialValue!==void 0){let f=Zn(r.initialValue);this._initialValue=f,this._value=f}this.parent.nodeMgr.addLiveNode(this.asNode),this.updatePositionFromParent(),this.doSetOrient(d)}get asNode(){return this}isOutput(){return nc.isOutput(this.asNode)}get unrotatedWidth(){return Tr}get unrotatedHeight(){return Tr}get color(){return this._color}doSetColor(e){this._color=e,this.propagateColor(e),this.setNeedsRedraw("color changed")}propagateColor(e){}isOver(e,r){return this.parent.mode>=2&&Ba(e,r,this.posX,this.posY)}destroy(){this.preDestroy(),this._isAlive=!1,this.parent.nodeMgr.removeLiveNode(this.asNode)}forceDraw(){return!1}doDraw(e,r){let i=this.parent.mode;if(i<2&&!this.forceDraw())return;let s=this._forceValue!==void 0&&i>=4,a=i>=4&&!U(this._value)&&!U(this.value)&&this._value!==this.value,u=ue.isVertical(this.component.orient),l=this.parent.options.hideWireColors;Ia(e,r,this.posX,this.posY,this.nodeDisplayStyle,this.value,r.isMouseOver,l,s,a,u)}get isAlive(){return this._isAlive}get value(){return this._forceValue!==void 0?this._forceValue:this._value}set value(e){let r=this.value;e!==this._value&&(this._value=e,this.propagateNewValueIfNecessary(r))}propagateNewValueIfNecessary(e){let r=this.value;r!==e&&this.propagateNewValue(r)}get gridOffsetX(){return this._gridOffsetX}set gridOffsetX(e){this._gridOffsetX=e,this.updatePositionFromParent()}get gridOffsetY(){return this._gridOffsetY}set gridOffsetY(e){this._gridOffsetY=e,this.updatePositionFromParent()}get posXInParentTransform(){return this.component.posX+this._gridOffsetX*H}get posYInParentTransform(){return this.component.posY+this._gridOffsetY*H}updatePositionFromParent(){var s;let e=this.component,[r,i]=(()=>{switch(e.orient){case"e":return[+this._gridOffsetX,+this._gridOffsetY];case"w":return[-this._gridOffsetX,-this._gridOffsetY];case"s":return[-this._gridOffsetY,+this._gridOffsetX];case"n":return[+this._gridOffsetY,-this._gridOffsetX]}})();return(s=super.trySetPosition(e.posX+r*H,e.posY+i*H,!1))!=null?s:[this.posX,this.posY]}get wireProlongDirection(){switch(this.component.orient){case"e":switch(this.orient){case"e":return"w";case"w":return"e";case"s":return"n";case"n":return"s"}break;case"w":return this.orient;case"s":switch(this.orient){case"e":return"n";case"w":return"s";case"s":return"e";case"n":return"w"}break;case"n":switch(this.orient){case"e":return"s";case"w":return"n";case"s":return"w";case"n":return"e"}}}cursorWhenMouseover(e){return"crosshair"}mouseDown(e){return this.parent.wireMgr.startDraggingFrom(this.asNode),{wantsDragEvents:!1}}mouseUp(e){let r=this.parent.wireMgr.stopDraggingOn(this.asNode);return r===void 0?Z.NoChange:rc(r.startNode,r.endNode,(i,s)=>this.parent.wireMgr.addWire(i,s,!0)!==void 0)}};c(As,"NodeBase");var Xr=class extends As{constructor(){super(...arguments);this._tag="_nodein";this._incomingWire=null;this.prefersSpike=!1;this.isClock=!1}get incomingWire(){return this._incomingWire}set incomingWire(e){this._incomingWire=e,e===null?this.value=!1:this.value=e.startNode.value}preDestroy(){this._incomingWire!==null&&this.parent.wireMgr.deleteWire(this._incomingWire)}get acceptsMoreConnections(){return this._incomingWire===null}get isDisconnected(){return this._incomingWire===null}get forceValue(){}get initialValue(){}propagateNewValue(e){this.component.setNeedsRecalc()}get nodeDisplayStyle(){return this._incomingWire===null?1:0}};c(Xr,"NodeIn");var Ar=class extends As{constructor(){super(...arguments);this._tag="_nodeout";this._outgoingWires=[]}get isClock(){return!1}addOutgoingWire(e){this._outgoingWires.indexOf(e)===-1&&this._outgoingWires.push(e)}removeOutgoingWire(e){let r=this._outgoingWires.indexOf(e);r!==-1&&this._outgoingWires.splice(r,1)}get outgoingWires(){return this._outgoingWires}preDestroy(){for(let e of[...this._outgoingWires])this.parent.wireMgr.deleteWire(e)}get acceptsMoreConnections(){return!0}get isDisconnected(){return this._outgoingWires.length===0}findWireTo(e){return this._outgoingWires.find(r=>r.endNode===e)}get forceValue(){return this._forceValue}set forceValue(e){let r=this.value;this._forceValue=e,this.propagateNewValueIfNecessary(r),this.setNeedsRedraw("changed forced output value")}get initialValue(){return this._initialValue}propagateColor(e){for(let r of this._outgoingWires)r.endNode.doSetColor(e)}propagateNewValue(e){let r=this.parent.timeline.logicalTime();for(let i of this._outgoingWires)i.propagateNewValue(e,r)}forceDraw(){return this._outgoingWires.length>1&&this.component.alwaysDrawMultiOutNodes}get nodeDisplayStyle(){return this._outgoingWires.length===0?3:2}mouseDoubleClicked(e){let r=super.mouseDoubleClicked(e);return r.isChange?r:this.parent.mode>=4&&e.altKey&&this.isOutput()&&this.component.allowsForcedOutputs?(this.forceValue=(()=>{switch(this._forceValue){case void 0:return I;case I:return Pe;case Pe:return!1;case!1:return!0;case!0:return}})(),Z.SimpleChange):Z.NoChange}};c(Ar,"NodeOut");var nc={isOutput(o){return o._tag==="_nodeout"}};function rc(o,n,e){let r=o.group,i=n.group;if(r===void 0||i===void 0)return Z.SimpleChange;let s=r.indexOf(o),a=s<r.nodes.length-1?1:-1,u=i.indexOf(n),l=u<i.nodes.length-1?1:-1,d=c(function f(m,h){return m>=r.nodes.length||m<0||h>=i.nodes.length||h<0?!1:()=>e(r.nodes[m],i.nodes[h])?f(m+a,h+l):!1},"makeRepeatFunction")(s+a,u+l);return d===!1?Z.SimpleChange:Z.RepeatableChange(d)}c(rc,"tryMakeRepeatableNodeAction");var dd=c(o=>De.union([De.number,De.string,o,De.array(De.union([De.number,De.string,o]))],"NodeSeqRepr"),"NodeSeqRepr"),f3=De.type({id:De.number},"InputNode"),m3=De.intersection([De.type({id:De.number}),De.partial({force:Gr,initialValue:Gr,color:De.keyof(Gn)})],"OutputNode"),fd=dd(f3),md=dd(m3),h3=De.partial({id:fd}),g3=De.partial({id:md}),D3=De.partial({in:fd,out:md}),v3=De.type({}),y3=c((o,n)=>o?n?D3:h3:n?g3:v3,"NodeIDsRepr"),ic=c((o,n)=>De.intersection([De.type({type:De.string}),pd,y3(o,n)],"Component"),"ComponentRepr");function sc(o){return pe(o)}c(sc,"isNodeArray");var ka=class{constructor(n,e){this.parent=n;this.name=e;this._orient="e";this._avgGridOffets=void 0;this.hasNameOverrides=!1;this._nodes=[],this._nodes.group=this}get nodes(){return this._nodes}addNode(n){this._avgGridOffets!==void 0&&console.warn("Adding nodes to a group after the group's position has been used"),this._nodes.push(n),this._orient=n.orient}get avgGridOffsets(){if(this._avgGridOffets===void 0){let n=0,e=0;for(let i of this._nodes)n+=i.gridOffsetX,e+=i.gridOffsetY;let r=this._nodes.length;this._avgGridOffets=[n/r,e/r]}return this._avgGridOffets}get orient(){return this._orient}get posXInParentTransform(){return this.parent.posX+this.avgGridOffsets[0]*H}get posYInParentTransform(){return this.parent.posY+this.avgGridOffsets[1]*H}indexOf(n){for(let e=0;e<this._nodes.length;e++)if(this._nodes[e]===n)return e;return-1}};c(ka,"NodeGroup");function b3(o){if(!Vn(o))return!1;for(let n in o)if(Object.prototype.hasOwnProperty.call(o,n)&&typeof o[n]!="string")return!1;return!0}c(b3,"isDynamicName");var Ot=P(De.union([De.string,De.record(De.union([De.string,De.number]),De.string)]));function Pa(o){return gn(o[0])}c(Pa,"isNodeDesc");var he=class extends No{constructor(e,r,i){super(e,i);this.def=r,this._width=r.size.gridWidth*H,this._height=r.size.gridHeight*H,this._value=r.initialValue(i);let s=r.nodeRecs.ins,a=r.nodeRecs.outs;function u(h){if(h===void 0)return 0;let v=0;for(let D of Object.values(h))if(Pa(D))v++;else for(let b of D)Pa(b)?v++:v+=b.length;return v}c(u,"countNodes");let l=u(s),p=u(a);i!==void 0?this._state=1:this.setSpawning();let[d,f,m]=this.nodeSpecsFromRepr(i,l,p);[this.inputs,this.inputGroups]=this.makeNodes(s,d,Xr),[this.outputs,this.outputGroups]=this.makeNodes(a,f,Ar),m?this.setNeedsPropagate():this.setNeedsRecalc(!0)}setSpawning(){var e;this._state=0,(e=this.parent.moveMgr)==null||e.setDrawableMoving(this)}setSpawned(){var e;this._state=1,(e=this.parent.moveMgr)==null||e.setDrawableStoppedMoving(this)}setInvalid(){this._state=3}toNodelessJSON(){let e=this.toJSON();return delete e.ref,delete e.in,delete e.out,delete e.id,e}toJSONBase(){let e={type:this.jsonType()};return k(k(k({},e),super.toJSONBase()),this.buildNodesRepr())}jsonType(){return this.def.type}makeNodes(e,r,i){let s={},a=[],u=new Map;if(e!==void 0){let l=c((d,f,m)=>{var O,L,W;let h=r[p++],[v,D,b,C,A]=m,M=A,w=(O=M==null?void 0:M.isClock)!=null?O:!1,T=(L=M==null?void 0:M.prefersSpike)!=null?L:!1,R=(W=M==null?void 0:M.hasTriangle)!=null?W:!1;d!==void 0&&C!==void 0?(f=C,d.hasNameOverrides=!0):(M==null?void 0:M.labelName)!==void 0&&(f=M.labelName);let S=C===void 0?f:C,F=new i(this,h,d,f,S,v,D,R,b);return(T||w)&&(F instanceof Xr?(F.prefersSpike=!0,F.isClock=w):console.warn(`prefersSpike is only supported for inputs, can't set it for ${name}`)),a.push(F),F},"makeNode"),p=0;for(let[d,f]of Object.entries(e))if(Pa(f))s[d]=l(void 0,d,f);else{let m=c(h=>{let v=new ka(this,d);u.set(d,v);for(let D=0;D<h.length;D++)v.addNode(l(v,`${d}${D}`,h[D]));return v.nodes},"makeNodesForGroup");if(Pa(f[0])){let h=f;s[d]=m(h)}else{let h=f;s[d]=h.map(m)}}}return s._all=a,[s,u]}nodeSpecsFromRepr(e,r,i){let s=this.parent.nodeMgr,a=c(()=>({id:s.newID()}),"makeDefaultSpec"),u=c(m=>wt(a,m),"makeDefaultSpecArray");if(e===void 0)return[u(r),u(i),!1];let l=[],p=[],d=c((m,h)=>{if(h===void 0)return u(m);let v=[];function D(b){v.push({id:b}),s.markIDUsed(b)}c(D,"pushId");for(let b of pe(h)?h:[h])if(gn(b))D(b);else if(Re(b)){let[C,A]=b.split("-").map(M=>parseInt(M));for(let M=C;M<=A;M++)D(M)}else v.push(b),s.markIDUsed(b.id);return v},"makeNormalizedSpecs");if(r!==0)if(i!==0){let m=e;l=d(r,m.in),p=d(i,m.out)}else l=d(r,e.id);else i!==0&&(p=d(i,e.id));let f=p.some(m=>m.initialValue!==void 0);return[l,p,f]}buildNodesRepr(){let e=this.inputs._all.length,r=this.outputs._all.length;function i(u){let l=c(p=>p.id,"reprOne");return u.length===1?l(u[0]):a(u.map(l))}c(i,"inNodeReprs");function s(u){let l=c(p=>{let d=p.forceValue===void 0,f=p.initialValue===void 0,m=p.color===tc;return d&&m&&f?p.id:{id:p.id,intialValue:f?void 0:tt(p.initialValue),force:d?void 0:tt(p.forceValue),color:m?void 0:p.color}},"reprOne");return u.length===1?l(u[0]):a(u.map(l))}c(s,"outNodeReprs");function a(u){let l=[],p,d;function f(){p!==void 0&&d!==void 0&&(p===d?l.push(p):d===p+1?(l.push(p),l.push(d)):l.push(`${p}-${d}`),p=void 0,d=void 0)}c(f,"pushRange");for(let m of u)gn(m)?p!==void 0&&m-1===d?d=m:(f(),p=d=m):(f(),l.push(m));return f(),l.length===1?l[0]:l}return c(a,"compactRepr"),e!==0?r!==0?{in:i(this.inputs._all),out:s(this.outputs._all)}:{id:i(this.inputs._all)}:r!==0?{id:s(this.outputs._all)}:{}}get unrotatedWidth(){return this._width}get unrotatedHeight(){return this._height}toStringDetails(){let e=this._name;return(e!==void 0?`name='${e}', `:"")+String(this.value)}get state(){return this._state}get allowsForcedOutputs(){return!0}get alwaysDrawMultiOutNodes(){return!1}*allNodes(){for(let e of this.inputs._all)yield e;for(let e of this.outputs._all)yield e}*allNodeGroups(){for(let e of this.inputGroups.values())yield e;for(let e of this.outputGroups.values())yield e}get value(){return this._value}doSetValue(e,r=!1){let i=this._value;(r||!fs(e,i))&&(this._value=e,this.setNeedsRedraw("value changed"),this.setNeedsPropagate())}recalcValue(e){this.doSetValue(this.doRecalcValue(),e)}propagateCurrentValue(){this.propagateValue(this._value)}propagateValue(e){}inputValues(e){return e.map(r=>r.value)}outputValues(e,r,i=!1){let s=e.length;if(r.length!==s)throw new Error(`outputValues: expected ${s} values, got ${r.length}`);for(let a=0;a<s;a++){let u=i?s-a-1:a;e[a].value=r[u]}}setNeedsRecalc(e=!1){this.parent.recalcMgr.enqueueForRecalc(this,e)}setNeedsPropagate(){this.parent.recalcMgr.enqueueForPropagate(this)}updateNodePositions(){for(let e of this.allNodes())e.updatePositionFromParent()}bounds(){return new Ts(this)}draw(e,r){if(super.draw(e,r),this._state===3){e.fillStyle="rgba(255, 0, 0, 0.3)";let i=this.bounds();e.fill(i.outline(e,5))}}doDraw(e,r){this.doDrawDefault(e,r)}doDrawDefault(e,r,i){var p,d,f;let s=this.bounds(),a=typeof i!="function"?i:{drawLabels:i};e.fillStyle=(p=a==null?void 0:a.background)!=null?p:Ke;let u=s.outline(e);e.fill(u);for(let m of this.allNodes())this.drawWireLineTo(e,m,s);let l=!((d=a==null?void 0:a.skipLabels)!=null&&d);if(l)for(let m of this.allNodeGroups())m.hasNameOverrides||this.drawGroupBox(e,m,s);(f=a==null?void 0:a.drawInside)==null||f.call(a,s),e.lineWidth=3,e.strokeStyle=r.borderColor,e.stroke(u),r.inNonTransformedFrame(m=>{var h,v,D;if(((h=a==null?void 0:a.componentName)==null?void 0:h[0])!==void 0){let[b,C,A]=a.componentName,M=gn(A)||Re(A)?A:A();$r(e,m,b,M,this,C)}if(l){let b=(v=a==null?void 0:a.labelSize)!=null?v:11;e.fillStyle=Tn,e.textAlign="center",e.font=`bold ${b}px sans-serif`;for(let C of this.allNodeGroups())C.hasNameOverrides||this.drawGroupLabel(m,C,s);e.font=`${b}px sans-serif`;for(let C of this.allNodes())(C.group===void 0||C.group.hasNameOverrides)&&this.drawNodeLabel(m,C,s)}(D=a==null?void 0:a.drawLabels)==null||D.call(a,m,s)})}drawWireLineTo(e,r,i){var a;if(r.isClock){gd(e,i.left,r,(a=this._trigger)!=null?a:$e.rising);return}let s=r.hasTriangle?3:0;Ae(e,r,...this.anchorFor(r,i,s),r.hasTriangle)}drawGroupBox(e,r,i){if(!Es(r.nodes))return;let s=ue.isVertical(ue.add(this.orient,r.orient))?8:6,a=r.nodes[0],u=r.nodes[r.nodes.length-1],l=2;switch(e.beginPath(),r.orient){case"e":e.rect(i.right-s,a.posYInParentTransform-l,s,u.posYInParentTransform-a.posYInParentTransform+2*l);break;case"w":e.rect(i.left,a.posYInParentTransform-l,s,u.posYInParentTransform-a.posYInParentTransform+2*l);break;case"n":e.rect(u.posXInParentTransform-l,i.top,a.posXInParentTransform-u.posXInParentTransform+2*l,s);break;case"s":e.rect(u.posXInParentTransform-l,i.bottom-s,a.posXInParentTransform-u.posXInParentTransform+2*l,s);break}e.fillStyle=Di,e.fill()}drawNodeLabel(e,r,i){!r.isClock&&!Yr(r.shortName)&&Rt(e,this.orient,r.shortName,r.orient,...this.anchorFor(r,i,1),r)}drawGroupLabel(e,r,i){Yr(r.name)||Rt(e,this.orient,r.name,r.orient,...this.anchorFor(r,i,1),r.nodes)}anchorFor(e,r,i){switch(e.orient){case"e":return[r.right+i,e.posYInParentTransform];case"w":return[r.left-i,e.posYInParentTransform];case"n":return[e.posXInParentTransform,r.top-i];case"s":return[e.posXInParentTransform,r.bottom+i]}}replaceWithComponent(e){var d,f;let r=c((m,h)=>{let v=new Map;for(let D of m){let b=D.group,C=h(D);if(b===void 0)v.set(D.shortName,C);else{let A=v.get(b.name);pe(A)||(A=new Array(b.nodes.length),v.set(b.name,A)),A[b.nodes.indexOf(D)]=C}}return v},"saveWires"),i=r(this.inputs._all,m=>m.incomingWire),s=r(this.outputs._all,m=>m.outgoingWires),a=c((m,h,v)=>{for(let D of h){let b=D.group;if(b===void 0){let C=m.get(D.shortName);v(C,D)}else{let C=m.get(b.name),A=C==null?void 0:C[b.nodes.indexOf(D)];v(A,D)}}},"restoreNodes");a(i,e.inputs._all,(m,h)=>{m!=null&&m.setEndNode(h)});let u=this.parent.timeline.logicalTime();a(s,e.outputs._all,(m,h)=>{if(!(m===void 0||m.length===0))for(let v of[...m])v.setStartNode(h,u)});let l=this.parent.components;return l.tryDelete(this)||console.warn("Could not delete old component"),this.ref!==void 0&&l.changeIdOf(e,this.ref),e.setPosition(this.posX,this.posY,!1),e.setSpawned(),(d=this.parent.undoMgr)==null||d.takeSnapshot(),(f=this.parent.redrawMgr)==null||f.addReason("component replaced",e),e}makeClone(e){let r=this.toNodelessJSON(),i=this.def.makeFromJSON(this.parent,r);return i===void 0?console.warn("Could not create component clone"):e&&i.setSpawning(),i}mouseDown(e){if(this.parent.mode>=2&&!e.shiftKey&&this.parent.isMainEditor()){let r=this.parent.cursorMovementMgr,i;r.currentSelection!==void 0&&(i=r.currentSelection.previouslySelectedElements).size>0&&!i.has(this)&&(r.currentSelection=void 0)}return super.mouseDown(e)}mouseUp(e){var s,a;let r=!1;this._state===0&&(this._state=1,r=!0);let i=super.mouseUp(e).isChange;if(r||i){let u=this.parent.nodeMgr.tryConnectNodesOf(this);return u.length>0&&this.autoConnected(u),(a=(s=this.parent).setDirty)==null||a.call(s,"moved component"),Z.SimpleChange}return Z.NoChange}autoConnected(e){}updateSelfPositionIfNeeded(e,r,i,s){return this._state===0?this.trySetPosition(e,r,i):super.updateSelfPositionIfNeeded(e,r,i,s)}positionChanged(){this.updateNodePositions()}mouseClicked(e){return this.parent.mode>=2&&e.shiftKey&&this.parent.isMainEditor()?(this.parent.cursorMovementMgr.toggleSelect(this),Z.SimpleChange):Z.NoChange}mouseDoubleClicked(e){if(this.parent.mode>=2&&e.metaKey&&this.canRotate()){let r=c(()=>(this.doSetOrient(ue.nextClockwise(this.orient)),!0),"doChange");return r(),Z.RepeatableChange(r)}return Z.NoChange}doSetOrient(e){super.doSetOrient(e),this.updateNodePositions()}destroy(){this._state=2;for(let e of this.allNodes())e.destroy()}cursorWhenMouseover(e){var i,s;let r=this.parent.mode;if((i=e==null?void 0:e.ctrlKey)!=null&&i&&r>=2)return"context-menu";if((s=e==null?void 0:e.altKey)!=null&&s&&r>=3)return"copy";if(!this.lockPos&&r>=2)return"grab"}makeContextMenu(){if(!this.parent.isMainEditor())return;let e=[],r=this.makeBaseContextMenu(this.parent),i=this.makeComponentSpecificContextMenuItems(),s=!0;function a(u,l,p=!1){p&&(s||e.push(_.sep()),s=!0);for(let[d,f]of l)d===u&&(e.push(f),s=f._tag==="sep")}return c(a,"addItemsAt"),a("start",i),a("start",r),a("mid",r,!0),a("mid",i),a("end",r,!0),a("end",i),e}makeBaseContextMenu(e){let r=x.Components.Generic.contextMenu,i=e.cursorMovementMgr.currentSelectionEmpty()?[]:[["start",_.item("newcomponent",r.MakeNewComponent,()=>{let l=e.factory.tryMakeNewCustomComponent(e);l!==void 0?l.length>0&&window.alert(r.MakeNewComponentFailed+" "+l):e.updateCustomComponentButtons()})],["start",_.sep()]],s=e.mode<4?[]:[["end",this.makeSetIdContextMenuItem()],["end",_.sep()]],a=this.state!==3?[]:[["end",_.item("reset",r.Reset,()=>{this._state=1,this.setNeedsRecalc(!0)})]],u=_.item("trash",r.Delete,()=>e.components.tryDelete(this)?(this.setNeedsRedraw("deleted component"),Z.SimpleChange):Z.NoChange,"\u232B",!0);return[...i,...this.makeOrientationAndPosMenuItems(),...s,...a,["end",u]]}makeComponentSpecificContextMenuItems(){return[]}makeForceOutputsContextMenuItem(e=!1){let r=this.outputs._all.length;if(r===0||this.parent.mode<4)return[];let i=x.Components.Generic.contextMenu;function s(l){let p=l.forceValue,d=[void 0,I,!0,!1,Pe].map(f=>_.item(p===f?"check":"none",(()=>{switch(f){case void 0:return i.NormalOutput;case I:return i.ForceAsUnknown;case!0:return i.ForceAs1;case!1:return i.ForceAs0;case Pe:return i.ForceAsZ}})(),()=>{l.forceValue=f}));return d.splice(1,0,_.sep()),d}c(s,"makeOutputItems");let a=[_.sep(),_.text(i.ForceOutputDesc)],u=[];return e&&u.push(["mid",_.sep()]),r===1?u.push(["mid",_.submenu("force",i.ForceOutputSingle,[...s(this.outputs._all[0]),...a])]):u.push(["mid",_.submenu("force",i.ForceOutputMultiple,[...this.outputs._all.map(l=>{let p=l.forceValue!==void 0?"force":"none";return _.submenu(p,i.Output+" "+l.fullName,s(l))}),...a])]),u}makeSetNameContextMenuItem(e,r){let i=x.Components.Generic.contextMenu,s=e===void 0?i.SetName:i.ChangeName;return _.item("pen",s,()=>this.runSetNameDialog(e,r),"\u21A9\uFE0E")}runSetNameDialog(e,r){let i=e===void 0||Re(e)?e:oc.default.stringify(e),s=window.prompt(x.Components.Generic.contextMenu.SetNamePrompt,i);if(s!==null){let a;if(s.length===0)a=void 0;else try{let u=oc.default.parse(s);b3(u)?a=u:a=s}catch(u){a=s}r(a)}}runSetFontDialog(e,r,i){let s=x.Components.Generic.contextMenu,a=window.prompt(s.SetFontPrompt[0]+r+s.SetFontPrompt[1],e===r?"":e);if(a!==null){let u=a.length===0?r:a;i(u)}}};c(he,"ComponentBase");var we=class extends he{constructor(e,[r,i],s){super(e,r,s);this._defP=i}makeChangeParamsContextMenuItem(e,[r,i],s,a,u){let l=c(p=>{let d=s===p,f=d?"check":"none",m=d?()=>{}:()=>{this.replaceWithNewParams({[a]:p})};return _.item(f,i.expand({val:p}),m)},"makeChangeValueItem");return u===void 0&&(u=this._defP.paramDefs[a].range),["mid",_.submenu(e,r,u.map(l))]}makeChangeBooleanParamsContextMenuItem(e,r,i){let s=r?"check":"none";return["mid",_.item(s,e,()=>{this.replaceWithNewParams({[i]:!r})})]}replaceWithNewParams(e){let r=this.toNodelessJSON(),i=k(k({},r),e),s=this._defP.makeFromJSON(this.parent,i);if(s===void 0){console.warn("Could not create component variant");return}return this.replaceWithComponent(s)}keyDown(e){e.key==="+"?this.tryChangeParam(0,!0):e.key==="-"?this.tryChangeParam(0,!1):e.key==="*"?this.tryChangeParam(1,!0):e.key==="/"?this.tryChangeParam(1,!1):super.keyDown(e)}tryChangeParam(e,r){let i=Object.keys(this._defP.defaultParams),s=i.length;if(e>=s)return;let a=i[e],u=this.toJSON()[a],l=this._defP.paramDefs[a];u===void 0&&(u=l.defaultValue);let p;if(gn(u)){if(p=l.nextValue(u,r),p===void 0||p===u)return}else _o(u)&&(p=!u);if(p===void 0)return;let d=this.replaceWithNewParams({[a]:p});d!==void 0&&this.parent.isMainEditor()&&this.parent.cursorMovementMgr.setCurrentMouseOverComp(d)}};c(we,"ParametrizedComponentBase");function nn(o,n){return L0(n,([e,r,i])=>[e,r,o,i])}c(nn,"group");function ie(o,n,e,r,i){let s=i!=null?i:Je(r)?1:2,a=(r-1)*s,u=e-a/2;return nn(o,wt(l=>[n,u+l*s],r))}c(ie,"groupVertical");function Ha(o,n,e,r,i){let s=Je(i===1?r:i)?1:2,a=i===1?s:s*2,u=(i-1)*s+a,l=r*(i-1)*s+(r-1)*a,p=e-l/2;return wt(d=>nn(o,wt(f=>[n,p+d*u+f*s],i)),r)}c(Ha,"groupVerticalMulti");function tr(o,n,e,r,i){let s=i!=null?i:Je(r)?1:2,a=(r-1)*s,u=n+a/2;return nn(o,wt(l=>[u-l*s,e],r))}c(tr,"groupHorizontal");function hd(o,n,e,r){return De.intersection([De.type(k({type:De.string},r)),ic(n,e)],o)}c(hd,"makeComponentRepr");var Va=class{constructor(n,e,r,i,s,a,u,l){this.type=n;this.idPrefix=e;this.aults=r;this.size=i;this._buttonProps=s;this._initialValue=a;this.impl=void 0;let p=u(i,r);this.nodeRecs=p;let d="ins"in p,f="outs"in p;this.repr=hd(n,d,f,l!=null?l:{})}isValid(){return this.impl!==void 0}initialValue(n){return this._initialValue(n,this.aults)}button(n,e){return k({type:this.type,visual:n,width:this._buttonProps.imgWidth},e)}make(n){let e=new this.impl(n);return n.components.add(e),e}makeFromJSON(n,e){var s;let r=br(e,this.repr,(s=this.impl.name)!=null?s:"component");if(r===void 0)return;let i=new this.impl(n,r);return n.components.add(i),i}};c(Va,"ComponentDef");function ve(o,{idPrefix:n,button:e,repr:r,valueDefaults:i,size:s,makeNodes:a,initialValue:u}){return new Va(o,n,i,s,e,u!=null?u:()=>{},a,r)}c(ve,"defineComponent");function ac(o){return Y(k({},o),{aults:o.valueDefaults})}c(ac,"defineAbstractComponent");var gi=class{constructor(n,e,r){this.defaultValue=n;this.range=e;this.isAllowed=r}validate(n,e){return this.isAllowed(n)?n:(console.warn(`Using default value ${this.defaultValue} for ${e} instead of invalid value ${n}; allowed values are: ${this.range.join(", ")}`),this.defaultValue)}nextValue(n,e){let r=this.range.indexOf(n);if(r===-1)return this.defaultValue;let i=r+(e?1:-1);if(!(i<0||i>=this.range.length))return this.range[i]}};c(gi,"ParamDef");function Ce(o,n){return n===void 0?new gi(o,[],()=>!0):new gi(o,n,e=>n.includes(e))}c(Ce,"param");function Wa(){return new gi(!1,[!1,!0],_o)}c(Wa,"paramBool");function C3(o){return Object.fromEntries(Object.entries(o).map(([n,e])=>[n,e.defaultValue]))}c(C3,"paramDefaults");var La=class{constructor(n,e,r,i,s,a,u,l,p,d,f,m,h){this.type=n;this.idPrefix=e;this.variantName=s;this._buttonProps=a;this.paramDefs=p;this.size=d;this._makeNodes=f;this._initialValue=m;this._validateParams=h;this.impl=void 0;this.defaultParams=C3(p),this.aults=k(k({},l),this.defaultParams),this.repr=hd(n,r,i,u!=null?u:{})}isValid(){return this.impl!==void 0}with(n){let e=this.size(n),r=this._makeNodes(k(k({},e),n),this.aults);return[{type:this.type,idPrefix:this.idPrefix,size:e,nodeRecs:r,initialValue:i=>this._initialValue(i,n),makeFromJSON:this.makeFromJSON.bind(this)},this]}button(n,e,r){return k({type:this.type,params:x3(this,n),visual:e,width:this._buttonProps.imgWidth},r)}make(n,e){let r=e===void 0?this.defaultParams:Ll(this.defaultParams,e),i=this.doValidate(r,void 0),s=new this.impl(n,i);return n.components.add(s),s}makeFromJSON(n,e){var u;let r=br(e,this.repr,(u=this.impl.name)!=null?u:"component");if(r===void 0)return;let i=Ll(this.defaultParams,r),s=this.doValidate(i,r.type),a=new this.impl(n,s,r);return n.components.add(a),a}doValidate(n,e){var i,s;let r=(s=(i=this.impl)==null?void 0:i.name)!=null?s:"component";return n=Object.fromEntries(Object.entries(this.paramDefs).map(([a,u])=>{var p;let l=(p=n[a])!=null?p:u.defaultValue;if(a==="type")return[a,l];{let d=u.validate(l,`${r}.${a}`);return[a,d]}})),this._validateParams(n,e,this.paramDefs)}};c(La,"ParametrizedComponentDef");function ye(o,n,e,{variantName:r,idPrefix:i,button:s,repr:a,valueDefaults:u,params:l,validateParams:p,size:d,makeNodes:f,initialValue:m}){return new La(o,i,n,e,r,s,a,u,l,d,f,m,p!=null?p:h=>h)}c(ye,"defineParametrizedComponent");function x3(o,n){return V0()({def:o,params:n})}c(x3,"defParams");var H=10,Kr=8,Tr=8,w3=Tr+5;function vd(o){return Math.round(o/H)}c(vd,"pxToGrid");function pc(o){return Math.max(.1,Math.min(10,o/100))}c(pc,"clampZoom");function Un(o,n,e,r){let i=e-o,s=r-n;return Math.sqrt(i*i+s*s)}c(Un,"dist");function Fa(o,n,e,r,i,s){let a=e/2,u=r/2;return i>=o-a&&i<o+a&&s>=n-u&&s<n+u}c(Fa,"inRect");var Ts=class{constructor(n){this.width=n.unrotatedWidth,this.height=n.unrotatedHeight,this.top=n.posY-this.height/2,this.left=n.posX-this.width/2,this.bottom=this.top+this.height,this.right=this.left+this.width}outline(n,e=0){let r=n.createPath();return r.rect(this.left-e,this.top-e,this.width+e*2,this.height+e*2),r}};c(Ts,"DrawingRect");var yd="rgba(0,0,0,0)",Ke,yi,Ga,Ua,za,qa,Xa,Bo,lc,uc,K,Tn,Di,Fo,hi,cc,ws,Ss,vi,bd,_s,Er,Ci,ct,Ms,Ya,Rs,bi,Qa,ja,$a,Ka=!1;xd(Ka);function xi(o){if(o!==Ka){xd(o);for(let n of nr.allConnectedEditors)n.wrapHandler(()=>{n.setDark(o),n.redrawMgr.addReason("dark/light mode switch",null)})()}}c(xi,"setColors");function Cd(){return Ka}c(Cd,"isDarkMode");function xd(o){o?(Ke=j(30),yi=j(60),Ua=j([168,20,20]),Ga=j(55),za=j(85),qa=j(30),Xa=j(45),Bo=j(185),lc=Ke,uc=220,Tn=j(139),Di=j([128,128,128,.13]),Fo=j(175),cc=j([0,123,255]),ws=j([194,34,14]),Ss=j([128,128,128,.5]),vi=[255,193,7],_s=j([180,0,0]),Er=[80,89,99],ct=j([108,106,98]),Ms=j([103,84,23]),Ya=j([95,95,95]),Rs={green:j([11,144,11]),red:j([144,11,11]),yellow:j([144,144,11])},bi={black:Fo,red:j([206,63,57]),blue:j([77,102,153]),yellow:j([245,209,63]),green:j([87,136,97]),white:j([230,217,199])},$a=Dd(Ke,"rgba(128,128,128,0.4)")):(Ke=j(255),yi=j(223),Ua=j([255,187,187]),Ga=j(238),za=j(200),qa=j(240),Xa=j(215),Bo=j(255),lc=j(0),uc=0,Tn=j(170),Di=j([128,128,128,.13]),Fo=j(80),cc=j([0,123,255]),ws=j([194,34,14]),Ss=j([128,128,128,.5]),vi=[255,193,7],_s=j([180,0,0]),Er=[52,58,64],ct=j([152,158,164]),Ms=j([137,114,35]),Ya=j([190,190,190]),Rs={green:j([20,232,20]),red:j([232,20,20]),yellow:j([232,232,20])},bi={black:Fo,red:j([206,63,57]),blue:j([77,102,153]),yellow:j([245,209,63]),green:j([87,136,97]),white:j([230,217,199])},$a=Dd(Ke,"rgba(128,128,128,0.2)")),Qa={yellow:j([230,230,0,.2]),blue:j([54,54,255,.2]),green:j([54,255,54,.2]),red:j([255,54,54,.2]),grey:j([120,120,120,.2]),turquoise:j([0,210,210,.2])},ja={yellow:j([196,196,0,.5]),blue:j([115,115,255,.5]),green:j([0,167,0,.5]),red:j([214,0,0,.5]),grey:j([35,35,35,.5]),turquoise:j([0,162,162,.5])},K=j(uc),dc(!1),bd=j(vi),Ci=j(Er),Ka=o}c(xd,"doSetColors");function Dd(o,n){let e=document.createElement("canvas"),r=4;e.width=2*r,e.height=6*r;let i=e.getContext("2d");i.fillStyle=o,i.fillRect(0,0,e.width,e.height),i.fillStyle=n,i.beginPath(),i.moveTo(r,0),i.lineTo(e.width,0),i.lineTo(0,e.height),i.lineTo(0,3*r),i.closePath(),i.moveTo(r,e.height),i.lineTo(e.width,e.height),i.lineTo(e.width,3*r),i.closePath(),i.fill();let s=i.createPattern(e,"repeat");return s===null&&console.warn("Failed to create pattern"),s}c(Dd,"createStripedPattern");function dc(o){hi=o?ws:cc}c(dc,"setColorMouseOverIsDanger");function j(o){return pe(o)?o.length===3?`rgb(${o[0]},${o[1]},${o[2]})`:`rgba(${o[0]},${o[1]},${o[2]},${o[3]})`:`rgb(${o},${o},${o})`}c(j,"ColorString");function wd(o){let n="rgb(";o.startsWith(n)&&(o=o.substring(n.length));let e=")";return o.endsWith(e)&&(o=o.substring(0,o.length-e.length)),o.split(",").map(r=>parseInt(r))}c(wd,"colorComps");function Nt(o){return U(o)?ct:me(o)?Ms:o?bd:Ci}c(Nt,"colorForBoolean");function Ad(o){let n=[(vi[0]-Er[0])*o+Er[0],(vi[1]-Er[1])*o+Er[1],(vi[2]-Er[2])*o+Er[2]];return j(n)}c(Ad,"colorForFraction");var Ja="18px sans-serif";function Je(o){return o>=5}c(Je,"useCompact");var A3=/^(In|Out|in|out)\d*$/;function Yr(o){return o===void 0||A3.test(o)}c(Yr,"isTrivialNodeName");function jr(o,n,e,r,i,s,a){o.moveTo(n,e),o.lineTo(r,i),o.lineTo(s,a),o.closePath()}c(jr,"triangle");function pn(o,n,e,r){let i=r/2;o.ellipse(n,e,i,i,0,0,2*Math.PI)}c(pn,"circle");function Os(o,n,e,r,i){o.beginPath(),o.moveTo(n,e),o.lineTo(r,i),o.stroke()}c(Os,"strokeSingleLine");function Es(o){if(pe(o))return o.map(Es).includes(!0);let n=o,e=n.parent;return!(e.mode<=1&&!e.options.showDisconnectedPins&&n.isDisconnected)}c(Es,"shouldShowNode");function Ae(o,n,e,r,i=!1){if(!Es(n))return;let s=n.parent.options.hideWireColors,a=n.posXInParentTransform,u=n.posYInParentTransform;if(fc(o,a,u,e,r,n.value,n.color,s),i){if(o.strokeStyle=K,o.fillStyle=K,o.beginPath(),a===e)if(n.isOutput()&&r<=u||!n.isOutput()&&u<=r){let p=n.isOutput()?1:0;jr(o,e-3,r-2+p,e+3,r-2+p,e,r+1+p)}else{let p=n.isOutput()?-3:-4;jr(o,e-3,r-2-p,e+3,r-2-p,e,r-5-p)}else if(u===r){let l=n.isOutput()?1:0;n.isOutput()&&e<=a||!n.isOutput()&&a<=e?jr(o,e-2+l,r-3,e-2+l,r+3,e+1+l,r):jr(o,e+2-l,r-3,e+2-l,r+3,e-1-l,r)}else console.log(`ERROR  wireLineToComponent cannot draw triangle as line is not vertical or horizontal between (${a}, ${u}) and (${e}, ${r})`);o.fill(),o.stroke()}}c(Ae,"drawWireLineToComponent");function fc(o,n,e,r,i,s,a,u){o.beginPath(),o.moveTo(n,e),o.lineTo(r,i),Jr(o,s,a,!1,u)}c(fc,"drawStraightWireLine");function Jr(o,n,e,r,i,s){let a=o.lineCap;o.lineCap="butt";let u=Kr/2;r?(o.lineWidth=u+2,o.strokeStyle=hi):(o.lineWidth=u,o.strokeStyle=bi[e]),s?o.stroke(s):o.stroke(),o.strokeStyle=i?ct:Nt(n),o.lineWidth=u-2,s?o.stroke(s):o.stroke(),o.lineCap=a}c(Jr,"strokeAsWireLine");function Ba(o,n,e,r){return Un(o,n,e,r)<w3/2}c(Ba,"isOverWaypoint");function Ia(o,n,e,r,i,s,a,u,l,p,d){let[f,m]=l?[_s,3]:[Fo,1];o.strokeStyle=f,o.lineWidth=m,o.fillStyle=i===1?Ke:u?ct:Nt(s),o.beginPath(),pn(o,e,r,Tr),o.fill(),o.stroke(),a&&(o.fillStyle=Ss,o.beginPath(),pn(o,e,r,Tr*2),o.fill(),o.stroke()),p&&(o.textAlign="center",o.fillStyle=f,o.font="bold 14px sans-serif",n.inNonTransformedFrame(h=>{o.fillText("!!",...h.rotatePoint(e+(d?13:0),r+(d?0:-13)))}))}c(Ia,"drawWaypoint");function gd(o,n,e,r){let i=e.posYInParentTransform,s=1;o.strokeStyle=K,o.lineWidth=2,o.beginPath(),o.moveTo(n+1,i-4),o.lineTo(n+9,i),o.lineTo(n+1,i+4),o.stroke(),r===$e.falling&&(o.fillStyle=K,o.closePath(),o.fill()),Ae(o,e,n-s,i,!1)}c(gd,"drawClockInput");function Rt(o,n,e,r,i,s,a){if(e===void 0)return;let u=!1;if(a===void 0&&(gn(i)?gn(s)||(a=s):a=i),a!==void 0&&(u=!Es(a)),u)return;let[l,p,d,f]=(()=>{if(r===void 0)return["center","middle",0,0];switch(ue.add(n,r)){case"e":return["right","middle",-3,0];case"w":return["left","middle",3,0];case"n":return["center","top",0,2];case"s":return["center","bottom",0,-2]}})(),m=gn(i)?i:(sc(i)?i.group:i).posXInParentTransform,h=gn(s)?s:(sc(s)?s.group:s).posYInParentTransform,[v,D]=o.rotatePoint(m,h),b=o.g;b.textAlign=l,b.textBaseline=p,b.fillText(e,v+d,D+f)}c(Rt,"drawLabel");function Za(o,n,e,r){Io(o,n,e.posX,e.posY,r)}c(Za,"drawValueTextCentered");function Io(o,n,e,r,i){var f;o.textAlign="center",o.textBaseline="middle";let s="",a="",u=(f=i==null?void 0:i.small)!=null?f:!1,l=i==null?void 0:i.fillStyle,p=u?"12":"18",d=u?"10":"16";U(n)?(o.fillStyle=l!=null?l:Bo,s="bold "+p,a="?"):me(n)?(o.fillStyle=l!=null?l:Bo,s=d,a="Z"):n?(o.fillStyle=l!=null?l:lc,s="bold "+p,a="1"):(o.fillStyle=l!=null?l:Bo,s=p,a="0"),o.font=`${s}px sans-serif`,o.fillText(a,e,r)}c(Io,"drawValueText");var dn=26,Qr={right:["start","middle",7],left:["end","middle",9],top:["center","bottom",5],bottom:["center","top",5]};function T3(o,n){if(o)switch(n){case"e":return Qr.right;case"w":return Qr.left;case"n":return Qr.top;case"s":return Qr.bottom}else switch(n){case"e":return Qr.left;case"w":return Qr.right;case"n":return Qr.bottom;case"s":return Qr.top}}c(T3,"textSettingsForName");function $r(o,n,e,r,i,s){if(e===void 0)return;let a;if(Re(e)?a=e:r in e?a=`${e[r]}`:"default"in e?a=`${e.default}`:U(r)?a=I:a=void 0,a===void 0)return;let[u,l,p]=T3(s,i.orient);o.textAlign=u,o.textBaseline=l,o.font="italic 18px sans-serif",o.fillStyle=K;let d=n.rotatePoint(i.posX+(s?1:-1)*(i.unrotatedWidth/2+p),i.posY);o.fillText(a,...d),o.textBaseline="middle"}c($r,"drawComponentName");function Oe(o,n){let e="",r=!1,i=n?a=>e=e+a:a=>e=a+e;for(let a of o)U(a)||me(a)?(r=!0,i(a)):i(+a);let s=r?I:parseInt(e,2);return[e,s]}c(Oe,"displayValuesFromArray");function Zr(o,n,e,r=!0){if(U(o))return I;if(n===-10){let i=(o>>>0).toString(2).padStart(e,"0");if(i[0]==="1"){let s=parseInt(i.substring(1),2);return"\u2013"+String(-(-Math.pow(2,e-1)+s))}else return String(o)}else{let i=n===10?1:Math.ceil(Math.log(Math.pow(2,e))/Math.log(n)),s=o.toString(n).toUpperCase().padStart(i,"0");return(r?(()=>{switch(n){case 16:return"0x";case 8:return"0o";case 2:return"0b";default:return""}})():"")+s}}c(Zr,"formatWithRadix");var tu=ce(Me());var eo={none:"none",up:"up",down:"down"},En=ye("pass",!0,!0,{variantName:({bits:o})=>`pass-${o}`,idPrefix:"pass",button:{imgWidth:32},repr:{bits:P(tu.number),slant:P(tu.keyof(eo))},valueDefaults:{slant:eo.none},params:{bits:Ce(1,[1,2,3,4,8,16])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>({gridWidth:2,gridHeight:Je(o)?o:2*o}),makeNodes:({numBits:o})=>({ins:{In:ie("w",-1,0,o)},outs:{Out:ie("e",1,0,o)}}),initialValue:(o,{numBits:n})=>$(!1,n)}),eu=class extends we{constructor(e,r,i){var s;super(e,En.with(r),i);this.numBits=r.numBits,this._hShift=[0,0],this._slant=(s=i==null?void 0:i.slant)!=null?s:En.aults.slant,this.updateNodeOffsets()}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===En.aults.bits?void 0:this.numBits,slant:this._slant===En.aults.slant?void 0:this._slant})}destroy(){var r;let e=[];for(let i=0;i<this.numBits;i++){let s=(r=this.inputs.In[i].incomingWire)==null?void 0:r.startNode;if(s===void 0||!(s instanceof Ar))continue;let a=[];for(let u of this.outputs.Out[i].outgoingWires){let l=u.endNode;l!==null&&a.push([l,u.style])}a.length>0&&e.push([s,a])}if(super.destroy(),e.length>0){let i=this.parent.wireMgr;for(let[s,a]of e)for(let[u,l]of a){let p=i.addWire(s,u,!1);if(p===void 0){console.error("Failed to add wire back");continue}l!==void 0&&p.doSetStyle(l)}}}get alwaysDrawMultiOutNodes(){return!0}doRecalcValue(){return this.inputValues(this.inputs.In)}propagateValue(e){this.outputValues(this.outputs.Out,e)}isOver(e,r){if(this._slant===eo.none)return super.isOver(e,r);let i=0,s=0;switch(this._slant){case eo.up:i=this.inputs.In[0].posY,s=-1;break;case eo.down:i=this.inputs.In[this.numBits-1].posY,s=1;break}let a=(r-i)*s;return super.isOver(e+a,r)}makeTooltip(){return Q(void 0,q(z(x.Components.Passthrough.tooltip)))}doDraw(e,r){let s=this.unrotatedHeight,a=this.posY-s/2,u=a+s,l=this.posX-3/2,p=l+3,d=4,[f,m]=this._hShift;e.beginPath(),e.moveTo(this.posX+f,a),e.lineTo(this.posX+m,u),r.isMouseOver?(e.lineWidth=3+d*2,e.strokeStyle=Ss,e.stroke(),e.strokeStyle=K):e.strokeStyle=ct,this.parent.mode>=2&&(e.lineWidth=3,e.stroke());for(let h of this.inputs._all)Ae(e,h,l+2+(h.gridOffsetX+1)*H,h.posYInParentTransform);for(let h of this.outputs._all)Ae(e,h,p-2+(h.gridOffsetX-1)*H,h.posYInParentTransform)}makeComponentSpecificContextMenuItems(){if(this.numBits===1)return[];let e=x.Components.Passthrough.contextMenu,r=c((i,s)=>{let a=this._slant===s,u=a?"check":"none",l=a?()=>{}:()=>this.doSetSlant(s);return _.item(u,i,l)},"makeItemSetSlant");return[["mid",_.submenu("slanted",e.Slant,[r(e.SlantNone,eo.none),_.sep(),r(e.SlantRight,eo.down),r(e.SlantLeft,eo.up)])],["mid",_.sep()],this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits")]}doSetSlant(e){this._slant=e,this.updateNodeOffsets(),this.setNeedsRedraw("slant changed")}updateNodeOffsets(){let e=this.numBits;switch(this._slant){case"none":for(let r=0;r<e;r++)this.inputs.In[r].gridOffsetX=-1,this.outputs.Out[r].gridOffsetX=1;this._hShift=[0,0];break;case"down":{let r=e>4?1:2;for(let i=0;i<e;i++){let s=r*(e-1-i);this.inputs.In[i].gridOffsetX=-1+s,this.outputs.Out[i].gridOffsetX=1+s}this._hShift=[r*(e-.5)*H,-r*H/2];break}case"up":{let r=e>4?1:2;for(let i=0;i<e;i++){let s=r*i;this.inputs.In[i].gridOffsetX=-1+s,this.outputs.Out[i].gridOffsetX=1+s}this._hShift=[-r*H/2,r*(e-.5)*H];break}}}};c(eu,"Passthrough");En.impl=eu;var Sn=class extends No{constructor(e,r){super(e.parent,Sn.toSuperRepr(r));this.wire=e}static get Repr(){return Ne.union([Ne.tuple([Ne.number,Ne.number,Ne.keyof(xs),Ne.partial({lockPos:Ne.boolean})]),Ne.tuple([Ne.number,Ne.number,Ne.keyof(xs)]),Ne.tuple([Ne.number,Ne.number])],"Wire")}static toSuperRepr(e){var r;if(e!==void 0)return{pos:[e[0],e[1]],lockPos:(r=e[3])==null?void 0:r.lockPos,orient:e[2],ref:void 0}}toJSON(){return this.lockPos?[this.posX,this.posY,this.orient,{lockPos:!0}]:this.orient!==ue.default?[this.posX,this.posY,this.orient]:[this.posX,this.posY]}get unrotatedWidth(){return Tr}get unrotatedHeight(){return Tr}isOver(e,r){return this.parent.mode>=2&&Ba(e,r,this.posX,this.posY)}cursorWhenMouseover(e){var i;let r=this.parent.mode;if((i=e==null?void 0:e.ctrlKey)!=null&&i&&r>=2)return"context-menu";if(!this.lockPos&&r>=2)return"grab"}getPrevAndNextAnchors(){var a;let e=this.wire.waypoints,r=e.indexOf(this),i=r>0?e[r-1]:this.wire.startNode,s=r<e.length-1?e[r+1]:(a=this.wire.endNode)!=null?a:this.wire.startNode;return[i,s]}removeFromParent(){this.wire.removeWaypoint(this)}doDraw(e,r){if(this.parent.mode<2)return;let i=this.parent.options.hideWireColors;Ia(e,r,this.posX,this.posY,5,this.wire.startNode.value,r.isMouseOver,i,!1,!1,!1)}makeContextMenu(){return[...this.makeOrientationAndPosMenuItems().map(e=>e[1]),_.sep(),_.item("trash",x.Components.Generic.contextMenu.Delete,()=>{this.removeFromParent()},"\u232B",!0)]}};c(Sn,"Waypoint");var $t={auto:"auto",straight:"straight",bezier:"bezier"},rr=class extends Wn{constructor(e,r){let i=e.parent;super(i);this._waypoints=[];this._style=void 0;this._propagatingValues=[];this._waypointBeingDragged=void 0;this.customPropagationDelay=void 0;this.ribbon=void 0;this._startNode=e,this._endNode=r;let s=-1-i.options.propagationDelay;this._propagatingValues.push([e.value,s]),this.setStartNode(e),this.setEndNode(r)}static get Repr(){let e=Ne.tuple([Ne.number,Ne.number]),r=Ne.tuple([Ne.number,Ne.number,Ne.type({ref:P(Ne.string),via:P(Ne.array(Sn.Repr)),propagationDelay:P(Ne.number),style:P(Ne.keyof($t))})]);return Ne.union([r,e],"Wire")}toJSON(){let e=this._endNode.id;if(this._waypoints.length===0&&this.customPropagationDelay===void 0&&this.ref===void 0&&this.style===void 0)return[this._startNode.id,e];{let r=this._waypoints.map(i=>i.toJSON());return[this._startNode.id,e,{ref:this.ref,via:r.length===0?void 0:r,propagationDelay:this.customPropagationDelay,style:this.style}]}}get startNode(){return this._startNode}get endNode(){return this._endNode}isInRect(e){return!1}get waypoints(){return this._waypoints}setWaypoints(e){this._waypoints=e.map(r=>new Sn(this,r))}get style(){return this._style}doSetStyle(e){this._style=e,this.setNeedsRedraw("style changed")}setStartNode(e,r){this._startNode!==void 0&&this._startNode.removeOutgoingWire(this),this._startNode=e,e.addOutgoingWire(this),r!==void 0&&this.propagateNewValue(this._startNode.value,r)}setEndNode(e){this._endNode!==void 0&&(this._endNode.incomingWire=null),this._endNode=e,e.incomingWire!==null&&e.incomingWire!==void 0&&console.warn(`Unexpectedly replacing existing incoming wire on node ${this._endNode.id}`),e.incomingWire=this,e.value=this._startNode.value,e.doSetColor(this._startNode.color)}propagateNewValue(e,r){var s;this._propagatingValues[this._propagatingValues.length-1][0]!==e&&this._propagatingValues.push([e,r]);let i=(s=this.customPropagationDelay)!=null?s:this.parent.options.propagationDelay;if(i===0)this.endNode.value=e;else{let a=x.Components.Wire.timeline.PropagatingValue.expand({val:tt(e)});this.parent.timeline.scheduleAt(r+i,()=>{this.endNode.value=e},a,!1)}}destroy(){nc.isOutput(this._startNode)&&this._startNode.removeOutgoingWire(this),this._endNode!==null&&(this._endNode.incomingWire=null)}get isAlive(){return this.startNode.isAlive&&this.endNode.isAlive}addPassthroughFrom(e){let r=this.parent,[i,s]=r.editor.offsetXYForContextMenu(e,!0),a=this.endNode,u=En.make(r,{bits:1});u.setSpawned(),u.setPosition(i,s,!1),this.setEndNode(u.inputs.In[0]);let l=r.wireMgr.addWire(u.outputs.Out[0],a,!1);if(l===void 0){console.warn("Couldn't create new wire");return}return l.doSetStyle(this.style),u}addWaypointFrom(e){let[r,i]=this.parent.editor.offsetXYForContextMenu(e,!0);return this.addWaypointWith(r,i)}addWaypointWith(e,r){let i=this.indexOfNextWaypointIfMouseover(e,r);i===void 0&&(i=[0,[this.startNode.posX,this.startNode.posY],[this.endNode.posX,this.endNode.posY]]);let[s,[a,u],[l,p]]=i,d=l-a,f=p-u,m;Math.abs(d)>=Math.abs(f)?l>=a?m="e":m="w":p>=u?m="s":m="n";let h=new Sn(this,[e,r,m]);return this._waypoints.splice(s,0,h),h}removeWaypoint(e){let r=this._waypoints.indexOf(e);r!==-1&&(this._waypoints.splice(r,1),this.setNeedsRedraw("waypoint deleted"))}prunePropagatingValues(e,r){let i=0;for(let s=1;s<this._propagatingValues.length&&e>=this._propagatingValues[s][1]+r;s++)i=s;return i>0&&this._propagatingValues.splice(0,i),this._propagatingValues[0][0]}doDraw(e,r){var w,T,R,S;let i=this._propagatingValues.length>1,s=this.parent.options,a=(w=this.customPropagationDelay)!=null?w:s.propagationDelay,u=s.hideWireColors,l=r.drawParams.drawTime;this.prunePropagatingValues(l,a);let p=this.startNode.posX,d=this.startNode.posY,f=this.startNode.wireProlongDirection,m={posX:this.endNode.posX,posY:this.endNode.posY,orient:this.endNode.wireProlongDirection},h=[...this._waypoints,m],v="M"+p+" "+d+" ",D=(T=this.style)!=null?T:this.startNode.parent.options.wireStyle;for(let F=0;F<h.length;F++){let O=h[F],L=O.posX,W=O.posY,se=L-p,ae=W-d,oe=O.orient,Fe,He,it,ht;if(D===$t.straight||D===$t.auto&&(p===L||d===W))F===0&&([Fe,He]=to(f,p,d,-Kr/2,-Kr/2),v+="M"+Fe+" "+He+" ",v+="L"+p+" "+d+" "),v+="L"+L+" "+W+" ",F===h.length-1&&([Fe,He]=to(oe,L,W,-Kr/2,-Kr/2),v+="L"+Fe+" "+He+" ");else{let st=Math.max(25,Math.abs(se)/3),bt=Math.max(25,Math.abs(ae)/3);[Fe,He]=to(f,p,d,st,bt),[it,ht]=to(oe,L,W,st,bt),v+="C"+Fe+" "+He+","+it+" "+ht+","+L+" "+W+" "}p=L,d=W,f=ue.invert(oe)}let b=this.parent.editor.lengthOfPath(v),C=e.createPath(v),A=r.drawParams;A.highlightColor!==void 0&&((S=(R=A.highlightedItems)==null?void 0:R.wires.includes(this))!=null&&S)&&(e.lineWidth=15,e.shadowColor=A.highlightColor,e.shadowBlur=20,e.shadowOffsetX=0,e.shadowOffsetY=0,e.strokeStyle=e.shadowColor,e.stroke(C),e.shadowBlur=0);let M=e.getLineDash();for(let[F,O]of this._propagatingValues){let L=Math.min(1,(l-O)/a),W=b*L;e.setLineDash([W,b]),Jr(e,F,this._startNode.color,r.isMouseOver,u,C)}e.setLineDash(M),i&&!this.parent.timeline.isPaused&&this.setNeedsRedraw("propagating value")}isOver(e,r){return this.parent.mode<2||!this.startNode.isAlive||!this.endNode.isAlive?!1:this.indexOfNextWaypointIfMouseover(e,r)!==void 0}indexOfNextWaypointIfMouseover(e,r){let i=[this.startNode,...this._waypoints,this.endNode],s=Kr/(10*2);for(let a=0;a<i.length-1;a++){let u=i[a].posX,l=i[a].posY,p=i[a+1].posX,d=i[a+1].posY,f=Un(u,l,e,r)+Un(p,d,e,r),m=Un(u,l,p,d);if(f>=m-s&&f<=m+s)return[a,[u,l],[p,d]]}}mouseDown(e){if(e.altKey&&this.parent.mode>=3){let r=this.addPassthroughFrom(e);if(r!==void 0)return r.outputs.Out[0].mouseDown(e)}return super.mouseDown(e)}mouseDragged(e){if(this._waypointBeingDragged!==void 0)this._waypointBeingDragged.mouseDragged(e);else if(this.parent.isMainEditor()&&this.parent.cursorMovementMgr.currentSelectionEmpty()){let r=this.addWaypointFrom(e);this._waypointBeingDragged=r,r.mouseDown(e),r.mouseDragged(e)}}mouseUp(e){return this._waypointBeingDragged!==void 0?(this._waypointBeingDragged.mouseUp(e),this._waypointBeingDragged=void 0,Z.SimpleChange):Z.NoChange}makeContextMenu(){let e=x.Components.Wire.contextMenu,r=this.customPropagationDelay===void 0?"":` (${this.customPropagationDelay} ms)`,i=c((l,p)=>{let d=this._startNode.color===p,f=d?"check":"none",m=d?()=>{}:()=>this._startNode.doSetColor(p),h=bi[p];return _.item(f,Yt(vn(l),ke(`display: inline-block; width: 140px; height: ${Kr}px; background-color: ${h}; margin-right: 8px`)),m)},"makeItemUseColor"),s=c((l,p)=>{let d=this.style===p,f=d?"check":"none",m=d?()=>{}:()=>this.doSetStyle(p);return _.item(f,l,m)},"makeItemDisplayStyle"),a=this.parent.mode<3?[]:[_.sep(),_.item("timer",e.CustomPropagationDelay.expand({current:r}),l=>{let p=this.customPropagationDelay===void 0?"":String(this.customPropagationDelay),d=String(this.parent.options.propagationDelay),f=e.CustomPropagationDelayDesc.expand({current:d}),m=prompt(f,p);if(m!==null)if(m==="")this.customPropagationDelay=void 0;else{let h=parseInt(m);isNaN(h)||(this.customPropagationDelay=h)}}),_.submenu("palette",e.WireColor,[i(e.WireColorBlack,Gn.black),i(e.WireColorRed,Gn.red),i(e.WireColorBlue,Gn.blue),i(e.WireColorYellow,Gn.yellow),i(e.WireColorGreen,Gn.green),i(e.WireColorWhite,Gn.white)]),_.submenu("wirestyle",e.WireStyle,[s(e.WireStyleDefault,void 0),_.sep(),s(e.WireStyleAuto,$t.auto),s(e.WireStyleStraight,$t.straight),s(e.WireStyleCurved,$t.bezier)])],u=this.parent.mode<4?[]:[_.sep(),this.makeSetIdContextMenuItem()];return[_.item("add",e.AddMiddlePoint,(l,p)=>{this.addWaypointFrom(p)}),_.item("add",e.AddPassthrough,(l,p)=>{this.addPassthroughFrom(p)}),...a,...u,_.sep(),_.item("trash",x.Components.Generic.contextMenu.Delete,()=>this.parent.wireMgr.deleteWire(this),"\u232B",!0)]}};c(rr,"Wire");function to(o,n,e,r,i){switch(o){case"e":return[n-r,e];case"w":return[n+r,e];case"s":return[n,e-i];case"n":return[n,e+i]}}c(to,"bezierAnchorForWire");var nu=class extends Wn{constructor(e,r,i){super(e);this.startNodeGroup=r;this.endNodeGroup=i;this._startGroupStartIndex=Number.MAX_SAFE_INTEGER;this._startGroupEndIndex=Number.MIN_SAFE_INTEGER;this._endGroupStartIndex=Number.MAX_SAFE_INTEGER;this._endGroupEndIndex=Number.MIN_SAFE_INTEGER;this._coveredWires=[]}isEmpty(){return this._coveredWires.length===0}addCoveredWire(e,r,i){this._coveredWires.push(e),this.updateIndices(r,i)}wireWasDeleted(e){}updateIndices(e,r){this._startGroupStartIndex=Math.min(this._startGroupStartIndex,e),this._startGroupEndIndex=Math.max(this._startGroupEndIndex,e),this._endGroupStartIndex=Math.min(this._endGroupStartIndex,r),this._endGroupEndIndex=Math.max(this._endGroupEndIndex,r)}doDraw(e,r){let[[i,s],a]=this.drawRibbonEnd(e,r,this.startNodeGroup,this._startGroupStartIndex,this._startGroupEndIndex),[[u,l],p]=this.drawRibbonEnd(e,r,this.endNodeGroup,this._endGroupStartIndex,this._endGroupEndIndex),d=u-i,f=l-s,m=Math.max(25,Math.abs(d)/3),h=Math.max(25,Math.abs(f)/3),[v,D]=to(ue.invert(a),i,s,m,h),[b,C]=to(ue.invert(p),u,l,m,h),A=new ze(i,s,v,D,b,C,u,l),M=[];for(let w=this._startGroupStartIndex;w<=this._startGroupEndIndex;w++)M.push(this.startNodeGroup.nodes[w].value);this.strokeWireBezier(e,A,M,Gn.black,r.isMouseOver,!1)}strokeWireBezier(e,r,i,s,a,u){let l=i.length,p=l===1?1:l<=4||l>8?2:3,d=1,f=l<=8?2:1;if(l===0)return;let m=2*p+l*f+(l-1)*d,h=c(A=>{let[M,w,T,R]=A.points;e.moveTo(M.x,M.y),e.bezierCurveTo(w.x,w.y,T.x,T.y,R.x,R.y)},"addBezierToPath"),v=c(A=>{e.beginPath(),h(A),e.stroke()},"drawBezier"),D=c(A=>{if(pe(A)){e.beginPath();for(let M of A)h(M);e.stroke()}},"drawBeziers"),b=e.lineCap;e.lineCap="butt",a?(e.lineWidth=m+2,e.strokeStyle=hi,v(r),e.lineWidth=m-2*p):e.lineWidth=m,e.strokeStyle=bi[s],v(r),e.lineWidth=f;let C=-((l-1)/2)*(f+d);for(let A of i){e.strokeStyle=u?ct:Nt(A);let M=r.offset(C);D(M),C+=f+d}e.lineCap=b}drawRibbonEnd(e,r,i,s,a){let u=i.nodes,l=u[s].orient,p=a-s+1,d=Number.POSITIVE_INFINITY,f=Number.POSITIVE_INFINITY,m=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,v=0,D=0;for(let T=s;T<=a;T++){let R=u[T],S=R.posX,F=R.posY;d=Math.min(d,S),f=Math.min(f,F),m=Math.max(m,S),h=Math.max(h,F),v+=S,D+=F}let[[b,C],[A,M],w]=(()=>{switch(l){case"e":return[[m,f],[m,h],[m,D/p]];case"w":return[[d,f],[d,h],[d,D/p]];case"s":return[[d,f],[m,f],[v/p,f]];case"n":return[[d,h],[m,h],[v/p,h]]}})();return fc(e,b,C,A,M,"Z","black",!0),[w,l]}isOver(e,r){return!1}isInRect(e){return!1}};c(nu,"Ribbon");var Po=class{constructor(n){this._wires=[];this._ribbons=[];this._wireBeingAddedFrom=void 0;this.parent=n}get wires(){return this._wires}get ribbons(){return this._ribbons}get isAddingWire(){return this._wireBeingAddedFrom!==void 0}draw(n,e){this.removeDeadWires();let r=this.parent.options.groupParallelWires;if(r)for(let i of this._ribbons)i.draw(n,e);for(let i of this._wires)if(!(r&&i.ribbon!==void 0)){i.draw(n,e);for(let s of i.waypoints)s.draw(n,e)}this.drawWireBeingAdded(n)}drawWireBeingAdded(n){let e=this._wireBeingAddedFrom;if(e!==void 0){let r=e.posX,i=e.posY,s=this.parent.editor,a=s.mouseX,u=s.mouseY;if(n.beginPath(),n.moveTo(r,i),this.parent.options.wireStyle===$t.straight)n.lineTo(a,u);else{let l=a-r,p=u-i,d=Math.max(25,Math.abs(l)/3),f=Math.max(25,Math.abs(p)/3),m=ue.add(e.component.orient,e.orient),[h,v]=to(ue.invert(m),r,i,d,f),[D,b]=to(m,a,u,d,f);n.bezierCurveTo(h,v,D,b,a,u)}Jr(n,e.value,e.color,!1,!1)}}removeDeadWires(){let n=0;for(;n<this._wires.length;){let e=this._wires[n];e.isAlive?n++:(e.destroy(),this._wires.splice(n,1))}}addWire(n,e,r){var s,a;if(!n.acceptsMoreConnections||!e.acceptsMoreConnections)return;let i=new rr(n,e);return this._wires.push(i),r&&this.offsetWireIfNecessary(i),this.tryMergeWire(i),(a=(s=this.parent).setDirty)==null||a.call(s,"added wire"),i}startDraggingFrom(n){var e,r;this._wireBeingAddedFrom!==void 0&&console.warn("WireManager.startDraggingFrom: already dragging from a node"),n.acceptsMoreConnections&&(this._wireBeingAddedFrom=n,(r=(e=this.parent).setToolCursor)==null||r.call(e,"crosshair"))}stopDraggingOn(n){let e=this.getOutInNodes(n);if(this._wireBeingAddedFrom=void 0,e!==void 0)return this.addWire(e[0],e[1],!0)}isValidMouseUp(n){return this.getOutInNodes(n)!==void 0}getOutInNodes(n){var r,i;let e=this._wireBeingAddedFrom;if(e!==void 0&&n!==e){if(e.isOutput())return n.isOutput()||!n.acceptsMoreConnections?void 0:[e,n];if(n.isOutput())return[n,e];{let s=(r=n.incomingWire)==null?void 0:r.startNode;return s!==void 0&&e.acceptsMoreConnections?[s,e]:(s=(i=e.incomingWire)==null?void 0:i.startNode,s!==void 0&&n.acceptsMoreConnections?[s,n]:void 0)}}}tryCancelWire(){var n,e;this._wireBeingAddedFrom=void 0,(e=(n=this.parent)==null?void 0:n.setToolCursor)==null||e.call(n,null)}offsetWireIfNecessary(n){let e=n.startNode,r=n.endNode,i=e.component;if(i!==r.component)return;let s=(r.posX-e.posX)/2,a=(r.posY-e.posY)/2,u=e.posX+s,l=e.posY+a;if(!i.isOver(u,l))return;let p=s>a,d=p?e.posX<r.posX?1:e.posX>r.posX||e.posX<i.posX?-1:1:e.posY<r.posY?1:e.posY>r.posY||e.posY<i.posY?-1:1,f=c(D=>d*(D/2+2*H),"calcOffsetFromDim"),m=ue.isVertical(i.orient),h=u+(p?f(m?i.unrotatedHeight:i.unrotatedWidth):0),v=l+(p?0:f(m?i.unrotatedWidth:i.unrotatedHeight));n.addWaypointWith(h,v)}tryMergeWire(n){let e=n.startNode,r=n.endNode,i=e.group,s=r.group;if(i===void 0||s===void 0)return;let a=c((d,f,m,h)=>{if(!(f<0||h<0||f>=d.nodes.length||h>=m.nodes.length))return d.nodes[f].findWireTo(m.nodes[h])},"findWire"),u=i.nodes.indexOf(e),l=s.nodes.indexOf(r),p=a(i,u-1,s,l-1);if(p!==void 0){let d=p.ribbon;d===void 0&&(d=new nu(e.parent,i,s),this._ribbons.push(d),p.ribbon=d,d.addCoveredWire(p,u-1,l-1)),d.addCoveredWire(n,u,l),n.ribbon=d}}deleteWire(n){let e=n.startNode,r=n.endNode;return this.doDeleteWire(n)?rc(e,r,(s,a)=>{let u=a.incomingWire;return u===null||u.startNode!==s?!1:this.doDeleteWire(u)}):Z.NoChange}doDeleteWire(n){var r;n.destroy();let e=n.ribbon;return e!==void 0&&(e.wireWasDeleted(n),e.isEmpty()&&this._ribbons.splice(this._ribbons.indexOf(e),1)),this._wires.splice(this._wires.indexOf(n),1),(r=this.parent.redrawMgr)==null||r.addReason("deleted wire",null),!0}clearAllWires(){var n;for(let e of this._wires)e.destroy();this._wires.splice(0,this._wires.length),(n=this.parent.redrawMgr)==null||n.addReason("deleted wires",null)}};c(Po,"WireManager");var ru=class{saveCircuitToFile(n){var s;let e=this.stringifyObject(this.buildCircuitObject(n),!1),r=new Blob([e],{type:"application/json"}),i=((s=n.options.name)!=null?s:"circuit")+".json";(0,gc.saveAs)(r,i)}saveLibraryToFile(n){var s;let e=this.stringifyObject(this.buildLibraryObject(n),!1),r=new Blob([e],{type:"application/json"}),i=((s=n.options.name)!=null?s:"circuit")+"-lib.json";(0,gc.saveAs)(r,i)}loadCircuitOrLibrary(n,e,r){let i;if(!Re(e))i=e;else try{i=H0(e)}catch(a){return console.error(a),"can't load this JSON - error \u201C"+a+`\u201D, length = ${e.length}, JSON:
`+e}return i.type==="lib"?this.doLoadLibrary(n,i):this.loadCircuit(n,i,r)}doLoadLibrary(n,e){Xl(e);let r=n.factory.tryLoadCustomDefsFrom(e.defs);n.updateCustomComponentButtons(),console.log(`Loaded ${r} custom component definitions`)}loadCircuit(n,e,r){var h,v,D;let i=n.nodeMgr,s=n.wireMgr,a=n.components,u=k({},e);try{(h=r==null?void 0:r.skipMigration)!=null&&h||Xl(u)}catch(b){return console.error(b),"can't migrate JSON - error \u201C"+b+`\u201D, JSON:
`+Fs(u,{maxLength:120})}delete u.v,n.isMainEditor()&&(n.factory.clearCustomDefs(),n.factory.tryLoadCustomDefsFrom(u.defs),delete u.defs);for(let b of a.all())b.destroy();a.clearAll(),s.clearAllWires(),i.clearAllLiveNodes(),n.isMainEditor()&&n.timeline.reset();let l=n.editor.factory,p=u.components;if(pe(p))for(let b of p)l.makeFromJSON(n,b);else if(Vn(p))for(let[b,C]of Object.entries(p))Vn(C)?(C.ref=b,l.makeFromJSON(n,C)):console.error(`Invalid non-object component repr: '${C}'`);delete u.components;let d=n.recalcMgr;d.recalcAndPropagateIfNeeded();let f=(v=r==null?void 0:r.immediateWirePropagation)!=null?v:!1;for(let b of pe(u.wires)?u.wires:[]){let C=br(b,rr.Repr,"wire");if(C===void 0)return;let[A,M,w]=C,T=i.findNode(A),R=i.findNode(M);if(T!==void 0&&R!==void 0&&T.isOutput()&&!R.isOutput()){let S=s.addWire(T,R,!1);S!==void 0&&(w!==void 0&&(S.doSetValidatedId(w.ref),w.via!==void 0&&S.setWaypoints(w.via),w.propagationDelay!==void 0&&(S.customPropagationDelay=w.propagationDelay),w.style!==void 0&&S.doSetStyle(w.style)),f&&(S.customPropagationDelay=0)),d.recalcAndPropagateIfNeeded()}}delete u.wires,n.isMainEditor()&&(u.userdata!==void 0&&(typeof n.userdata=="object"&&typeof u.userdata=="object"&&(n.userdata=k(k({},u.userdata),n.userdata)),delete u.userdata),n.setPartialOptions(u.opts),delete u.opts,(D=r==null?void 0:r.isUndoRedoAction)!=null&&D||n.undoMgr.takeSnapshot(),n.updateCustomComponentButtons());let m=ds(u);m.length!==0&&console.log("Unloaded data fields: "+m.join(", "))}buildCircuitObject(n){let e={v:ci,opts:n.nonDefaultOptions(),defs:n.factory.customDefReprs(),userdata:n.userdata};return this.buildComponentReprsInto(e,n.components.all(),n.wireMgr.wires),e}buildLibraryObject(n){return{v:ci,defs:n.factory.customDefReprs(),type:"lib"}}buildComponentsObject(n){let e={},r=[];for(let i of n)for(let s of i.inputs._all){let a=s.incomingWire;a!==null&&n.includes(a.startNode.component)&&r.push(a)}return this.buildComponentReprsInto(e,n,r),e}buildComponentReprsInto(n,e,r){for(let i of e){n.components===void 0&&(n.components={});let s=i.ref;if(s===void 0){console.error("Skipping component with no id: "+i);continue}n.components[s]!==void 0&&console.error("Skipping component with duplicate id: "+i);let a=i.toJSON();n.components[s]=a}r.length!==0&&(n.wires=r.map(i=>i.toJSON()))}removeShowOnlyFrom(n){n.opts!==void 0&&delete n.opts.showOnly}stringifyObject(n,e){if(e)return ou.default.stringify(n);let r=k({},n),i=[];Ns(i,r,"v"),Ns(i,r,"type"),Ns(i,r,"opts"),Ns(i,r,"userdata");let s=r.defs;if(s!==void 0&&pe(s)){let u=[];for(let l of s){let p=l.circuit;delete l.circuit;let d=Fs(l,{maxLength:1/0});l.circuit=p;let f=[];Td(f,k({},p),!0);let m=f.length===0?"{}":`{
      `+f.join(`,
      `)+`
    }`;d=d.slice(0,d.length-1)+', "circuit": '+m+"}",u.push(d)}i.push(`defs: [
    `+u.join(`,
    `)+`
  ]`)}delete r.defs,Td(i,r,!1);let a=ds(r);return a.length!==0&&console.error("ERROR: unprocessed fields in stringified JSON: "+a.join(", ")),`{ // JSON5
  `+i.join(`,
  `)+`
}`}};c(ru,"_Serialization");var vt=new ru;function Ns(o,n,e){let r=n[e];r!==void 0&&o.push(`${Dc(e)}: ${Fs(r,{maxLength:1/0})}`),delete n[e]}c(Ns,"stringifyCompactReprTo");function Td(o,n,e){let r="  ".repeat(e?4:2),i="  ".repeat(e?3:1),s=n.components,a;if(s!==void 0){if(pe(s)&&s.length!==0){let u=[];for(let l of s)u.push(Fs(l,{maxLength:1/0}));o.push(`components: [
${r}`+u.join(`,
${r}`)+`,
${i}]`)}else if((a=Object.entries(s)).length!==0){let u=[];for(let[l,p]of a)delete p.ref,u.push(`${Dc(l)}: ${Fs(p,{maxLength:1/0})}`);o.push(`components: {
${r}`+u.join(`,
${r}`)+`,
${i}}`)}}delete n.components,Ns(o,n,"wires")}c(Td,"stringifyComponentAndWiresReprsTo");var E3=/("(?:[^\\"]|\\.)*")|[:,]/g;function Fs(o,n){var s,a;n!=null||(n={});let e=JSON.stringify([1],void 0,(s=n.indent)!=null?s:2).slice(2,-3),r=e===""?1/0:(a=n.maxLength)!=null?a:80,i=n.replacer;return c(function u(l,p,d){l!==void 0&&typeof l.toJSON=="function"&&(l=l.toJSON());let f=ou.default.stringify(l,i);if(f===void 0)return f;let m=r-p.length-d;if(f.length<=m){let h=f.replace(E3,function(v,D){return D!=null?D:v+" "});if(h.length<=m)return h}if(i!==null&&(l=ou.default.parse(f),i=void 0),typeof l=="object"&&l!==null){let h=p+e,v=[],D=0,b,C;if(Array.isArray(l))for(b="[",C="]",m=l.length;D<m;D++)v.push(u(l[D],h,D===m-1?0:1)||"null");else{b="{",C="}";let A=Object.keys(l);for(m=A.length;D<m;D++){let M=A[D],w=Dc(M)+": ",T=u(l[M],h,w.length+(D===m-1?0:1));T!==void 0&&v.push(w+T)}}if(v.length>0)return[b,e+v.join(`,
`+h),C].join(`
`+p)}return f},"_stringify")(o,"",0)}c(Fs,"stringifySmart");function Dc(o){if(o.length===0)return hc(o);let n=String.fromCodePoint(o.codePointAt(0));if(!wi.isIdStartChar(n))return hc(o);for(let e=n.length;e<o.length;e++)if(!wi.isIdContinueChar(String.fromCodePoint(o.codePointAt(e))))return hc(o);return o}c(Dc,"stringifyKey");var mc={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};function hc(o){let n={"'":.1,'"':.2},e="";for(let i=0;i<o.length;i++){let s=o[i];switch(s){case"'":case'"':n[s]++,e+=s;continue;case"\0":if(wi.isDigit(o[i+1])){e+="\\x00";continue}}if(mc[s]!==void 0){e+=mc[s];continue}if(s<" "){let a=s.charCodeAt(0).toString(16);e+="\\x"+("00"+a).substring(a.length);continue}e+=s}let r=ds(n).reduce(function(i,s){return n[i]<n[s]?i:s});return e=e.replace(new RegExp(r,"g"),mc[r]),r+e+r}c(hc,"quoteString");var Is=ce(Me());var Ai=ce(Me());var no=xt.withProps()({not:{out:([o])=>o===!1?!0:o===!0?!1:I,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.not},buf:{out:([o])=>o===!0?!0:o===!1?!1:I,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.buf}}),_d=Ai.keyof(no.props),ko=xt.withProps()({and:{out:Ed,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.and},or:{out:vc,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.or},xor:{out:Sd,includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.xor},nand:{out:o=>Ue.invert(Ed(o)),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.nand},nor:{out:o=>Ue.invert(vc(o)),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.nor},xnor:{out:o=>Ue.invert(Sd(o)),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.xnor}}),S3=Ai.keyof(ko.props),su=xt.withProps()({imply:{out:o=>iu(o[0],o[1]),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.imply},rimply:{out:o=>iu(o[1],o[0]),includeInContextMenu:!1,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.rimply},nimply:{out:o=>Ue.invert(iu(o[0],o[1])),includeInContextMenu:!0,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.nimply},rnimply:{out:o=>Ue.invert(iu(o[1],o[0])),includeInContextMenu:!1,includeInPoseAs:!0,fullShortDesc:()=>x.Components.Gate.rnimply},txa:{out:o=>o[0],includeInContextMenu:!0,includeInPoseAs:!1,fullShortDesc:()=>x.Components.Gate.txa},txb:{out:o=>o[1],includeInContextMenu:!1,includeInPoseAs:!1,fullShortDesc:()=>x.Components.Gate.txb},txna:{out:o=>Ue.invert(o[0]),includeInContextMenu:!1,includeInPoseAs:!1,fullShortDesc:()=>x.Components.Gate.txna},txnb:{out:o=>Ue.invert(o[1]),includeInContextMenu:!1,includeInPoseAs:!1,fullShortDesc:()=>x.Components.Gate.txnb}}),_3=Ai.keyof(su.props),or=xt.withProps()(k(k({},ko.props),su.props)),Md=Ai.union([S3,_3]);function Ed(o){return o.includes(!1)?!1:o.includes(I)||o.includes(Pe)?I:!0}c(Ed,"logicAnd");function vc(o){return o.includes(!0)?!0:o.includes(I)||o.includes(Pe)?I:!1}c(vc,"logicOr");function Sd(o){let n=0;for(let e of o)if(e===!0)n++;else if(e===I||e===Pe)return I;return n%2===1}c(Sd,"logicXor");function iu(o,n){return vc([Ue.invert(o),n])}c(iu,"logicImply");var _n=ye("alu",!0,!0,{variantName:({bits:o})=>`alu-${o}`,idPrefix:"alu",button:{imgWidth:50},repr:{bits:P(Is.number),ext:P(Is.boolean),showOp:P(Is.boolean)},valueDefaults:{showOp:!0},params:{bits:Ce(4,[2,4,8,16]),ext:Wa()},validateParams:({bits:o,ext:n})=>({numBits:o,usesExtendedOpcode:n}),size:({numBits:o})=>({gridWidth:7,gridHeight:19+Math.max(0,o-8)*2}),makeNodes:({numBits:o,usesExtendedOpcode:n,gridWidth:e,gridHeight:r})=>{let i=5+Math.max(0,(o-8)/2),s=e/2+1,a=(r+1)/2,u=-a,p=tr("n",0,u,n?5:3),d=p.pop(),f=p.pop();return{ins:{A:ie("w",-s,-i,o),B:ie("w",-s,i,o),Op:p,Mode:f,Cin:[d[0],d[1],"n",`Cin (${x.Components.ALU.InputCinDesc})`]},outs:{S:ie("e",s,0,o),V:[0,a,"s","V (oVerflow)"],Z:[2,a,"s","Z (Zero)"],Cout:[-2,a,"s",`Cout (${x.Components.ALU.OutputCoutDesc})`]}}},initialValue:(o,{numBits:n})=>({s:$(!1,n),v:!1,cout:!1})}),Rd={shortName(o){return x.Components.ALU[o][0]},fullName(o){return x.Components.ALU[o][1]}},M3=["A+B","A-B","A+1","A-1","-A","B-A","A*2","A/2","A|B","A&B","A|~B","A&~B","~A","A^B","A<<","A>>"],R3=["A+B","A-B","A|B","A&B"],au=class extends we{constructor(e,r,i){var s;super(e,_n.with(r),i);this.numBits=r.numBits,this.usesExtendedOpcode=r.usesExtendedOpcode,this._showOp=(s=i==null?void 0:i.showOp)!=null?s:_n.aults.showOp}toJSON(){return Y(k({bits:this.numBits===_n.aults.bits?void 0:this.numBits,ext:this.usesExtendedOpcode===_n.aults.ext?void 0:this.usesExtendedOpcode},this.toJSONBase()),{showOp:this._showOp!==_n.aults.showOp?this._showOp:void 0})}makeTooltip(){let e=this.op,r=x.Components.ALU.tooltip,i=U(e)?r.SomeUnknownOperation:r.ThisOperation+" "+Rd.fullName(e);return Q(r.title,q(z(`${r.CurrentlyCarriesOut} ${i}.`)))}get op(){let e=this.inputValues(this.inputs.Op);e.push(this.inputs.Mode.value);let r=Oe(e,!1)[1];return U(r)?I:(this.usesExtendedOpcode?M3:R3)[r]}doRecalcValue(){let e=this.op;if(U(e))return{s:$(I,this.numBits),v:I,cout:I};let r=this.inputValues(this.inputs.A),i=this.inputValues(this.inputs.B),s=this.inputs.Cin.value;return N3(e,r,i,s)}propagateValue(e){this.outputValues(this.outputs.S,e.s),this.outputs.V.value=e.v,this.outputs.Z.value=O3(e.s),this.outputs.Cout.value=e.cout}doDraw(e,r){let i=this.bounds(),{left:s,top:a,right:u,bottom:l}=i,p=a+2*H;for(let D of this.inputs.A)Ae(e,D,s,D.posYInParentTransform);for(let D of this.inputs.B)Ae(e,D,s,D.posYInParentTransform);for(let D of this.inputs.Op)Ae(e,D,D.posXInParentTransform,p);Ae(e,this.inputs.Mode,this.inputs.Mode.posXInParentTransform,p),Ae(e,this.inputs.Cin,this.inputs.Cin.posXInParentTransform,p);for(let D of this.outputs.S)Ae(e,D,u,D.posYInParentTransform);Ae(e,this.outputs.Z,this.outputs.Z.posXInParentTransform,l-17),Ae(e,this.outputs.V,this.outputs.V.posXInParentTransform,l-9),Ae(e,this.outputs.Cout,this.outputs.Cout.posXInParentTransform,l-3),e.fillStyle=Ke,e.lineWidth=3,e.strokeStyle=r.borderColor,e.beginPath(),e.moveTo(s,a),e.lineTo(u,p),e.lineTo(u,l-2*H),e.lineTo(s,l),e.lineTo(s,this.posY+1*H),e.lineTo(s+2*H,this.posY),e.lineTo(s,this.posY-1*H),e.closePath(),e.fill(),e.stroke(),this.drawGroupBox(e,this.inputs.A.group,i),this.drawGroupBox(e,this.inputs.B.group,i),this.drawGroupBox(e,this.outputs.S.group,i),e.beginPath();let d=8,f=this.inputs.Mode.posXInParentTransform-2,m=this.inputs.Op[0].posXInParentTransform+2,h=a+(this.usesExtendedOpcode?8:11),v=a+18;e.moveTo(f,h),e.lineTo(m,v),e.lineTo(m,v+d),e.lineTo(f,h+d),e.closePath(),e.fillStyle=Di,e.fill(),r.inNonTransformedFrame(D=>{e.fillStyle=Tn,e.font="11px sans-serif";let C=ue.isVertical(this.orient)?0:1;if(Rt(D,this.orient,"Z","s",this.outputs.Z,l-16),Rt(D,this.orient,"V","s",this.outputs.V.posXInParentTransform+C*2,l-10,this.outputs.V),Rt(D,this.orient,"Cout","s",this.outputs.Cout.posXInParentTransform+C*4,l-7,this.outputs.Cout),Rt(D,this.orient,"Cin","n",this.inputs.Cin.posXInParentTransform,a+4,this.inputs.Cin),e.font="bold 11px sans-serif",Rt(D,this.orient,"Op","n",(f+m)/2,a+12,this.inputs.Op),e.font="bold 12px sans-serif",Rt(D,this.orient,"A","w",s,this.inputs.A),Rt(D,this.orient,"B","w",s,this.inputs.B),Rt(D,this.orient,"S","e",u,this.outputs.S),this._showOp){let A=U(this.op)?"??":Rd.shortName(this.op),M=A.length===1?25:A.length===2?17:13;e.font=`bold ${M}px sans-serif`,e.fillStyle=K,e.textAlign="center",e.textBaseline="middle",e.fillText(A,...D.rotatePoint(this.posX+5,this.posY))}})}doSetShowOp(e){this._showOp=e,this.setNeedsRedraw("show op changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.ALU.contextMenu,r=this._showOp?"check":"none";return[["mid",_.item(r,e.toggleShowOp,()=>{this.doSetShowOp(!this._showOp)})],["mid",_.sep()],this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),this.makeChangeBooleanParamsContextMenuItem(e.ParamUseExtendedOpcode,this.usesExtendedOpcode,"ext"),["mid",_.sep()],...this.makeForceOutputsContextMenuItem()]}};c(au,"ALU");_n.impl=au;function O3(o){for(let n of o){if(U(n)||me(n))return I;if(n===!0)return!1}return!0}c(O3,"allZeros");function N3(o,n,e,r){let i=n.length;switch(o){case"A+B":return Lo(n,e,r);case"A*2":return Lo(n,n,r);case"A+1":return Lo(n,[!0,...$(!1,i-1)],r);case"A/2":return Vo([...n.slice(1),n[i-1]],$(!1,i),r);case"A-1":return Vo(n,[!0,...$(!1,i-1)],r);case"A-B":return Vo(n,e,r);case"B-A":return Vo(e,n,r);case"-A":return Vo($(!1,i),n,r);default:{let s=!1;return{s:(()=>{switch(o){case"A|B":return Bs("or",n,e);case"A&B":return Bs("and",n,e);case"A^B":return Bs("xor",n,e);case"A|~B":return Bs("or",n,yc(e));case"A&~B":return Bs("and",n,yc(e));case"~A":return yc(n);case"A>>":return[...n.slice(1),r];case"A<<":return s=n[n.length-1],[r,...n.slice(0,n.length-1)]}})(),v:!1,cout:s}}}}c(N3,"doALUOp");function Lo(o,n,e){let r=o.length,i=c((p,d,f)=>{let m=c(D=>D===!0?1:0,"asNumber"),h=(U(p)||me(p)?1:0)+(U(d)||me(p)?1:0)+(U(f)||me(p)?1:0),v=m(p)+m(d)+m(f);return h===0?[v%2===1,v>=2]:h===1&&v>=2?[I,!0]:[I,I]},"sum3bits"),s=$(I,r),a=$(I,r+1);a[0]=e;for(let p=0;p<r;p++){let[d,f]=i(a[p],o[p],n[p]);s[p]=d,a[p+1]=f}let u=a[r],l=!_o(u)||!_o(a[r-2])?I:u!==a[r-1];return{s,cout:u,v:l}}c(Lo,"doALUAdd");function Vo(o,n,e){let r=o.length,i=$(I,r),s=c(d=>{let f=0,m=1;for(let h of d){if(U(h))return;f+=Number(h)*m,m*=2}return f},"toInt"),a=s(o),u=s(n),l=I,p=I;if(a!==void 0&&u!==void 0&&_o(e)){let d=a-u-(e?1:0);d<0&&(d+=Math.pow(2,r));let f=(d>>>0).toString(2).padStart(r,"0"),m=r-1;for(let b=0;b<r;b++)i[b]=f[m-b]==="1";l=u>a-(e?1:0);let h=o[m]===!0,v=n[m]===!0,D=i[m]===!0;p=h!==v&&h!==D}return{s:i,cout:l,v:p}}c(Vo,"doALUSub");function yc(o){let n=no.props.not.out;return wt(e=>n([o[e]]),o.length)}c(yc,"doALUNot");function Bs(o,n,e){let r=ko.props[o].out;return wt(i=>r([n[i],e[i]]),n.length)}c(Bs,"doALUBinOp");var Ti=ve("adder",{idPrefix:"adder",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:7,gridHeight:5},makeNodes:()=>{let o=x.Components.Generic;return{ins:{A:[-2,-4,"n","A",{hasTriangle:!0}],B:[2,-4,"n","B",{hasTriangle:!0}],Cin:[5,0,"e",o.InputCarryInDesc,{hasTriangle:!0}]},outs:{S:[0,4,"s",o.OutputSumDesc,{hasTriangle:!0}],Cout:[-5,0,"w",o.OutputCarryOutDesc,{hasTriangle:!0}]}}},initialValue:()=>({s:!1,cout:!1})}),uu=class extends he{constructor(n,e){super(n,Ti,e)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.Adder.tooltip;return Q(n.title,q(z(n.desc)))}doRecalcValue(){let n=this.inputs.A.value,e=this.inputs.B.value,r=this.inputs.Cin.value;if(U(n)||U(e)||U(r)||me(n)||me(e)||me(r))return{s:I,cout:I};switch(+n+ +e+ +r){case 0:return{s:!1,cout:!1};case 1:return{s:!0,cout:!1};case 2:return{s:!1,cout:!0};case 3:return{s:!0,cout:!0};default:return console.log("ERROR: sum of adder is > 3"),{s:!1,cout:!1}}}propagateValue(n){this.outputs.S.value=n.s,this.outputs.Cout.value=n.cout}doDraw(n,e){this.doDrawDefault(n,e,()=>{n.fillStyle=K,n.font="bold 30px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillText("+",this.posX,this.posY-2)})}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(uu,"Adder");Ti.impl=uu;var Od=ce(Me());var Sr=ye("adder-array",!0,!0,{variantName:({bits:o})=>`adder-array-${o}`,idPrefix:"adder",button:{imgWidth:50},repr:{bits:P(Od.number)},valueDefaults:{},params:{bits:Ce(4,[2,4,8,16])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>({gridWidth:4,gridHeight:_n.size({numBits:o,usesExtendedOpcode:!1}).gridHeight}),makeNodes:({numBits:o,gridHeight:n})=>{let e=5+Math.max(0,(o-8)/2),r=Math.floor(n/2)+1,i=-r;return{ins:{A:ie("w",-3,-e,o),B:ie("w",-3,e,o),Cin:[0,i,"n"]},outs:{S:ie("e",3,0,o),Cout:[0,r,"s"]}}},initialValue:(o,{numBits:n})=>({s:$(!1,n),cout:!1})}),lu=class extends we{constructor(e,r,i){super(e,Sr.with(r),i);this.numBits=r.numBits}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===Sr.aults.bits?void 0:this.numBits})}makeTooltip(){let e=x.Components.AdderArray.tooltip;return Q(e.title.expand({numBits:this.numBits}),q(z(e.desc)))}doRecalcValue(){let e=this.inputValues(this.inputs.A),r=this.inputValues(this.inputs.B),i=this.inputs.Cin.value;return Lo(e,r,i)}propagateValue(e){this.outputValues(this.outputs.S,e.s),this.outputs.Cout.value=e.cout}doDraw(e,r){this.doDrawDefault(e,r,i=>{e.font="bold 25px sans-serif",e.fillStyle=K,e.textAlign="center",e.textBaseline="middle",e.fillText("+",...i.rotatePoint(this.posX-4,this.posY))})}makeComponentSpecificContextMenuItems(){return[this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}};c(lu,"AdderArray");Sr.impl=lu;var Si=ce(Me());var zn=ce(Me());var Ei=class extends we{constructor(e,r,i){var s;super(e,r,i);this._name=(s=i==null?void 0:i.name)!=null?s:void 0}toJSONBase(){return Y(k({},super.toJSONBase()),{name:this._name})}isOver(e,r){return this.numBits===1?Un(e,r,this.posX,this.posY)<dn/2:Fa(this.posX,this.posY,this.width,this.height,e,r)}get allowsForcedOutputs(){return!1}get name(){return this._name}doRecalcValue(){return this.value}propagateValue(e){this.outputValues(this.outputs.Out,e)}shouldDrawBorder(){return!0}doDraw(e,r){this.numBits===1?this.doDrawSingle(e,r,this.outputs.Out[0]):this.doDrawMulti(e,r,this.outputs.Out)}doDrawSingle(e,r,i){Ae(e,i,this.posX+8,this.posY);let s=this.parent.options.hideInputColors?I:i.value,a=this.shouldDrawBorder();a&&(r.isMouseOver&&this.parent.mode!==0?(e.strokeStyle=r.borderColor,e.fillStyle=r.borderColor):(e.strokeStyle=K,e.fillStyle=K),e.lineWidth=3,e.beginPath(),jr(e,this.posX+dn/2-1,this.posY-7,this.posX+dn/2-1,this.posY+7,this.posX+dn/2+5,this.posY),e.fill(),e.stroke(),e.fillStyle=Nt(s),e.lineWidth=4,e.beginPath(),pn(e,this.posX,this.posY,dn),e.fill(),e.stroke()),r.inNonTransformedFrame(u=>{this._name!==void 0&&$r(e,u,this._name,tt(s),this,!1);let l=a?void 0:e.fillStyle=K;Za(e,s,this,{fillStyle:l})})}doDrawMulti(e,r,i){let s=this.bounds(),{left:a,top:u,width:l,right:p}=s,d=s.outline(e);e.fillStyle=Ke,e.fill(d);for(let v of i)Ae(e,v,p+3,v.posYInParentTransform,!0);let f=this.parent.options.hideInputColors?$(I,this.numBits):this.value,m=r.isMouseOver&&this.parent.mode!==0;e.strokeStyle=m?r.borderColor:K,e.lineWidth=1;let h=Je(this.numBits)?H:2*H;for(let v=0;v<this.numBits;v++){let D=u+v*h;e.fillStyle=Nt(f[v]),e.beginPath(),e.rect(a,D,l,h),e.fill(),e.stroke()}e.lineWidth=3,e.stroke(d),r.inNonTransformedFrame(v=>{if(this._name!==void 0){let D=f.map(tt).reverse().join("");$r(e,v,this._name,D,this,!1)}for(let D=0;D<this.numBits;D++){let b=u+h/2+D*h;Io(e,f[D],...v.rotatePoint(this.posX,b),{small:Je(this.numBits)})}})}autoConnected(e){if(e.length!==1)return;let[r,i,s]=e[0];if(s instanceof Xr&&(s.prefersSpike&&this.doSetIsPushButton(!0),this._name===void 0&&!Yr(s.shortName)&&this.doSetName(s.shortName)),r.orient==="e")switch(ue.add(i.orient,s.orient)){case"w":return;case"e":this.doSetOrient("w"),this.setPosition(this.posX+H*6,this.posY,!1);return;case"s":this.doSetOrient("n"),this.setPosition(this.posX+H*3,this.posY+H*3,!1);return;case"n":this.doSetOrient("s"),this.setPosition(this.posX+H*3,this.posY-H*3,!1);return}}doSetIsPushButton(e){}doSetName(e){this._name=e,this.setNeedsRedraw("name changed")}makeComponentSpecificContextMenuItems(){return[["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetNameDialog(this._name,this.doSetName.bind(this)):super.keyDown(e)}};c(Ei,"InputBase");var Lt=ye("in",!1,!0,{variantName:({bits:o})=>`in-${o}`,idPrefix:"in",button:{imgWidth:32},repr:{bits:P(zn.number),val:P(zn.union([Gr,zn.string,zn.array(Gr)])),isPushButton:P(zn.boolean),isConstant:P(zn.boolean),name:Ot},valueDefaults:{isPushButton:!1,isConstant:!1},params:{bits:Ce(1,[1,2,3,4,8,16,32])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>{if(o===1){let n=dn/H;return{gridWidth:n,gridHeight:n}}return{gridWidth:2,gridHeight:Je(o)?o:2*o}},makeNodes:({numBits:o})=>({outs:{Out:ie("e",o===1?3:2,0,o)}}),initialValue:(o,{numBits:n})=>{let e=c(()=>$(!1,n),"allFalse");if(o===void 0)return e();let r;return(r=o.val)!==void 0?pe(r)?Hl(r.map(i=>Zn(i)),n,!1):gn(r)?$(Zn(r),n):r.length===0?e():Hl(Array.from(r).reverse().map(i=>zl(i)),n,!1):e()}}),ro=class extends Ei{constructor(e,r,i){var s,a;super(e,Lt.with(r),i);this.numBits=r.numBits,this._isPushButton=(s=i==null?void 0:i.isPushButton)!=null?s:Lt.aults.isPushButton,this._isConstant=(a=i==null?void 0:i.isConstant)!=null?a:Lt.aults.isConstant}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===Lt.aults.bits?void 0:this.numBits,val:this.contentRepr(),isPushButton:this._isPushButton!==Lt.aults.isPushButton?this._isPushButton:void 0,isConstant:this._isConstant!==Lt.aults.isConstant?this._isConstant:void 0})}get isConstant(){return this._isConstant}contentRepr(){if(this.numBits===1){let i=this.value[0];return i===!1?void 0:tt(i)}let e=this.value,r=!1;for(let i=0;i<this.numBits;i++)if(e[i]!==!1){r=!0;break}if(r)return this.value.map(tt).reverse().join("")}cursorWhenMouseover(e){var i,s;let r=this.parent.mode;return r===0?"not-allowed":(i=e==null?void 0:e.ctrlKey)!=null&&i&&r>=2?"context-menu":(s=e==null?void 0:e.altKey)!=null&&s&&r>=3?"copy":this._isConstant?r>=3&&!this.lockPos?"grab":void 0:"pointer"}makeTooltip(){let e=x.Components.Input.tooltip;return Q(void 0,q(e.title.expand({numBits:this.numBits})))}get isLinkedToSomeClock(){return this.outputs._all.some(e=>e.outgoingWires.some(r=>r.endNode.isClock))}get isPushButton(){return this._isPushButton}shouldDrawBorder(){return!this._isConstant}mouseClicked(e){let r;if((r=super.mouseClicked(e)).isChange)return r;if(this.parent.mode===0||this._isPushButton||this._isConstant||!this.parent.isMainEditor())return Z.NoChange;let i=this.clickedBitIndex(e,this.parent);if(i===-1)return Z.SimpleChange;let s=e.altKey,a=c(()=>(this.doSetValueChangingBit(i,F3(this.value[i],this.parent.mode,s)),!0),"doChange");return a(),Z.RepeatableChange(a)}mouseDown(e){return this.trySetPushButtonBit(!0,e),super.mouseDown(e)}mouseUp(e){let r=super.mouseUp(e);return this.trySetPushButtonBit(!1,e),r}clickedBitIndex(e,r){let i=this.unrotatedHeight,s=r.offsetXYForComponent(e,this)[1]-this.posY+i/2,a=Math.floor(s*this.numBits/i);return a>=0&&a<this.numBits?a:-1}trySetPushButtonBit(e,r){let i;this.parent.mode!==0&&this._isPushButton&&!this._isConstant&&this.parent.isMainEditor()&&this.parent.cursorMovementMgr.currentSelectionEmpty()&&(i=this.clickedBitIndex(r,this.parent))!==-1&&this.doSetValueChangingBit(i,e)}doSetValueChangingBit(e,r){let i=[...this.value];i[e]=r,this.doSetValue(i)}doSetIsPushButton(e){this._isPushButton=e,e&&this.doSetValue($(!1,this.numBits))}doSetIsConstant(e){this._isConstant=e,this.setNeedsRedraw("constant changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.Input.contextMenu,r=c((s,a)=>{let u=this._isPushButton===a,l=u?"check":"none",p=u?()=>{}:()=>this.doSetIsPushButton(a);return _.item(l,s,p)},"makeItemBehaveAs"),i=[["mid",r(e.ToggleButton,!1)],["mid",r(e.PushButton,!0)],["mid",_.sep()],this.makeChangeParamsContextMenuItem("outputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),["mid",_.sep()]];if(this.numBits===1){let s=c(()=>{let u=this._isConstant?"check":"none",l=c(()=>this.doSetIsConstant(!this._isConstant),"action");return _.item(u,e.LockValue+` (${tt(this.value[0])})`,l)},"makeToggleConstantItem"),a=_.item("timer",e.ReplaceWithClock,()=>{this.replaceWithComponent(rn.make(this.parent))});i.push(["mid",s()],["mid",_.sep()],["mid",a],["mid",_.sep()])}return i.push(...super.makeComponentSpecificContextMenuItems()),i}};c(ro,"Input");Lt.impl=ro;function F3(o,n,e){switch(o){case!0:return n>=4&&e?I:!1;case!1:return n>=4&&e?I:!0;case I:return n>=4?e?Pe:!1:I;case Pe:return n>=4?e?I:!1:Pe}}c(F3,"nextValue");var rn=ve("clock",{idPrefix:"clock",button:{imgWidth:50},repr:{name:Ot,period:Si.number,dutycycle:P(Si.number),phase:P(Si.number),showLabel:P(Si.boolean)},valueDefaults:{period:2e3,dutycycle:50,phase:0,showLabel:!0},size:{gridWidth:2,gridHeight:2},makeNodes:()=>({outs:{Out:[[3,0,"e"]]}}),initialValue:()=>[!1]}),_i=class extends Ei{constructor(e,r){var i,s;super(e,[rn,void 0],r);this._period=(i=r==null?void 0:r.period)!=null?i:rn.aults.period,this._dutycycle=(r==null?void 0:r.dutycycle)!==void 0?r.dutycycle%100:rn.aults.dutycycle,this._phase=(r==null?void 0:r.phase)!==void 0?r.phase%this._period:rn.aults.phase,this._showLabel=(s=r==null?void 0:r.showLabel)!=null?s:rn.aults.showLabel,this.tickCallback()}get numBits(){return 1}toJSON(){return Y(k({},this.toJSONBase()),{period:this._period,dutycycle:this._dutycycle===rn.aults.dutycycle?void 0:this._dutycycle,phase:this._phase===rn.aults.phase?void 0:this._phase,showLabel:this._showLabel===rn.aults.showLabel?void 0:this._showLabel})}toStringDetails(){return`period=${this._period} duty=${this._dutycycle} phase=${this._phase}`}makeTooltip(){let e=x.Components.Clock.tooltip;return Q(e.title,q(e.period[0]+this._period+e.period[1],Jl,e.dutycycle[0]+this._dutycycle+e.dutycycle[1],this._phase===0?At:q(Jl,e.phase[0]+this._phase+e.phase[1])))}currentClockValue(e){let i=(e-this._phase)%this._period;i<0&&(i+=this._period);let s=this._period*this._dutycycle/100,a=this._period-s,u,l;i<s?(u=!0,l=i):(u=!1,l=i-s);let d=e-l+(u?s:a);return[u,d]}tickCallback(){let e=this.parent.timeline,[r,i]=this.currentClockValue(e.logicalTime());if(this.doSetValue([r]),this.state!==2){let s=x.Components.Clock.timeline,a=r?s.NextFallingEdge:s.NextRisingEdge;e.scheduleAt(i,()=>{this.tickCallback()},a,!0)}}doDraw(e,r){super.doDraw(e,r),this._showLabel&&r.inNonTransformedFrame(()=>{let a=this.orient==="s"?-36:26;e.strokeStyle=K,e.lineWidth=1;let u=this.posX-40/2,l=u+40*this._phase/this._period,p=l+40*this._dutycycle/100,d=this.posX+40/2,f=this.posY+a+10/2,m=this.posY+a-10/2;e.beginPath(),e.moveTo(u,f),e.lineTo(l,f),e.lineTo(l,m),e.lineTo(p,m),e.lineTo(p,f),e.lineTo(d,f),e.stroke(),e.fillStyle=K,e.textAlign="center",e.font="10px sans-serif";let h=this._period>=1e3?this._period/1e3+" s":this._period+" ms";e.fillText(h,this.posX,f+8)})}doSetPeriod(e){this._period=e,this.setNeedsRedraw("period changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.Clock.contextMenu,r=[[100,"100 ms (10 Hz)"],[250,"250 ms (4 Hz)"],[500,"500 ms (2 Hz)"],[1e3,"1 s (1 Hz)"],[2e3,"2 s (0.5 Hz)"],[4e3,"4 s (0.25 Hz)"],[8e3,"8 s (0.125 Hz)"],[16e3,"8 s (0.0625 Hz)"]],i=c(a=>{let[u,l]=a,d=this._period===u?"check":"none";return _.item(d,l,()=>this.doSetPeriod(u))},"makeItemSetPeriod"),s=_.item("replace",e.ReplaceWithInput,()=>{this.replaceWithComponent(Lt.make(this.parent,{bits:1}))});return[...super.makeComponentSpecificContextMenuItems(),["mid",_.sep()],["mid",_.submenu("timer",e.Period,r.map(i))],["mid",_.sep()],["mid",s]]}};c(_i,"Clock");rn.impl=_i;var Mi=ve("comp",{idPrefix:"comp",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:5,gridHeight:7},makeNodes:()=>({ins:{A:[-4,2,"w","A",{hasTriangle:!0}],B:[-4,-2,"w","B",{hasTriangle:!0}],E:[0,5,"s","E",{hasTriangle:!0}]},outs:{G:[4,0,"e",">",{hasTriangle:!0,labelName:">"}],Eq:[0,-5,"n","=",{hasTriangle:!0,labelName:"="}]}}),initialValue:()=>({g:!1,eq:!1})}),cu=class extends he{constructor(n,e){super(n,Mi,e)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.Comparator.tooltip;return Q(n.title,q(z(n.desc)))}doRecalcValue(){let n=this.inputs.A.value,e=this.inputs.B.value,r=this.inputs.E.value;if(U(n)||U(e)||U(r)||me(n)||me(e)||me(r))return{g:I,eq:I};if(+r==0)return{g:!1,eq:!1};let i=+n>+e,s=+n==+e;return{g:i,eq:s}}propagateValue(n){this.outputs.G.value=n.g,this.outputs.Eq.value=n.eq}doDraw(n,e){this.doDrawDefault(n,e,()=>{n.fillStyle=K,n.font="bold 11px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillText("CMP",this.posX,this.posY)})}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(cu,"Comparator");Mi.impl=cu;var Nd=ce(Me());var _r=ye("cnot-array",!0,!0,{variantName:({bits:o})=>`cnot-array-${o}`,idPrefix:"cnot",button:{imgWidth:50},repr:{bits:P(Nd.number)},valueDefaults:{},params:{bits:Ce(4,[2,4,8,16])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>({gridWidth:4,gridHeight:8+Math.max(0,o-8)}),makeNodes:({numBits:o,gridHeight:n})=>({ins:{In:ie("w",-3,0,o),S:[0,-(n/2+1),"n"]},outs:{Out:ie("e",3,0,o)}}),initialValue:(o,{numBits:n})=>$(!1,n)}),pu=class extends we{constructor(e,r,i){super(e,_r.with(r),i);this.numBits=r.numBits}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===_r.aults.bits?void 0:this.numBits})}makeTooltip(){let e=x.Components.ControlledInverter.tooltip;return Q(e.title,q(z(e.desc)))}doRecalcValue(){let e=this.inputValues(this.inputs.In),r=this.inputs.S.value;return U(r)||me(r)?$(I,this.numBits):r?e.map(Ue.invert):e}propagateValue(e){this.outputValues(this.outputs.Out,e)}doDraw(e,r){this.doDrawDefault(e,r,{skipLabels:!0,drawInside:({top:i,left:s,right:a})=>{let u=this.inputs.S.value;e.lineWidth=2,e.strokeStyle=Nt(u),e.beginPath(),e.moveTo(this.posX,i),e.lineTo(this.posX,this.posY-4),e.stroke(),e.strokeStyle=u===!0?K:ct,e.beginPath(),e.moveTo(s+12,this.posY-8),e.lineTo(a-13,this.posY),e.lineTo(s+12,this.posY+8),e.closePath(),e.stroke(),e.beginPath(),pn(e,a-10,this.posY,5),e.stroke()}})}makeComponentSpecificContextMenuItems(){return[this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}};c(pu,"ControlledInverter");_r.impl=pu;var Ri=ce(Me());var du=ce(Me());var Mn=ac({button:{imgWidth:50},repr:{state:P(Gr),showContent:P(du.boolean)},valueDefaults:{state:!1,showContent:!0},size:{gridWidth:5,gridHeight:7},makeNodes:()=>{let o=x.Components.Generic;return{outs:{Q:[4,-2,"e",o.OutputQDesc],Q\u0305:[4,2,"e",o.OutputQBarDesc]}}},initialValue:(o,n)=>{if(o===void 0)return[!1,!0];let e=o.state===void 0?n.state:Zn(o.state);return[e,Ue.invert(e)]}}),on=class extends he{constructor(e,r,i){var s;super(e,r,i);this._isInInvalidState=!1;this._showContent=(s=i==null?void 0:i.showContent)!=null?s:Mn.aults.showContent}toJSONBase(){let e=this.value[0];return Y(k({},super.toJSONBase()),{state:e!==Mn.aults.state?tt(e):void 0,showContent:this._showContent!==Mn.aults.showContent?this._showContent:void 0})}propagateValue(e){this.outputs.Q.value=e[0],this.outputs.Q\u0305.value=e[1]}doSetShowContent(e){this._showContent=e,this.setNeedsRedraw("show content changed")}doDraw(e,r){this.doDrawDefault(e,r,{background:this._isInInvalidState?Ua:void 0,drawLabels:()=>{this._showContent&&!this.parent.options.hideMemoryContent&&on.drawStoredValue(e,this.value[0],this.posX,this.posY,26,!1)}})}static drawStoredValueFrame(e,r,i,s,a,u){u&&([s,a]=[a,s]),e.strokeStyle=K,e.lineWidth=2,e.beginPath(),e.rect(r-s/2,i-a/2,s,a),e.fill(),e.stroke()}static drawStoredValue(e,r,i,s,a,u){e.fillStyle=Nt(r),on.drawStoredValueFrame(e,i,s,20,a,u),Io(e,r,i,s,{small:a<18})}};c(on,"FlipflopOrLatch");var qn=ac({button:Mn.button,repr:Y(k({},Mn.repr),{trigger:P(du.keyof($e))}),valueDefaults:Y(k({},Mn.valueDefaults),{trigger:$e.rising}),size:Mn.size,makeNodes:o=>{let n=Mn.makeNodes(),e=x.Components.Generic;return{ins:{Clock:[-4,o,"w",e.InputClockDesc,{isClock:!0}],Pre:[0,-4,"n",e.InputPresetDesc,{prefersSpike:!0}],Clr:[0,4,"s",e.InputClearDesc,{prefersSpike:!0}]},outs:n.outs}},initialValue:Mn.initialValue}),pt=class extends on{constructor(e,r,i){var s;super(e,r,i);this._lastClock=I;this._trigger=(s=i==null?void 0:i.trigger)!=null?s:qn.aults.trigger}toJSONBase(){return Y(k({},super.toJSONBase()),{trigger:this._trigger!==qn.aults.trigger?this._trigger:void 0})}get trigger(){return this._trigger}static doRecalcValueForSyncComponent(e,r,i,s,a){return s===!0?a===!0?{isInInvalidState:!0,newState:e.makeInvalidState()}:{isInInvalidState:!1,newState:e.makeStateFromMainValue(!0)}:a===!0?{isInInvalidState:!1,newState:e.makeStateFromMainValue(!1)}:pt.isClockTrigger(e.trigger,r,i)?{isInInvalidState:!1,newState:e.makeStateAfterClock()}:{isInInvalidState:!1,newState:e.value}}static isClockTrigger(e,r,i){return e===$e.rising&&r===!1&&i===!0||e===$e.falling&&r===!0&&i===!1}doRecalcValue(){let e=this._lastClock,r=this._lastClock=this.inputs.Clock.value,{isInInvalidState:i,newState:s}=pt.doRecalcValueForSyncComponent(this,e,r,this.inputs.Pre.value,this.inputs.Clr.value);return this._isInInvalidState=i,s}makeInvalidState(){return[!1,!1]}makeStateFromMainValue(e){return[e,Ue.invert(e)]}makeStateAfterClock(){return this.makeStateFromMainValue(Ue.filterHighZ(this.doRecalcValueAfterClock()))}doSetTrigger(e){this._trigger=e,this.setNeedsRedraw("trigger changed")}makeComponentSpecificContextMenuItems(){let e=this._showContent?"check":"none",r=_.item(e,x.Components.Generic.contextMenu.ShowContent,()=>this.doSetShowContent(!this._showContent));return[...Mr(this._trigger,this.doSetTrigger.bind(this)),["mid",_.sep()],["mid",r],...this.makeForceOutputsContextMenuItem(!0)]}};c(pt,"Flipflop");function Mr(o,n){let e=x.Components.Generic.contextMenu,r=c((i,s)=>{let a=o===i,u=a?"check":"none",l=e.TriggerOn+" "+s,p=a?()=>{}:()=>n(i);return _.item(u,l,p)},"makeTriggerItem");return[["mid",r($e.rising,e.TriggerRisingEdge)],["mid",r($e.falling,e.TriggerFallingEdge)]]}c(Mr,"makeTriggerItems");var Xn=ye("counter",!0,!0,{variantName:({bits:o})=>`counter-${o}`,idPrefix:"counter",button:{imgWidth:50},repr:{bits:P(Ri.number),count:P(Ri.number),trigger:P(Ri.keyof($e)),displayRadix:P(X0(Ri.number))},valueDefaults:{trigger:$e.rising,displayRadix:10},params:{bits:Ce(4,[2,3,4,7,8,16])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>({gridWidth:o<=6?5:o<=8?6:7,gridHeight:Math.max(11,1+(o+1)*(Je(o)?1:2))}),makeNodes:({numBits:o,gridWidth:n,gridHeight:e})=>{let r=x.Components.Generic,i=1+n/2,s=ie("e",i,-1,o),a=s[o-1][1],u=a-s[o-2][1],l=a+u,p=(e+1)/2;return{ins:{Clock:[-i,l,"w",r.InputClockDesc,{isClock:!0}],Clr:[0,p,"s",r.InputClearDesc,{prefersSpike:!0}]},outs:{Q:s,V:[i,l,"e","V (oVerflow)"]}}},initialValue:(o,{numBits:n})=>o===void 0||o.count===void 0?Yn.emptyValue(n):[Yn.decimalToNBits(o.count,n),!1]}),Yn=class extends we{constructor(e,r,i){var s;super(e,Xn.with(r),i);this._lastClock=I;this.numBits=r.numBits,this._trigger=(s=i==null?void 0:i.trigger)!=null?s:Xn.aults.trigger,this._displayRadix=(i==null?void 0:i.displayRadix)===void 0?Xn.aults.displayRadix:i.displayRadix===null?void 0:i.displayRadix}static emptyValue(e){return[$(!1,e),!1]}static decimalToNBits(e,r){let i=e.toString(2).padStart(r,"0"),s=$(!1,r);for(let a=0;a<r;a++)s[a]=i[r-a-1]==="1";return s}toJSON(){let[e,r]=Oe(this.value[0],!1),i=U(r)?0:r,s=this._displayRadix===void 0?null:this._displayRadix;return Y(k({},this.toJSONBase()),{bits:this.numBits===Xn.aults.bits?void 0:this.numBits,count:i===0?void 0:i,trigger:this._trigger!==Xn.aults.trigger?this._trigger:void 0,displayRadix:s!==Xn.aults.displayRadix?s:void 0})}get trigger(){return this._trigger}makeTooltip(){let e=x.Components.Counter.tooltip;return Q(e.title,q(z(e.desc)))}doRecalcValue(){if(this.inputs.Clr.value===!0)return Yn.emptyValue(this.numBits);let r=this._lastClock,i=this._lastClock=this.inputs.Clock.value,s=this._trigger===$e.rising;if(pt.isClockTrigger(this._trigger,r,i)){let[a,u]=Oe(this.value[0],!1);if(U(u))return[$(I,this.numBits),I];let l=u+1;return l>=Math.pow(2,this.numBits)?[$(!1,this.numBits),s]:[Yn.decimalToNBits(l,this.numBits),!s]}else return[this.value[0],!s]}propagateValue(e){let[r,i]=e;this.outputValues(this.outputs.Q,r),this.outputs.V.value=i}doSetTrigger(e){this._trigger=e,this.setNeedsRedraw("trigger changed")}doDraw(e,r){this.doDrawDefault(e,r,(i,{width:s})=>{if(this._displayRadix!==void 0){e.font="bold 20px sans-serif";let[a,u]=Oe(this.value[0],!1),l=Zr(u,this._displayRadix,this.numBits,!1),p=10,d=i.rotatePoint(this.posX-p/2,this.outputs.Q.group.posYInParentTransform);e.fillStyle=Ci;let f=s-p-12;on.drawStoredValueFrame(e,...d,f,28,!1),e.textAlign="center",e.textBaseline="middle",e.fillStyle=Bo,e.fillText(l,...d)}})}doSetDisplayRadix(e){this._displayRadix=e,this.setNeedsRedraw("display radix changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.Counter.contextMenu,r=c((i,s)=>{let a=this._displayRadix===i?"check":"none",u=e.DisplayTempl.expand({desc:s}),l=c(()=>this.doSetDisplayRadix(i),"action");return _.item(a,u,l)},"makeItemShowRadix");return[...Mr(this._trigger,this.doSetTrigger.bind(this)),["mid",_.sep()],["mid",r(void 0,e.DisplayNone)],["mid",r(10,e.DisplayDecimal)],["mid",r(16,e.DisplayHex)],["mid",_.sep()],this.makeChangeParamsContextMenuItem("outputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}};c(Yn,"Counter");Xn.impl=Yn;var sn=ce(Me());var oo={Background:0,Normal:1,Overlay:2},Ho=class{constructor(){this._componentsByZIndex=wt(()=>[],3);this._componentsById=new Map}*all(){for(let n of this._componentsByZIndex)for(let e of n)yield e}*allInReversedZIndexOrder(){for(let n=this._componentsByZIndex.length-1;n>=0;n--){let e=this._componentsByZIndex[n];for(let r of e)yield r}}*withZIndex(n){for(let e of this._componentsByZIndex[n])yield e}add(n){let e=n.drawZIndex;this._componentsByZIndex[e].push(n);let r=n.ref,i;if(r===void 0)r=this.generateIdFor(n),n.doSetValidatedId(r);else if((i=this._componentsById.get(r))!==void 0){console.error(`Component with id '${r}' already exists and will be renamed`);let s=this.generateIdFor(i);i.doSetValidatedId(s),this._componentsById.set(s,i)}this._componentsById.set(r,n)}contains(n){for(let e of this.all())if(e.def.type===n)return!0;return!1}updateCustomComponents(n){for(let e of[...this.all()])e.def.type===n&&e instanceof Rr&&e.updateFromDef()}changeIdOf(n,e){let r=n.ref;if(r!==void 0&&(this._componentsById.delete(r)||console.warn(`Component with id '${r}' not found`)),this._componentsById.has(e))throw new Error(`Component with id '${e}' already exists`);n.doSetValidatedId(e),this._componentsById.set(e,n)}swapIdsOf(n,e){let r=n.ref,i=e.ref;if(r===void 0||i===void 0)throw new Error("Cannot swap ids of components without ids");n.doSetValidatedId(i),e.doSetValidatedId(r),this._componentsById.set(r,e),this._componentsById.set(i,n)}get(n){return this._componentsById.get(n)}generateIdFor(n){let e=n.def.idPrefix,r=Re(e)?e:e(n),i=0,s;for(;this._componentsById.has(s=`${r}${i}`);)i++;return s}tryDelete(n){return this.tryDeleteWhere(e=>e===n,!0)>0}tryDeleteWhere(n,e){let r=[];e:for(let i of this._componentsByZIndex)for(let s=0;s<i.length;s++){let a=i[s];if(n(a)&&(a.destroy(),i.splice(s,1),r.push(a),e))break e}for(let i of r){let s=i.ref;s===void 0?console.warn("Removing component without id"):this._componentsById.has(s)?this._componentsById.delete(s):console.warn(`Removing component with id '${s}' but no component with that id exists`)}return r.length}clearAll(){for(let n of this._componentsByZIndex)n.splice(0,n.length);this._componentsById.clear()}};c(Ho,"ComponentList");var Wo=class{constructor(){this.lastGivenNodeID=-1;this.usedIDs=new Set;this.allLiveNodes=[]}newID(){for(;this.usedIDs.has(++this.lastGivenNodeID););return this.usedIDs.add(this.lastGivenNodeID),this.lastGivenNodeID}markIDUsed(n){this.usedIDs.has(n)&&console.error(`Loaded node with id ${n}, which is already taken`),this.usedIDs.add(n)}addLiveNode(n){this.usedIDs.has(n.id)||console.error(`Inserting live node with unreserved id ${n.id}`),this.allLiveNodes[n.id]=n}removeLiveNode(n){delete this.allLiveNodes[n.id],this.usedIDs.delete(n.id)}clearAllLiveNodes(){this.allLiveNodes.splice(0,this.allLiveNodes.length),this.usedIDs.clear(),this.lastGivenNodeID=-1}findNode(n){return this.allLiveNodes[n]}tryConnectNodesOf(n){let e=n.parent.wireMgr,r=[];for(let i of n.allNodes())if(i.acceptsMoreConnections){let s=i.posX,a=i.posY,u=i.component;for(let l of this.allLiveNodes)l!==void 0&&l.component!==u&&l.acceptsMoreConnections&&l.posX===s&&l.posY===a&&(e.startDraggingFrom(i),e.stopDraggingOn(l)!==void 0&&r.push([i,l.component,l]))}return r}};c(Wo,"NodeManager");var Ps=class{constructor(){this._canvasRedrawReasons={};this._isEmpty=!0}addReason(n,e){let r=e,i=this._canvasRedrawReasons[n];i===void 0?this._canvasRedrawReasons[n]=[r]:i.push(r),this._isEmpty=!1}getReasonsAndClear(){var e,r;if(this._isEmpty)return;let n=[];for(let i of Object.keys(this._canvasRedrawReasons)){n.push(i);let s=this._canvasRedrawReasons[i];n.push(" (",String(s.length),"\xD7)",": ");for(let a of s)if(a!==null){let u=a;n.push((r=(e=u.constructor)==null?void 0:e.name)!=null?r:"Component"),u.type!==void 0&&n.push("_",u.type),u.name!==void 0&&n.push("('",u.name,"')"),n.push("; ")}n.pop(),n.push(`
    `)}return n.pop(),this._canvasRedrawReasons={},this._isEmpty=!0,n.join("")}hasReasons(){return!this._isEmpty}};c(Ps,"RedrawManager");var Go=class{constructor(){this._propagateQueue=[];this._recalcQueue=[];this.debug=!1}enqueueForPropagate(n){this._propagateQueue.push(n),this.log("Enqueued for propagate: "+n)}enqueueForRecalc(n,e){this._recalcQueue.push([n,e]),this.log("Enqueued for recalc: "+n)}queueIsEmpty(){return this._propagateQueue.length===0&&this._recalcQueue.length===0}recalcAndPropagateIfNeeded(){return this.queueIsEmpty()?!1:(this.recalcAndPropagate(),!0)}recalcAndPropagate(){let n=0,e=1e3;do{if(n++,n>=e){console.warn(`ERROR: Circular dependency; suspending updates after ${e} recalc/propagate rounds`);for(let s of[...this._propagateQueue,...this._recalcQueue.map(a=>a[0])])s.setInvalid();this._propagateQueue=[],this._recalcQueue=[];break}this.log(`Recalc/propagate round ${n}: ${this._propagateQueue.length} propagate, ${this._recalcQueue.length} recalc.`);let r=this._propagateQueue;this._propagateQueue=[],this.log(`  PROPAG (${r.length}) \u2013 `+r.map(s=>s.toString()).join("; "));for(let s of r)try{s.propagateCurrentValue()}catch(a){console.error("Error while propagating value of "+s,a),s.setInvalid()}let i=this._recalcQueue;this._recalcQueue=[],this.log(`  RECALC (${i.length}) \u2013 `+i.map(s=>s.toString()).join("; "));for(let[s,a]of i)try{s.recalcValue(a)}catch(u){console.error("Error while recalculating value of "+s,u),s.setInvalid()}}while(!this.queueIsEmpty());this.log(`Recalc/propagate done in ${n} rounds.`)}log(n){this.debug&&console.log(n)}};c(Go,"RecalcManager");var ir=class{constructor(n,e){this.strokeStyle="#000000";this.fillStyle="#000000";this.lineCap="butt";this.lineJoin="miter";this.miterLimit=10;this.lineWidth=1;this.globalAlpha=1;this.font="10px sans-serif";this.shadowColor="#000000";this.shadowOffsetX=0;this.shadowOffsetY=0;this.shadowBlur=0;this.textAlign="start";this.textBaseline="alphabetic";this.lineDash=null;this.fontUnderline="";this._groupStack=[];this._transformMatrixStack=[];this._currentPath=new Uo(this);this._transformMatrix=new DOMMatrix;var i,s,a,u;let r;if(e!==void 0?r={width:n,height:e}:n!==void 0?r=n:r={},this.width=(i=r.width)!=null?i:500,this.height=(s=r.height)!=null?s:500,this.enableMirroring=(a=r.enableMirroring)!=null?a:!1,this.canvas=this,this._document=(u=r.document)!=null?u:document,r.ctx?this._g=r.ctx:(this._helperCanvas=this._document.createElement("canvas"),this._g=this._helperCanvas.getContext("2d")),this._styleStack=[this._getStyleState()],this._svg=this._document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.setAttribute("version","1.1"),this._svg.setAttribute("xmlns","http://www.w3.org/2000/svg"),this._svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this._svg.setAttribute("width",String(this.width)),this._svg.setAttribute("height",String(this.height)),this._ids={},r.metadata!==void 0){let l=this._document.createElementNS("http://www.w3.org/2000/svg","metadata"),p=this._document.createTextNode(r.metadata);l.appendChild(p),this._svg.appendChild(l)}this._defs=this._document.createElementNS("http://www.w3.org/2000/svg","defs"),this._svg.appendChild(this._defs),this._currentElement=this._document.createElementNS("http://www.w3.org/2000/svg","g"),this._svg.appendChild(this._currentElement),this.resetTransform()}_createElement(n,e,r=!1){let i=this._document.createElementNS("http://www.w3.org/2000/svg",n);if(r&&(i.setAttribute("fill","none"),i.setAttribute("stroke","none")),e!==void 0)for(let[s,a]of Object.entries(e))i.setAttribute(s,String(a));return i}_closestGroupOrSvg(n){return n=n!=null?n:this._currentElement,n.nodeName==="g"||n.nodeName==="svg"?n:this._closestGroupOrSvg(n.parentNode)}_applyStyleState(n){for(let[e,r]of Object.entries(n))this[e]=r}_getStyleState(){let n={};for(let e of Object.keys(Fd))n[e]=this[e];return n}_applyTransformation(n,e){let{a:r,b:i,c:s,d:a,e:u,f:l}=e!=null?e:this.getTransform();r===1&&i===0&&s===0&&a===1&&u===0&&l===0||n.setAttribute("transform",`matrix(${r} ${i} ${s} ${a} ${u} ${l})`)}_applyStyleToElement(n,e){for(let[r,i]of Object.entries(Fd)){let s=this[r];if("apply"in i&&i.apply){if(s instanceof ks){for(let a of s._ctx._defs.children){let u=a.getAttribute("id");this._ids[u]=u,this._defs.appendChild(a)}n.setAttribute(i.apply,`url(#${s.patternElem.getAttribute("id")})`)}else if(s instanceof Oi)n.setAttribute(i.apply,`url(#${s.gradientElem.getAttribute("id")})`);else if(i.apply.indexOf(e)!==-1&&i.svg!==s)if((i.svgAttr==="stroke"||i.svgAttr==="fill")&&s.indexOf("rgba")!==-1){let u=/rgba\(\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(s);n.setAttribute(i.svgAttr,`rgb(${u[1]},${u[2]},${u[3]})`);let l=parseFloat(u[4])*this.globalAlpha;n.setAttribute(i.svgAttr+"-opacity",String(l))}else{let a=i.svgAttr;if(r==="globalAlpha"){if(a=e+"-"+i.svgAttr,n.getAttribute(a)!==null)continue}else if(r==="lineWidth"){let u=this._getTransformScale();s=s*Math.max(u.x,u.y)}n.setAttribute(a,s)}}}}getSerializedSvg(n=!1){let e=new XMLSerializer().serializeToString(this._svg);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(e)&&(e=e.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),n)for(let[i,s]of Object.entries(V3)){let a=new RegExp(i,"gi");a.test(e)&&(e=e.replace(a,s))}return e}getSvg(){return this._svg}beginGroup(n){let e=this._createElement("g");n!==void 0&&e.setAttribute("class",n);let r=this._closestGroupOrSvg();this._groupStack.push(r),r.appendChild(e),this._currentElement=e}endGroup(){var n;this._currentElement=(n=this._groupStack.pop())!=null?n:this._svg.children[1]}save(){this.beginGroup(void 0),this._styleStack.push(this._getStyleState()),this._transformMatrixStack.push(this.getTransform())}restore(){this.endGroup(),this._applyStyleState(this._styleStack.pop()),this.setTransform(this._transformMatrixStack.pop())}_createPathElement(){let n=this._createElement("path",{},!0);return this._closestGroupOrSvg().appendChild(n),n}beginPath(){this._currentPath=new Uo(this)}closePath(){this._currentPath.closePath()}moveTo(n,e){this._currentPath.moveTo(n,e)}lineTo(n,e){this._currentPath.lineTo(n,e)}rect(n,e,r,i){this._currentPath.rect(n,e,r,i)}bezierCurveTo(n,e,r,i,s,a){this._currentPath.bezierCurveTo(n,e,r,i,s,a)}quadraticCurveTo(n,e,r,i){this._currentPath.quadraticCurveTo(n,e,r,i)}arc(n,e,r,i,s,a=!1){this._currentPath.arc(n,e,r,i,s,a)}arcTo(n,e,r,i,s){this._currentPath.arcTo(n,e,r,i,s)}ellipse(n,e,r,i,s,a,u,l=!1){this._currentPath.ellipse(n,e,r,i,s,a,u,l)}stroke(n){this._strokeOrFill("stroke",n)}fill(n){this._strokeOrFill("fill",n)}_strokeOrFill(n,e){let r;if(e){if(!(e instanceof Uo))throw new Error("Path2D is not a Path2DSVG");r=e}else r=this._currentPath;let i=this._createPathElement();this._applyStyleToElement(i,n),i.setAttribute("paint-order","fill stroke markers"),i.setAttribute("d",r.d)}fillRect(n,e,r,i){let{a:s,b:a,c:u,d:l,e:p,f:d}=this.getTransform();s===1&&a===0&&u===0&&l===1&&p===0&&d===0&&n===0&&e===0&&r===this.width&&i===this.height&&this._clearCanvas();let f=this._createElement("rect",{x:n,y:e,width:r,height:i},!0);this._closestGroupOrSvg().appendChild(f),this._currentElement=f,this._applyTransformation(f),this._applyStyleToElement(this._currentElement,"fill")}strokeRect(n,e,r,i){let s=this._createElement("rect",{x:n,y:e,width:r,height:i},!0);this._closestGroupOrSvg().appendChild(s),this._currentElement=s,this._applyTransformation(s),this._applyStyleToElement(this._currentElement,"stroke")}_clearCanvas(){let n=this._svg.children[1];this._svg.removeChild(n),this._currentElement=this._document.createElementNS("http://www.w3.org/2000/svg","g"),this._svg.appendChild(this._currentElement),this._groupStack.splice(0,this._groupStack.length)}clearRect(n,e,r,i){let{a:s,b:a,c:u,d:l,e:p,f:d}=this.getTransform();if(s===1&&a===0&&u===0&&l===1&&p===0&&d===0&&n===0&&e===0&&r===this.width&&i===this.height){this._clearCanvas();return}let f=this._closestGroupOrSvg(),m=this._createElement("rect",{x:n,y:e,width:r,height:i,fill:"#FFFFFF"},!0);this._applyTransformation(m),f.appendChild(m)}setLineDash(n){n&&n.length>0?this.lineDash=n.join(","):this.lineDash=null}getLineDash(){return this.lineDash===null?[]:this.lineDash.split(",").map(n=>parseFloat(n))}clip(n){let e=this._closestGroupOrSvg(),r=this._createElement("clipPath"),i=fu(this._ids),s=this._createPathElement();s.setAttribute("d",this._currentPath.d),r.setAttribute("id",i),n!==void 0&&r.setAttribute("clip-rule",n),r.appendChild(s),this._defs.appendChild(r),e.setAttribute("clip-path",`url(#${i})`),this._currentElement=e}drawImage(){let n=Array.prototype.slice.call(arguments),e=n[0],r,i,s,a,u=0,l=0,p,d;if(n.length===3)r=n[1],i=n[2],p=e.width,d=e.height,s=p,a=d;else if(n.length===5)r=n[1],i=n[2],s=n[3],a=n[4],p=e.width,d=e.height;else if(n.length===9)u=n[1],l=n[2],p=n[3],d=n[4],r=n[5],i=n[6],s=n[7],a=n[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);let f=this._closestGroupOrSvg(),m=this.getTransform().translate(r,i);if(e instanceof ir){let h=e.getSvg().cloneNode(!0);if(h.childNodes.length>1){let v=h.childNodes[0];for(;v.childNodes.length;){let b=v.childNodes[0].getAttribute("id");this._ids[b]=b,this._defs.appendChild(v.childNodes[0])}let D=h.children[1];D!==void 0&&(this._applyTransformation(D,m),f.appendChild(D))}}else if(e.nodeName==="CANVAS"||e.nodeName==="IMG"){let h=this._createElement("image");if(h.setAttribute("width",String(s)),h.setAttribute("height",String(a)),h.setAttribute("preserveAspectRatio","none"),u||l||p!==e.width||d!==e.height){let v=this._document.createElement("canvas");v.width=s,v.height=a,v.getContext("2d").drawImage(e,u,l,p,d,0,0,s,a),e=v}this._applyTransformation(h,m),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),f.appendChild(h)}}_applyText(n,e,r,i){let s=document.createElement("span");s.setAttribute("style","font:"+this.font);let a=s.style,u=this._closestGroupOrSvg(),l=this._createElement("text",{"font-family":a.fontFamily,"font-size":a.fontSize,"font-style":a.fontStyle,"font-weight":a.fontWeight,"text-decoration":this.fontUnderline,x:e,y:r,"text-anchor":I3(this.textAlign),"dominant-baseline":P3(this.textBaseline)},!0);if(l.appendChild(this._document.createTextNode(n)),this._currentElement=l,this._applyTransformation(l),this._applyStyleToElement(this._currentElement,i),this.fontHref!==void 0){let p=this._createElement("a");p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",this.fontHref),p.appendChild(l),u.appendChild(p)}else u.appendChild(l)}fillText(n,e,r){this._applyText(n,e,r,"fill")}strokeText(n,e,r){this._applyText(n,e,r,"stroke")}measureText(n){return this._g.font=this.font,this._g.measureText(n)}createPath(n){return new Uo(this,n)}createLinearGradient(n,e,r,i){let s=this._createElement("linearGradient",{id:fu(this._ids),x1:n+"px",x2:r+"px",y1:e+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(s),new Oi(s,this)}createRadialGradient(n,e,r,i,s,a){let u=this._createElement("radialGradient",{id:fu(this._ids),cx:i+"px",cy:s+"px",r:a+"px",fx:n+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this._defs.appendChild(u),new Oi(u,this)}createPattern(n,e){let r=this._document.createElementNS("http://www.w3.org/2000/svg","pattern"),i=fu(this._ids);if(r.setAttribute("id",i),r.setAttribute("width",String(n.width)),r.setAttribute("height",String(n.height)),r.setAttribute("patternUnits","userSpaceOnUse"),"nodeName"in n&&(n.nodeName==="CANVAS"||n.nodeName==="IMG")){let s=this._document.createElementNS("http://www.w3.org/2000/svg","image");s.setAttribute("width",String(n.width)),s.setAttribute("height",String(n.height)),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n.nodeName==="CANVAS"?n.toDataURL():n.getAttribute("src")),r.appendChild(s),this._defs.appendChild(r)}else n instanceof ir&&(r.appendChild(n._svg.children[1]),this._defs.appendChild(r));return new ks(r,this)}setTransform(n,e,r,i,s,a){if(e===void 0){let u=n;this._transformMatrix=new DOMMatrix([u.a,u.b,u.c,u.d,u.e,u.f])}else{let u=n;this._transformMatrix=new DOMMatrix([u,e,r,i,s,a])}}getTransform(){let{a:n,b:e,c:r,d:i,e:s,f:a}=this._transformMatrix;return new DOMMatrix([n,e,r,i,s,a])}resetTransform(){this.setTransform(1,0,0,1,0,0)}transform(n,e,r,i,s,a){let u=this.getTransform().multiply(new DOMMatrix([n,e,r,i,s,a]));this.setTransform(u)}scale(n,e){if(e===void 0&&(e=n),isNaN(n)||isNaN(e)||!isFinite(n)||!isFinite(e))return;let r=this.getTransform().scale(n,e);this.setTransform(r)}rotate(n){let e=this.getTransform().multiply(new DOMMatrix([Math.cos(n),Math.sin(n),-Math.sin(n),Math.cos(n),0,0]));this.setTransform(e)}translate(n,e){let r=this.getTransform().translate(n,e);this.setTransform(r)}_matrixTransform(n,e){let{a:r,b:i,c:s,d:a,e:u,f:l}=this._transformMatrix,p=r*n+s*e+u,d=i*n+a*e+l;return[p,d]}_getTransformScale(){return{x:Math.hypot(this._transformMatrix.a,this._transformMatrix.b),y:Math.hypot(this._transformMatrix.c,this._transformMatrix.d)}}_getTransformRotation(){return Math.atan2(this._transformMatrix.b,this._transformMatrix.a)}};c(ir,"SVGRenderingContext");var Uo=class{constructor(n,e){this._posX=void 0;this._posY=void 0;this.g=n,e===void 0?(this._parts=[],this._hasMoved=!1):Re(e)?(this._parts=[e],this._hasMoved=e.indexOf("M")>=0):(this._parts=[...e._parts],this._hasMoved=this._parts.some(r=>r.indexOf("M")>=0))}get d(){return this._parts.join(" ")}addPath(n,e){e&&console.error("transform argument to addPath is not supported"),this._parts.push(n),this._hasMoved||(this._hasMoved=n.indexOf("M")>=0)}closePath(){this.addPath("Z")}moveTo(n,e){this._posX=n,this._posY=e;let[r,i]=this.g._matrixTransform(n,e);this.addPath(`M ${r} ${i}`)}lineTo(n,e){this._posX=n,this._posY=e;let r=this._hasMoved?"L":"M",[i,s]=this.g._matrixTransform(n,e);this.addPath(`${r} ${i} ${s}`)}bezierCurveTo(n,e,r,i,s,a){this._posX=s,this._posY=a;let u=this.g,[l,p]=u._matrixTransform(n,e),[d,f]=u._matrixTransform(r,i),[m,h]=u._matrixTransform(s,a);this.addPath(`C ${l} ${p} ${d} ${f} ${m} ${h}`)}quadraticCurveTo(n,e,r,i){this._posX=r,this._posY=i;let s=this.g,[a,u]=s._matrixTransform(n,e),[l,p]=s._matrixTransform(r,i);this.addPath(`Q ${a} ${u} ${l} ${p}`)}rect(n,e,r,i){this.moveTo(n,e),this.lineTo(n+r,e),this.lineTo(n+r,e+i),this.lineTo(n,e+i),this.closePath()}arc(n,e,r,i,s,a=!1){if(i===s)return;let u=this.g;i=i%(2*Math.PI),s=s%(2*Math.PI),i===s&&(s=(s+2*Math.PI-.001*(a?-1:1))%(2*Math.PI));let l=n+r*Math.cos(s),p=e+r*Math.sin(s),d=n+r*Math.cos(i),f=e+r*Math.sin(i),m=a?0:1,h=0,v=s-i;v<0&&(v+=2*Math.PI),a?h=v>Math.PI?0:1:h=v>Math.PI?1:0;let D=Math.hypot(u._transformMatrix.a,u._transformMatrix.b),b=Math.hypot(u._transformMatrix.c,u._transformMatrix.d);this.lineTo(d,f);let[C,A]=u._matrixTransform(l,p);this.addPath(`A ${r*D} ${r*b} 0 ${h} ${m} ${C} ${A}`),this._posX=n,this._posY=e}arcTo(n,e,r,i,s){let a=this._posX,u=this._posY;if(a===void 0||u===void 0)return;if(s<0)throw new Error("IndexSizeError: The radius provided ("+s+") is negative.");if(a===n&&u===e||n===r&&e===i||s===0){this.lineTo(n,e);return}let l=[a-n,u-e],p=[r-n,i-e],d=Math.hypot(l[0],l[1]),f=Math.hypot(p[0],p[1]),m=(l[0]*p[0]+l[1]*p[1])/(d*f);if(m===-1){this.lineTo(n,e);return}if(m===1){let ae=65535/d,oe=[a+ae*l[0],u+ae*l[1]];this.lineTo(oe[0],oe[1]);return}let h=s/Math.tan(Math.acos(m)/2),v=h/d,D=[n+v*l[0],e+v*l[1]],b=[l[1],-l[0]],C=Math.hypot(b[0],b[1]),A=s/C;(b[0]*p[0]+b[1]*p[1])/(C*f)<0&&(b=[-b[0],-b[1]]);let w=[D[0]+A*b[0],D[1]+A*b[1]];b=[-b[0],-b[1]];let T=Math.acos(b[0]/C);b[1]<0&&(T=2*Math.PI-T);let R=!1,S=h/f,F=[n+S*p[0],e+S*p[1]],O=[F[0]-w[0],F[1]-w[1]],L=Math.hypot(O[0],O[1]),W=Math.acos(O[0]/L);O[1]<0&&(W=2*Math.PI-W),T>W&&T-W<Math.PI&&(R=!0),T<W&&W-T>Math.PI&&(R=!0),this.lineTo(D[0],D[1]),this.arc(w[0],w[1],s,T,W,R)}ellipse(n,e,r,i,s,a,u,l=!1){if(a===u)return;let p=this.g;[n,e]=p._matrixTransform(n,e);let d=p._getTransformScale();r=r*d.x,i=i*d.y,s=s+p._getTransformRotation(),a=a%(2*Math.PI),u=u%(2*Math.PI),a===u&&(u=(u+2*Math.PI-.001*(l?-1:1))%(2*Math.PI));let f=n+Math.cos(-s)*r*Math.cos(u)+Math.sin(-s)*i*Math.sin(u),m=e-Math.sin(-s)*r*Math.cos(u)+Math.cos(-s)*i*Math.sin(u),h=n+Math.cos(-s)*r*Math.cos(a)+Math.sin(-s)*i*Math.sin(a),v=e-Math.sin(-s)*r*Math.cos(a)+Math.cos(-s)*i*Math.sin(a),D=l?0:1,b=0,C=u-a;C<0&&(C+=2*Math.PI),l?b=C>Math.PI?0:1:b=C>Math.PI?1:0;let A=p._transformMatrix;p.resetTransform(),this.lineTo(h,v),p._transformMatrix=A,this.addPath(`A ${r} ${i} ${s*(180/Math.PI)} ${b} ${D} ${f} ${m}`),this._posX=f,this._posY=m}};c(Uo,"Path2DSVG");var Oi=class{constructor(n,e){this.gradientElem=n;this._ctx=e}addColorStop(n,e){let r=this._ctx._createElement("stop");if(r.setAttribute("offset",String(n)),e.indexOf("rgba")!==-1){let s=/rgba\(\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(e);s?(r.setAttribute("stop-color",`rgb(${s[1]},${s[2]},${s[3]})`),r.setAttribute("stop-opacity",s[4])):r.setAttribute("stop-color",e)}else r.setAttribute("stop-color",e);this.gradientElem.appendChild(r)}};c(Oi,"CanvasGradientSVG");var ks=class{constructor(n,e){this.patternElem=n;this._ctx=e}};c(ks,"CanvasPatternSVG");function fu(o){if(!o)throw new Error("cannot create a random attribute name for an undefined object");let n="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",e="";do{e="";for(let r=0;r<12;r++)e+=n[Math.floor(Math.random()*n.length)]}while(o[e]!==void 0);return e}c(fu,"randomString");var Fd={strokeStyle:{svgAttr:"stroke",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",svg:1,apply:"fill stroke"},lineDash:{svgAttr:"stroke-dasharray",svg:null,apply:"stroke"}},Bd={left:"start",right:"end",center:"middle",start:"start",end:"end"};function I3(o){var n;return(n=Bd[o])!=null?n:Bd.start}c(I3,"getTextAnchor");var Id={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};function P3(o){var n;return(n=Id[o])!=null?n:Id.alphabetic}c(P3,"getDominantBaseline");function k3(o,n){let e={},r=o.split(",");n=n!=null?n:10;for(let i=0;i<r.length;i+=2){let s="&"+r[i+1]+";",a=parseInt(r[i],n);e[s]="&#"+a+";"}return e["\\xa0"]="&#160;",e}c(k3,"createNamedToNumberedLookup");var V3=k3("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var Pd=ce(Me());var Or=ye("out",!0,!1,{variantName:({bits:o})=>`out-${o}`,idPrefix:"out",button:{imgWidth:32},repr:{bits:P(Pd.number),name:Ot},valueDefaults:{},params:Lt.paramDefs,validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>{if(o===1){let n=dn/H;return{gridWidth:n,gridHeight:n}}return{gridWidth:2,gridHeight:Je(o)?o:2*o}},makeNodes:({numBits:o})=>({ins:{In:ie("w",o===1?-3:-2,0,o)}}),initialValue:(o,{numBits:n})=>$(!1,n)}),io=class extends we{constructor(e,r,i){var s;super(e,Or.with(r),i);this.numBits=r.numBits,this._name=(s=i==null?void 0:i.name)!=null?s:void 0}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===Or.aults.bits?void 0:this.numBits,name:this._name})}isOver(e,r){return this.numBits===1?this.parent.mode>=2&&Un(e,r,this.posX,this.posY)<dn/2:super.isOver(e,r)}get name(){return this._name}makeTooltip(){let e=x.Components.Output.tooltip;return Q(void 0,q(e.title.expand({numBits:this.numBits})))}doRecalcValue(){return this.inputValues(this.inputs.In)}doDraw(e,r){this.numBits===1?this.doDrawSingle(e,r,this.inputs.In[0]):this.doDrawMulti(e,r,this.inputs.In)}doDrawSingle(e,r,i){Ae(e,i,this.posX,this.posY),e.strokeStyle=r.borderColor,e.fillStyle=r.borderColor,e.beginPath(),jr(e,this.posX-dn/2-5,this.posY-5,this.posX-dn/2-5,this.posY+5,this.posX-dn/2-1,this.posY),e.fill(),e.stroke();let s=this.parent.options.hideOutputColors?I:i.value;e.fillStyle=Nt(s),e.lineWidth=4,e.beginPath(),pn(e,this.posX,this.posY,dn),e.fill(),e.stroke(),r.inNonTransformedFrame(a=>{this._name!==void 0&&$r(e,a,this._name,tt(s),this,!0),Za(e,s,this)})}doDrawMulti(e,r,i){let s=this.bounds(),{left:a,top:u,width:l}=s,p=s.outline(e);e.fillStyle=Ke,e.fill(p);for(let h of i)Ae(e,h,a-2,h.posYInParentTransform,!0);let d=this.parent.options.hideOutputColors?$(I,this.numBits):this.value,f=r.isMouseOver&&this.parent.mode!==0;e.strokeStyle=f?r.borderColor:K,e.lineWidth=1;let m=Je(this.numBits)?H:2*H;for(let h=0;h<this.numBits;h++){let v=u+h*m;e.fillStyle=Nt(d[h]),e.beginPath(),e.rect(a,v,l,m),e.fill(),e.stroke()}e.lineWidth=3,e.stroke(p),r.inNonTransformedFrame(h=>{if(this._name!==void 0){let v=d.map(tt).reverse().join("");$r(e,h,this._name,v,this,!0)}for(let v=0;v<this.numBits;v++){let D=u+m/2+v*m;Io(e,d[v],...h.rotatePoint(this.posX,D),{small:Je(this.numBits)})}})}autoConnected(e){if(e.length!==1)return;let[r,i,s]=e[0];if(s instanceof Ar){let a;(a=s.group)!==void 0&&a.nodes.length===1&&!Yr(a.name)?this.doSetName(a.name):this._name===void 0&&!Yr(s.shortName)&&this.doSetName(s.shortName)}if(s.orient==="w")switch(ue.add(i.orient,r.orient)){case"e":return;case"w":this.doSetOrient("w"),this.setPosition(this.posX-H*6,this.posY,!1);return;case"s":this.doSetOrient("s"),this.setPosition(this.posX-H*3,this.posY+H*3,!1);return;case"n":this.doSetOrient("n"),this.setPosition(this.posX-H*3,this.posY-H*3,!1);return}}doSetName(e){this._name=e,this.setNeedsRedraw("name changed")}makeComponentSpecificContextMenuItems(){return[["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))],["mid",_.sep()],this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits")]}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetNameDialog(this._name,this.doSetName.bind(this)):super.keyDown(e)}};c(io,"Output");Or.impl=io;var zo="custom-",bc=50,Cc=34,kd=sn.type({id:sn.string,caption:sn.string,circuit:sn.type({components:P(sn.record(sn.string,sn.record(sn.string,sn.unknown))),wires:P(sn.array(rr.Repr))})}),Vs=class{constructor(n){this.numBySide={n:0,e:0,s:0,w:0};var s,a,u;this.customId=n.id,this._caption=n.caption,this.circuit=n.circuit,this.insOuts=[];let e=0,r=0,i=(s=this.circuit.components)!=null?s:{};for(let[l,p]of Object.entries(i)){let d=p,f=d.type==="in"&&!((a=d.isConstant)!=null&&a),m=d.type==="out";if(f||m){let h=d,v=Re(h.name)?h.name:f?"In":"Out",D=ec.includes(h.orient)?h.orient:ue.default;D=f?ue.invert(D):D;let b=Number((u=h.bits)!=null?u:1);this.numBySide[D]+=b;let C=pe(h.pos)&&h.pos.length===2?h.pos.map(Number):[0,0];this.insOuts.push({isIn:f,id:l,name:v,orient:D,numBits:b,sourcePos:C,sourceRepr:h}),delete i[l],f?e+=b:r+=b}}H3(this.insOuts);for(let l of this.insOuts)i[l.id]=l.sourceRepr;this.numInputs=e,this.numOutputs=r,this.recalcSize()}toJSON(){return{id:this.customId,caption:this._caption,circuit:this.circuit}}get caption(){return this._caption}doSetCaption(n){this._caption=n,this.recalcSize()}recalcSize(){let r=1*this._caption.length+2;this.gridWidth=Math.ceil(Math.max(r,(Math.max(this.numBySide.s,this.numBySide.n)-1)*2+2*1.5)),this.gridHeight=Math.ceil(Math.max(r,(Math.max(this.numBySide.e,this.numBySide.w)-1)*2+2*1.5))}isValid(){return!0}get type(){return zo+this.customId}uses(n){let e=this.circuit.components;if(e===void 0)return!1;for(let r of Object.values(e))if(r.type===n)return!0;return!1}make(n){let e=new Rr(n,this);return n.components.add(e),e}makeFromJSON(n,e){let r=br(e,L3,"CustomComponent");if(r===void 0)return;let i=new Rr(n,this,r);return n.components.add(i),i}makeButtonSVG(){let n=bc,e=Cc,r=new ir(n,e);r.rect(10,2,30,30),r.strokeStyle="currentColor",r.lineWidth=2,r.stroke();let i=24,s=6,a=c((d,f,m)=>{let h=(d-1)*s<=i?s:i/(d-1),v=e/2-(d-1)*h/2;for(let D=0;D<d;D++){let b=v+D*h;r.moveTo(f,b),r.lineTo(m,b)}},"drawInsOuts");r.lineWidth=1;let u=10;a(Math.min(u,this.numInputs),2,10),a(Math.min(u,this.numOutputs),40,48),r.stroke();let l=this._caption,p=!1;for(;;){let d=15;r.font=`${d}px sans-serif`;let f=r.measureText(l).width,m=(n-24)/f;if(m<1&&(d=Math.floor(m*d),r.font=`${d}px sans-serif`),d>=8){r.textAlign="center",r.textBaseline="middle",r.fillStyle="currentColor",r.fillText(l+(p?".":""),n/2,e/2);break}l=l.slice(0,-1),p=!0}return r.getSvg()}toStandardDef(){return ve(zo+this.customId,{idPrefix:this.customId,button:{imgWidth:50},valueDefaults:{},size:{gridWidth:this.gridWidth,gridHeight:this.gridHeight},makeNodes:({gridWidth:n,gridHeight:e})=>{let r=n/2+1,i=-r,s=e/2+1,a=-s,u={n:this.numBySide.n-1,e:-(this.numBySide.e-1),s:this.numBySide.s-1,w:-(this.numBySide.w-1)},l={n:0,e:0,s:0,w:0},p=c(m=>{let{orient:h,numBits:v}=m,[D,b]=(()=>{let C=ue.isVertical(h)?-1:1,A=u[h]+C*(l[h]+(v-1)/2)*2;switch(h){case"e":return[r,A];case"w":return[i,A];case"n":return[A,a];case"s":return[A,s]}})();return l[h]+=v,v===1?[D,b,h]:ue.isVertical(h)?tr(h,D,b,v):ie(h,D,b,v)},"make"),d={},f={};for(let m of this.insOuts)(m.isIn?d:f)[m.name]=p(m);return{ins:d,outs:f}},initialValue:()=>$(!1,this.numOutputs)})}};c(Vs,"CustomComponentDef");var L3=ic(!0,!0),Rr=class extends he{constructor(e,r,i){super(e,r.toStandardDef(),i);this.wireMgr=new Po(this);this.recalcMgr=new Go;this.nodeMgr=new Wo;this.components=new Ho;this._subcircuitInputs=[];this._subcircuitOutputs=[];this.customDef=r,this.numInputs=this.inputs._all.length,this.numOutputs=this.outputs._all.length;let s=vt.loadCircuit(this,r.circuit,{immediateWirePropagation:!0,skipMigration:!0});s!==void 0&&(console.error("Failed to load custom component:",s),this.setInvalid());let a=0;for(let u of this.components.all())if(u instanceof ro&&!u.isConstant){let l=u.outputs._all;this._subcircuitInputs.push(...l);let p=l.length;p===1&&u.isLinkedToSomeClock&&(this.inputs._all[a].isClock=!0);for(let d=0;d<p;d++)this.inputs._all[a+d].prefersSpike=u.isPushButton;a+=p}else u instanceof io&&this._subcircuitOutputs.push(...u.inputs._all)}isMainEditor(){return!1}get editor(){return this.parent.editor}get mode(){return this.parent.mode}get options(){return this.parent.options}get timeline(){return this.parent.timeline}toJSON(){return this.toJSONBase()}jsonType(){return zo+this.customDef.customId}makeClone(e){let r=this.toNodelessJSON(),i=new Rr(this.parent,this.customDef,r);return this.parent.components.add(i),e&&i.setSpawning(),i}updateFromDef(){this.replaceWithComponent(this.makeClone(!1))}doRecalcValue(){for(let r=0;r<this.numInputs;r++)this._subcircuitInputs[r].value=this.inputs._all[r].value;return this.recalcMgr.recalcAndPropagateIfNeeded(),wt(r=>this._subcircuitOutputs[r].value,this.numOutputs)}propagateValue(e){this.outputValues(this.outputs._all,e)}doDraw(e,r){super.doDrawDefault(e,r,()=>{e.font="bold 18px sans-serif",e.fillStyle=K,e.textAlign="center",e.textBaseline="middle",e.fillText(this.customDef.caption,this.posX,this.posY)})}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(Rr,"CustomComponent");function H3(o){let n={e:0,w:1,n:2,s:3},e=c(r=>ue.isVertical(r.orient)?-r.sourcePos[0]:r.sourcePos[1],"criterion");o.sort((r,i)=>n[r.orient]-n[i.orient]||e(r)-e(i))}c(H3,"sortInputsOutputs");var Vd=ce(Me());var qo=ye("dec",!0,!0,{variantName:({bits:o})=>`dec-${o}`,idPrefix:"dec",button:{imgWidth:50},repr:{bits:P(Vd.number)},valueDefaults:{},params:{bits:Ce(2,[2,3,4,5])},validateParams:({bits:o})=>({numFrom:o,numTo:fa(2,o)}),size:({numTo:o})=>({gridWidth:4,gridHeight:Math.max(8,1+o)}),makeNodes:({numFrom:o,numTo:n})=>({ins:{In:ie("w",-3,0,o)},outs:{Out:ie("e",3,0,n)}}),initialValue:(o,{numTo:n})=>$(!1,n)}),mu=class extends we{constructor(e,r,i){super(e,qo.with(r),i);this.numFrom=r.numFrom,this.numTo=r.numTo}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numFrom===qo.aults.bits?void 0:this.numFrom})}makeTooltip(){let e=x.Components.Decoder.tooltip;return Q(e.title,q(z(e.desc.expand({numFrom:this.numFrom,numTo:this.numTo,n:this.currentAddr()}))))}currentAddr(){let e=this.inputValues(this.inputs.In);return Oe(e,!1)[1]}doRecalcValue(){let e=this.currentAddr();if(U(e))return $(I,this.numTo);let r=$(!1,this.numTo);return r[e]=!0,r}doDraw(e,r){this.doDrawDefault(e,r,{skipLabels:!0,drawLabels:()=>{e.font="bold 14px sans-serif",e.textAlign="center",e.textBaseline="middle",e.fillStyle=K,e.fillText("Dec.",this.posX,this.posY)}})}propagateValue(e){this.outputValues(this.outputs.Out,e)}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(mu,"Decoder");qo.impl=mu;var Ni=ve("dec-16seg",{idPrefix:"dec",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:4,gridHeight:10},makeNodes:()=>({ins:{In:nn("w",[[-3,-3],[-3,-2],[-3,-1],[-3,0],[-3,1],[-3,2],[-3,3]])},outs:{Out:nn("e",[[4,-4,"a1"],[3,-3.5,"a2"],[4,-3,"b"],[3,-2.5,"c"],[4,-2,"d2"],[3,-1.5,"d1"],[4,-1,"e"],[3,-.5,"f"],[4,0,"g1"],[3,.5,"g2"],[4,1,"h"],[3,1.5,"i"],[4,2,"j"],[3,2.5,"k"],[4,3,"l"],[3,3.5,"m"],[4,4,"p"]])}}),initialValue:()=>Dn(!1,17)}),hu=class extends he{constructor(n,e){super(n,Ni,e)}toJSON(){return this.toJSONBase()}makeTooltip(){return Q(void 0,q(z(x.Components.Decoder16Seg.tooltip)))}doRecalcValue(){let n=this.inputValues(this.inputs.In),[e,r]=Oe(n,!1),i;if(U(r))i=Dn(I,17);else if(r<32)i=Dn(!1,17);else{let s=W3[r-32];i=Dn(!1,17);for(let a=0;a<s.length;a++)i[a]=s.charAt(a)==="1"}return i}propagateValue(n){this.outputValues(this.outputs.Out,n)}doDraw(n,e){this.doDrawDefault(n,e,{skipLabels:!0,drawInside:r=>{this.drawGroupBox(n,this.inputs.In.group,r)},drawLabels:(r,{left:i,right:s})=>{n.fillStyle=Tn,n.font="bold 11px sans-serif",Rt(r,this.orient,"C","w",i,this.inputs.In),n.font="7px sans-serif",this.outputs._all.forEach(a=>{Rt(r,this.orient,a.shortName,"e",s,a)})}})}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(hu,"Decoder16Seg");Ni.impl=hu;var W3=["00000000000000000","00110000000000001","00100000000100000","00111100110100100","11011101110100100","10011001110111100","10001110101100010","00000000000100000","00000000000010010","00000000001001000","00000000111111110","00000000110100100","00000000000001000","00000000110000000","00000000000000001","00000000000011000","11111111000011000","00110000000010000","11101110110000000","11111100010000000","00110001110000000","11001101100000010","11011111110000000","11110000000000000","11111111110000000","11111101110000000","00000000000100100","00000000000101000","00000000100010010","00001100110000000","00000000011001000","11100000010000101","11101111010100000","11110011110000000","11111100010100100","11001111000000000","11111100000100100","11001111100000000","11000011100000000","11011111010000000","00110011110000000","11001100000100100","00111110000000000","00000011100010010","00001111000000000","00110011001010000","00110011001000010","11111111000000000","11100011110000000","11111111000000010","11100011110000010","11011101110000000","11000000000100100","00111111000000000","00000011000011000","00110011000001010","00000000001011010","00111101110000000","11001100000011000","01001000000100100","00000000001000010","10000100000100100","00000000000001010","00001100000000000","00000000001000000","00001110100000100","00000111100000100","00000110100000000","00000110100100100","00000110100001000","10000011100000000","10000101100100100","00000011100000100","00000000000000100","00000100000100100","00000000000110110","00000000000100100","00010010110000100","00000010100000100","00000110100000100","10000011100100000","10000001100100100","00000010100000000","10000101100000100","00000111100000000","00000110000000100","00000010000001000","00010010000001010","00000000001011010","00000101100100100","00000100100001000","01001000100100100","00000000000100100","10000100010100100","00000000110011000","00000000000000000"];var Fi=ve("dec-7seg",{idPrefix:"dec",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:4,gridHeight:8},makeNodes:()=>({ins:{In:nn("w",[[-3,-3,"A"],[-3,-1,"B"],[-3,1,"C"],[-3,3,"D"]])},outs:{Out:nn("e",[[3,-3,"a"],[3,-2,"b"],[3,-1,"c"],[3,0,"d"],[3,1,"e"],[3,2,"f"],[3,3,"g"]])}}),initialValue:()=>Dn(!1,7)}),gu=class extends he{constructor(n,e){super(n,Fi,e)}toJSON(){return this.toJSONBase()}makeTooltip(){return Q(void 0,q(z(x.Components.Decoder7Seg.tooltip)))}doRecalcValue(){let n=this.inputValues(this.inputs.In),[e,r]=Oe(n,!1),i;return U(r)?i=Dn(I,7):i=(()=>{switch(r){case 0:return[!0,!0,!0,!0,!0,!0,!1];case 1:return[!1,!0,!0,!1,!1,!1,!1];case 2:return[!0,!0,!1,!0,!0,!1,!0];case 3:return[!0,!0,!0,!0,!1,!1,!0];case 4:return[!1,!0,!0,!1,!1,!0,!0];case 5:return[!0,!1,!0,!0,!1,!0,!0];case 6:return[!0,!1,!0,!0,!0,!0,!0];case 7:return[!0,!0,!0,!1,!1,!1,!1];case 8:return[!0,!0,!0,!0,!0,!0,!0];case 9:return[!0,!0,!0,!0,!1,!0,!0];case 10:return[!0,!0,!0,!1,!0,!0,!0];case 11:return[!1,!1,!0,!0,!0,!0,!0];case 12:return[!0,!1,!1,!0,!0,!0,!1];case 13:return[!1,!0,!0,!0,!0,!1,!0];case 14:return[!0,!1,!1,!0,!0,!0,!0];case 15:return[!0,!1,!1,!1,!0,!0,!0];default:return Dn(I,7)}})(),i}propagateValue(n){this.outputValues(this.outputs.Out,n)}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(gu,"Decoder7Seg");Fi.impl=gu;var Bi=ve("dec-bcd4",{idPrefix:"bcd",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:5,gridHeight:10},makeNodes:()=>({ins:{In:nn("w",[[-4,-3,"A"],[-4,-1,"B"],[-4,1,"C"],[-4,3,"D"]])},outs:{Out:ie("e",4,0,5,2)}}),initialValue:()=>Dn(!1,5)}),Du=class extends he{constructor(n,e){super(n,Bi,e)}toJSON(){return this.toJSONBase()}makeTooltip(){return Q(void 0,q(z(x.Components.DecoderBCD4.tooltip)))}doRecalcValue(){let n=this.inputValues(this.inputs.In),[e,r]=Oe(n,!1),i;return U(r)?i=Dn(I,5):i=(()=>{switch(r){case 0:return[!1,!1,!1,!1,!1];case 1:return[!1,!1,!1,!1,!0];case 2:return[!1,!1,!1,!0,!1];case 3:return[!1,!1,!1,!0,!0];case 4:return[!1,!1,!0,!1,!1];case 5:return[!1,!1,!0,!1,!0];case 6:return[!1,!1,!0,!0,!1];case 7:return[!1,!1,!0,!0,!0];case 8:return[!1,!0,!1,!1,!1];case 9:return[!1,!0,!1,!1,!0];case 10:return[!0,!1,!1,!1,!1];case 11:return[!0,!1,!1,!1,!0];case 12:return[!0,!1,!1,!0,!1];case 13:return[!0,!1,!1,!0,!0];case 14:return[!0,!1,!0,!1,!1];case 15:return[!0,!1,!0,!1,!0];default:return Dn(I,5)}})(),i}propagateValue(n){this.outputValues(this.outputs.Out,n,!0)}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(Du,"DecoderBCD4");Bi.impl=Du;var Ii=ce(Me());var sr=ye("demux",!0,!0,{variantName:({from:o,to:n})=>`demux-${o}to${n}`,idPrefix:"demux",button:{imgWidth:50},repr:{from:P(Ii.number),to:P(Ii.number),showWiring:P(Ii.boolean),disconnectedAsHighZ:P(Ii.boolean)},valueDefaults:{showWiring:!0,disconnectedAsHighZ:!1},params:{from:Ce(2,[1,2,4,8,16]),to:Ce(4)},validateParams:({from:o,to:n})=>{let e=Math.min(16*o,Math.max(2*o,n)),r=Math.ceil(e/o),i=Math.ceil(Math.log2(r));return{numFrom:o,numTo:e,numGroups:r,numSel:i}},size:({numFrom:o,numTo:n,numGroups:e,numSel:r})=>{let i=2*r,s=Je(o===1?n:o)?1:2,a=o>1?1:0,u=n+(e-1)*a,l=s*u;return{gridWidth:i,gridHeight:l}},makeNodes:({numFrom:o,numGroups:n,numSel:e})=>{let r=1+e,i=-r,s=Ha("e",r,0,n,o),u=s[0][0][1]-2;return{ins:{In:ie("w",i,0,o),S:tr("n",0,u,e)},outs:{Z:s}}},initialValue:(o,{numTo:n})=>$(!1,n)}),vu=class extends we{constructor(e,r,i){var s,a;super(e,sr.with(r),i);this.numFrom=r.numFrom,this.numTo=r.numTo,this.numGroups=r.numGroups,this.numSel=r.numSel,this._showWiring=(s=i==null?void 0:i.showWiring)!=null?s:sr.aults.showWiring,this._disconnectedAsHighZ=(a=i==null?void 0:i.disconnectedAsHighZ)!=null?a:sr.aults.disconnectedAsHighZ}toJSON(){return Y(k({},super.toJSONBase()),{from:this.numFrom,to:this.numTo,showWiring:this._showWiring!==sr.aults.showWiring?this._showWiring:void 0,disconnectedAsHighZ:this._disconnectedAsHighZ!==sr.aults.disconnectedAsHighZ?this._disconnectedAsHighZ:void 0})}makeTooltip(){return Q(void 0,q(z(x.Components.Demux.tooltip.expand({from:this.numFrom,to:this.numTo}))))}doRecalcValue(){let e=this.inputValues(this.inputs.S),r=Oe(e,!1)[1];if(U(r))return $(I,this.numTo);let i=[],s=this._disconnectedAsHighZ?Pe:!1;for(let a=0;a<this.numGroups;a++)if(a===r){let u=this.inputValues(this.inputs.In);for(let l of u)i.push(l)}else for(let u=0;u<this.numFrom;u++)i.push(s);return i}propagateValue(e){this.outputValues(this.outputs._all,e)}doDraw(e,r){let{top:i,left:s,bottom:a,right:u}=this.bounds(),l=(u-s)/3;for(let d of this.inputs.In)Ae(e,d,s,d.posYInParentTransform);for(let d of this.inputs.S)Ae(e,d,d.posXInParentTransform,i+l);for(let d of this.outputs.Z)for(let f of d)Ae(e,f,u,f.posYInParentTransform);let p=e.createPath();if(p.moveTo(s,i+l),p.lineTo(u,i),p.lineTo(u,a),p.lineTo(s,a-l),p.closePath(),e.fillStyle=Ke,e.fill(p),this._showWiring){let d=this.parent.options.hideWireColors,f=this.inputValues(this.inputs.S),m=Oe(f,!1)[1];if(!U(m)){let h=this.outputs.Z[m],v=(u-s)/3,D=this.parent.options.wireStyle===$t.straight;for(let b=0;b<this.inputs.In.length;b++){e.beginPath();let C=this.inputs.In[b],A=C.posYInParentTransform,M=h[b].posYInParentTransform;e.moveTo(s+1,A),D?(e.lineTo(s+3,A),e.lineTo(u-3,M),e.lineTo(u-1,M)):e.bezierCurveTo(s+v,A,u-v,M,u-1,M),Jr(e,this.inputs.In[b].value,C.color,!1,d)}}}e.lineWidth=3,e.strokeStyle=r.borderColor,e.stroke(p)}doSetShowWiring(e){this._showWiring=e,this.setNeedsRedraw("show wiring changed")}doSetDisconnectedAsHighZ(e){this._disconnectedAsHighZ=e,this.setNeedsRecalc()}makeComponentSpecificContextMenuItems(){let e=x.Components.MuxDemux.contextMenu,r=this._showWiring?"check":"none",i=_.item(r,e.ShowWiring,()=>{this.doSetShowWiring(!this._showWiring)});r=this._disconnectedAsHighZ?"check":"none";let s=_.item(r,e.UseZForDisconnected,()=>{this.doSetDisconnectedAsHighZ(!this._disconnectedAsHighZ)});return[this.makeChangeParamsContextMenuItem("inputs",e.ParamNumFrom,this.numFrom,"from"),this.makeChangeParamsContextMenuItem("outputs",e.ParamNumTo,this.numTo,"to",[2,4,8,16].map(a=>a*this.numFrom)),["mid",_.sep()],["mid",i],["mid",s],...this.makeForceOutputsContextMenuItem(!0)]}};c(vu,"Demux");sr.impl=vu;var Ls=ce(Me());var Rn=ye("display",!0,!1,{variantName:({bits:o})=>`display-${o}`,idPrefix:"disp",button:{imgWidth:32},repr:{bits:P(Ls.number),name:Ot,radix:P(Ls.number),showAsUnknown:P(Ls.boolean)},valueDefaults:{radix:10,showAsUnknown:!1},params:{bits:Ce(4,[3,4,8,16])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>({gridWidth:2+Math.ceil(o/2),gridHeight:Je(o)?o:2*o}),makeNodes:({numBits:o,gridWidth:n})=>{let e=-n/2-1;return{ins:{In:ie("w",e,0,o)}}},initialValue:(o,{numBits:n})=>[G3("0",n),0]}),yu=class extends we{constructor(e,r,i){var s,a,u;super(e,Rn.with(r),i);this.numBits=r.numBits,this._name=(s=i==null?void 0:i.name)!=null?s:void 0,this._radix=(a=i==null?void 0:i.radix)!=null?a:Rn.aults.radix,this._showAsUnknown=(u=i==null?void 0:i.showAsUnknown)!=null?u:Rn.aults.showAsUnknown}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===Rn.aults.bits?void 0:this.numBits,name:this._name,radix:this._radix===Rn.aults.radix?void 0:this._radix,showAsUnknown:this._showAsUnknown===Rn.aults.showAsUnknown?void 0:this._showAsUnknown})}get showAsUnknown(){return this._showAsUnknown||this.parent.options.hideOutputColors}makeTooltip(){let e=x.Components.Display.tooltip,r=(()=>{switch(this._radix){case 2:return e.RadixBinary;case 10:return e.RadixDecimal;case-10:return e.RadixSignedDecimal;case 16:return e.RadixHexadecimal;default:return e.RadixGeneric.expand({radix:this._radix})}})(),[i,s]=this.value,a={numBits:this.numBits,radixStr:r};return Q(e.title.expand(a),q(z(e.desc[0].expand(a)+" ",Hn(i),e.desc[1]),!U(s)||this.showAsUnknown?At:z(e.CurrentlyUndefined)))}doRecalcValue(){return Oe(this.inputValues(this.inputs.In),!1)}doDraw(e,r){let[i,s]=this.value,a=(1<<this.inputs.In.length)-1,u=U(s)||this.showAsUnknown?ct:Ad(s/a);this.doDrawDefault(e,r,{background:u,skipLabels:!0,componentName:[this._name,!0,s],drawLabels:(l,{width:p,height:d})=>{let f=ue.isVertical(this.orient),m=wd(u),h=j(m[0]+m[1]+m[2]>3*127?0:255);if(e.fillStyle=h,e.textAlign="center",!this.showAsUnknown){let[b,C]=U3(i,this._radix);e.font=`${b?9:10}px sans-serif`,e.fillText(C,this.posX,this.posY+(f?-p/2+7:-d/2+8))}let v=this.numBits===4&&this._radix===8?16:18;e.font=`bold ${v}px sans-serif`;let D=this.showAsUnknown?I:Zr(s,this._radix,this.numBits);e.fillText(D,this.posX,this.posY+(f?6:0))}})}mouseDoubleClicked(e){let r=super.mouseDoubleClicked(e);if(r.isChange)return r;let i=this.parent.mode;return i>=4&&e.altKey?(this.doSetShowAsUnknown(!this._showAsUnknown),Z.SimpleChange):i>=3?(this.doSetRadix(this._radix===10?16:10),Z.SimpleChange):Z.NoChange}doSetName(e){this._name=e,this.setNeedsRedraw("name changed")}doSetShowAsUnknown(e){this._showAsUnknown=e,this.setNeedsRedraw("display as unknown changed")}doSetRadix(e){this._radix=e,this.setNeedsRedraw("radix changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.Display.contextMenu,r=c((s,a,u)=>{let l=u?"check":"none",p=e.DisplayAs+" "+s,d=u?()=>{}:a;return _.item(l,p,d)},"makeItemShowAs"),i=c((s,a)=>r(a,()=>{this._showAsUnknown&&this.doSetShowAsUnknown(!1),this.doSetRadix(s)},!this._showAsUnknown&&this._radix===s),"makeItemShowRadix");return[["mid",i(10,e.DisplayAsDecimal)],["mid",i(-10,e.DisplayAsSignedDecimal)],["mid",i(8,e.DisplayAsOctal)],["mid",i(16,e.DisplayAsHexadecimal)],["mid",r(e.DisplayAsUnknown,()=>this.doSetShowAsUnknown(!this._showAsUnknown),this._showAsUnknown)],["mid",_.sep()],this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),["mid",_.sep()],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetNameDialog(this._name,this.doSetName.bind(this)):super.keyDown(e)}};c(yu,"Display");Rn.impl=yu;function G3(o,n){let e="";for(let r=0;r<n;r++)e+=o;return e}c(G3,"repeatString");function U3(o,n){let e=-1;if(n===16?e=4:n===8&&(e=3),e<0)return[!1,o];let r=new RegExp(`(.{${e}})`,"g");return[!0,Ld(Ld(o).replace(r,"$1 "))]}c(U3,"insertSpaces");function Ld(o){return o.split("").reverse().join("")}c(Ld,"reverseString");var xu=ce(Me());var Hs=ce(Me());var Ws={green:null,red:null,yellow:null},z3={v:null,h:null,px:null,PX:null};function Gs(o,n){return U(o)?ct:me(o)?Ms:o?Rs[n]:Fo}c(Gs,"ledColorForLogicValue");var so=class extends he{constructor(e,r,i,s){var a,u,l;super(e,r,s);this.transparentDefault=i,this._color=(a=s==null?void 0:s.color)!=null?a:Nr.aults.color,this._transparent=(u=s==null?void 0:s.transparent)!=null?u:i,this._name=(l=s==null?void 0:s.name)!=null?l:void 0}toJSONBase(){return Y(k({},super.toJSONBase()),{color:this._color===Nr.aults.color?void 0:this._color,transparent:this._transparent===this.transparentDefault?void 0:this._transparent,name:this._name})}doSetName(e){this._name=e,this.setNeedsRedraw("name changed")}doSetColor(e){this._color=e,this.setNeedsRedraw("color changed")}doSetTransparent(e){this._transparent=e,this.setNeedsRedraw("transparent changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.DisplayBar.contextMenu,r=c((s,a)=>{let u=this._color===a,l=u?"check":"none",p=u?()=>{}:()=>this.doSetColor(a),d=Rs[a];return _.item(l,Yt(vn(s),ke(`display: inline-block; width: 140px; height: 16px; background-color: ${d}; margin-right: 8px`)),p)},"makeItemUseColor"),i=_.item(this._transparent?"check":"none",e.TransparentWhenOff,()=>this.doSetTransparent(!this._transparent));return[["mid",_.submenu("palette",e.Color,[r(e.ColorGreen,"green"),r(e.ColorRed,"red"),r(e.ColorYellow,"yellow"),_.sep(),i])],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetNameDialog(this._name,this.doSetName.bind(this)):super.keyDown(e)}};c(so,"DisplayBarBase");var Nr=ve("bar",{idPrefix:"bar",button:{imgWidth:32},repr:{display:Hs.keyof(z3,"OutputBarType"),color:P(Hs.keyof(Ws,"LedColor")),transparent:P(Hs.boolean),name:Ot},valueDefaults:{display:"h",color:"green",transparent:!0},size:{gridWidth:1,gridHeight:1},makeNodes:()=>({ins:{I:[0,0,"w"]}}),initialValue:()=>!1}),bu=class extends so{constructor(e,r){var i;super(e,Nr,!1,r);this.doSetDisplay((i=r==null?void 0:r.display)!=null?i:Nr.aults.display)}toJSON(){return Y(k({},super.toJSONBase()),{display:this._display})}get unrotatedWidth(){return this.getWidthAndHeight()[0]}get unrotatedHeight(){return this.getWidthAndHeight()[1]}makeTooltip(){let e=x.Components.DisplayBar.tooltip,r=(()=>{switch(this.value){case I:return e.ValueUnknown;case Pe:return e.ValueUnknown;case!0:return q(e.Value1[0],Oo(this.value),e.Value1[1]);case!1:return q(e.Value0[0],Oo(this.value),e.Value0[1])}})();return Q(e.title,r)}get display(){return this._display}doRecalcValue(){return this.inputs.I.value}doDraw(e,r){let i=this.parent.options.hideOutputColors?I:this.value,s=this._transparent&&i===!1?yd:Gs(i,this._color);this.doDrawDefault(e,r,{background:s,skipLabels:!0,componentName:[this._name,!0,tt(i)]})}getWidthAndHeight(){switch(this._display){case"h":return[10*H,2*H];case"v":return[2*H,10*H];case"px":return[2*H,2*H];case"PX":return[10*H,10*H]}}mouseDoubleClicked(e){let r=super.mouseDoubleClicked(e);return r.isChange?r:(this.doSetDisplay((()=>{switch(this.display){case"h":return"v";case"v":return"px";case"px":return"PX";case"PX":return"h"}})()),Z.SimpleChange)}doSetDisplay(e){this._display=e,this.updateInputOffsetX(),this.setNeedsRedraw("display mode changed")}updateInputOffsetX(){let e=this.getWidthAndHeight()[0];this.inputs.I.gridOffsetX=-vd(e/2)-2}makeComponentSpecificContextMenuItems(){let e=x.Components.DisplayBar.contextMenu,r=c((i,s)=>{let a=this._display===s,u=a?"check":"none",l=a?()=>{}:()=>{this.doSetDisplay(s)};return _.item(u,i,l)},"makeItemShowAs");return[["mid",_.submenu("eye",e.Display,[r(e.DisplayVerticalBar,"v"),r(e.DisplayHorizontalBar,"h"),r(e.DisplaySmallSquare,"px"),r(e.DisplayLargeSquare,"PX"),_.sep(),_.text(e.DisplayChangeDesc)])],...super.makeComponentSpecificContextMenuItems()]}};c(bu,"DisplayBar");Nr.impl=bu;var Pi=ve("16seg",{idPrefix:"16seg",button:{imgWidth:32},repr:{color:P(xu.keyof(Ws,"LedColor")),transparent:P(xu.boolean),name:Ot},valueDefaults:{},size:{gridWidth:8,gridHeight:10},makeNodes:()=>({ins:{In:nn("w",[[-5,-4,"a1"],[-6,-3.5,"a2"],[-5,-3,"b"],[-6,-2.5,"c"],[-5,-2,"d2"],[-6,-1.5,"d1"],[-5,-1,"e"],[-6,-.5,"f"],[-5,0,"g1"],[-6,.5,"g2"],[-5,1,"h"],[-6,1.5,"i"],[-5,2,"j"],[-6,2.5,"k"],[-5,3,"l"],[-6,3.5,"m"],[-5,4,"p"]])}}),initialValue:()=>$(!1,17)}),Cu=class extends so{constructor(n,e){super(n,Pi,!0,e)}toJSON(){return this.toJSONBase()}makeTooltip(){return Q(void 0,q(z(x.Components.Display16Seg.tooltip)))}doRecalcValue(){return this.inputValues(this.inputs.In)}doDraw(n,e){this.doDrawDefault(n,e,{labelSize:7,componentName:[this._name,!0,()=>this.value.map(tt).reverse().join("")],drawInside:({left:r,right:i,top:s,bottom:a})=>{let[u,l,p,d,f,m,h,v,D,b,C,A,M,w,T,R,S]=this.value,F=10,O=3,L=r+18,W=i-10,se=(L+W)/2,ae=s+F,oe=a-F,Fe=c(je=>{(!this._transparent||je!==!1)&&(n.fillStyle=Gs(je,this._color),n.fill())},"doFill"),He=c((je,We,X,ee)=>{n.beginPath(),n.moveTo(We,ee),n.lineTo(We+O,ee-O),n.lineTo(X-O,ee-O),n.lineTo(X,ee),n.lineTo(X-O,ee+O),n.lineTo(We+O,ee+O),n.closePath(),n.stroke(),Fe(je)},"drawH"),it=c((je,We,X,ee)=>{n.beginPath(),n.moveTo(We,X),n.lineTo(We+O,X+O),n.lineTo(We+O,ee-O),n.lineTo(We,ee),n.lineTo(We-O,ee-O),n.lineTo(We-O,X+O),n.closePath(),n.stroke(),Fe(je)},"drawV"),ht=O*1.41,st=O*1.41,bt=c((je,We,X,ee,Ge)=>{n.beginPath(),n.moveTo(We,X),n.lineTo(We+ht,X),n.lineTo(ee,Ge-st),n.lineTo(ee,Ge),n.lineTo(ee-ht,Ge),n.lineTo(We,X+st),n.closePath(),n.stroke(),Fe(je)},"drawBackslash"),Pt=c((je,We,X,ee,Ge)=>{n.beginPath(),n.moveTo(We,X),n.lineTo(We,X-st),n.lineTo(ee-ht,Ge),n.lineTo(ee,Ge),n.lineTo(ee,Ge+st),n.lineTo(We+ht,X),n.closePath(),n.stroke(),Fe(je)},"drawSlash");n.strokeStyle=yi,n.lineWidth=1,He(u,L+O,se,ae+O),He(l,se,W-O,ae+O),it(p,W-O,ae+O,this.posY),it(d,W-O,this.posY,oe-O),He(m,L+O,se,oe-O),He(f,se,W-O,oe-O),it(h,L+O,this.posY,oe-O),it(v,L+O,ae+O,this.posY),He(D,L+O,se,this.posY),He(b,se,W-O,this.posY),it(A,se,ae+O,this.posY),it(T,se,this.posY,oe-O);let Kt=ae+O+O,Cn=oe-O-O;bt(C,L+O+O,Kt,se-O,this.posY-O),Pt(M,se+O,this.posY-O,W-O-O,Kt),Pt(w,L+O+O,Cn,se-O,this.posY+O),bt(R,se+O,this.posY+O,W-O-O,Cn),n.beginPath();let Jt=1.3*O;n.arc(i-8,a-7-Jt/2,Jt,0,2*Math.PI),n.stroke(),Fe(S)}})}};c(Cu,"Display16Seg");Pi.impl=Cu;var Au=ce(Me());var ki=ve("7seg",{idPrefix:"7seg",button:{imgWidth:32},repr:{color:P(Au.keyof(Ws,"LedColor")),transparent:P(Au.boolean),name:Ot},valueDefaults:{},size:{gridWidth:8,gridHeight:10},makeNodes:()=>({ins:{In:nn("w",[[-5,-4,"a"],[-5,-3,"b"],[-5,-2,"c"],[-5,-1,"d"],[-5,0,"e"],[-5,1,"f"],[-5,2,"g"],[-5,4,"p"]])}}),initialValue:()=>$(!1,8)}),wu=class extends so{constructor(n,e){super(n,ki,!0,e)}toJSON(){return this.toJSONBase()}makeTooltip(){return Q(void 0,q(z(x.Components.Display7Seg.tooltip)))}doRecalcValue(){return this.inputValues(this.inputs.In)}doDraw(n,e){this.doDrawDefault(n,e,{labelSize:9,componentName:[this._name,!0,()=>this.value.map(tt).reverse().join("")],drawInside:({left:r,right:i,top:s,bottom:a})=>{let[u,l,p,d,f,m,h,v]=this.value,D=20,b=10,C=4,A=r+D,M=i-D,w=s+b,T=a-b,R=c(L=>{(!this._transparent||L!==!1)&&(n.fillStyle=Gs(L,this._color),n.fill())},"doFill"),S=c((L,W)=>{n.beginPath(),n.moveTo(A+C,W),n.lineTo(A+C+C,W-C),n.lineTo(M-C-C,W-C),n.lineTo(M-C,W),n.lineTo(M-C-C,W+C),n.lineTo(A+C+C,W+C),n.closePath(),n.stroke(),R(L)},"drawH"),F=c((L,W,se,ae)=>{n.beginPath(),n.moveTo(W,se),n.lineTo(W+C,se+C),n.lineTo(W+C,ae-C),n.lineTo(W,ae),n.lineTo(W-C,ae-C),n.lineTo(W-C,se+C),n.closePath(),n.stroke(),R(L)},"drawV");n.strokeStyle=yi,n.lineWidth=1,S(u,w+C),F(l,M-C,w+C,this.posY),F(p,M-C,this.posY,T-C),S(d,T-C),F(f,A+C,this.posY,T-C),F(m,A+C,w+C,this.posY),S(h,this.posY),n.beginPath();let O=1.3*C;n.arc(i-D/2,a-b-O/2,O,0,2*Math.PI),n.stroke(),R(v)}})}};c(wu,"Display7Seg");ki.impl=wu;var Tu=ce(Me());var Vi=ve("ascii",{idPrefix:"disp",button:{imgWidth:32},repr:{name:Ot,additionalReprRadix:P(Tu.number),showAsUnknown:P(Tu.boolean)},valueDefaults:{},size:{gridWidth:4,gridHeight:8},makeNodes:()=>({ins:{Z:ie("w",-3,0,7)}}),initialValue:()=>["0000000",0]}),Fr=class extends he{constructor(e,r){var i,s,a;super(e,Vi,r);this._name=(i=r==null?void 0:r.name)!=null?i:void 0,this._additionalReprRadix=(s=r==null?void 0:r.additionalReprRadix)!=null?s:void 0,this._showAsUnknown=(a=r==null?void 0:r.showAsUnknown)!=null?a:!1}toJSON(){return Y(k({},this.toJSONBase()),{name:this._name,additionalReprRadix:this._additionalReprRadix,showAsUnknown:this._showAsUnknown?!0:void 0})}get showAsUnknown(){return this._showAsUnknown||this.parent.options.hideOutputColors}makeTooltip(){let e=x.Components.DisplayAscii.tooltip,[r,i]=this.value;return Q(e.title,q(z(e.desc[0],Hn(r),e.desc[1]),this.showAsUnknown?At:U(i)?z(e.CurrentlyUndefined):q(e.CurrentlyThisCharacter+" ",Hn(""+i),i<32?e.WhichIsNotPrintable:q(", \u2018",Hn(String.fromCharCode(i)),"\u2019."))))}doRecalcValue(){let e=this.inputValues(this.inputs.Z);return Oe(e,!1)}doDraw(e,r){let[i,s]=this.value,a,u,l=K;U(s)||this.showAsUnknown?(u="bold 18px sans-serif",this.showAsUnknown&&(l=ct),a="?"):(a=Fr.numberToAscii(s),s<32?u="16px sans-serif":u="bold 18px sans-serif"),this.doDrawDefault(e,r,{skipLabels:!0,componentName:[this._name,!0,a],drawLabels:(p,{width:d,height:f})=>{var D;let m=ue.isVertical(this.orient),h=this._additionalReprRadix!==void 0,v=this.posY+(m?4:0);if(e.font="9px sans-serif",e.fillStyle=K,!this.showAsUnknown&&(m&&h?(e.textAlign="start",e.fillText(i,this.posX-f/2+3,this.posY-d/2+8),e.textAlign="center"):(e.textAlign="center",e.fillText(i,this.posX,this.posY+(m?-d/2+8:-f/2+10))),h)){let b=Zr(s,(D=this._additionalReprRadix)!=null?D:10,7);e.font="bold 11px sans-serif",m?(e.textAlign="end",e.fillText(b,this.posX+f/2-3,this.posY-d/2+9),e.textAlign="center"):(e.fillText(b,this.posX,this.posY-f/2+22),v+=8)}e.font=u,e.fillStyle=l,e.fillText(a,this.posX,v)}})}static numberToAscii(e){return e<32?"\\"+e:String.fromCharCode(e)}mouseDoubleClicked(e){let r=super.mouseDoubleClicked(e);if(r.isChange)return r;let i=this.parent.mode;return i>=4&&e.altKey?(this.doSetShowAsUnknown(!this._showAsUnknown),Z.SimpleChange):i>=3?(this.doSetAdditionalDisplayRadix((()=>{switch(this._additionalReprRadix){case void 0:return 10;case 10:return 16;case 16:return;default:return}})()),Z.SimpleChange):Z.NoChange}doSetName(e){this._name=e,this.setNeedsRedraw("name changed")}doSetShowAsUnknown(e){this._showAsUnknown=e,this.setNeedsRedraw("display as unknown changed")}doSetAdditionalDisplayRadix(e){this._additionalReprRadix=e,this.setNeedsRedraw("additional display radix changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.DisplayAscii.contextMenu,r=c((s,a,u)=>{let l=u?"check":"none";return _.item(l,s,a)},"makeItemShowAs"),i=c((s,a)=>r(a,()=>this.doSetAdditionalDisplayRadix(s),this._additionalReprRadix===s),"makeItemShowRadix");return[["mid",_.submenu("eye",e.AdditionalDisplay,[i(void 0,e.DisplayNone),i(10,e.DisplayDecimal),i(16,e.DisplayHex),_.sep(),_.text(e.ChangeDisplayDesc)])],["mid",r(x.Components.Generic.contextMenu.ShowAsUnknown,()=>this.doSetShowAsUnknown(!this._showAsUnknown),this._showAsUnknown)],["mid",_.sep()],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetNameDialog(this._name,this.doSetName.bind(this)):super.keyDown(e)}};c(Fr,"DisplayAscii");Vi.impl=Fr;var Li=ve("ff-d",Y(k({idPrefix:"ff"},qn),{makeNodes:()=>{let o=qn.makeNodes(2),n=x.Components.Generic;return{ins:Y(k({},o.ins),{D:[-4,-2,"w",n.InputDataDesc]}),outs:o.outs}}})),Eu=class extends pt{constructor(n,e){super(n,Li,e)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.FlipflopD.tooltip;return Q(n.title,q(z(n.desc)))}doRecalcValueAfterClock(){return Ue.filterHighZ(this.inputs.D.value)}};c(Eu,"FlipflopD");Li.impl=Eu;var Hi=ve("ff-jk",Y(k({idPrefix:"ff"},qn),{makeNodes:()=>{let o=qn.makeNodes(0),n=x.Components.FlipflopJK;return{ins:Y(k({},o.ins),{J:[-4,-2,"w",n.InputJDesc],K:[-4,2,"w",n.InputKDesc]}),outs:o.outs}}})),Su=class extends pt{constructor(n,e){super(n,Hi,e)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.FlipflopJK.tooltip;return Q(n.title,q(z(n.desc)))}doRecalcValueAfterClock(){let n=this.inputs.J.value,e=this.inputs.K.value,r=this.outputs.Q.value;return n===!0?e===!0?Ue.invert(r):!0:e===!0?!1:r}};c(Su,"FlipflopJK");Hi.impl=Su;var Wi=ve("ff-t",Y(k({idPrefix:"ff"},qn),{makeNodes:()=>{let o=qn.makeNodes(2),n=x.Components.FlipflopT;return{ins:Y(k({},o.ins),{T:[-4,-2,"w",n.InputTDesc]}),outs:o.outs}}})),_u=class extends pt{constructor(n,e){super(n,Wi,e)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.FlipflopT.tooltip;return Q(n.title,q(z(n.desc)))}doRecalcValueAfterClock(){let n=this.inputs.T.value;if(U(n)||me(n))return I;let e=this.outputs.Q.value;return n?Ue.invert(e):e}};c(_u,"FlipflopT");Wi.impl=_u;var xc=ce(Me());var Us=class extends we{constructor(e,r,i,s){var a,u;super(e,r,s);this._type=i,this._poseAs=(a=s==null?void 0:s.poseAs)!=null?a:void 0,this._showAsUnknown=(u=s==null?void 0:s.showAsUnknown)!=null?u:!1}toJSONBase(){return Y(k({},super.toJSONBase()),{showAsUnknown:this._showAsUnknown?!0:void 0,poseAs:this._poseAs})}jsonType(){return this._type}get type(){return this._type}doSetType(e){this._type=e,this.setNeedsRecalc(),this.setNeedsRedraw("gate type changed")}get poseAs(){return this._poseAs}set poseAs(e){e!==this._poseAs&&(this._poseAs=e,this.setNeedsRedraw("gate display changed"))}get showAsUnknown(){return this._showAsUnknown}doSetShowAsUnknown(e){this._showAsUnknown=e,this.setNeedsRedraw("display as unknown changed")}toStringDetails(){return this.type}doRecalcValue(){let e=this.inputValues(this.inputs.In),r=this.gateTypes(this.numBits).props[this.type].out;return r(e)}propagateValue(e){this.outputs.Out.value=e}makeTooltip(){let e=x.Components.Gate.tooltip;if(this.showAsUnknown)return z(e.UnknownGate);let r=this.inputValues(this.inputs.In),i=this.value,s=this.gateTypes(this.numBits).props[this.type],a=c(()=>{let h=this.numBits===1?[e.Input]:wt(D=>e.Input+" "+(D+1),this.numBits);h.push(e.Output);let v=[];for(let D of q3(this.numBits)){let b=fs(r,D),C=s.out(D);D.push(C),v.push({matchesCurrent:b,cells:D})}return[h,v]},"genTruthTableData"),l=this.outputs.Out.value===i?e.CurrentlyDelivers:e.ShouldCurrentlyDeliver,d=r.includes(I)?q(l+" "+e.UndeterminedOutputBecauseInputUnknown):q(l+" "+e.ThisOutput+" ",Oo(i)," "+e.BecauseInputIs+" ",...r.map(Oo),", "+e.AccordingToTruthTable),f=s.fullShortDesc(),m=(()=>{switch(this.type){case"not":return q(e.Inverter[0],Hn(x.Components.Gate.not[0]),e.Inverter[1]);case"buf":return q(e.Buffer[0],Hn(x.Components.Gate.buf[0]),e.Buffer[1]);default:return e.GateTitle(Hn(f[0]))}})();return Y3(this.numBits,m,f[2],d,X3(a()))}doDraw(e,r){var s;let i=this._showAsUnknown?I:(s=this.poseAs)!=null?s:this.type;this.drawGate(e,i,i!==this.type&&!this._showAsUnknown,r)}drawGate(e,r,i,s){let a=this.numBits,u=this.outputs.Out,l=this.unrotatedWidth,p=this.unrotatedHeight,d=this.posY-p/2,f=d+p,m=this.posX-l/2,h=Math.PI/2;s.isMouseOver&&(e.lineWidth=2,e.strokeStyle=s.borderColor,e.beginPath(),e.rect(m-2-2,d-2-2,l+2*(2+2),p+2*(2+2)),e.stroke());let v=2*Math.max(2,this.numBits)*H,D=this.posX-v/2,b=this.posX+v/2,C=0,A=c(()=>{b+=5,e.beginPath(),pn(e,b,this.posY,8),e.fillStyle=Ke,e.fill(),e.stroke(),b+=4},"drawRightCircle"),M=c(F=>{e.beginPath(),pn(e,D-5,this.posY-(F?1:-1)*H,8),e.fillStyle=Ke,e.fill(),e.stroke()},"drawLeftCircle"),w=c((F=!1,O=!1,L=!1)=>{for(let W=0;W<a;W++){let se=this.inputs.In[W],ae=W===0?F:O,oe=D-1;ae&&(oe-=9),L&&(a===3?(oe+=3,W===1&&(oe+=4)):a===4&&(oe+=3,(W===1||W===2)&&(oe+=8))),Ae(e,se,oe,se.posYInParentTransform)}Ae(e,u,b+1,this.posY)},"drawWireEnds"),T=i&&this.parent.mode>=4,R=T?_s:K,S=T?$a:Ke;switch(e.lineWidth=3,e.strokeStyle=R,e.fillStyle=S,e.beginPath(),r){case"not":case"buf":e.moveTo(D,d),e.lineTo(b,this.posY),e.lineTo(D,f),e.closePath(),e.fill(),e.stroke(),r==="not"&&A(),w(),C-=6;break;case"and":case"nand":case"nimply":case"rnimply":{e.moveTo(this.posX,f),e.lineTo(D,f),e.lineTo(D,d),e.lineTo(this.posX,d),e.arc(this.posX,this.posY,p/2,-h,h),e.closePath(),e.fill(),e.lineWidth=1,e.stroke(),e.strokeStyle=R,e.lineWidth=3,e.stroke(),e.beginPath(),r.startsWith("nand")&&A();let F=!1,O=!1;r==="nimply"?(M(!1),O=!0):r==="rnimply"&&(M(!0),F=!0),w(F,O),C-=1;break}case"or":case"nor":case"xor":case"xnor":case"imply":case"rimply":{e.beginPath(),e.moveTo(D,d),e.lineTo(this.posX-15,d),e.bezierCurveTo(this.posX+10,d,b-5,this.posY-8,b,this.posY),e.bezierCurveTo(b-5,this.posY+8,this.posX+10,f,this.posX-15,f),e.lineTo(D,f),e.quadraticCurveTo(this.posX-8,this.posY,D,d),e.closePath(),e.fill(),e.stroke();let F=D;D+=4,(r.startsWith("nor")||r.startsWith("xnor"))&&A();let O=!1,L=!1;r==="imply"?(M(!0),O=!0):r==="rimply"&&(M(!1),L=!0),r.startsWith("x")&&(D=F-2,e.beginPath(),e.moveTo(F-6,f),e.quadraticCurveTo(this.posX-14,this.posY,F-6,d),e.lineWidth=3,e.strokeStyle=R,e.stroke()),w(O,L,!0),C-=1;break}case"txa":case"txna":{e.beginPath(),e.moveTo(D,f),e.lineTo(D,d),e.lineTo(b,this.posY),e.lineTo(D+2,this.posY),e.fill(),e.stroke();let F=!1;r==="txna"&&(M(!0),F=!0),w(F,!1);break}case"txb":case"txnb":{e.beginPath(),e.moveTo(D,d),e.lineTo(D,f),e.lineTo(b,this.posY),e.lineTo(D+2,this.posY),e.fill(),e.stroke();let F=!1;r==="txnb"&&(M(!1),F=!0),w(!1,F);break}case"?":e.strokeStyle=ct,e.beginPath(),e.moveTo(D,d),e.lineTo(b,d),e.lineTo(b,f),e.lineTo(D,f),e.closePath(),e.fill(),e.stroke(),e.lineWidth=0,w(),s.inNonTransformedFrame(()=>{e.fillStyle=ct,e.textAlign="center",e.font="bold 20px sans-serif",e.fillText("?",this.posX,this.posY)});break}if(this.parent.options.showGateTypes&&!U(r)){let F=this.gateTypes(this.numBits).props[r].fullShortDesc()[1];if(F!==void 0){e.fillStyle=Ya,e.textAlign="center",e.font="bold 13px sans-serif";let O=e.getTransform();e.translate(this.posX+C,this.posY),e.scale(.65,1),e.fillText(F,0,0),e.setTransform(O)}}}mouseDoubleClicked(e){return this.parent.mode>=4&&e.altKey?(this.doSetShowAsUnknown(!this._showAsUnknown),Z.SimpleChange):super.mouseDoubleClicked(e)}makeComponentSpecificContextMenuItems(){let e=[["start",this.makeReplaceByMenuItem()]];return this.parent.mode>=4&&e.push(["mid",this.makePoseAsMenuItem()],...this.makeForceOutputsContextMenuItem()),e}makeReplaceByMenuItem(){let e=this.gateTypes(this.numBits),r=x.Components.Gate.contextMenu,i=e.values.filter(s=>s!==this._type&&e.props[s].includeInContextMenu);return _.submenu("replace",r.ReplaceBy,[...i.map(s=>{let a=e.props[s];return _.item(void 0,r.GateTempl.expand({type:a.fullShortDesc()[0]}),()=>{this.doSetType(s)})}),_.sep(),_.text(r.VariantChangeDesc)])}makePoseAsMenuItem(){let e=this.gateTypes(this.numBits),r=x.Components.Gate.contextMenu,i=e.values.filter(u=>u!==this._type&&e.props[u].includeInPoseAs),s=this._showAsUnknown,a=this.poseAs;return _.submenu("questioncircled",r.ShowAs,[_.item(!s&&a===void 0?"check":"none",r.NormalGateTempl.expand({type:e.props[this._type].fullShortDesc()[0]}),()=>{this.poseAs=void 0,this.doSetShowAsUnknown(!1)}),_.item(s?"check":"none",r.UnknownGate,()=>{this.poseAs=void 0,this.doSetShowAsUnknown(!0)}),_.sep(),...i.map(u=>{let l=e.props[u];return _.item(!s&&u===a?"check":"none",r.GateTempl.expand({type:l.fullShortDesc()[0]}),()=>{this.doSetShowAsUnknown(!1),this.poseAs=u})})])}};c(Us,"GateBase");function Ou(o,n,e,r,i){let s;return e===void 0?s=n:i!==void 0&&e.endsWith(i)?s=e.slice(0,-i.length):s=e,o.includes(s)?s:(console.error(`Invalid gate type: '${s}'`),r)}c(Ou,"validateGateType");var ao=ye("gate1",!0,!0,{variantName:({type:o})=>[o],button:{imgWidth:50},repr:{poseAs:P(_d),showAsUnknown:P(xc.boolean)},valueDefaults:{},params:{type:Ce("not")},validateParams:({type:o},n,e)=>({type:Ou(no,o,n,e.type.defaultValue)}),idPrefix:({type:o})=>o,size:()=>({gridWidth:7,gridHeight:4}),makeNodes:()=>({ins:{In:[[-4,0,"w"]]},outs:{Out:[4,0,"e"]}}),initialValue:()=>!1}),Mu=class extends Us{get numBits(){return 1}constructor(n,e,r){super(n,ao.with(e),e.type,r)}gateTypes(){return no}toJSON(){return super.toJSONBase()}mouseDoubleClicked(n){let e=super.mouseDoubleClicked(n);return e.isChange?e:this.parent.mode>=3?(this.doSetType(this.type==="buf"?"not":"buf"),Z.SimpleChange):Z.NoChange}};c(Mu,"Gate1");ao.impl=Mu;var qe=ye("gate",!0,!0,{variantName:({type:o,bits:n})=>[o,`${o}-${n}`],button:{imgWidth:50},repr:{poseAs:P(Md),showAsUnknown:P(xc.boolean)},valueDefaults:{},params:{bits:Ce(2,[2,3,4,7,8,16]),type:Ce("and")},validateParams:({type:o,bits:n},e,r)=>({type:Ou(n>2?ko:or,o,e,r.type.defaultValue),numBits:n}),idPrefix:({type:o})=>o,size:({numBits:o})=>({gridWidth:7+Math.max(0,o-2)*2,gridHeight:4+Math.max(0,o-2)*2}),makeNodes:({numBits:o})=>{let n=4+(o-2),e=-n;return{ins:{In:ie("w",e,0,o)},outs:{Out:[n,0,"e"]}}},initialValue:()=>!1}),Ru=class extends Us{constructor(e,r,i){super(e,qe.with(r),r.type,i);this.numBits=r.numBits}gateTypes(e){return e>2?ko:or}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits!==qe.aults.bits?this.numBits:void 0})}mouseDoubleClicked(e){let r=super.mouseDoubleClicked(e);if(r.isChange)return r;if(this.parent.mode>=3){let i=(()=>{switch(this.type){case"imply":return"rimply";case"rimply":return"imply";case"nimply":return"rnimply";case"rnimply":return"nimply";case"txa":return"txb";case"txb":return"txna";case"txna":return"txnb";case"txnb":return"txa";default:return}})();if(i!==void 0)return this.doSetType(i),Z.SimpleChange}return Z.NoChange}makeComponentSpecificContextMenuItems(){let e=x.Components.Generic.contextMenu;return[...su.includes(this.type)?[]:[this.makeChangeParamsContextMenuItem("inputs",e.ParamNumInputs,this.numBits,"bits"),["mid",_.sep()]],...super.makeComponentSpecificContextMenuItems()]}};c(Ru,"GateN");qe.impl=Ru;function*q3(o){let n=0,e=1<<o;for(;n<e;)yield n.toString(2).padStart(o,"0").split("").reverse().map(s=>s==="1"),n++}c(q3,"valueCombinations");function X3([o,n]){let e=n.map(({matchesCurrent:r,cells:i})=>Ql(r?at("current"):At,...i.map(s=>rd(Oo(s)))));return Z0(at("truth-table"),ed(Ql(...o.map(r=>nd(r)))),td(...e))}c(X3,"makeTruthTable");function Y3(o,n,e,r,i){let s=200+Math.max(0,o-2)*50;return Q(n,q(z(e),z(r),z(i)),s)}c(Y3,"makeGateTooltip");var Fu=ce(Me());var ar=ye("gate-array",!0,!0,{variantName:({type:o,bits:n})=>["gate-array",`${o}-array`,`${o}-array-${n}`],idPrefix:"array",button:{imgWidth:50},repr:{bits:P(Fu.number),showAsUnknown:P(Fu.boolean)},valueDefaults:{showAsUnknown:!1},params:{bits:Ce(4,[2,4,8,16]),type:Ce("and",or.values)},validateParams:({type:o,bits:n},e,r)=>({type:Ou(or,o,e,r.type.defaultValue,"-array"),numBits:n}),size:Sr.size,makeNodes:({numBits:o})=>{let n=5+Math.max(0,(o-8)/2);return{ins:{A:ie("w",-3,-n,o),B:ie("w",-3,n,o)},outs:{S:ie("e",3,0,o)}}},initialValue:(o,{numBits:n})=>$(!1,n)}),Nu=class extends we{constructor(e,r,i){var s;super(e,ar.with(r),i);this.numBits=r.numBits,this._type=r.type,this._showAsUnknown=(s=i==null?void 0:i.showAsUnknown)!=null?s:ar.aults.showAsUnknown}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===ar.aults.bits?void 0:this.numBits,showAsUnknown:this._showAsUnknown===ar.aults.showAsUnknown?void 0:this._showAsUnknown})}jsonType(){return`${this._type}-array`}get type(){return this._type}makeTooltip(){let e=x.Components.GateArray.tooltip,r=x.Components.Gate[this._type][0];return Q(e.title,q(z(e.desc.expand({op:r}))))}doRecalcValue(){let e=or.props[this._type].out,r=this.inputValues(this.inputs.A),i=this.inputValues(this.inputs.B);return wt(s=>e([r[s],i[s]]),this.numBits)}propagateValue(e){this.outputValues(this.outputs.S,e)}doDraw(e,r){this.doDrawDefault(e,r,{skipLabels:!0,drawInside:({left:i,right:s})=>{if(this._showAsUnknown)r.inNonTransformedFrame(()=>{e.fillStyle=ct,e.textAlign="center",e.font="bold 20px sans-serif",e.fillText("?",this.posX,this.posY)});else{e.lineWidth=2,e.strokeStyle=K,e.beginPath();let a=this.posY-H,u=this.posY+H,l=i+10,p=s-10,d=Math.PI/2,f=this._type,m=c(()=>{e.beginPath(),pn(e,p+3,this.posY,5),e.stroke()},"drawRightCircle"),h=c(v=>{e.beginPath(),pn(e,l-3,this.posY-(v?1:-1)*4,5),e.stroke()},"drawLeftCircle");switch(f){case"and":case"nand":case"nimply":case"rnimply":{e.moveTo(this.posX,u),e.lineTo(l,u),e.lineTo(l,a),e.lineTo(this.posX,a),e.arc(this.posX,this.posY,H,-d,d),e.closePath(),e.stroke(),e.beginPath(),f.startsWith("nand")&&m(),f==="nimply"?h(!1):f==="rnimply"&&h(!0);break}case"or":case"nor":case"xor":case"xnor":case"imply":case"rimply":{e.beginPath(),e.moveTo(l,a),e.lineTo(this.posX-5,a),e.bezierCurveTo(this.posX+2,a,p-5,this.posY-8,p,this.posY),e.bezierCurveTo(p-5,this.posY+8,this.posX+2,u,this.posX-5,u),e.lineTo(l,u),e.quadraticCurveTo(this.posX-4,this.posY,l,a),e.closePath(),e.stroke();let v=l;l+=2,(f.startsWith("nor")||f.startsWith("xnor"))&&m(),f==="imply"?h(!0):f==="rimply"&&h(!1),f.startsWith("x")&&(e.beginPath(),e.moveTo(v-4,u),e.quadraticCurveTo(this.posX-8,this.posY,v-4,a),e.stroke());break}case"txa":case"txna":{e.beginPath(),e.moveTo(l,u),e.lineTo(l,a),e.lineTo(p,this.posY),e.lineTo(l+2,this.posY),e.stroke(),f==="txna"&&h(!0);break}case"txb":case"txnb":{e.beginPath(),e.moveTo(l,a),e.lineTo(l,u),e.lineTo(p,this.posY),e.lineTo(l+2,this.posY),e.stroke(),f==="txnb"&&h(!1);break}}}}})}doSetType(e){this._type=e,this.setNeedsRecalc(),this.setNeedsRedraw("quad gate type changed")}doSetShowAsUnknown(e){this._showAsUnknown=e,this.setNeedsRedraw("display as unknown changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.GateArray.contextMenu,r=[];for(let s of["and","or","xor","nand","nor","xnor","-","imply","rimply","nimply","rnimply"])if(s==="-")r.push(_.sep());else{let a=this._type===s?"check":"none";r.push(_.item(a,s,()=>{this.doSetType(s)}))}let i=[["mid",_.submenu("settings",e.Type,r)]];if(this.parent.mode>=4){let s=_.item(this._showAsUnknown?"check":"none",e.ShowAsUnknown,()=>{this.doSetShowAsUnknown(!this._showAsUnknown)});i.push(["mid",s])}return i.push(["mid",_.sep()],this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)),i}};c(Nu,"GateArray");ar.impl=Nu;var Gi=ve("halfadder",{idPrefix:"hadder",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:4,gridHeight:6},makeNodes:()=>{let o=x.Components.Generic;return{ins:{A:[-4,-2,"w","A",{hasTriangle:!0}],B:[-4,2,"w","B",{hasTriangle:!0}]},outs:{S:[4,-2,"e",o.OutputSumDesc,{hasTriangle:!0}],C:[4,2,"e",o.OutputCarryDesc,{hasTriangle:!0}]}}},initialValue:()=>({s:!1,c:!1})}),Bu=class extends he{constructor(n,e){super(n,Gi,e)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.HalfAdder.tooltip;return Q(n.title,q(z(n.desc)))}doRecalcValue(){let n=this.inputs.A.value,e=this.inputs.B.value;if(U(n)||U(e)||me(n)||me(e))return{s:I,c:I};switch(+n+ +e){case 0:return{s:!1,c:!1};case 1:return{s:!0,c:!1};case 2:return{s:!1,c:!0};default:return console.log("ERROR: sum of halfadder is > 2"),{s:!1,c:!1}}}propagateValue(n){this.outputs.S.value=n.s,this.outputs.C.value=n.c}doDraw(n,e){this.doDrawDefault(n,e,()=>{n.fillStyle=K,n.font="26px sans-serif",n.textAlign="center",n.textBaseline="middle",n.fillText("+",this.posX,this.posY-2)})}makeComponentSpecificContextMenuItems(){return this.makeForceOutputsContextMenuItem()}};c(Bu,"HalfAdder");Gi.impl=Bu;var wc=ce(Me());var $n=ve("label",{idPrefix:"label",button:{imgWidth:32},repr:{text:wc.string,font:P(wc.string)},valueDefaults:{text:"Label",font:Ja},size:{gridWidth:4,gridHeight:2},makeNodes:()=>({})}),Ui=class extends he{constructor(e,r){var i,s;super(e,$n,r);this._cachedTextMetrics=void 0;this._text=(i=r==null?void 0:r.text)!=null?i:$n.aults.text,this._font=(s=r==null?void 0:r.font)!=null?s:$n.aults.font}toJSON(){return Y(k({},this.toJSONBase()),{text:this._text,font:this._font===$n.aults.font?void 0:this._font})}get unrotatedWidth(){var e,r;return(r=(e=this._cachedTextMetrics)==null?void 0:e.width)!=null?r:H*this._text.length}get unrotatedHeight(){let e=this._cachedTextMetrics;return e===void 0?2*H:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent}get text(){return this._text}doRecalcValue(){}get drawZIndex(){return 2}doDraw(e,r){if(e.font=this._font,e.lineWidth=3,r.isMouseOver){this._cachedTextMetrics===void 0&&(this._cachedTextMetrics=e.measureText(this._text));let i=this.unrotatedWidth,s=this.unrotatedHeight;e.strokeStyle=r.borderColor,e.beginPath(),e.rect(this.posX-i/2,this.posY-s/2,i,s),e.stroke()}e.fillStyle=K,e.textAlign="center",e.textBaseline="middle",e.fillText(this._text,this.posX,this.posY)}doSetText(e){this._text=e,this._cachedTextMetrics=void 0,this.setNeedsRedraw("text changed")}doSetFont(e){this._font=e,this._cachedTextMetrics=void 0,this.setNeedsRedraw("font changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.Label.contextMenu,r=_.item("pen",e.ChangeText,this.runSetTextDialog.bind(this),"\u21A9\uFE0E"),i=_.item("font",e.Font,()=>{this.runSetFontDialog(this._font,$n.aults.font,this.doSetFont.bind(this))});return[["mid",r],["mid",i]]}runSetTextDialog(){let e=window.prompt(x.Components.Label.contextMenu.ChangeTextPrompt,this._text);if(e!==null){let r=e.length===0?$n.aults.text:e;return this.doSetText(r),Z.SimpleChange}return Z.NoChange}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetTextDialog():super.keyDown(e)}mouseDoubleClicked(e){let r=super.mouseDoubleClicked(e);return r.isChange?r:this.runSetTextDialog()}};c(Ui,"Label");$n.impl=Ui;var zi=ve("latch-sr",Y(k({idPrefix:"latch"},Mn),{makeNodes:()=>{let o=Mn.makeNodes(),n=x.Components.Generic;return{ins:{S:[-4,-2,"w",n.InputSetDesc,{prefersSpike:!0}],R:[-4,2,"w",n.InputResetDesc,{prefersSpike:!0}]},outs:o.outs}}})),Iu=class extends on{constructor(n,e){super(n,zi,e)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.LatchSR.tooltip;return Q(n.title,q(z(n.desc)))}doRecalcValue(){let n=this.inputs.S.value,e=this.inputs.R.value;if(this._isInInvalidState=!1,n===!0)return e===!0?(this._isInInvalidState=!0,[!1,!1]):[!0,!1];if(e===!0)return[!1,!0];let r=this.outputs.Q.value;return[r,Ue.invert(r)]}makeComponentSpecificContextMenuItems(){let n=this._showContent?"check":"none";return[["mid",_.item(n,x.Components.Generic.contextMenu.ShowContent,()=>{this.doSetShowContent(!this._showContent)})],...this.makeForceOutputsContextMenuItem(!0)]}};c(Iu,"LatchSR");zi.impl=Iu;var zs=ce(Me());var uo=ye("mux",!0,!0,{variantName:({from:o,to:n})=>`mux-${o}to${n}`,idPrefix:"mux",button:{imgWidth:50},repr:{from:P(zs.number),to:P(zs.number),showWiring:P(zs.boolean)},valueDefaults:{showWiring:!0},params:{to:Ce(2,[1,2,4,8,16]),from:Ce(4)},validateParams:({from:o,to:n})=>{let e=Math.min(16*n,Math.max(2*n,o)),r=Math.ceil(e/n),i=Math.ceil(Math.log2(r));return{numFrom:e,numTo:n,numGroups:r,numSel:i}},size:({numFrom:o,numTo:n,numGroups:e,numSel:r})=>{let i=2*r,s=Je(n===1?o:n)?1:2,a=n>1?1:0,u=o+(e-1)*a,l=1+s*u;return{gridWidth:i,gridHeight:l}},makeNodes:({numTo:o,numGroups:n,numSel:e})=>{let r=1+e,i=-r,s=Ha("w",i,0,n,o),u=s[0][0][1]-2;return{ins:{I:s,S:tr("n",0,u,e)},outs:{Z:ie("e",r,0,o)}}},initialValue:(o,{numTo:n})=>$(!1,n)}),Pu=class extends we{constructor(e,r,i){var s;super(e,uo.with(r),i);this.numFrom=r.numFrom,this.numTo=r.numTo,this.numGroups=r.numGroups,this.numSel=r.numSel,this._showWiring=(s=i==null?void 0:i.showWiring)!=null?s:uo.aults.showWiring}toJSON(){return Y(k({},super.toJSONBase()),{from:this.numFrom,to:this.numTo,showWiring:this._showWiring!==uo.aults.showWiring?this._showWiring:void 0})}makeTooltip(){return Q(void 0,q(z(x.Components.Mux.tooltip.expand({from:this.numFrom,to:this.numTo}))))}doRecalcValue(){let e=this.inputValues(this.inputs.S),r=Oe(e,!1)[1];return U(r)?$(I,this.numTo):this.inputValues(this.inputs.I[r])}propagateValue(e){this.outputValues(this.outputs.Z,e)}doDraw(e,r){let{top:i,left:s,bottom:a,right:u}=this.bounds(),l=(u-s)/3;for(let d of this.inputs.I)for(let f of d)Ae(e,f,s,f.posYInParentTransform);for(let d of this.inputs.S)Ae(e,d,d.posXInParentTransform,i+l);for(let d of this.outputs.Z)Ae(e,d,u,d.posYInParentTransform);e.fillStyle=Ke;let p=e.createPath();if(p.moveTo(s,i),p.lineTo(u,i+l),p.lineTo(u,a-l),p.lineTo(s,a),p.closePath(),e.fill(p),this._showWiring){let d=this.inputValues(this.inputs.S),f=Oe(d,!1)[1];if(!U(f)){let m=this.parent.options.hideWireColors,h=this.inputs.I[f],v=(u-s)/3,D=this.parent.options.wireStyle===$t.straight;for(let b=0;b<h.length;b++){this.parent.options.wireStyle,e.beginPath();let C=h[b].posYInParentTransform,A=this.outputs.Z[b],M=A.posYInParentTransform;e.moveTo(s+1,C),D?(e.lineTo(s+3,C),e.lineTo(u-3,M),e.lineTo(u-1,M)):e.bezierCurveTo(s+v,C,u-v,M,u-1,M),Jr(e,h[b].value,A.color,!1,m)}}}e.lineWidth=3,e.strokeStyle=r.borderColor,e.stroke(p)}doSetShowWiring(e){this._showWiring=e,this.setNeedsRedraw("show wiring changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.MuxDemux.contextMenu,r=this._showWiring?"check":"none",i=_.item(r,e.ShowWiring,()=>{this.doSetShowWiring(!this._showWiring)});return[this.makeChangeParamsContextMenuItem("outputs",e.ParamNumTo,this.numTo,"to"),this.makeChangeParamsContextMenuItem("inputs",e.ParamNumFrom,this.numFrom,"from",[2,4,8,16].map(s=>s*this.numTo)),["mid",_.sep()],["mid",i],...this.makeForceOutputsContextMenuItem(!0)]}};c(Pu,"Mux");uo.impl=Pu;var Wd=ce(Me());var Hd=ce(ma()),yn=ce(Me());var qi={button:{imgWidth:50},repr:{bits:P(yn.number),lines:P(yn.number),showContent:P(yn.boolean),displayRadix:P(yn.number),content:P(yn.union([yn.string,yn.array(yn.string)]))},valueDefaults:{showContent:!0,displayRadix:void 0},params:{bits:Ce(4,[4,8,16,32]),lines:Ce(16,[8,16,32,64,128,256,512,1024,2048])},validateParams:({bits:o,lines:n})=>{let e=Math.ceil(Math.log2(n)),r=Math.pow(2,e);return{numDataBits:o,numAddressBits:e,numWords:r}},size:({numWords:o,numDataBits:n})=>({gridWidth:11,gridHeight:Math.max(o<=16?16:22,n+4)}),makeNodes:({numDataBits:o,numAddressBits:n,gridHeight:e})=>{let r=-Math.ceil((e+1)/2);return{ins:{Addr:tr("n",0,r,n)},outs:{Q:ie("e",7,0,o)}}},initialValue:(o,{numDataBits:n,numWords:e})=>{if(o===void 0||o.content===void 0)return ur.defaultValue(e,n);let r=ur.contentsFromString(o.content,n,e),i=[...r[0]];return{mem:r,out:i}}},ur=class extends we{constructor(e,r,i,s){var a,u;super(e,r.with(i),s);this.numDataBits=i.numDataBits,this.numAddressBits=i.numAddressBits,this.numWords=i.numWords,this._showContent=(a=s==null?void 0:s.showContent)!=null?a:this.canShowContent()?Ht.aults.showContent:!1,this._displayRadix=(u=s==null?void 0:s.displayRadix)!=null?u:Ht.aults.displayRadix}static defaultValue(e,r){return ur.valueFilledWith(!1,e,r)}static valueFilledWith(e,r,i){let s=new Array(r);for(let u=0;u<r;u++)s[u]=$(e,i);let a=$(e,i);return{mem:s,out:a}}static contentsFromString(e,r,i){let s=pe(e)?e:e.split(/\s+/),a=new Array(i);for(let u=0;u<i;u++){let l=u>=s.length?$(!1,r):Sa(s[u],r);a[u]=l}return a}toJSONBase(){return Y(k({},super.toJSONBase()),{bits:this.numDataBits===Ht.aults.bits?void 0:this.numDataBits,lines:this.numWords===Ht.aults.lines?void 0:this.numWords,showContent:this.canShowContent()&&this._showContent!==Ht.aults.showContent?this._showContent:void 0,displayRadix:this._displayRadix!==Ht.aults.displayRadix?this._displayRadix:void 0,content:this.contentRepr(" ",!0)})}contentRepr(e,r){let i=[],s=this.numDataBits>=8,a=Math.ceil(this.numDataBits/4);for(let l=0;l<this.numWords;l++){let p=this.value.mem[l],d=s&&Ta(p)?Ea(p,a):Mo(p);i.push(d)}if(r){let l=0;for(let p=this.numWords-1;p>=0&&li(i[p]);p--)l++;l>0&&i.splice(this.numWords-l,l)}return i.length===0?void 0:i.join(e)}currentAddress(){let e=this.inputValues(this.inputs.Addr),[r,i]=Oe(e,!1);return i}propagateValue(e){this.outputValues(this.outputs.Q,e.out)}canShowContent(){return this.numWords<=64&&this.numDataBits<=16}doSetShowContent(e){this._showContent=e,this.setNeedsRedraw("show content changed")}doDraw(e,r){this.doDrawDefault(e,r,(i,{width:s,height:a})=>{let u=this.value.mem,l=this.currentAddress(),p,d;if(!this._showContent||!this.canShowContent()||this.parent.options.hideMemoryContent){e.font="bold 18px sans-serif",e.fillStyle=K,e.textAlign="center",e.textBaseline="middle",e.fillText(this.moduleName,this.posX,this.posY-6),e.font="11px sans-serif";let f=this.numWords>=1024?`${this.numWords/1024}k`:this.numWords.toString();e.fillText(`${f} \xD7 ${this.numDataBits} bits`,this.posX,this.posY+12),d=this.posX,p=this.posY+25}else{let f=ue.isVertical(this.orient),m=f,h=this._displayRadix!==void 0?12:0,v=this.posY-h/2,[D,b]=f?[a-66,s-30-h]:[s-42,a-30-h],C=10,A=!1,M=Math.floor((b-h)*2/this.numWords)/2;if(M<=2&&m&&(A=!0,M=Math.floor((b-h)*4/this.numWords)/2),A){let w=Math.floor((D/2-2*C)*2/this.numDataBits)/2;d=this.posX,p=Ac(e,u,this.numDataBits,l,0,this.numWords/2,this.posX+2-38,v,w,M),Ac(e,u,this.numDataBits,l,this.numWords/2,this.numWords,this.posX+2+38,v,w,M)}else{let w=Math.floor((D-C)*2/this.numDataBits)/2;d=this.posX+3,p=Ac(e,u,this.numDataBits,l,0,this.numWords,d,v,w,M)}}if(this._displayRadix!==void 0){e.textAlign="center",e.textBaseline="top";let f=U(l)?I:Oe(u[l],!1)[1],m=Zr(f,this._displayRadix,this.numDataBits,!0);e.fillStyle=K,e.fillText(`${m}`,d,p+3)}})}doSetDisplayRadix(e){this._displayRadix=e,this.setNeedsRedraw("additional display radix changed")}doSetMem(e){let r=this.currentAddress(),i=U(r)?$(I,this.numDataBits):e[r];this.doSetValue({mem:e,out:i},!0)}makeComponentSpecificContextMenuItems(){let e=x.Components.RAM.contextMenu,r=x.Components.Generic.contextMenu,i=x.Components.Display.contextMenu,s=c((h,v)=>{let D=this._displayRadix===h?"check":"none";return _.item(D,v,()=>this.doSetDisplayRadix(h))},"makeItemShowRadix"),a=["mid",_.item("memcontent",e.EditContent,()=>{let h=this.contentRepr(" ",!1),v=window.prompt(e.EditContentPrompt,h);v!==null&&this.doSetMem(lr.contentsFromString(v,this.numDataBits,this.numWords))})],u=["mid",_.item("download",e.SaveContent,()=>{var D,b;let h=new Blob([this.contentRepr(`
`,!1)],{type:"text/plain"}),v=((D=this.parent.options.name)!=null?D:"circuit")+"."+((b=this.ref)!=null?b:this.moduleName.toLowerCase())+"-content.txt";(0,Hd.saveAs)(h,v)})],l=["mid",_.item("open",e.LoadContent,()=>{this.parent.editor.runFileChooser("text/plain",h=>wo(this,null,function*(){let v=yield h.text();this.doSetMem(lr.contentsFromString(v,this.numDataBits,this.numWords))}))})],p=["mid",_.item("replace",e.SwapROMRAM,()=>{let h=this instanceof qs,v=this.toNodelessJSON();v.type=h?"ram":"rom";let b=(h?Ht:Xo).makeFromJSON(this.parent,v);return b===void 0?(console.warn("Could not swap ROM/RAM from repr:",v),Z.NoChange):(this.replaceWithComponent(b),Z.SimpleChange)})],d=["mid",_.submenu("eye",e.SelectedDataDisplay,[s(void 0,i.DisplayNone),_.sep(),s(2,i.DisplayAsBinary),s(16,i.DisplayAsHexadecimal),s(10,i.DisplayAsDecimal),s(-10,i.DisplayAsSignedDecimal),s(8,i.DisplayAsOctal)])],f=this._showContent?"check":"none",m=this.canShowContent()?[["mid",_.item(f,r.ShowContent,()=>this.doSetShowContent(!this._showContent))]]:[];return[...this.makeSpecificROMRAMItems(),d,...m,["mid",_.sep()],a,u,l,["mid",_.sep()],p,["mid",_.sep()],this.makeChangeParamsContextMenuItem("memlines",r.ParamNumWords,this.numWords,"lines"),this.makeChangeParamsContextMenuItem("outputs",x.Components.Generic.contextMenu.ParamNumBits,this.numDataBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}makeSpecificROMRAMItems(){return[]}};c(ur,"ROMRAMBase");function Ac(o,n,e,r,i,s,a,u,l,p){let d=s-i,f=u-d/2*p,m=a-e/2*l,h=m+e*l,v=f+d*p;o.fillStyle=Ci,o.fillRect(m,f,h-m,v-f);for(let b=i;b<s;b++)for(let C=0;C<e;C++){let A=n[b][e-C-1];A!==!1&&(o.fillStyle=Nt(A),o.fillRect(m+C*l,f+b*p,l,p))}o.strokeStyle=K,o.lineWidth=.5;for(let b=1;b<d;b++){let C=f+b*p;Os(o,m,C,h,C)}for(let b=1;b<e;b++){let C=m+b*l;Os(o,C,f,C,v)}let D=2;if(o.lineWidth=D,o.strokeRect(m-D/2,f-D/2,h-m+D,v-f+D),!U(r)&&r>=i&&r<s){let b=f+(r-i)*p+p/2,C=m-3,A=8,M=3;o.beginPath(),o.moveTo(C,b),o.lineTo(C-A,b+M),o.lineTo(C-A+2,b),o.lineTo(C-A,b-M),o.closePath(),o.fillStyle=K,o.fill()}return v}c(Ac,"drawMemoryCells");var Xo=ye("rom",!0,!0,k({variantName:({bits:o,lines:n})=>`rom-${n}x${o}`,idPrefix:"rom"},qi)),qs=class extends ur{constructor(n,e,r){super(n,Xo,e,r)}toJSON(){return super.toJSONBase()}get moduleName(){return"ROM"}doRecalcValue(){let{mem:n}=this.value,e=this.currentAddress(),r=U(e)?$(I,this.numDataBits):n[e];return{mem:n,out:r}}makeTooltip(){let n=x.Components.ROM.tooltip;return Q(n.title,q(z(n.desc.expand({numWords:this.numWords,numDataBits:this.numDataBits}))))}};c(qs,"ROM");Xo.impl=qs;var Ht=ye("ram",!0,!0,Y(k({variantName:({bits:o,lines:n})=>`ram-${n}x${o}`,idPrefix:"ram"},qi),{repr:Y(k({},qi.repr),{trigger:P(Wd.keyof($e))}),valueDefaults:Y(k({},qi.valueDefaults),{trigger:$e.rising}),makeNodes:(o,n)=>{let e=qi.makeNodes(o,n),{numDataBits:r,gridHeight:i}=o,s=Math.ceil((i+1)/2),a=s-2,u=x.Components.Generic;return{ins:{Clock:[-7,a,"w",u.InputClockDesc,{isClock:!0}],WE:[-2,s,"s",u.InputWriteEnableDesc],Clr:[2,s,"s",u.InputClearDesc,{prefersSpike:!0}],D:ie("w",-7,0,r),Addr:e.ins.Addr},outs:e.outs}}})),lr=class extends ur{constructor(e,r,i){var s;super(e,Ht,r,i);this._trigger=Ht.aults.trigger;this._lastClock=I;this._trigger=(s=i==null?void 0:i.trigger)!=null?s:Ht.aults.trigger}toJSON(){return Y(k({},super.toJSONBase()),{trigger:this._trigger!==Ht.aults.trigger?this._trigger:void 0})}get moduleName(){return"RAM"}get trigger(){return this._trigger}doSetTrigger(e){this._trigger=e,this.setNeedsRedraw("trigger changed")}doRecalcValue(){let e=this.inputs.Clr.value,r=this.numWords;if(e===!0)return lr.valueFilledWith(!1,r,this.numDataBits);let i=this.currentAddress(),s=this._lastClock,a=this._lastClock=this.inputs.Clock.value,u=this.value;if(this.inputs.WE.value!==!0||!pt.isClockTrigger(this.trigger,s,a)){let f=U(i)?$(I,this.numDataBits):u.mem[i];return{mem:u.mem,out:f}}if(U(i))return lr.valueFilledWith(I,r,this.numDataBits);let p=this.inputValues(this.inputs.D).map(Ue.filterHighZ),d=new Array(r);for(let f=0;f<r;f++)f===i?d[f]=p:d[f]=u.mem[f];return{mem:d,out:p}}makeTooltip(){let e=x.Components.RAM.tooltip;return Q(e.title,q(z(e.desc.expand({numWords:this.numWords,numDataBits:this.numDataBits}))))}override(){return[...Mr(this._trigger,this.doSetTrigger.bind(this)),["mid",_.sep()]]}};c(lr,"RAM");Ht.impl=lr;var Yo=ce(Me());var pr=ce(Me());var lo={button:{imgWidth:50},repr:{bits:P(pr.number),showContent:P(pr.boolean),trigger:P(pr.keyof($e)),content:P(pr.string)},valueDefaults:{showContent:!0,trigger:$e.rising},params:{bits:Ce(4,[2,4,8,16])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>({gridWidth:7,gridHeight:o===2?11:Math.max(15,5+o)}),makeNodes:({numBits:o,gridHeight:n})=>{let e=(n+1)/2,r=e-2,i=-e,s=x.Components.Generic;return{ins:{Clock:[-5,r,"w",s.InputClockDesc,{isClock:!0}],Pre:[0,i,"n",s.InputPresetDesc,{prefersSpike:!0}],Clr:[0,e,"s",s.InputClearDesc,{prefersSpike:!0}]},outs:{Q:ie("e",5,0,o)}}},initialValue:(o,{numBits:n})=>{let e;return o===void 0||(e=o.content)===void 0?$(!1,n):Sa(e,n)}},cr=class extends we{constructor(e,r,i,s){var a,u;super(e,r.with(i),s);this._isInInvalidState=!1;this._lastClock=I;this.numBits=i.numBits,this._showContent=(a=s==null?void 0:s.showContent)!=null?a:fn.aults.showContent,this._trigger=(u=s==null?void 0:s.trigger)!=null?u:fn.aults.trigger}toJSONBase(){return Y(k({bits:this.numBits===fn.aults.bits?void 0:this.numBits},super.toJSONBase()),{showContent:this._showContent!==fn.aults.showContent?this._showContent:void 0,trigger:this._trigger!==fn.aults.trigger?this._trigger:void 0,content:this.contentRepr()})}contentRepr(){let e=this.value,r=Math.ceil(this.numBits/4),i=Ta(e)?Ea(e,r):Mo(e);return li(i)?void 0:i}get trigger(){return this._trigger}doRecalcValue(){let e=this._lastClock,r=this._lastClock=this.inputs.Clock.value,{isInInvalidState:i,newState:s}=pt.doRecalcValueForSyncComponent(this,e,r,this.inputs.Pre.value,this.inputs.Clr.value);return this._isInInvalidState=i,s}makeInvalidState(){return $(!1,this.numBits)}makeStateFromMainValue(e){return $(e,this.numBits)}propagateValue(e){this.outputValues(this.outputs.Q,e)}doSetShowContent(e){this._showContent=e,this.setNeedsRedraw("show content changed")}doSetTrigger(e){this._trigger=e,this.setNeedsRedraw("trigger changed")}doDraw(e,r){this.doDrawDefault(e,r,i=>{this._showContent&&!this.parent.options.hideMemoryContent?cr.drawStoredValues(e,i,this.outputs.Q,this.posX,ue.isVertical(this.orient)):this.doDrawGenericCaption(e)})}static drawStoredValues(e,r,i,s,a){let u=Je(i.length)?H:2*H;for(let l of i)on.drawStoredValue(e,l.value,...r.rotatePoint(s,l.posYInParentTransform),u,a)}makeComponentSpecificContextMenuItems(){let e=x.Components.Generic.contextMenu,r=this._showContent?"check":"none",i=_.item(r,e.ShowContent,()=>this.doSetShowContent(!this._showContent));return[this.makeChangeParamsContextMenuItem("outputs",e.ParamNumBits,this.numBits,"bits"),...this.makeRegisterSpecificContextMenuItems(),["mid",_.sep()],...Mr(this._trigger,this.doSetTrigger.bind(this)),["mid",_.sep()],["mid",i],...this.makeForceOutputsContextMenuItem(!0)]}makeRegisterSpecificContextMenuItems(){return[]}};c(cr,"RegisterBase");var fn=ye("reg",!0,!0,Y(k({variantName:({bits:o})=>`reg-${o}`,idPrefix:"reg"},lo),{repr:Y(k({},lo.repr),{inc:P(pr.boolean),saturating:P(pr.boolean)}),valueDefaults:Y(k({},lo.valueDefaults),{saturating:!1}),params:{bits:lo.params.bits,inc:Wa()},validateParams:({bits:o,inc:n})=>({numBits:o,hasIncDec:n}),makeNodes:(o,n)=>{let e=lo.makeNodes(o,n),r=e.ins.Clr,i=e.ins.Clr[1];return{ins:k(Y(k({},e.ins),{D:ie("w",-5,0,o.numBits)}),o.hasIncDec?{Clr:[2,i,"s",r[3],r[4]],Inc:[-2,i,"s"],Dec:[0,i,"s"]}:{}),outs:e.outs}}})),ku=class extends cr{constructor(e,r,i){var s;super(e,fn,r,i);this.hasIncDec=r.hasIncDec,this._saturating=this.hasIncDec&&((s=i==null?void 0:i.saturating)!=null?s:fn.aults.saturating)}toJSON(){return Y(k({},this.toJSONBase()),{inc:this.hasIncDec===fn.aults.inc?void 0:this.hasIncDec,saturating:this._saturating===fn.aults.saturating?void 0:this._saturating})}makeTooltip(){let e=x.Components.Register.tooltip;return Q(e.title,q(z(e.desc.expand({numBits:this.numBits}))))}makeStateAfterClock(){var i,s,a,u;let e=(s=(i=this.inputs.Inc)==null?void 0:i.value)!=null?s:!1,r=(u=(a=this.inputs.Dec)==null?void 0:a.value)!=null?u:!1;if(U(e)||U(r)||me(e)||me(r))return $(!1,this.numBits);if(e||r){if(e&&r)return this.value;let[l,p]=Oe(this.value,!1);if(U(p))return $(I,this.numBits);let d;if(e){if(d=p+1,d>=fa(2,this.numBits))return this._saturating?$(!0,this.numBits):$(!1,this.numBits)}else if(d=p-1,d<0)return this._saturating?$(!1,this.numBits):$(!0,this.numBits);return Yn.decimalToNBits(d,this.numBits)}return this.inputValues(this.inputs.D).map(Ue.filterHighZ)}doDrawGenericCaption(e){e.font="bold 15px sans-serif",e.fillStyle=K,e.textAlign="center",e.textBaseline="middle",e.fillText("Reg.",this.posX,this.posY-8),e.font="11px sans-serif",e.fillText(`${this.numBits} bits`,this.posX,this.posY+10)}doSetSaturating(e){this._saturating=e,this.setNeedsRedraw("saturating changed")}makeRegisterSpecificContextMenuItems(){let e=x.Components.Register.contextMenu,r=this.hasIncDec?[["mid",_.item(this._saturating?"check":"none",e.Saturating,()=>this.doSetSaturating(!this._saturating))]]:[];return[this.makeChangeBooleanParamsContextMenuItem(e.ParamHasIncDec,this.hasIncDec,"inc"),...r]}};c(ku,"Register");fn.impl=ku;var bn=ye("rand",!0,!0,{variantName:({bits:o})=>`rand-${o}`,idPrefix:"rand",button:{imgWidth:32},repr:{bits:P(Yo.number),prob1:P(Yo.number),showProb:P(Yo.boolean),trigger:P(Yo.keyof($e)),name:Ot},valueDefaults:{prob1:.5,showProb:!1,trigger:$e.rising},params:{bits:Ce(1,[1,2,3,4,7,8,16])},validateParams:({bits:o})=>({numBits:o}),size:({numBits:o})=>({gridWidth:4,gridHeight:4+(Je(o)?o/2:o)*2}),makeNodes:({numBits:o,gridHeight:n})=>{let e=x.Components.Generic;return{ins:{Clock:[-3,n/2-1,"w",e.InputClockDesc,{isClock:!0}]},outs:{Out:ie("e",3,0,o)}}},initialValue:(o,{numBits:n})=>$(!1,n)}),Vu=class extends we{constructor(e,r,i){var s,a,u;super(e,bn.with(r),i);this._lastClock=I;this.numBits=r.numBits,this._prob1=(i==null?void 0:i.prob1)!==void 0?Math.max(0,Math.min(1,i.prob1)):bn.aults.prob1,this._showProb=(s=i==null?void 0:i.showProb)!=null?s:bn.aults.showProb,this._trigger=(a=i==null?void 0:i.trigger)!=null?a:bn.aults.trigger,this._name=(u=i==null?void 0:i.name)!=null?u:void 0}toJSON(){return Y(k({},super.toJSONBase()),{bits:this.numBits===bn.aults.bits?void 0:this.numBits,name:this._name,prob1:this._prob1!==bn.aults.prob1?this._prob1:void 0,showProb:this._showProb!==bn.aults.showProb?this._showProb:void 0,trigger:this._trigger!==bn.aults.trigger?this._trigger:void 0})}get allowsForcedOutputs(){return!1}makeTooltip(){let e=x.Components.Random.tooltip;return Q(e.title,e.desc[0]+this._prob1+e.desc[1])}doRecalcValue(){let e=this._lastClock,r=this._lastClock=this.inputs.Clock.value;return pt.isClockTrigger(this._trigger,e,r)?wt(c(()=>Math.random()<this._prob1,"randBool"),this.numBits):this.value}propagateValue(e){this.outputValues(this.outputs.Out,e)}doDraw(e,r){let i=this.value;this.doDrawDefault(e,r,{componentName:[this._name,!1,()=>Oe(i,!1)[1]],skipLabels:!0,drawLabels:(s,{top:a})=>{if(this.numBits===1){let u=this.outputs.Out[0];on.drawStoredValue(e,u.value,...s.rotatePoint(this.posX,u.posYInParentTransform),26,!1)}else cr.drawStoredValues(e,s,this.outputs.Out,this.posX,ue.isVertical(this.orient));if(this._showProb){let u=ue.isVertical(this.orient);e.fillStyle=Tn,e.font="9px sans-serif",e.textAlign="center",e.textBaseline="middle";let p=["P(1)","=",String(Math.round(this._prob1*100)/100).substring(1)];if(u){let d=-10,f=Math.abs(d);this.orient==="s"&&(d=-d,f=-f);for(let m of p)Rt(s,this.orient,m,"n",this.posX-d,a-1,void 0),d+=f}else{let d=p.join("\u202F");Rt(s,this.orient,d,"n",this.posX,a,void 0)}}}})}doSetName(e){this._name=e,this.setNeedsRedraw("name changed")}doSetShowProb(e){this._showProb=e,this.setNeedsRedraw("show probability changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.Random.contextMenu,r=this._showProb?"check":"none";return[["mid",_.item(r,e.ShowProb,()=>this.doSetShowProb(!this._showProb))],["mid",_.sep()],this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),["mid",_.sep()],["mid",this.makeSetNameContextMenuItem(this._name,this.doSetName.bind(this))]]}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetNameDialog(this._name,this.doSetName.bind(this)):super.keyDown(e)}};c(Vu,"Random");bn.impl=Vu;var mn=ce(Me());var co={grey:"grey",red:"red",blue:"blue",yellow:"yellow",green:"green",turquoise:"turquoise"},Qn={n:"n",ne:"ne",e:"e",se:"se",s:"s",sw:"sw",w:"w",nw:"nw",c:"c"},nt=ve("rect",{idPrefix:"rect",button:{imgWidth:32},repr:{w:mn.number,h:mn.number,color:P(mn.keyof(co)),strokeWidth:P(mn.number),noFill:P(mn.boolean),rounded:P(mn.boolean),caption:P(mn.string),captionPos:P(mn.keyof(Qn)),captionInside:P(mn.boolean),font:P(mn.string)},valueDefaults:{width:10*H,height:10*H,color:co.yellow,strokeWidth:2,noFill:!1,rounded:!1,caption:void 0,captionPos:Qn.n,captionInside:!1,font:Ja},size:{gridWidth:10,gridHeight:10},makeNodes:()=>({})}),Xi=class extends he{constructor(e,r){var i,s,a,u,l,p,d,f,m,h;super(e,nt,r);this._w=(i=r==null?void 0:r.w)!=null?i:nt.aults.width,this._h=(s=r==null?void 0:r.h)!=null?s:nt.aults.height,this._color=(a=r==null?void 0:r.color)!=null?a:nt.aults.color,this._strokeWidth=(u=r==null?void 0:r.strokeWidth)!=null?u:nt.aults.strokeWidth,this._noFill=(l=r==null?void 0:r.noFill)!=null?l:nt.aults.noFill,this._rounded=(p=r==null?void 0:r.rounded)!=null?p:nt.aults.rounded,this._caption=(d=r==null?void 0:r.caption)!=null?d:nt.aults.caption,this._captionPos=(f=r==null?void 0:r.captionPos)!=null?f:nt.aults.captionPos,this._captionInside=(m=r==null?void 0:r.captionInside)!=null?m:nt.aults.captionInside,this._font=(h=r==null?void 0:r.font)!=null?h:nt.aults.font}toJSON(){return Y(k({},this.toJSONBase()),{w:this._w,h:this._h,color:this._color,strokeWidth:this._strokeWidth,noFill:this._noFill===nt.aults.noFill?void 0:this._noFill,rounded:this._rounded===nt.aults.rounded?void 0:this._rounded,caption:this._caption===nt.aults.caption?void 0:this._caption,captionPos:this._captionPos===nt.aults.captionPos?void 0:this._captionPos,captionInside:this._captionInside===nt.aults.captionInside?void 0:this._captionInside,font:this._font===nt.aults.font?void 0:this._font})}canRotate(){return!1}get unrotatedWidth(){return this._w}get unrotatedHeight(){return this._h}doRecalcValue(){}get drawZIndex(){return 0}doDraw(e,r){let i=this._w,s=this._h,a=this.posX-i/2,u=this.posY-s/2;if(e.beginPath(),this._rounded){let l=3*this._strokeWidth;e.moveTo(a+l,u),e.lineTo(a+i-l,u),e.quadraticCurveTo(a+i,u,a+i,u+l),e.lineTo(a+i,u+s-l),e.quadraticCurveTo(a+i,u+s,a+i-l,u+s),e.lineTo(a+l,u+s),e.quadraticCurveTo(a,u+s,a,u+s-l),e.lineTo(a,u+l),e.quadraticCurveTo(a,u,a+l,u)}else e.rect(a,u,i,s);if(e.closePath(),this._noFill||(e.fillStyle=Qa[this._color],e.fill()),this._caption!==void 0){e.fillStyle=K,e.font=this._font,e.textAlign="center",e.textBaseline="middle";let l=e.measureText(this._caption),p=(l.actualBoundingBoxAscent+l.actualBoundingBoxDescent+this._strokeWidth)/2+2,d=2,f=(l.width+this._strokeWidth)/2+d,m=(()=>{switch(this._captionPos){case"c":case"w":case"e":return this.posY;case"n":case"nw":case"ne":return this.posY-this.height/2+(this._captionInside?1:-1)*p;case"s":case"se":case"sw":return this.posY+this.height/2+(this._captionInside?-1:1)*p}})(),h=(()=>{switch(this._captionPos){case"c":case"n":case"s":return this.posX;case"w":return this.posX-this.width/2+(this._captionInside?1:-1)*f;case"nw":case"sw":return this.posX-this.width/2+f-(this._captionInside?0:1)*(d+this._strokeWidth);case"e":return this.posX+this.width/2+(this._captionInside?-1:1)*f;case"ne":case"se":return this.posX+this.width/2-f+(this._captionInside?0:1)*(d+this._strokeWidth)}})();e.fillText(this._caption,h,m)}r.isMouseOver?(e.lineWidth=Math.max(3,this._strokeWidth),e.strokeStyle=r.borderColor,e.stroke()):this._strokeWidth>0&&(e.lineWidth=this._strokeWidth,e.strokeStyle=ja[this._color],e.stroke())}doSetColor(e){this._color=e,this.setNeedsRedraw("color changed")}doSetStrokeWidth(e){this._strokeWidth=e,this.setNeedsRedraw("stroke width changed")}doSetCaption(e){this._caption=e,this.setNeedsRedraw("caption changed")}doSetCaptionPos(e){this._captionPos=e,this.setNeedsRedraw("caption position changed")}doSetFont(e){this._font=e,this.setNeedsRedraw("font changed")}makeCurrentSizeString(){return`${this._w} \xD7 ${this._h}`}makeComponentSpecificContextMenuItems(){let e=x.Components.Rectangle.contextMenu,r=this.makeCurrentSizeString(),i=_.item("dimensions",e.Size+` (${r})\u2026`,()=>this.runSetSizeDialog(r)),s=c((v,D)=>{let C=this._strokeWidth===v?"check":"none";return _.item(C,D,()=>this.doSetStrokeWidth(v))},"makeSetStrokeWidthItem"),a=c((v,D)=>{let b=this._color===D,C=b?"check":"none",A=b?()=>{}:()=>this.doSetColor(D);if(D!==void 0){let M=this._noFill?"":`background-color: ${Qa[D]}; `,w=this._rounded?"border-radius: 4px; ":"",T=ja[D];return _.item(C,Yt(vn(v),ke(`display: inline-block; width: 140px; height: 18px; ${M}${w}margin-right: 8px; border: 2px solid ${T}`)),A)}else return _.item(C,v,A)},"makeItemUseColor"),u=_.item(this._rounded?"check":"none",e.Rounded,()=>{this._rounded=!this._rounded,this.setNeedsRedraw("rounded changed")}),l=_.item(this._noFill?"none":"check",e.WithBackgroundColor,()=>{this._noFill=!this._noFill,this.setNeedsRedraw("nofill changed")}),p=this._caption!==void 0?e.ChangeTitle:e.SetTitle,d=_.item("pen",p,()=>this.runSetCaptionDialog(),"\u21A9\uFE0E"),f=c((v,D)=>{let b=this._captionPos===D,C=b?"check":"none",A=b?()=>{}:()=>this.doSetCaptionPos(D);return _.item(C,v,A)},"makeItemSetPlacement"),m=this._captionPos==="c"?[]:[_.item(this._captionInside?"check":"none",e.InsideFrame,()=>{this._captionInside=!this._captionInside,this.setNeedsRedraw("caption inside changed")}),_.sep()],h=_.item("font",e.Font,()=>{this.runSetFontDialog(this._font,nt.aults.font,this.doSetFont.bind(this))});return[["mid",i],["mid",_.submenu("palette",e.Color,[l,_.sep(),a(e.ColorYellow,co.yellow),a(e.ColorRed,co.red),a(e.ColorGreen,co.green),a(e.ColorBlue,co.blue),a(e.ColorTurquoise,co.turquoise),a(e.ColorGrey,co.grey)])],["mid",_.submenu("strokewidth",e.Border,[s(0,e.BorderNone),_.sep(),s(1,e.Border1px),s(2,e.Border2px),s(3,e.Border3px),s(5,e.Border5px),s(10,e.Border10px)])],["mid",u],["mid",_.sep()],["mid",d],["mid",h],["mid",_.submenu("placement",e.TitlePlacement,[...m,f(e.PlacementTop,Qn.n),f(e.PlacementTopLeft,Qn.nw),f(e.PlacementTopRight,Qn.ne),f(e.PlacementBottom,Qn.s),f(e.PlacementBottomLeft,Qn.sw),f(e.PlacementBottomRight,Qn.se),f(e.PlacementLeft,Qn.w),f(e.PlacementRight,Qn.e),f(e.PlacementCenter,Qn.c)])]]}runSetSizeDialog(e){var i,s;let r=window.prompt(x.Components.Rectangle.contextMenu.SizePrompt,e);if(r!==null){let a;if((a=new RegExp("^(?<w>\\d*)(?:(?:\\s+|(?: *[\xD7x,;] *))(?<h>\\d*))?$").exec(r))!==null){let u=c((d,f)=>{if(d===void 0)return f;let m=parseInt(d);return isNaN(m)||m<=0?f:m},"parse"),l=u((i=a.groups)==null?void 0:i.w,this._w),p=u((s=a.groups)==null?void 0:s.h,this._h);this.doSetDimensions(l,p)}}}doSetDimensions(e,r){this._w=e,this._h=r,this.setNeedsRedraw("size changed")}wrapContents(e){var h;if(e.size===0)return;let r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let v of e)v instanceof er&&(r=Math.min(r,v.posX-v.width/2),i=Math.min(i,v.posY-v.height/2),s=Math.max(s,v.posX+v.width/2),a=Math.max(a,v.posY+v.height/2));let u=(r+s)/2,l=(i+a)/2,[p,d]=(h=this.trySetPosition(u,l,!0))!=null?h:[u,l];r=Math.floor((r+Math.max(0,u-p))/H)*H,i=Math.floor((i+Math.max(0,l-d))/H)*H,s=Math.ceil((s+Math.max(0,p-u))/H)*H,a=Math.ceil((a+Math.max(0,d-l))/H)*H;let f=s-r+4*H,m=a-i+4*H;this.doSetDimensions(f,m)}runSetCaptionDialog(){let e=window.prompt(x.Components.Rectangle.contextMenu.SetTitlePrompt,this._caption);if(e!==null){let r=e.length===0?void 0:e;this.doSetCaption(r)}}mouseDoubleClicked(e){return this.runSetSizeDialog(this.makeCurrentSizeString()),Z.SimpleChange}keyDown(e){e.key==="Enter"&&!e.altKey?this.runSetCaptionDialog():super.keyDown(e)}};c(Xi,"Rectangle");nt.impl=Xi;var po=ce(Me()),Ud=ce(Vr());var zd={raw:{decodeWidth:1,maxDisplayWidth:16,decode:o=>o.toString()},octal:{decodeWidth:3,maxDisplayWidth:16,decode:o=>o.toString()},hex:{decodeWidth:4,maxDisplayWidth:16,decode:o=>o.toString(16).toUpperCase()},ascii:{decodeWidth:7,maxDisplayWidth:12,decode:o=>Fr.numberToAscii(o)},ascii8:{decodeWidth:8,maxDisplayWidth:12,decode:o=>Fr.numberToAscii(o&127)},uint4:{decodeWidth:4,maxDisplayWidth:8,decode:o=>o.toString()},int4:{decodeWidth:4,maxDisplayWidth:8,decode:o=>(o>7?o-16:o).toString()},uint8:{decodeWidth:8,maxDisplayWidth:4,decode:o=>o.toString()},int8:{decodeWidth:8,maxDisplayWidth:4,decode:o=>(o>127?o-256:o).toString()},uint16:{decodeWidth:16,maxDisplayWidth:1,decode:o=>o.toString()},int16:{decodeWidth:16,maxDisplayWidth:1,decode:o=>(o>32767?o-65536:o).toString()}},Tc=xt.withProps()(zd),dr=ve("shift-display",{idPrefix:"shiftdisp",button:{imgWidth:50},repr:{state:P(po.string),decodeAs:P(po.keyof(zd)),groupEvery:P(po.number),maxItems:P(po.number),trigger:P(po.keyof($e))},valueDefaults:{decodeAs:"raw",trigger:$e.rising},size:{gridWidth:25,gridHeight:5},makeNodes:()=>{let o=x.Components.Generic;return{ins:{Clock:[-14,1,"w",o.InputClockDesc,{isClock:!0}],Clr:[-10,3,"s",o.InputClearDesc,{prefersSpike:!0}],D:[-14,-1,"w",o.InputDataDesc]}}},initialValue:o=>{if(o===void 0||o.state===void 0)return{incoming:[],decoded:[]};let n=[];for(let e=0;e<o.state.length;e++){let r=o.state.charAt(e);r==="1"?n.push(!0):r==="0"?n.push(!1):n.push(I)}return{incoming:n,decoded:[]}}}),$o=class extends he{constructor(e,r){var i,s,a,u;super(e,dr,r);this._lastClock=I;this._decodeAs=(i=r==null?void 0:r.decodeAs)!=null?i:dr.aults.decodeAs,this._groupEvery=(s=r==null?void 0:r.groupEvery)!=null?s:void 0,this._maxItems=(a=r==null?void 0:r.maxItems)!=null?a:void 0,this._trigger=(u=r==null?void 0:r.trigger)!=null?u:dr.aults.trigger,this.redecodeAll()}toJSON(){let e=Gd(this.value).map(r=>tt(r));return Y(k({},this.toJSONBase()),{state:e.length===0?void 0:e.join(""),decodeAs:this._decodeAs!==dr.aults.decodeAs?this._decodeAs:void 0,groupEvery:this._groupEvery,maxItems:this._maxItems,trigger:this._trigger!==dr.aults.trigger?this._trigger:void 0})}get trigger(){return this._trigger}makeTooltip(){return Q(x.Components.ShiftDisplay.tooltip,q(z(Ud.default.stringify(this.value))))}doRecalcValue(){var s;if(this.inputs.Clr.value===!0)return{incoming:[],decoded:[]};let e=this._lastClock,r=this._lastClock=this.inputs.Clock.value,i=this.value;if(pt.isClockTrigger(this._trigger,e,r)){let a=this.inputs.D.value,u=Tc.props[this._decodeAs],l=(s=this._maxItems)!=null?s:u.maxDisplayWidth;return $o.valueByAddingNewBit(a,i,u,l)}return i}static valueByAddingNewBit(e,r,i,s){let a=[e,...r.incoming];if(a.length<i.decodeWidth)return{incoming:a,decoded:r.decoded};let u=Oe(a,!0)[1],p=[[U(u)?I:i.decode(u),a],...r.decoded];return p.length>s&&p.splice(s,p.length-s),{incoming:[],decoded:p}}doSetTrigger(e){this._trigger=e,this.setNeedsRedraw("trigger changed")}doDraw(e,r){this.doDrawDefault(e,r,{drawInside:()=>{let i=c(()=>{let s=this.makeRepresentationString(),a;s===void 0?(e.fillStyle=Tn,e.font="15px sans-serif",a=x.Components.ShiftDisplay.EmptyCaption):(e.fillStyle=K,e.font="bold 16px sans-serif",a=s),e.fillText(a,this.posX,this.posY)},"drawContents");e.textAlign="center",e.textBaseline="middle",this.orient==="w"?r.inNonTransformedFrame(i):i()}})}makeRepresentationString(){var f;let{incoming:e,decoded:r}=this.value;if(e.length===0&&r.length===0)return;let i=this._decodeAs,a=Tc.props[i].decodeWidth-e.length,l=U0("_\u202F",a)+Oe(e,!0)[0],p=i.includes("int")?" ":"",d;if(r.length===0)d="\u2026";else{let m=(f=this._groupEvery)!=null?f:0;if(m<2)d=r.map(h=>h[0]).join(p);else{let h=m-r.length%m,v=[];for(let D=0;D<r.length;D++)D!==0&&((D+h)%m===0?v.push(p+" "):v.push(p)),v.push(r[D][0]);d=v.join("")}i==="hex"?d="0x"+(m<2?"":" ")+d:i==="octal"&&(d="0o"+(m<2?"":" ")+d)}return i==="raw"?d:l+" \u279F "+d}redecodeAll(){var a;let e=Tc.props[this._decodeAs],r=Gd(this.value),i=(a=this._maxItems)!=null?a:e.maxDisplayWidth,s={incoming:[],decoded:[]};for(let u of r.reverse())s=$o.valueByAddingNewBit(u,s,e,i);this.doSetValue(s)}doSetDecodeAs(e){this._decodeAs=e,this.redecodeAll()}doSetGroupEvery(e){this._groupEvery=e,this.setNeedsRedraw("grouping changed")}makeComponentSpecificContextMenuItems(){let e=x.Components.ShiftDisplay.contextMenu,r=c((s,a)=>{let l=this._decodeAs===s?"check":"none";return _.item(l,a,()=>this.doSetDecodeAs(s))},"makeItemDecodeAs"),i=c((s,a)=>{let l=this._groupEvery===s?"check":"none";return _.item(l,a,()=>this.doSetGroupEvery(s))},"makeItemGroupEvery");return[...Mr(this._trigger,this.doSetTrigger.bind(this)),["mid",_.sep()],["mid",_.submenu("eye",e.Decoding,[r("raw",e.DecodingNone),r("octal",e.DecodingOctal),r("hex",e.DecodingHex),r("ascii",e.DecodingAscii7),r("ascii8",e.DecodingAscii8),r("uint4",e.DecodingUint4),r("int4",e.DecodingInt4),r("uint8",e.DecodingUint8),r("int8",e.DecodingInt8),r("uint16",e.DecodingUint16),r("int16",e.DecodingInt16),_.sep(),_.text(e.DecodingChangeWarning)])],["mid",_.submenu("regroup",e.Grouping,[i(void 0,e.GroupingNone),_.sep(),i(2,e.GroupBy.expand({n:2})),i(3,e.GroupBy.expand({n:3})),i(4,e.GroupBy.expand({n:4})),i(7,e.GroupBy.expand({n:7})),i(8,e.GroupBy.expand({n:8})),i(16,e.GroupBy.expand({n:16}))])]]}};c($o,"ShiftDisplay");dr.impl=$o;function Gd({incoming:o,decoded:n}){let e=[...o];for(let[r,i]of n)e.push(...i);return e}c(Gd,"allBitsOf");var Yi=ye("shift-reg",!0,!0,Y(k({variantName:({bits:o})=>`shift-reg-${o}`,idPrefix:"reg"},lo),{makeNodes:(o,n)=>{let e=lo.makeNodes(o,n),r=e.ins.Clock[1]-2;return{ins:Y(k({},e.ins),{D:[-5,0,"w"],L\u0305R:[-5,r,"w"]}),outs:e.outs}}})),Lu=class extends cr{constructor(n,e,r){super(n,Yi,e,r)}toJSON(){return this.toJSONBase()}makeTooltip(){let n=x.Components.ShiftRegister.tooltip;return Q(n.title,q(z(n.desc.expand({numBits:this.numBits}))))}makeStateAfterClock(){let n=this.inputs.L\u0305R.value;if(U(n)||me(n))return this.makeStateFromMainValue(I);let e=Ue.filterHighZ(this.inputs.D.value),r=this.value;return n?[...r.slice(1),e]:[e,...r.slice(0,-1)]}doDrawGenericCaption(n){n.font="bold 13px sans-serif",n.fillStyle=K,n.textAlign="center",n.textBaseline="middle",n.fillText("Shift R.",this.posX,this.posY-8),n.font="11px sans-serif",n.fillText(`${this.numBits} bits`,this.posX,this.posY+10)}};c(Lu,"ShiftRegister");Yi.impl=Lu;var $i=ve("tristate",{idPrefix:"tristate",button:{imgWidth:50},valueDefaults:{},size:{gridWidth:7,gridHeight:4},makeNodes:()=>({ins:{In:[-4,0,"w"],E:[0,-3,"n","E (Enable)"]},outs:{Out:[4,0,"e"]}}),initialValue:()=>Pe}),Hu=class extends he{constructor(n,e){super(n,$i,e)}toJSON(){return this.toJSONBase()}makeTooltip(){return Q(void 0,q(z(x.Components.TristateBuffer.tooltip)))}doRecalcValue(){let n=this.inputs.E.value;if(U(n)||me(n))return I;if(!n)return Pe;let e=this.inputs.In.value;return me(e)?I:e}propagateValue(n){this.outputs.Out.value=n}doDraw(n,e){let r=this.unrotatedWidth,i=this.unrotatedHeight,s=this.posX-r/2,a=this.posY-i/2,u=a+i;e.isMouseOver&&(n.lineWidth=2,n.strokeStyle=e.borderColor,n.beginPath(),n.rect(s-2-2,a-2-2,r+2*(2+2),i+2*(2+2)),n.stroke()),n.fillStyle=Ke,n.strokeStyle=K,n.lineWidth=3;let l=2*Math.max(2,this.inputs._all.length)*H,p=this.posX-l/2,d=this.posX+l/2;n.beginPath(),n.moveTo(p,a),n.lineTo(d,this.posY),n.lineTo(p,u),n.closePath(),n.stroke(),Ae(n,this.inputs.In,p-1,this.inputs.In.posYInParentTransform),Ae(n,this.inputs.E,this.inputs.E.posXInParentTransform,this.posY-i/4-1),Ae(n,this.outputs.Out,d+1,this.posY)}};c(Hu,"TristateBuffer");$i.impl=Hu;var qd=ce(Me());var Qo=ye("tristate-array",!0,!0,{variantName:({bits:o})=>`tristate-array-${o}`,idPrefix:"tristate",button:{imgWidth:50},repr:{bits:P(qd.number)},valueDefaults:{},params:{bits:Ce(4,[2,4,8,16])},validateParams:({bits:o})=>({numBits:o}),size:_r.size,makeNodes:({numBits:o,gridHeight:n})=>({ins:{In:ie("w",-3,0,o),E:[0,-(n/2+1),"n","E (Enable)"]},outs:{Out:ie("e",3,0,o)}}),initialValue:(o,{numBits:n})=>$(Pe,n)}),Wu=class extends we{constructor(e,r,i){super(e,Qo.with(r),i);this.numBits=r.numBits}toJSON(){return Y(k({},this.toJSONBase()),{bits:this.numBits===Qo.aults.bits?void 0:this.numBits})}makeTooltip(){let e=x.Components.TristateBufferArray.tooltip;return Q(e.title,q(z(e.desc)))}doRecalcValue(){let e=this.inputs.E.value;return U(e)||me(e)?$(I,this.numBits):e?this.inputValues(this.inputs.In):$(Pe,this.numBits)}propagateValue(e){this.outputValues(this.outputs.Out,e)}doDraw(e,r){this.doDrawDefault(e,r,{skipLabels:!0,drawInside:({top:i,left:s,right:a})=>{let u=this.inputs.E.value;e.lineWidth=2,e.strokeStyle=Nt(u),e.beginPath(),e.moveTo(this.posX,i),e.lineTo(this.posX,this.posY-4),e.stroke(),e.strokeStyle=K,e.beginPath(),e.moveTo(s+12,this.posY-8),e.lineTo(a-13,this.posY),e.lineTo(s+12,this.posY+8),e.closePath(),e.stroke()}})}makeComponentSpecificContextMenuItems(){return[this.makeChangeParamsContextMenuItem("inputs",x.Components.Generic.contextMenu.ParamNumBits,this.numBits,"bits"),...this.makeForceOutputsContextMenuItem(!0)]}};c(Wu,"TristateBufferArray");Qo.impl=Wu;var Q3=[Lt,rn,bn,Or,Rn,ki,Pi,Vi,Nr,dr,ao,qe,ar,$i,Qo,_r,$n,nt,En,Gi,Ti,Mi,Sr,_n,uo,sr,zi,Hi,Wi,Li,fn,Yi,Xo,Ht,Xn,qo,Fi,Ni,Bi],Xs=class{constructor(n){this._predefinedComponents=new Map;this._customComponents=new Map;this.editor=n;for(let e of Q3){let r=e.type;if(!e.isValid())throw new Error(`Implementation missing for components of type '${r}'`);if(this._predefinedComponents.has(r))throw new Error(`Duplicate component for components of type '${r}'`);this._predefinedComponents.set(r,e)}}makeFromJSON(n,e){if(!Vn(e)){console.warn(`Skipping invalid non-object component: ${Sc.default.stringify(e,null,2)}`);return}let r=Re(e.type)?e.type:"<unknown>",i=this.getMaker(r);return i==null?void 0:i.makeFromJSON(n,e)}makeFromButton(n,e){let r=e.dataset,i=r.params,s=this.getMaker(r.type),a=i===void 0?void 0:Sc.default.parse(i);return s==null?void 0:s.make(n,a)}getMaker(n){let e;if((e=this._predefinedComponents.get(n))!==void 0)return e;if(no.includes(n))return ao;if(or.includes(n))return qe;let r=n.indexOf("-");if(r!==-1){let i=n.substring(0,r);if(n.substring(r+1)==="array"&&or.includes(i))return ar;if(n.startsWith(zo)){let a=n.substring(zo.length);if((e=this._customComponents.get(a))!==void 0)return e}}console.warn(`Unknown component for '${n}'`)}customDefs(){if(this._customComponents.size!==0)return[...this._customComponents.values()]}customDefReprs(){let n=this.customDefs();if(n!==void 0)return n.map(e=>e.toJSON())}clearCustomDefs(){this._customComponents.clear()}tryAddCustomDef(n){let e=n.id;if(this._customComponents.has(e)){console.warn(`Could not add custom component with duplicate id '${e}'`);return}let r=new Vs(n);return this._customComponents.set(e,r),r}tryLoadCustomDefsFrom(n){if(n===void 0)return 0;let e=br(n,Xd.array(kd),"defs");if(e===void 0)return 0;let r=0;for(let i of e)this.tryAddCustomDef(i)!==void 0&&r++;return r}hasCustomComponents(){return this._customComponents.size>0}makeContextMenu(n){let e=n.substring(zo.length),r=this._customComponents.get(e);if(r===void 0)return;let i=x.Components.Custom.contextMenu;return[_.item("pen",i.ChangeName,()=>{var u;let s=r.caption,a=r.type;for(;;){let l=window.prompt(i.ChangeNamePrompt,s);if(l===null||l===s)return;if(l.length===0){window.alert(i.ChangeNameEmpty);continue}r.doSetCaption(l);let p=Ec(s);if(r.customId===p){let d=Ec(l);if(!this._customComponents.has(d)){this._customComponents.delete(p),r.customId=d;let f=r.type;for(let m of this._customComponents.values())for(let h of Object.values((u=m.circuit.components)!=null?u:{}))h.type===a&&(h.type=f);this._customComponents.set(d,r)}}this.editor.updateCustomComponentButtons(),this.editor.components.updateCustomComponents(a);break}},void 0),_.item("connect",i.ChangeCircuit,()=>{window.alert(x.Messages.NotImplemented)},void 0),_.sep(),_.item("trash",i.Delete,()=>{if(this.editor.components.contains(n)){window.alert(i.CannotDeleteInUse);return}for(let s of this._customComponents.values())if(s.uses(r.type)){window.alert(i.CannotDeleteInUseBy.expand({caption:s.caption}));return}window.confirm(i.ConfirmDelete)&&(this._customComponents.delete(e),this.editor.updateCustomComponentButtons())},void 0,!0)]}tryMakeNewCustomComponent(n){var T;let e=x.Components.Custom.messages,r=(T=n.cursorMovementMgr.currentSelection)==null?void 0:T.previouslySelectedElements;if(r===void 0)return e.EmptySelection;let i=[...r].filter(R=>R instanceof he);if(i.length===0)return e.EmptySelection;let s=i.filter(R=>R instanceof ro);if(s.length===0)return e.NoInput;let a=i.filter(R=>R instanceof io);if(a.length===0)return e.NoOutput;function u(R){let S=new Set;for(let F of R){let O=F.name;if(!Re(O)||S.has(O))return!1;S.add(O)}return!0}if(c(u,"checkNames"),!(u(s)&&u(a)))return e.InputsOutputsMustHaveNames;let p=[...s,...a],d=[],f;for(d.push(...s);(f=d.shift())!==void 0;)for(let R of f.outputs._all)for(let S of R.outgoingWires){let F=S.endNode.component;i.includes(F)&&!p.includes(F)&&(p.push(F),d.push(F))}d.push(...a);let m=[];for(;(f=d.shift())!==void 0;)for(let R of f.inputs._all){let S=R.incomingWire;if(S!==null){let F=S.startNode.component;i.includes(F)?p.includes(F)||(p.push(F),d.push(F)):m.includes(F)||m.push(F)}}if(m.length>0){let R=m.map(S=>S.toString()).join(", ");return e.MissingComponents.expand({list:R})}let h=i.filter(R=>!p.includes(R)&&(R.inputs._all.length!==0||R.outputs._all.length!==0));if(h.length>0){let R=h.map(S=>S.toString()).join(", ");return e.UselessComponents.expand({list:R})}if(p.some(R=>R instanceof _i))return e.CannotIncludeClock;let v,D=i.filter(R=>R instanceof Ui);if(D.length!==1){if(v=window.prompt(e.EnterCaptionPrompt),v===null)return""}else v=D[0].text;let b=Ec(v);if(this._customComponents.has(b))return e.ComponentAlreadyExists.expand({id:b});let{components:C,wires:A}=vt.buildComponentsObject(p);if(C===void 0||A===void 0)return"";let M=this.tryAddCustomDef({id:b,caption:v,circuit:{components:C,wires:A}});if(M===void 0)return"";let w=M.make(n);w.setSpawned(),w.setPosition(n.mouseX+w.unrotatedWidth/2-5,n.mouseY,!0),n.cursorMovementMgr.currentSelection=void 0,n.cursorMovementMgr.setCurrentMouseOverComp(w)}};c(Xs,"ComponentFactory");function Ec(o){return o.trim().normalize("NFKD").toLowerCase().replace(/[^a-z0-9]+/g,"")}c(Ec,"makeCustomIdFromCaption");var Qf=ce(Vr());

var _c={add:Yd,bordercolor:$d,check:Qd,close:jd,connect:Kd,dimensions:Jd,direction:Zd,download:e1,edit:t1,eye:n1,font:r1,force:o1,inputs:i1,link:s1,memcontent:a1,memlines:u1,move:l1,newcomponent:c1,none:p1,open:d1,outputs:f1,palette:m1,pause:h1,pen:g1,placement:D1,play:v1,question:y1,questioncircled:b1,redo:C1,ref:Gu,regroup:Gu,replace:x1,reset:w1,screenshot:A1,settings:T1,slanted:E1,step:S1,strokewidth:_1,timer:M1,trash:R1,undo:O1,wirestyle:N1},Q5={Adder:B1,AdderArray:I1,ALU:F1,and:xf,and3:wf,and4:Af,buf:Tf,Clock:P1,Comparator:k1,Counter:L1,Decoder:H1,Decoder7Seg:G1,Decoder16Seg:W1,DecoderBCD4:U1,Demux:z1,FlipflopD:K1,FlipflopJK:J1,FlipflopT:Z1,GateArray:ef,HalfAdder:tf,imply:Ef,Input1:nf,Input4:rf,Input8:of,Random:gf,Rectangle:Df,Label:sf,LatchSR:af,Mux:uf,nand:Sf,nand3:_f,nand4:Mf,nimply:Rf,nor:Of,nor3:Nf,nor4:Ff,not:Bf,or:If,or3:Pf,or4:kf,Output1:lf,Output4:cf,Output8:pf,Display7Seg:Y1,Display16Seg:q1,DisplayAscii:Q1,DisplayBar:j1,Display4:X1,Display8:$1,ShiftDisplay:yf,Passthrough1:df,PassthroughN:ff,RAM:mf,ROM:hf,Register:vf,ShiftRegister:bf,ControlledInverter:V1,tri:Vf,TristateBufferArray:Cf,txa:Lf,xnor:Hf,xnor3:Wf,xnor4:Gf,xor:Uf,xor3:zf,xor4:qf};function Xf(o){return o in _c}c(Xf,"isIconName");function Yf(o,n,e){return Uu("svgimg",qr(Mc(Q5,o)),n,e)}c(Yf,"makeImage");function Qi(o,n,e){return Uu("svgicon",qr(Mc(_c,o)),n,e)}c(Qi,"makeIcon");function Uu(o,n,e,r){let i=document.createElement("i");return i.classList.add(o),e!==void 0&&(i.style.width=`${e}px`),r!==void 0&&(i.style.height=`${r}px`),di(i,n),i}c(Uu,"makeSvgHolder");function Mc(o,n){return o[n]}c(Mc,"inlineSvgFor");function $f(o){return Mc(_c,o)}c($f,"inlineIconSvgFor");var ft="withButton",an="ifShowOnly",j5=[{nameKey:"InputOutput",items:[Lt.button({bits:1},"Input1"),Or.button({bits:1},"Output1"),Nr.button("DisplayBar",{compat:"out.bar",visible:ft}),rn.button("Clock"),Lt.button({bits:4},["InputN","Input4"],{compat:"in.nibble"}),Or.button({bits:4},["OutputN","Output4"],{compat:"out.nibble"}),Rn.button({bits:4},["DisplayN","Display4"],{compat:"out.nibble-display"}),Lt.button({bits:8},"Input8",{compat:"in.byte",visible:an}),Or.button({bits:8},"Output8",{compat:"out.byte",visible:an}),Rn.button({bits:8},"Display8",{compat:"out.byte-display",visible:an}),ki.button("Display7Seg",{compat:"out.7seg",visible:ft}),Pi.button("Display16Seg",{compat:"out.16seg",visible:ft}),Vi.button("DisplayAscii",{compat:"out.ascii",visible:ft}),bn.button({bits:1},"Random",{compat:"random",visible:ft}),dr.button("ShiftDisplay",{compat:"out.shift-buffer",visible:ft})]},{nameKey:"Gates",items:[ao.button({type:"not"},"not"),ao.button({type:"buf"},"buf",{visible:ft}),$i.button("tri",{compat:"tri",visible:ft}),qe.button({type:"and",bits:2},"and"),qe.button({type:"or",bits:2},"or"),qe.button({type:"xor",bits:2},"xor"),qe.button({type:"nand",bits:2},"nand"),qe.button({type:"nor",bits:2},"nor"),qe.button({type:"xnor",bits:2},"xnor",{visible:ft}),qe.button({type:"imply",bits:2},"imply",{visible:ft}),qe.button({type:"nimply",bits:2},"nimply",{visible:ft}),qe.button({type:"txa",bits:2},["transfer","txa"],{visible:ft}),qe.button({type:"and",bits:3},"and3",{compat:"and3",visible:an}),qe.button({type:"or",bits:3},"or3",{compat:"or3",visible:an}),qe.button({type:"xor",bits:3},"xor3",{compat:"xor3",visible:an}),qe.button({type:"nand",bits:3},"nand3",{compat:"nand3",visible:an}),qe.button({type:"nor",bits:3},"nor3",{compat:"nor3",visible:an}),qe.button({type:"xnor",bits:3},"xnor3",{compat:"xnor3",visible:an}),qe.button({type:"and",bits:4},"and4",{compat:"and4",visible:an}),qe.button({type:"or",bits:4},"or4",{compat:"or4",visible:an}),qe.button({type:"xor",bits:4},"xor4",{compat:"xor4",visible:an}),qe.button({type:"nand",bits:4},"nand4",{compat:"nand4",visible:an}),qe.button({type:"nor",bits:4},"nor4",{compat:"nor4",visible:an}),qe.button({type:"xnor",bits:4},"xnor4",{compat:"xnor4",visible:an}),_r.button({bits:4},"ControlledInverter",{compat:"switched-inverter",visible:ft}),ar.button({type:"and",bits:4},"GateArray",{visible:ft}),Qo.button({bits:4},"TristateBufferArray",{visible:ft})]},{nameKey:"Layout",items:[$n.button("Label"),nt.button("Rectangle",{compat:"label.rect"}),En.button({bits:1},"Passthrough1"),En.button({bits:4},"PassthroughN")]},{nameKey:"Components",items:[Gi.button("HalfAdder"),Ti.button("Adder"),Mi.button("Comparator",{compat:"comparator",visible:ft}),Sr.button({bits:4},"AdderArray"),_n.button({bits:4,ext:!1},"ALU"),uo.button({from:4,to:2},"Mux"),sr.button({from:2,to:4},"Demux"),zi.button("LatchSR"),Hi.button("FlipflopJK",{compat:"flipflop-jk",visible:ft}),Wi.button("FlipflopT",{compat:"flipflop-t",visible:ft}),Li.button("FlipflopD",{compat:"flipflop-d"}),fn.button({bits:4,inc:!1},"Register",{compat:"register"}),Yi.button({bits:4},"ShiftRegister",{compat:"shift-register"}),Xn.button({bits:4},"Counter"),Ht.button({lines:16,bits:4},"RAM"),Xo.button({lines:16,bits:4},"ROM",{visible:ft}),qo.button({bits:2},"Decoder",{compat:"decoder"}),Fi.button("Decoder7Seg",{compat:"decoder-7seg"}),Ni.button("Decoder16Seg",{compat:"decoder-16seg",visible:ft}),Bi.button("DecoderBCD4",{compat:"decoder-bcd4",visible:ft})]}],Ys=class{constructor(n,e){this.parent=n;this.showOnly=e;this._htmlSections=[];let r=e===void 0?void 0:[...e],i=!1;for(let s of j5){let{allButtons:a,buttonsShowWithMore:u,buttonsShowWithURLParam:l}=K5(s,r),p=this.makeSection(s.nameKey,a,u,l,r,i);p!==void 0&&(this._htmlSections.push(p),i=!0)}r!==void 0&&r.length>0&&console.log(`ERROR Supposed to show unknown elems: ${r.join("; ")}`)}allFixedButtons(){return this._htmlSections.flatMap(n=>n.buttons)}allCustomButtons(){return this._customComponentSection===void 0?[]:this._customComponentSection.buttons}updateCustomComponentButtons(n){let e=this._customComponentSection;if(e!==void 0){e.header!==void 0&&e.header.remove(),e.separator!==void 0&&e.separator.remove();for(let r of e.buttons)r.remove();e.showMoreLink!==void 0&&e.showMoreLink.remove()}this._customComponentSection=n===void 0?void 0:this.makeCustomComponentSection(n)}makeCustomComponentSection(n){let e=this.showOnly===void 0?void 0:[...this.showOnly],r=[],i=[];for(let a of n){let u=a.type,l=Uu("svgimg",a.makeButtonSVG(),bc,Cc),p=a.caption,[d,f]=jf(u,!1,[u],e,l,p,p+x.Components.Custom.MenuButtonSuffix,void 0,!0);f&&i.push(d),r.push(d)}let s=this._htmlSections.length>0;return this.makeSection("Custom",r,i,[],e,s)}makeSection(n,e,r,i,s,a){let u=r.length;if(e.length-u-i.length===0)return;let d;a&&(d=z(ke("height: 20px"),qr("&nbsp;")).render(),this.parent.appendChild(d));let f=z(at("leftToolbarHeader"),x.ComponentBar.SectionNames[n]).render();this.parent.appendChild(f);for(let h of e)this.parent.appendChild(h);let m;if(u!==0&&s===void 0){let h=!1,v=[x.ComponentBar.Labels.More+" \u2193",x.ComponentBar.Labels.Less+" \u2191"];m=fi(at("leftToolbarMore"),v[0]).render(),m.addEventListener("click",()=>{h=!h;for(let D of r)h?(D.style.removeProperty("padding"),D.style.removeProperty("border"),D.style.removeProperty("margin-bottom"),D.style.removeProperty("max-height"),D.style.removeProperty("overflow")):(D.style.padding="0",D.style.border="0",D.style.marginBottom="0",D.style.maxHeight="0",D.style.overflow="hidden");m.innerHTML=v[Number(h)]}),this.parent.appendChild(m)}return{separator:d,header:f,buttons:e,showMoreLink:m}}};c(Ys,"ComponentMenu");function K5(o,n){var s;let e=[],r=[],i=[];for(let a of o.items){let u=a.visible!==void 0&&a.visible!=="always",[l,p]=Re(a.visual)?[a.visual,a.visual]:a.visual,d=x.ComponentBar.Components.props[l],[f,m]=Re(d)?[d,void 0]:d,[h,v]=jf(a.type,u,Z5(a),n,Yf(p,a.width),m,f,(s=a.params)==null?void 0:s.params,!1);v&&(a.visible==="withButton"?r:i).push(h),e.push(h)}return{allButtons:e,buttonsShowWithMore:r,buttonsShowWithURLParam:i}}c(K5,"makeButtons");function jf(o,n,e,r,i,s,a,u,l){let p=r!==void 0?!J5(e,r):n,d=p?"max-height: 0; transition: all 0.25s ease-out; overflow: hidden; padding: 0; border: 0; margin-bottom: 0;":"",f=p?" sim-component-button-extra":"",m=l?" sim-component-button-custom":"",h=s===void 0?At:Yt(at("gate-label"),s),v=vn(a===void 0?"":a+` 
(\u201C${e[0]}\u201D)`),D=mi(wr("button"),ke(d),at(`list-group-item list-group-item-action sim-component-button${f}${m}`),i,h,v).render(),b=D.dataset;return b.type=o,b.componentId=e[0],u!==void 0&&(b.params=Qf.default.stringify(u)),[D,p]}c(jf,"makeButton");function J5(o,n){let e=!1;for(let r of o)if(n.includes(r)){e=!0;let i=n.indexOf(r);n.splice(i,1);break}return e}c(J5,"shouldShow");function Z5(o){let n=[],e=o.params,r=o.type;if(e===void 0)n.push(r);else{let i=e.def,s=i.variantName(e.params);pe(s)?n.push(...s):(q0(e.params,i.defaultParams)&&n.push(r),n.push(s))}return o.compat!==void 0&&n.push(o.compat),n}c(Z5,"componentIdsFor");var yt="top",Ft="bottom",Tt="right",Et="left",zu="auto",fo=[yt,Ft,Tt,Et],Br="start",qu="end",Kf="clippingParents",Xu="viewport",ji="popper",Jf="reference",Rc=fo.reduce(function(o,n){return o.concat([n+"-"+Br,n+"-"+qu])},[]),Yu=[].concat(fo,[zu]).reduce(function(o,n){return o.concat([n,n+"-"+Br,n+"-"+qu])},[]),e4="beforeRead",t4="read",n4="afterRead",r4="beforeMain",o4="main",i4="afterMain",s4="beforeWrite",a4="write",u4="afterWrite",Zf=[e4,t4,n4,r4,o4,i4,s4,a4,u4];function Bt(o){return o?(o.nodeName||"").toLowerCase():null}c(Bt,"getNodeName");function mt(o){if(o==null)return window;if(o.toString()!=="[object Window]"){var n=o.ownerDocument;return n&&n.defaultView||window}return o}c(mt,"getWindow");function Ir(o){var n=mt(o).Element;return o instanceof n||o instanceof Element}c(Ir,"isElement");function Qt(o){var n=mt(o).HTMLElement;return o instanceof n||o instanceof HTMLElement}c(Qt,"isHTMLElement");function $u(o){if(typeof ShadowRoot>"u")return!1;var n=mt(o).ShadowRoot;return o instanceof n||o instanceof ShadowRoot}c($u,"isShadowRoot");function l4(o){var n=o.state;Object.keys(n.elements).forEach(function(e){var r=n.styles[e]||{},i=n.attributes[e]||{},s=n.elements[e];!Qt(s)||!Bt(s)||(Object.assign(s.style,r),Object.keys(i).forEach(function(a){var u=i[a];u===!1?s.removeAttribute(a):s.setAttribute(a,u===!0?"":u)}))})}c(l4,"applyStyles");function c4(o){var n=o.state,e={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,e.popper),n.styles=e,n.elements.arrow&&Object.assign(n.elements.arrow.style,e.arrow),function(){Object.keys(n.elements).forEach(function(r){var i=n.elements[r],s=n.attributes[r]||{},a=Object.keys(n.styles.hasOwnProperty(r)?n.styles[r]:e[r]),u=a.reduce(function(l,p){return l[p]="",l},{});!Qt(i)||!Bt(i)||(Object.assign(i.style,u),Object.keys(s).forEach(function(l){i.removeAttribute(l)}))})}}c(c4,"effect");var em={name:"applyStyles",enabled:!0,phase:"write",fn:l4,effect:c4,requires:["computeStyles"]};function It(o){return o.split("-")[0]}c(It,"getBasePlacement");function On(o){var n=o.getBoundingClientRect();return{width:n.width,height:n.height,top:n.top,right:n.right,bottom:n.bottom,left:n.left,x:n.left,y:n.top}}c(On,"getBoundingClientRect");function jo(o){var n=On(o),e=o.offsetWidth,r=o.offsetHeight;return Math.abs(n.width-e)<=1&&(e=n.width),Math.abs(n.height-r)<=1&&(r=n.height),{x:o.offsetLeft,y:o.offsetTop,width:e,height:r}}c(jo,"getLayoutRect");function $s(o,n){var e=n.getRootNode&&n.getRootNode();if(o.contains(n))return!0;if(e&&$u(e)){var r=n;do{if(r&&o.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}c($s,"contains");function hn(o){return mt(o).getComputedStyle(o)}c(hn,"getComputedStyle");function Oc(o){return["table","td","th"].indexOf(Bt(o))>=0}c(Oc,"isTableElement");function Wt(o){return((Ir(o)?o.ownerDocument:o.document)||window.document).documentElement}c(Wt,"getDocumentElement");function Pr(o){return Bt(o)==="html"?o:o.assignedSlot||o.parentNode||($u(o)?o.host:null)||Wt(o)}c(Pr,"getParentNode");function tm(o){return!Qt(o)||hn(o).position==="fixed"?null:o.offsetParent}c(tm,"getTrueOffsetParent");function p4(o){for(var n=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,e=Pr(o);Qt(e)&&["html","body"].indexOf(Bt(e))<0;){var r=hn(e);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||n&&r.willChange==="filter"||n&&r.filter&&r.filter!=="none")return e;e=e.parentNode}return null}c(p4,"getContainingBlock");function jn(o){for(var n=mt(o),e=tm(o);e&&Oc(e)&&hn(e).position==="static";)e=tm(e);return e&&(Bt(e)==="html"||Bt(e)==="body"&&hn(e).position==="static")?n:e||p4(o)||n}c(jn,"getOffsetParent");function Ko(o){return["top","bottom"].indexOf(o)>=0?"x":"y"}c(Ko,"getMainAxisFromPlacement");var Nn=Math.max,mo=Math.min,Qs=Math.round;function Jo(o,n,e){return Nn(o,mo(n,e))}c(Jo,"within");function js(){return{top:0,right:0,bottom:0,left:0}}c(js,"getFreshSideObject");function Ks(o){return Object.assign({},js(),o)}c(Ks,"mergePaddingObject");function Js(o,n){return n.reduce(function(e,r){return e[r]=o,e},{})}c(Js,"expandToHashMap");var d4=c(function(n,e){return n=typeof n=="function"?n(Object.assign({},e.rects,{placement:e.placement})):n,Ks(typeof n!="number"?n:Js(n,fo))},"toPaddingObject");function f4(o){var n,e=o.state,r=o.name,i=o.options,s=e.elements.arrow,a=e.modifiersData.popperOffsets,u=It(e.placement),l=Ko(u),p=[Et,Tt].indexOf(u)>=0,d=p?"height":"width";if(!(!s||!a)){var f=d4(i.padding,e),m=jo(s),h=l==="y"?yt:Et,v=l==="y"?Ft:Tt,D=e.rects.reference[d]+e.rects.reference[l]-a[l]-e.rects.popper[d],b=a[l]-e.rects.reference[l],C=jn(s),A=C?l==="y"?C.clientHeight||0:C.clientWidth||0:0,M=D/2-b/2,w=f[h],T=A-m[d]-f[v],R=A/2-m[d]/2+M,S=Jo(w,R,T),F=l;e.modifiersData[r]=(n={},n[F]=S,n.centerOffset=S-R,n)}}c(f4,"arrow");function m4(o){var n=o.state,e=o.options,r=e.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=n.elements.popper.querySelector(i),!i)||$s(n.elements.popper,i)&&(n.elements.arrow=i))}c(m4,"effect");var nm={name:"arrow",enabled:!0,phase:"main",fn:f4,effect:m4,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};var h4={top:"auto",right:"auto",bottom:"auto",left:"auto"};function g4(o){var n=o.x,e=o.y,r=window,i=r.devicePixelRatio||1;return{x:Qs(Qs(n*i)/i)||0,y:Qs(Qs(e*i)/i)||0}}c(g4,"roundOffsetsByDPR");function rm(o){var n,e=o.popper,r=o.popperRect,i=o.placement,s=o.offsets,a=o.position,u=o.gpuAcceleration,l=o.adaptive,p=o.roundOffsets,d=p===!0?g4(s):typeof p=="function"?p(s):s,f=d.x,m=f===void 0?0:f,h=d.y,v=h===void 0?0:h,D=s.hasOwnProperty("x"),b=s.hasOwnProperty("y"),C=Et,A=yt,M=window;if(l){var w=jn(e),T="clientHeight",R="clientWidth";w===mt(e)&&(w=Wt(e),hn(w).position!=="static"&&(T="scrollHeight",R="scrollWidth")),w=w,i===yt&&(A=Ft,v-=w[T]-r.height,v*=u?1:-1),i===Et&&(C=Tt,m-=w[R]-r.width,m*=u?1:-1)}var S=Object.assign({position:a},l&&h4);if(u){var F;return Object.assign({},S,(F={},F[A]=b?"0":"",F[C]=D?"0":"",F.transform=(M.devicePixelRatio||1)<2?"translate("+m+"px, "+v+"px)":"translate3d("+m+"px, "+v+"px, 0)",F))}return Object.assign({},S,(n={},n[A]=b?v+"px":"",n[C]=D?m+"px":"",n.transform="",n))}c(rm,"mapToStyles");function D4(o){var n=o.state,e=o.options,r=e.gpuAcceleration,i=r===void 0?!0:r,s=e.adaptive,a=s===void 0?!0:s,u=e.roundOffsets,l=u===void 0?!0:u;if(!1)var p;var d={placement:It(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:i};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,rm(Object.assign({},d,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:a,roundOffsets:l})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,rm(Object.assign({},d,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}c(D4,"computeStyles");var om={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:D4,data:{}};var Qu={passive:!0};function v4(o){var n=o.state,e=o.instance,r=o.options,i=r.scroll,s=i===void 0?!0:i,a=r.resize,u=a===void 0?!0:a,l=mt(n.elements.popper),p=[].concat(n.scrollParents.reference,n.scrollParents.popper);return s&&p.forEach(function(d){d.addEventListener("scroll",e.update,Qu)}),u&&l.addEventListener("resize",e.update,Qu),function(){s&&p.forEach(function(d){d.removeEventListener("scroll",e.update,Qu)}),u&&l.removeEventListener("resize",e.update,Qu)}}c(v4,"effect");var im={name:"eventListeners",enabled:!0,phase:"write",fn:c(function(){},"fn"),effect:v4,data:{}};var y4={left:"right",right:"left",bottom:"top",top:"bottom"};function Ki(o){return o.replace(/left|right|bottom|top/g,function(n){return y4[n]})}c(Ki,"getOppositePlacement");var b4={start:"end",end:"start"};function ju(o){return o.replace(/start|end/g,function(n){return b4[n]})}c(ju,"getOppositeVariationPlacement");function Zo(o){var n=mt(o),e=n.pageXOffset,r=n.pageYOffset;return{scrollLeft:e,scrollTop:r}}c(Zo,"getWindowScroll");function ei(o){return On(Wt(o)).left+Zo(o).scrollLeft}c(ei,"getWindowScrollBarX");function Nc(o){var n=mt(o),e=Wt(o),r=n.visualViewport,i=e.clientWidth,s=e.clientHeight,a=0,u=0;return r&&(i=r.width,s=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=r.offsetLeft,u=r.offsetTop)),{width:i,height:s,x:a+ei(o),y:u}}c(Nc,"getViewportRect");function Fc(o){var n,e=Wt(o),r=Zo(o),i=(n=o.ownerDocument)==null?void 0:n.body,s=Nn(e.scrollWidth,e.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),a=Nn(e.scrollHeight,e.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),u=-r.scrollLeft+ei(o),l=-r.scrollTop;return hn(i||e).direction==="rtl"&&(u+=Nn(e.clientWidth,i?i.clientWidth:0)-s),{width:s,height:a,x:u,y:l}}c(Fc,"getDocumentRect");function ti(o){var n=hn(o),e=n.overflow,r=n.overflowX,i=n.overflowY;return/auto|scroll|overlay|hidden/.test(e+i+r)}c(ti,"isScrollParent");function Ku(o){return["html","body","#document"].indexOf(Bt(o))>=0?o.ownerDocument.body:Qt(o)&&ti(o)?o:Ku(Pr(o))}c(Ku,"getScrollParent");function ho(o,n){var e;n===void 0&&(n=[]);var r=Ku(o),i=r===((e=o.ownerDocument)==null?void 0:e.body),s=mt(r),a=i?[s].concat(s.visualViewport||[],ti(r)?r:[]):r,u=n.concat(a);return i?u:u.concat(ho(Pr(a)))}c(ho,"listScrollParents");function Ji(o){return Object.assign({},o,{left:o.x,top:o.y,right:o.x+o.width,bottom:o.y+o.height})}c(Ji,"rectToClientRect");function C4(o){var n=On(o);return n.top=n.top+o.clientTop,n.left=n.left+o.clientLeft,n.bottom=n.top+o.clientHeight,n.right=n.left+o.clientWidth,n.width=o.clientWidth,n.height=o.clientHeight,n.x=n.left,n.y=n.top,n}c(C4,"getInnerBoundingClientRect");function sm(o,n){return n===Xu?Ji(Nc(o)):Qt(n)?C4(n):Ji(Fc(Wt(o)))}c(sm,"getClientRectFromMixedType");function x4(o){var n=ho(Pr(o)),e=["absolute","fixed"].indexOf(hn(o).position)>=0,r=e&&Qt(o)?jn(o):o;return Ir(r)?n.filter(function(i){return Ir(i)&&$s(i,r)&&Bt(i)!=="body"}):[]}c(x4,"getClippingParents");function Bc(o,n,e){var r=n==="clippingParents"?x4(o):[].concat(n),i=[].concat(r,[e]),s=i[0],a=i.reduce(function(u,l){var p=sm(o,l);return u.top=Nn(p.top,u.top),u.right=mo(p.right,u.right),u.bottom=mo(p.bottom,u.bottom),u.left=Nn(p.left,u.left),u},sm(o,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}c(Bc,"getClippingRect");function fr(o){return o.split("-")[1]}c(fr,"getVariation");function Zs(o){var n=o.reference,e=o.element,r=o.placement,i=r?It(r):null,s=r?fr(r):null,a=n.x+n.width/2-e.width/2,u=n.y+n.height/2-e.height/2,l;switch(i){case yt:l={x:a,y:n.y-e.height};break;case Ft:l={x:a,y:n.y+n.height};break;case Tt:l={x:n.x+n.width,y:u};break;case Et:l={x:n.x-e.width,y:u};break;default:l={x:n.x,y:n.y}}var p=i?Ko(i):null;if(p!=null){var d=p==="y"?"height":"width";switch(s){case Br:l[p]=l[p]-(n[d]/2-e[d]/2);break;case qu:l[p]=l[p]+(n[d]/2-e[d]/2);break;default:}}return l}c(Zs,"computeOffsets");function Kn(o,n){n===void 0&&(n={});var e=n,r=e.placement,i=r===void 0?o.placement:r,s=e.boundary,a=s===void 0?Kf:s,u=e.rootBoundary,l=u===void 0?Xu:u,p=e.elementContext,d=p===void 0?ji:p,f=e.altBoundary,m=f===void 0?!1:f,h=e.padding,v=h===void 0?0:h,D=Ks(typeof v!="number"?v:Js(v,fo)),b=d===ji?Jf:ji,C=o.elements.reference,A=o.rects.popper,M=o.elements[m?b:d],w=Bc(Ir(M)?M:M.contextElement||Wt(o.elements.popper),a,l),T=On(C),R=Zs({reference:T,element:A,strategy:"absolute",placement:i}),S=Ji(Object.assign({},A,R)),F=d===ji?S:T,O={top:w.top-F.top+D.top,bottom:F.bottom-w.bottom+D.bottom,left:w.left-F.left+D.left,right:F.right-w.right+D.right},L=o.modifiersData.offset;if(d===ji&&L){var W=L[i];Object.keys(O).forEach(function(se){var ae=[Tt,Ft].indexOf(se)>=0?1:-1,oe=[yt,Ft].indexOf(se)>=0?"y":"x";O[se]+=W[oe]*ae})}return O}c(Kn,"detectOverflow");function Ic(o,n){n===void 0&&(n={});var e=n,r=e.placement,i=e.boundary,s=e.rootBoundary,a=e.padding,u=e.flipVariations,l=e.allowedAutoPlacements,p=l===void 0?Yu:l,d=fr(r),f=d?u?Rc:Rc.filter(function(v){return fr(v)===d}):fo,m=f.filter(function(v){return p.indexOf(v)>=0});m.length===0&&(m=f);var h=m.reduce(function(v,D){return v[D]=Kn(o,{placement:D,boundary:i,rootBoundary:s,padding:a})[It(D)],v},{});return Object.keys(h).sort(function(v,D){return h[v]-h[D]})}c(Ic,"computeAutoPlacement");function w4(o){if(It(o)===zu)return[];var n=Ki(o);return[ju(o),n,ju(n)]}c(w4,"getExpandedFallbackPlacements");function A4(o){var n=o.state,e=o.options,r=o.name;if(!n.modifiersData[r]._skip){for(var i=e.mainAxis,s=i===void 0?!0:i,a=e.altAxis,u=a===void 0?!0:a,l=e.fallbackPlacements,p=e.padding,d=e.boundary,f=e.rootBoundary,m=e.altBoundary,h=e.flipVariations,v=h===void 0?!0:h,D=e.allowedAutoPlacements,b=n.options.placement,C=It(b),A=C===b,M=l||(A||!v?[Ki(b)]:w4(b)),w=[b].concat(M).reduce(function(Jt,je){return Jt.concat(It(je)===zu?Ic(n,{placement:je,boundary:d,rootBoundary:f,padding:p,flipVariations:v,allowedAutoPlacements:D}):je)},[]),T=n.rects.reference,R=n.rects.popper,S=new Map,F=!0,O=w[0],L=0;L<w.length;L++){var W=w[L],se=It(W),ae=fr(W)===Br,oe=[yt,Ft].indexOf(se)>=0,Fe=oe?"width":"height",He=Kn(n,{placement:W,boundary:d,rootBoundary:f,altBoundary:m,padding:p}),it=oe?ae?Tt:Et:ae?Ft:yt;T[Fe]>R[Fe]&&(it=Ki(it));var ht=Ki(it),st=[];if(s&&st.push(He[se]<=0),u&&st.push(He[it]<=0,He[ht]<=0),st.every(function(Jt){return Jt})){O=W,F=!1;break}S.set(W,st)}if(F)for(var bt=v?3:1,Pt=c(function(je){var We=w.find(function(X){var ee=S.get(X);if(ee)return ee.slice(0,je).every(function(Ge){return Ge})});if(We)return O=We,"break"},"_loop"),Kt=bt;Kt>0;Kt--){var Cn=Pt(Kt);if(Cn==="break")break}n.placement!==O&&(n.modifiersData[r]._skip=!0,n.placement=O,n.reset=!0)}}c(A4,"flip");var am={name:"flip",enabled:!0,phase:"main",fn:A4,requiresIfExists:["offset"],data:{_skip:!1}};function um(o,n,e){return e===void 0&&(e={x:0,y:0}),{top:o.top-n.height-e.y,right:o.right-n.width+e.x,bottom:o.bottom-n.height+e.y,left:o.left-n.width-e.x}}c(um,"getSideOffsets");function lm(o){return[yt,Tt,Ft,Et].some(function(n){return o[n]>=0})}c(lm,"isAnySideFullyClipped");function T4(o){var n=o.state,e=o.name,r=n.rects.reference,i=n.rects.popper,s=n.modifiersData.preventOverflow,a=Kn(n,{elementContext:"reference"}),u=Kn(n,{altBoundary:!0}),l=um(a,r),p=um(u,i,s),d=lm(l),f=lm(p);n.modifiersData[e]={referenceClippingOffsets:l,popperEscapeOffsets:p,isReferenceHidden:d,hasPopperEscaped:f},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":f})}c(T4,"hide");var cm={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:T4};function E4(o,n,e){var r=It(o),i=[Et,yt].indexOf(r)>=0?-1:1,s=typeof e=="function"?e(Object.assign({},n,{placement:o})):e,a=s[0],u=s[1];return a=a||0,u=(u||0)*i,[Et,Tt].indexOf(r)>=0?{x:u,y:a}:{x:a,y:u}}c(E4,"distanceAndSkiddingToXY");function S4(o){var n=o.state,e=o.options,r=o.name,i=e.offset,s=i===void 0?[0,0]:i,a=Yu.reduce(function(d,f){return d[f]=E4(f,n.rects,s),d},{}),u=a[n.placement],l=u.x,p=u.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=l,n.modifiersData.popperOffsets.y+=p),n.modifiersData[r]=a}c(S4,"offset");var pm={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:S4};function _4(o){var n=o.state,e=o.name;n.modifiersData[e]=Zs({reference:n.rects.reference,element:n.rects.popper,strategy:"absolute",placement:n.placement})}c(_4,"popperOffsets");var dm={name:"popperOffsets",enabled:!0,phase:"read",fn:_4,data:{}};function Pc(o){return o==="x"?"y":"x"}c(Pc,"getAltAxis");function M4(o){var n=o.state,e=o.options,r=o.name,i=e.mainAxis,s=i===void 0?!0:i,a=e.altAxis,u=a===void 0?!1:a,l=e.boundary,p=e.rootBoundary,d=e.altBoundary,f=e.padding,m=e.tether,h=m===void 0?!0:m,v=e.tetherOffset,D=v===void 0?0:v,b=Kn(n,{boundary:l,rootBoundary:p,padding:f,altBoundary:d}),C=It(n.placement),A=fr(n.placement),M=!A,w=Ko(C),T=Pc(w),R=n.modifiersData.popperOffsets,S=n.rects.reference,F=n.rects.popper,O=typeof D=="function"?D(Object.assign({},n.rects,{placement:n.placement})):D,L={x:0,y:0};if(R){if(s||u){var W=w==="y"?yt:Et,se=w==="y"?Ft:Tt,ae=w==="y"?"height":"width",oe=R[w],Fe=R[w]+b[W],He=R[w]-b[se],it=h?-F[ae]/2:0,ht=A===Br?S[ae]:F[ae],st=A===Br?-F[ae]:-S[ae],bt=n.elements.arrow,Pt=h&&bt?jo(bt):{width:0,height:0},Kt=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:js(),Cn=Kt[W],Jt=Kt[se],je=Jo(0,S[ae],Pt[ae]),We=M?S[ae]/2-it-je-Cn-O:ht-je-Cn-O,X=M?-S[ae]/2+it+je+Jt+O:st+je+Jt+O,ee=n.elements.arrow&&jn(n.elements.arrow),Ge=ee?w==="y"?ee.clientTop||0:ee.clientLeft||0:0,Ie=n.modifiersData.offset?n.modifiersData.offset[n.placement][w]:0,Te=R[w]+We-Ie-Ge,Gt=R[w]+X-Ie;if(s){var Xe=Jo(h?mo(Fe,Te):Fe,oe,h?Nn(He,Gt):He);R[w]=Xe,L[w]=Xe-oe}if(u){var mr=w==="x"?yt:Et,kt=w==="x"?Ft:Tt,un=R[T],Do=un+b[mr],Bn=un-b[kt],ln=Jo(h?mo(Do,Te):Do,un,h?Nn(Bn,Gt):Bn);R[T]=ln,L[T]=ln-un}}n.modifiersData[r]=L}}c(M4,"preventOverflow");var fm={name:"preventOverflow",enabled:!0,phase:"main",fn:M4,requiresIfExists:["offset"]};function kc(o){return{scrollLeft:o.scrollLeft,scrollTop:o.scrollTop}}c(kc,"getHTMLElementScroll");function Vc(o){return o===mt(o)||!Qt(o)?Zo(o):kc(o)}c(Vc,"getNodeScroll");function Lc(o,n,e){e===void 0&&(e=!1);var r=Wt(n),i=On(o),s=Qt(n),a={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(s||!s&&!e)&&((Bt(n)!=="body"||ti(r))&&(a=Vc(n)),Qt(n)?(u=On(n),u.x+=n.clientLeft,u.y+=n.clientTop):r&&(u.x=ei(r))),{x:i.left+a.scrollLeft-u.x,y:i.top+a.scrollTop-u.y,width:i.width,height:i.height}}c(Lc,"getCompositeRect");function R4(o){var n=new Map,e=new Set,r=[];o.forEach(function(s){n.set(s.name,s)});function i(s){e.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(u){if(!e.has(u)){var l=n.get(u);l&&i(l)}}),r.push(s)}return c(i,"sort"),o.forEach(function(s){e.has(s.name)||i(s)}),r}c(R4,"order");function Hc(o){var n=R4(o);return Zf.reduce(function(e,r){return e.concat(n.filter(function(i){return i.phase===r}))},[])}c(Hc,"orderModifiers");function Wc(o){var n;return function(){return n||(n=new Promise(function(e){Promise.resolve().then(function(){n=void 0,e(o())})})),n}}c(Wc,"debounce");function Gc(o){var n=o.reduce(function(e,r){var i=e[r.name];return e[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,e},{});return Object.keys(n).map(function(e){return n[e]})}c(Gc,"mergeByName");var mm={placement:"bottom",modifiers:[],strategy:"absolute"};function hm(){for(var o=arguments.length,n=new Array(o),e=0;e<o;e++)n[e]=arguments[e];return!n.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}c(hm,"areValidElements");function gm(o){o===void 0&&(o={});var n=o,e=n.defaultModifiers,r=e===void 0?[]:e,i=n.defaultOptions,s=i===void 0?mm:i;return c(function(u,l,p){p===void 0&&(p=s);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},mm,s),modifiersData:{},elements:{reference:u,popper:l},attributes:{},styles:{}},f=[],m=!1,h={state:d,setOptions:c(function(C){D(),d.options=Object.assign({},s,d.options,C),d.scrollParents={reference:Ir(u)?ho(u):u.contextElement?ho(u.contextElement):[],popper:ho(l)};var A=Hc(Gc([].concat(r,d.options.modifiers)));if(d.orderedModifiers=A.filter(function(L){return L.enabled}),!1){var M;if(getBasePlacement(d.options.placement)===auto)var w;var T,R,S,F,O}return v(),h.update()},"setOptions"),forceUpdate:c(function(){if(!m){var C=d.elements,A=C.reference,M=C.popper;if(hm(A,M)){d.rects={reference:Lc(A,jn(M),d.options.strategy==="fixed"),popper:jo(M)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(W){return d.modifiersData[W.name]=Object.assign({},W.data)});for(var w=0,T=0;T<d.orderedModifiers.length;T++){if(d.reset===!0){d.reset=!1,T=-1;continue}var R=d.orderedModifiers[T],S=R.fn,F=R.options,O=F===void 0?{}:F,L=R.name;typeof S=="function"&&(d=S({state:d,options:O,name:L,instance:h})||d)}}}},"forceUpdate"),update:Wc(function(){return new Promise(function(b){h.forceUpdate(),b(d)})}),destroy:c(function(){D(),m=!0},"destroy")};if(!hm(u,l))return h;h.setOptions(p).then(function(b){!m&&p.onFirstUpdate&&p.onFirstUpdate(b)});function v(){d.orderedModifiers.forEach(function(b){var C=b.name,A=b.options,M=A===void 0?{}:A,w=b.effect;if(typeof w=="function"){var T=w({state:d,name:C,instance:h,options:M}),R=c(function(){},"noopFn");f.push(T||R)}})}c(v,"runModifierEffects");function D(){f.forEach(function(b){return b()}),f=[]}return c(D,"cleanupModifierEffects"),h},"createPopper")}c(gm,"popperGenerator");var O4=[im,dm,om,em,pm,am,fm,nm,cm],Uc=gm({defaultModifiers:O4});var Zi=class{constructor(n){this.currentlyDrawnRect=n;this.previouslySelectedElements=new Set}toggle(n){this.previouslySelectedElements.has(n)?this.previouslySelectedElements.delete(n):this.previouslySelectedElements.add(n)}finishCurrentRect(n){let e;if((e=this.currentlyDrawnRect)!==void 0){for(let r of n.components.all())r.isInRect(e)&&this.toggle(r);for(let r of n.wireMgr.wires)for(let i of r.waypoints)i.isInRect(e)&&this.toggle(i);this.currentlyDrawnRect=void 0}}isSelected(n){let e=this.previouslySelectedElements.has(n),r=this.currentlyDrawnRect;return r===void 0?e:n.isInRect(r)?!e:e}};c(Zi,"EditorSelection");var ea=class{constructor(n){this._currentMouseOverComp=null;this._currentMouseOverPopper=null;this._currentMouseDownData=null;this._startHoverTimeoutHandle=null;this._startDragTimeoutHandle=null;this._lastTouchEnd=void 0;this.currentSelection=void 0;this.editor=n,this._currentHandlers=new ta(n)}get currentMouseOverComp(){return this._currentMouseOverComp}get currentMouseDownData(){return this._currentMouseDownData}setHandlersFor(n){this._currentHandlers=(()=>{switch(n){case"edit":return new ta(this.editor);case"delete":return new Ju(this.editor);case"move":return new Zu(this.editor)}})(),dc(n==="delete")}setStartDragTimeout(n,e){let r=e;r._savedOffsetX=r.offsetX,r._savedOffsetY=r.offsetY,r._savedTarget=r.target,this._startDragTimeoutHandle=setTimeout(this.editor.wrapHandler(()=>{let i=!0,s=this._currentMouseDownData;if(s!==null&&(s.fireMouseClickedOnFinish=!1,s.triggeredContextMenu&&(i=!1)),i){n.mainComp instanceof Wn&&this._currentHandlers.mouseDraggedOn(n.mainComp,e);for(let a of n.selectionComps)this._currentHandlers.mouseDraggedOn(a,e)}}),300)}clearStartDragTimeout(){this._startDragTimeoutHandle!==null&&(clearTimeout(this._startDragTimeoutHandle),this._startDragTimeoutHandle=null)}clearHoverTimeoutHandle(){this._startHoverTimeoutHandle!==null&&(clearTimeout(this._startHoverTimeoutHandle),this._startHoverTimeoutHandle=null)}setCurrentMouseOverComp(n){n!==this._currentMouseOverComp&&(this.clearPopperIfNecessary(),this.clearHoverTimeoutHandle(),this._currentMouseOverComp=n,n!==null&&(this._startHoverTimeoutHandle=setTimeout(()=>{this._currentHandlers.mouseHoverOn(n),this._startHoverTimeoutHandle=null},1200)),this.editor.redrawMgr.addReason("mouseover changed",null))}currentSelectionEmpty(){return this.currentSelection===void 0||this.currentSelection.previouslySelectedElements.size===0}updateMouseOver([n,e],r){let i=c(()=>{if(this._currentMouseOverComp!==null&&this._currentMouseOverComp.drawZIndex!==0&&this._currentMouseOverComp.isOver(n,e))return this._currentMouseOverComp;if(!r){for(let s of this.editor.components.withZIndex(oo.Overlay))if(s.isOver(n,e))return s}for(let s of this.editor.components.withZIndex(oo.Normal)){let a=null;for(let u of s.allNodes())if(u.isOver(n,e)){a=u;break}if(a!==null&&(!r||this.editor.wireMgr.isValidMouseUp(a)))return a;if(!r&&s.isOver(n,e))return s}if(!r){for(let s of this.editor.wireMgr.wires){for(let a of s.waypoints)if(a.isOver(n,e))return a;if(s.isOver(n,e))return s}for(let s of this.editor.components.withZIndex(oo.Background))if(s.isOver(n,e))return s}return null},"findMouseOver");this.setCurrentMouseOverComp(i())}selectAll(){let n=new Zi(void 0);this.currentSelection=n;for(let e of this.editor.components.all())n.previouslySelectedElements.add(e);for(let e of this.editor.wireMgr.wires)for(let r of e.waypoints)n.previouslySelectedElements.add(r);this.editor.redrawMgr.addReason("selected all",null)}toggleSelect(n){let e;(e=this.currentSelection)===void 0&&(e=new Zi(void 0),this.currentSelection=e),e.toggle(n),this.editor.redrawMgr.addReason("toggled selection",null)}clearPopperIfNecessary(){if(this._currentMouseOverPopper!==null){let[n,e]=this._currentMouseOverPopper;e(),n.destroy(),this._currentMouseOverPopper=null,this.editor.html.tooltipElem.style.display="none"}}makePopper(n,e){let r=this.editor.html.tooltipContents,i=this.editor.html.tooltipElem;r.innerHTML="",n.applyTo(r),i.style.removeProperty("display");let s=this.editor.html.mainCanvas,a=Uc({getBoundingClientRect:e,contextElement:s},i,{placement:"right",modifiers:[{name:"offset",options:{offset:[4,8]}}]}),u=Y0(s),l=c(()=>a.update(),"scrollListener");u.addEventListener("scroll",l);let p=c(()=>u.removeEventListener("scroll",l),"removeListener");this._currentMouseOverPopper=[a,p],i.setAttribute("data-show",""),a.update()}registerCanvasListenersOn(n){let e=this.editor;n.addEventListener("touchstart",e.wrapHandler(r=>{this.editor.mode>=2&&r.preventDefault(),this._mouseDownTouchStart(r)})),n.addEventListener("touchmove",e.wrapHandler(r=>{this.editor.mode>=2&&r.preventDefault(),this._mouseMoveTouchMove(r)})),n.addEventListener("touchend",e.wrapHandler(r=>{r.preventDefault(),this._mouseUpTouchEnd(r),this.setCurrentMouseOverComp(null),this.editor.html.mainCanvas.focus()})),n.addEventListener("mousedown",e.wrapHandler(r=>{this._mouseDownTouchStart(r)})),n.addEventListener("mousemove",e.wrapHandler(r=>{this._mouseMoveTouchMove(r),this.editor.updateCursor(r)})),n.addEventListener("mouseleave",e.wrapHandler(()=>{this.clearPopperIfNecessary()})),n.addEventListener("mouseup",e.wrapHandler(r=>{this._mouseUpTouchEnd(r),this.updateMouseOver(this.editor.offsetXY(r),!1),this.editor.updateCursor(r),this.editor.html.mainCanvas.focus()})),n.addEventListener("contextmenu",e.wrapHandler(r=>{r.preventDefault(),this.editor.mode>=2&&this._currentMouseOverComp!==null&&this._currentHandlers.contextMenuOn(this._currentMouseOverComp,r)})),n.addEventListener("keyup",e.wrapHandler(r=>{var i;if(!Ro(r))switch(r.key){case"Escape":e.tryDeleteComponentsWhere(s=>s.state===0,!1),e.wireMgr.tryCancelWire(),r.preventDefault();return;case"Backspace":case"Delete":{let s;if((s=(i=this.currentSelection)==null?void 0:i.previouslySelectedElements)!==void 0&&s.size!==0){let a=!1;for(let u of s)a=e.tryDeleteDrawable(u).isChange||a;a&&e.undoMgr.takeSnapshot()}else if((s=this.currentMouseOverComp)!==null){let a=e.tryDeleteDrawable(s);e.undoMgr.takeSnapshot(a)}r.preventDefault();return}case"e":e.setCurrentMouseAction("edit"),r.preventDefault();return;case"d":e.setCurrentMouseAction("delete"),r.preventDefault();return;case"m":e.setCurrentMouseAction("move"),r.preventDefault();return}})),n.addEventListener("keydown",e.wrapHandler(r=>{let i=r.ctrlKey||r.metaKey,s=r.key.toLowerCase(),a=r.shiftKey||s!==r.key;switch(s){case"a":i&&e.mode>=2&&!Ro(r)&&(this.selectAll(),r.preventDefault());return;case"s":i&&e.isSingleton&&(e.saveCurrentStateToUrl(),r.preventDefault());return;case"z":i&&!Ro(r)&&(a?e.undoMgr.redoOrRepeat():e.undoMgr.undo(),r.preventDefault());return;case"y":i&&!Ro(r)&&(e.undoMgr.redoOrRepeat(),r.preventDefault());return;case"x":i&&!Ro(r)&&(e.cut(),r.preventDefault());return;case"v":i&&!Ro(r)&&(e.paste(),r.preventDefault());return}this._currentMouseOverComp!==null&&this._currentMouseOverComp.keyDown(r)}))}_mouseDownTouchStart(n){if(this.clearHoverTimeoutHandle(),this.clearPopperIfNecessary(),this._currentMouseDownData===null){let e=this.editor.offsetXY(n);if(this.updateMouseOver(e,!1),this._currentMouseOverComp!==null){let{wantsDragEvents:r}=this._currentHandlers.mouseDownOn(this._currentMouseOverComp,n);if(r){let i=this.currentSelection===void 0?[]:[...this.currentSelection.previouslySelectedElements];for(let a of i)a!==this._currentMouseOverComp&&this._currentHandlers.mouseDownOn(a,n);let s={mainComp:this._currentMouseOverComp,selectionComps:i,fireMouseClickedOnFinish:!0,initialXY:e,triggeredContextMenu:!1};this._currentMouseDownData=s,this.setStartDragTimeout(s,n)}this.editor.redrawMgr.addReason("mousedown",null)}else this._currentMouseDownData={mainComp:this.editor.html.canvasContainer,selectionComps:[],fireMouseClickedOnFinish:!0,initialXY:e,triggeredContextMenu:!1},this._currentHandlers.mouseDownOnBackground(n);this.editor.updateCursor(n)}}_mouseMoveTouchMove(n){if(this._currentMouseDownData!==null)if(this._currentMouseDownData.triggeredContextMenu)this._currentMouseDownData=null;else if(this._currentMouseDownData.mainComp instanceof Wn){let e=Un(...this.editor.offsetXY(n),...this._currentMouseDownData.initialXY);if(isNaN(e)||e>=5){this.clearStartDragTimeout(),this._currentMouseDownData.fireMouseClickedOnFinish=!1,this._currentHandlers.mouseDraggedOn(this._currentMouseDownData.mainComp,n);for(let r of this._currentMouseDownData.selectionComps)r!==this._currentMouseDownData.mainComp&&this._currentHandlers.mouseDraggedOn(r,n)}}else this._currentHandlers.mouseDraggedOnBackground(n);else this.updateMouseOver(this.editor.offsetXY(n),this.editor.wireMgr.isAddingWire)}_mouseUpTouchEnd(n){var r,i,s,a,u,l;let e=(i=(r=this._currentMouseDownData)==null?void 0:r.mainComp)!=null?i:this._currentMouseOverComp;if(e instanceof Wn){this._startDragTimeoutHandle!==null&&(clearTimeout(this._startDragTimeoutHandle),this._startDragTimeoutHandle=null);let p=this._currentHandlers.mouseUpOn(e,n);for(let d of(a=(s=this._currentMouseDownData)==null?void 0:s.selectionComps)!=null?a:[])if(d!==e){let f=this._currentHandlers.mouseUpOn(d,n);p=Z.merge(p,f)}if((l=(u=this._currentMouseDownData)==null?void 0:u.fireMouseClickedOnFinish)!=null&&l){let d;this.isDoubleClick(e,n)?(d=this._currentHandlers.mouseDoubleClickedOn(e,n),d.isChange||(d=this._currentHandlers.mouseClickedOn(e,n))):d=this._currentHandlers.mouseClickedOn(e,n),p=Z.merge(p,d)}p.isChange&&this.editor.undoMgr.takeSnapshot(p)}else this._currentHandlers.mouseUpOnBackground(n);this._currentMouseDownData=null,this.editor.redrawMgr.addReason("mouseup",null)}isDoubleClick(n,e){if("offsetX"in e)return e.detail===2;{let r=this._lastTouchEnd,i=new Date().getTime();if(this._lastTouchEnd=[n,i],r===void 0)return!1;let[s,a]=r,u=i-a,l=s===n&&u>0&&u<300;return l&&(this._lastTouchEnd=void 0),l}}registerButtonListenersOn(n,e){let r=this.editor;for(let i of n){let s=c(a=>{this.editor.setCurrentMouseAction("edit"),a.preventDefault(),this.editor.cursorMovementMgr.currentSelection=void 0;let u=r.factory.makeFromButton(r,i);if(u===void 0)return;this._currentMouseOverComp=u;let{wantsDragEvents:l}=this._currentHandlers.mouseDownOn(u,a);l&&(this._currentMouseDownData={mainComp:this._currentMouseOverComp,selectionComps:[],fireMouseClickedOnFinish:!1,initialXY:[NaN,NaN],triggeredContextMenu:!1}),this._currentHandlers.mouseDraggedOn(u,a)},"buttonMouseDownTouchStart");i.addEventListener("mousedown",r.wrapHandler(a=>{a.ctrlKey||a.button===2||s(a)})),i.addEventListener("touchstart",r.wrapHandler(a=>{s(a)})),i.addEventListener("touchmove",r.wrapHandler(a=>{a.preventDefault(),this._mouseMoveTouchMove(a)})),i.addEventListener("touchend",r.wrapHandler(a=>{a.preventDefault(),this._mouseUpTouchEnd(a),this.setCurrentMouseOverComp(null)})),i.addEventListener("contextmenu",r.wrapHandler(a=>{a.preventDefault(),a.stopPropagation(),e&&this.editor.mode>=3&&this._currentHandlers.contextMenuOnButton(i.dataset,a)}))}}};c(ea,"CursorMovementManager");var es=class{constructor(n){this.editor=n}mouseHoverOn(n){}mouseDownOn(n,e){return{wantsDragEvents:!0}}mouseDraggedOn(n,e){}mouseUpOn(n,e){return Z.NoChange}mouseClickedOn(n,e){return Z.NoChange}mouseDoubleClickedOn(n,e){return Z.NoChange}contextMenuOn(n,e){return!1}contextMenuOnButton(n,e){}mouseDownOnBackground(n){}mouseDraggedOnBackground(n){}mouseUpOnBackground(n){}};c(es,"ToolHandlers");var ta=class extends es{constructor(e){super(e);this._openedContextMenu=null}mouseHoverOn(e){let r=this.editor;if(r.cursorMovementMgr.clearPopperIfNecessary(),r.options.hideTooltips||e instanceof he&&e.state===2)return;let i=e.makeTooltip();if(i!==void 0){let s=c(()=>{let a=r.html.canvasContainer.getBoundingClientRect(),u=r.actualZoomFactor,[l,p,d,f]=e instanceof er?[e.posX*u,e.posY*u,e.width*u,e.height*u]:[r.mouseX,r.mouseY,4,4];return new DOMRect(a.x+l-d/2,a.y+p-f/2,d,f)},"rect");r.cursorMovementMgr.makePopper(i,s)}}mouseDownOn(e,r){return e.mouseDown(r)}mouseDraggedOn(e,r){e.mouseDragged(r)}mouseUpOn(e,r){let i=e.mouseUp(r);return this.editor.wireMgr.tryCancelWire(),i}mouseClickedOn(e,r){return e.mouseClicked(r)}mouseDoubleClickedOn(e,r){return e.mouseDoubleClicked(r)}contextMenuOn(e,r){return this.showContextMenu(e.makeContextMenu(),r)}contextMenuOnButton(e,r){return this.showContextMenu(this.editor.factory.makeContextMenu(e.type),r)}mouseDownOnBackground(e){let r=this.editor,i=r.cursorMovementMgr,s=i.currentSelection;if(s!==void 0){let a=r.mode>=2;if(e.shiftKey&&a){s.currentlyDrawnRect!==void 0&&console.log("unexpected defined current rect when about to begin a new one");let[u,l]=r.offsetXY(e),p=new DOMRect(u,l,1,1);s.currentlyDrawnRect=p}else i.currentSelection=void 0;r.redrawMgr.addReason("selection rect changed",null)}}mouseDraggedOnBackground(e){let r=this.editor;if(r.mode>=2){let s=r.cursorMovementMgr,a=s.currentSelection,[u,l]=r.offsetXY(e);if(a===void 0){let p=new DOMRect(u,l,1,1);s.currentSelection=new Zi(p)}else{let p=a.currentlyDrawnRect;p===void 0?console.log("trying to update a selection rect that is not defined"):(p.width=u-p.x,p.height=l-p.y,r.redrawMgr.addReason("selection rect changed",null))}}}mouseUpOnBackground(e){let r=this.editor;r.wireMgr.tryCancelWire();let s=r.cursorMovementMgr.currentSelection;s!==void 0&&(s.finishCurrentRect(this.editor),r.redrawMgr.addReason("selection rect changed",null))}showContextMenu(e,r){let i=c(()=>{this._openedContextMenu!==null&&(this._openedContextMenu.classList.remove("show-menu"),this._openedContextMenu.innerHTML="",this._openedContextMenu=null)},"hideMenu");if(i(),e!==void 0){let s=this.editor.cursorMovementMgr.currentMouseDownData;s!==null&&(s.triggeredContextMenu=!0);let a=c(D=>{var C;function b(A,M,w){return mi(wr("button"),at(`menu-btn${w?" danger":""}`),A.icon===void 0?A.caption:q(Qi(A.icon),Yt(at("menu-text"),A.caption)),M===void 0?At:Yt(at("menu-shortcut"),M))}switch(c(b,"mkButton"),D._tag){case"sep":return ys(at("menu-separator")).render();case"text":return ys(at("menu-item-static"),D.caption).render();case"item":{let A=b(D,D.shortcut,(C=D.danger)!=null?C:!1).render();return A.addEventListener("click",this.editor.wrapHandler(M=>{let w=D.action(M,r);this.editor.undoMgr.takeSnapshot(w)})),ys(at("menu-item"),A).render()}case"submenu":return ys(at("menu-item submenu"),b(D,void 0,!1),J0(at("menu"),...D.items.map(a))).render()}},"defToElem"),u=e.map(a),l=this.editor.html.mainContextMenu;Ma(l,u);let p=r;l.classList.add("show-menu");let d=p.pageY;l.style.top=d+"px",l.style.left=p.pageX+"px";let f=!1,m=l.getBoundingClientRect(),h=window.innerHeight-m.bottom;h<0&&(d+=Math.min(0,h),d<5&&(d=5,f=!0),l.style.top=d+"px"),f?(l.style.setProperty("max-height",window.innerHeight-10+"px"),l.style.setProperty("overflow-y","scroll")):(l.style.removeProperty("max-height"),l.style.removeProperty("overflow-y")),this._openedContextMenu=l;let v=c(()=>{i(),document.removeEventListener("click",v)},"clickHandler");return setTimeout(()=>{document.addEventListener("click",v,!1)},200),!0}return!1}};c(ta,"EditHandlers");var Ju=class extends es{constructor(n){super(n)}mouseClickedOn(n,e){return this.editor.tryDeleteDrawable(n)}};c(Ju,"DeleteHandlers");var Zu=class extends es{constructor(n){super(n)}mouseDownOnBackground(n){for(let e of this.editor.components.all())e.mouseDown(n);for(let e of this.editor.wireMgr.wires)for(let r of e.waypoints)r.mouseDown(n)}mouseDraggedOnBackground(n){for(let e of this.editor.components.all())e.mouseDragged(n);for(let e of this.editor.wireMgr.wires)for(let r of e.waypoints)r.mouseDragged(n)}mouseUpOnBackground(n){for(let e of this.editor.components.all())e.mouseUp(n);for(let e of this.editor.wireMgr.wires)for(let r of e.waypoints)r.mouseUp(n)}};c(Zu,"MoveHandlers");var na=class{constructor(n){this._movingDrawables=new Set;this.editor=n}areDrawablesMoving(){return this._movingDrawables.size>0}getSingleMovingWaypoint(){if(this._movingDrawables.size===1){let n=this._movingDrawables.values().next().value;if(n instanceof Sn)return n}}setDrawableMoving(n,e){this.changeMovingDrawables(()=>{this._movingDrawables.add(n)},e)}setDrawableStoppedMoving(n,e){this.changeMovingDrawables(()=>{this._movingDrawables.delete(n)},e)}changeMovingDrawables(n,e){let r=this._movingDrawables.size===0;n();let i=this._movingDrawables.size===0;r!==i&&(this.editor.updateCursor(e),this.editor.redrawMgr.addReason("started or stopped moving drawables",null))}dump(){var e;let n=this._movingDrawables.size;if(n===0)console.log("No moving drawables");else{console.log(`There are ${n} moving drawables:`);for(let r of this._movingDrawables){let i=r.constructor.name;r instanceof he?console.log(i+" - "+((e=r.outputs._all[0])==null?void 0:e.id)):console.log(i)}}}};c(na,"MoveManager");var ra=class{aluOps(){function*n(){for(let a of[!1,!0])for(let u of[!1,!0])for(let l of[!1,!0])for(let p of[!1,!0])yield[a,u,l,p]}c(n,"nibbles");function e(a){let[u,l]=Oe(a,!0),p=l,d=p<8?p:p-16;return[u,p,d]}c(e,"representationsOf");let r=0,i=0,s=!1;for(let a of n())for(let u of n())for(let l of[!1,!0]){let[p,d,f]=e(a),[m,h,v]=e(u);a.reverse(),u.reverse();let{s:D,v:b,cout:C}=Lo(a,u,l),{s:A,v:M,cout:w}=Vo(a,u,l);a.reverse(),u.reverse(),D.reverse(),A.reverse();let[T,R,S]=e(D),[F,O,L]=e(A),W=d+h+Number(l),se=W>15,ae=!1;se?ae=R===W||C!==!0:ae=R!==W||C!==!1,ae?(console.log(`ERROR carry - ${d} (${p}) + ${h} (${m}) + ${Number(l)} = ${R} (${T}) (c=${C})`),i++):s&&console.log(`carry - ${d} (${p}) + ${h} (${m}) + ${Number(l)} = ${R} (${T}) (c=${C})`),r++;let oe=d-h-Number(l),Fe=!1;d-Number(l)<h?Fe=O===oe||w!==!0:Fe=O!==oe||w!==!1,Fe?(console.log(`ERROR borrow - ${d} (${p}) - ${h} (${m}) - ${Number(l)} = ${O} (${F}) (c=${w})`),i++):s&&console.log(`borrow - ${d} (${p}) - ${h} (${m}) - ${Number(l)} = ${O} (${F}) (c=${w})`),r++;let He=f+v+Number(l),it=He>7||He<-8,ht=!1;it?ht=S===He||b!==!0:ht=S!==He||b!==!1,ht?(console.log(`ERROR overflow - ${f} (${p}) + ${v} (${m}) + ${Number(l)} = ${S} (${T}) (v=${b})`),i++):s&&console.log(`overflow - ${f} (${p}) + ${v} (${m}) + ${Number(l)} = ${S} (${T}) (v=${b})`),r++;let st=f-v-Number(l),bt=st>7||st<-8,Pt=!1;bt?Pt=L===st||M!==!0:Pt=L!==st||M!==!1,Pt?(console.log(`ERROR overflow - ${f} (${p}) - ${v} (${m}) - ${Number(l)} = ${L} (${F}) (v=${M})`),i++):s&&console.log(`overflow - ${f} (${p}) - ${v} (${m}) - ${Number(l)} = ${L} (${F}) (v=${M})`),r++}console.log(`Tests: ${r} total, ${i} failed, ${r-i} passed`)}};c(ra,"Tests");function N4(o,n){return o.hasCallbacks===n.hasCallbacks&&o.enablesPause===n.enablesPause&&o.isPaused===n.isPaused&&o.enablesPause===n.enablesPause&&o.nextStepDesc===n.nextStepDesc}c(N4,"areStatesEqual");var oa=class{constructor(n){this.onStateChanged=c(n=>null,"onStateChanged");this.editor=n,this.reset()}reset(){this._epochStart=this.unadjustedTime(),this._sortedNextCallbackTimes=[],this._schedule={},this._numCallbacksEnablingPause=0,this._nextTimeout!==void 0&&(clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0),this._fixedLogicalTime=void 0,this._pausedSince=void 0}get isPaused(){return this._pausedSince!==void 0}get nextTickDesc(){var i;if(this._sortedNextCallbackTimes.length===0)return;let n=this._sortedNextCallbackTimes[0],e=this._schedule[n];if(e.length===1)return e[0].desc;let r=new Map;for(let s of e)r.set(s.desc,((i=r.get(s.desc))!=null?i:0)+1);return[...r.entries()].map(([s,a])=>`${a} \xD7 ${s}`).join(`
`)}get state(){let n=this._sortedNextCallbackTimes.length>0,e=this._numCallbacksEnablingPause>0,r=this.isPaused,s=r&&n?this.nextTickDesc:void 0;return{hasCallbacks:n,enablesPause:e,isPaused:r,nextStepDesc:s}}unadjustedTime(){return new Date().getTime()}logicalTime(){return this._fixedLogicalTime!==void 0?this._fixedLogicalTime:this._pausedSince!==void 0?this._pausedSince-this._epochStart:this.unadjustedTime()-this._epochStart}scheduleAt(n,e,r,i){let s={callback:e,desc:r,enablesPause:i};if(this._numCallbacksEnablingPause+=i?1:0,n in this._schedule)this._schedule[n].push(s);else{n<this.logicalTime()&&console.log(`WARNING Scheduling this in the past (${n-this.logicalTime()} ms), may behave strangely: `+r);let a=0;do{if(a>=this._sortedNextCallbackTimes.length){this._sortedNextCallbackTimes.push(n);break}if(n<this._sortedNextCallbackTimes[a]){this._sortedNextCallbackTimes.splice(a,0,n);break}a++}while(!0);this._schedule[n]=[s],a===0&&this.rescheduleNextIfNeeded()}this.fireStateChangedIfNeeded()}rescheduleNextIfNeeded(){if(this._sortedNextCallbackTimes.length===0)this._nextTimeout!==void 0&&(clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0);else{let n=this._sortedNextCallbackTimes[0];if(this._nextTimeout!==void 0){if(this._nextTimeout.tickTime<=n)return;clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0}let e=this.logicalTime(),r=n-e,i=setTimeout(()=>this.nextTickCallback(),r);this._nextTimeout={handle:i,tickTime:n}}}nextTickCallback(){this._nextTimeout=void 0,this._pausedSince===void 0&&this.handleNextTick()}handleNextTick(){let n=this._sortedNextCallbackTimes.shift();if(n===void 0)return;let e=this.logicalTime(),r=this._schedule[n],i=e-n;i>100&&(this._epochStart+=i);let s=c(()=>{let a;for(this._fixedLogicalTime=n;(a=r.shift())!==void 0;){let{callback:u,desc:l,enablesPause:p}=a;this._numCallbacksEnablingPause-=p?1:0;try{u()}catch(d){console.log(`ERROR running callback '${l}': `+d)}}this._fixedLogicalTime=void 0},"runAllCallbacks");this.editor.wrapHandler(s)(),delete this._schedule[n],this.rescheduleNextIfNeeded(),this.fireStateChangedIfNeeded()}pause(){this._pausedSince===void 0&&(this._nextTimeout!==void 0&&(clearTimeout(this._nextTimeout.handle),this._nextTimeout=void 0),this._pausedSince=this.unadjustedTime(),this.fireStateChangedIfNeeded())}play(){this._pausedSince!==void 0&&(this._epochStart+=this.unadjustedTime()-this._pausedSince,this._pausedSince=void 0,this.editor.redrawMgr.addReason("timeline-play",null),this.rescheduleNextIfNeeded(),this.fireStateChangedIfNeeded())}step(){if(this._pausedSince===void 0||this._sortedNextCallbackTimes.length===0)return;let n=this._sortedNextCallbackTimes[0],e=this.logicalTime();this._epochStart-=n-e,this.handleNextTick(),this.fireStateChangedIfNeeded()}fireStateChangedIfNeeded(){let n=this.state;(this._lastSentState===void 0||!N4(this._lastSentState,n))&&(this.onStateChanged(n),this._lastSentState=n)}};c(oa,"Timeline");var F4=100,ia=class{constructor(n){this._undoSnapshots=[];this._redoSnapshots=[];this.onStateChanged=c(n=>null,"onStateChanged");this.editor=n}get state(){return{canUndo:this.canUndo(),canRedoOrRepeat:this.canRedoOrRepeat()}}canUndo(){return this._undoSnapshots.length>1}canRedoOrRepeat(){return this._redoSnapshots.length>0||(this._undoSnapshots.length>0&&this._undoSnapshots[this._undoSnapshots.length-1].repeatAction)!==void 0}takeSnapshot(n){var i;if(!((i=n==null?void 0:n.isChange)!=null?i:!0))return;let r=n===void 0?void 0:n._tag==="RepeatableChange"?n.repeat:void 0;this.doTakeSnapshot(r)}doTakeSnapshot(n){let e=Date.now(),r=this.editor.save(),i=vt.stringifyObject(r,!0);for(this._undoSnapshots.push({time:e,circuitStr:i,repeatAction:n});this._undoSnapshots.length>F4;)this._undoSnapshots.shift();this._redoSnapshots.length>0&&(this._redoSnapshots=[]),this.fireStateChangedIfNeeded()}undo(){if(!this.canUndo()){console.log("Nothing to undo");return}let n=this._undoSnapshots.pop(),e=this._undoSnapshots[this._undoSnapshots.length-1];this._redoSnapshots.push(n),this.loadSnapshot(e),this.fireStateChangedIfNeeded()}redoOrRepeat(){if(!this.canRedoOrRepeat()){console.log("Nothing to redo or repeat");return}let n=this._redoSnapshots.pop();if(n!==void 0)this._undoSnapshots.push(n),this.loadSnapshot(n);else{let e=this._undoSnapshots[this._undoSnapshots.length-1].repeatAction;if(e!==void 0){let r=e(),i=r===!1?void 0:r===!0?e:r;this.doTakeSnapshot(i)}}this.fireStateChangedIfNeeded()}dump(){function n(e,r){let i=e+(r.length===0?" (empty)":"");console.group(i);for(let s=r.length-1;s>=0;s--){let a=r[s],u=new Date(a.time).toISOString();console.log(u)}console.groupEnd()}c(n,"printStack"),n("Undo stack",this._undoSnapshots),n("Redo stack",this._redoSnapshots)}loadSnapshot(n){vt.loadCircuitOrLibrary(this.editor,n.circuitStr,{isUndoRedoAction:!0})}fireStateChangedIfNeeded(){let n=this.state;(this._lastSentState===void 0||!B4(this._lastSentState,n))&&(this.onStateChanged(n),this._lastSentState=n)}};c(ia,"UndoManager");function B4(o,n){return o.canUndo===n.canUndo&&o.canRedoOrRepeat===n.canRedoOrRepeat}c(B4,"areStatesEqual");var Dm={CharacterComparator:{v:5,in:[{pos:[50,130],id:0,val:1},{pos:[50,160],id:1,val:1},{pos:[50,190],id:2,val:1},{pos:[50,220],id:3,val:0},{pos:[50,250],id:4,val:1},{pos:[50,280],id:13,val:0},{pos:[50,310],id:14,val:1},{pos:[50,360],id:15,val:1},{pos:[50,390],id:16,val:0},{pos:[50,420],id:17,val:1},{pos:[50,450],id:18,val:0},{pos:[50,480],id:19,val:1},{pos:[50,510],id:20,val:0},{pos:[50,540],id:21,val:1}],out:[{pos:[870,310],id:5},{type:"ascii",pos:[180,60],id:[6,7,8,9,10,11,12]},{type:"ascii",pos:[180,620],id:[22,23,24,25,26,27,28]}],gates:[{type:"XOR",pos:[360,140],in:[29,30],out:31},{type:"XOR",pos:[360,200],in:[32,33],out:34},{type:"XOR",pos:[360,260],in:[35,36],out:37},{type:"XOR",pos:[360,320],in:[38,39],out:40},{type:"XOR",pos:[360,380],in:[41,42],out:43},{type:"XOR",pos:[360,440],in:[44,45],out:46},{type:"XOR",pos:[360,500],in:[47,48],out:49},{type:"OR",pos:[470,170],in:[68,69],out:70},{type:"OR",pos:[500,280],in:[71,72],out:73},{type:"OR",pos:[490,410],in:[74,75],out:76},{type:"OR",pos:[630,250],in:[77,78],out:79},{type:"OR",pos:[630,410],in:[80,81],out:82},{type:"OR",pos:[730,310],in:[83,84],out:85},{type:"NOT",pos:[800,310],in:50,out:51}],wires:[[0,6],[1,7],[2,8],[3,9],[4,10],[13,11],[14,12],[15,22],[16,23],[17,24],[18,25],[19,26],[20,27],[21,28],[0,29],[15,30],[79,83],[82,84],[31,68],[34,69],[37,71],[40,72],[43,74],[46,75],[49,81],[76,80],[73,78],[70,77],[85,50],[51,5],[1,32],[16,33],[2,35],[17,36],[18,39],[3,38],[4,41],[19,42],[13,44],[20,45],[21,48],[14,47]]},Counters:{v:5,in:[{type:"clock",pos:[70,40],id:0,name:"bit 0",period:2e3,phase:1e3,showLabel:!1},{type:"clock",pos:[70,80],id:10,name:"bit 1",period:4e3,phase:2e3,showLabel:!1},{type:"clock",pos:[70,120],id:23,name:"bit 2",period:8e3,phase:4e3,showLabel:!1},{type:"clock",pos:[70,160],id:24,name:"bit 3",period:16e3,phase:8e3,showLabel:!1},{type:"clock",pos:[430,30],id:5,period:500,phase:250,showLabel:!1},{type:"clock",pos:[430,70],id:6,period:1e3,phase:500,showLabel:!1},{type:"clock",pos:[430,110],id:7,period:2e3,phase:1e3,showLabel:!1},{type:"clock",pos:[430,150],id:8,period:4e3,phase:2e3,showLabel:!1},{type:"clock",pos:[430,190],id:9,period:8e3,phase:4e3,showLabel:!1},{type:"clock",pos:[430,230],id:11,period:16e3,phase:8e3,showLabel:!1},{type:"clock",pos:[430,270],id:12,period:32e3,phase:16e3,showLabel:!1}],out:[{type:"display",bits:4,pos:[240,90],id:[1,2,3,4]},{type:"ascii",pos:[580,150],id:[13,14,15,16,17,18,19]}],wires:[[0,1],[24,4],[23,3],[10,2],[5,13],[6,14],[7,15],[8,16],[9,17],[11,18],[12,19]]},AllGates:{v:5,in:[{pos:[40,320],id:0,val:0},{pos:[40,490],id:1,val:0}],out:[{pos:[400,30],id:48},{pos:[400,80],id:49},{pos:[400,140],id:50},{pos:[400,260],id:51},{pos:[400,380],id:52},{pos:[400,200],id:53},{pos:[400,320],id:54},{pos:[400,440],id:55},{pos:[400,560],id:56},{pos:[400,680],id:57},{pos:[400,500],id:58},{pos:[400,620],id:59},{pos:[400,740],id:60},{pos:[400,860],id:61},{pos:[400,800],id:62},{pos:[400,920],id:63}],gates:[{type:"NOT",pos:[290,80],in:2,out:3},{type:"BUF",pos:[290,30],in:4,out:5},{type:"AND",pos:[290,140],in:[6,7],out:8},{type:"OR",pos:[290,260],in:[9,10],out:11},{type:"XOR",pos:[290,380],in:[12,13],out:14},{type:"NAND",pos:[290,200],in:[15,16],out:17},{type:"NOR",pos:[290,320],in:[18,19],out:20},{type:"XNOR",pos:[290,440],in:[21,22],out:23},{type:"IMPLY",pos:[290,560],in:[24,25],out:26},{type:"RIMPLY",pos:[290,680],in:[27,28],out:29},{type:"NIMPLY",pos:[290,500],in:[30,31],out:32},{type:"RNIMPLY",pos:[290,620],in:[33,34],out:35},{type:"TXA",pos:[290,740],in:[36,37],out:38},{type:"TXB",pos:[290,860],in:[39,40],out:41},{type:"TXNA",pos:[290,800],in:[42,43],out:44},{type:"TXNB",pos:[290,920],in:[45,46],out:47}],wires:[[0,4],[0,2],[0,6],[0,9],[0,12],[0,15],[0,18],[0,21],[0,24],[0,27],[0,30],[0,33],[0,36],[0,39],[0,42],[0,45],[1,7],[1,10],[1,13],[1,16],[1,19],[1,22],[1,25],[1,28],[1,31],[1,34],[1,37],[1,40],[1,43],[1,46],[5,48],[3,49],[8,50],[11,51],[14,52],[17,53],[20,54],[23,55],[26,56],[29,57],[32,58],[35,59],[38,60],[41,61],[44,62],[47,63]]},SevenSegmentDisplay:{v:5,opts:{propagationDelay:20},in:[{type:"clock",pos:[90,60],orient:"s",id:21,period:16e3,phase:8e3},{type:"clock",pos:[130,60],orient:"s",id:22,period:8e3,phase:4e3},{type:"clock",pos:[170,60],orient:"s",id:23,period:4e3,phase:2e3},{type:"clock",pos:[210,60],orient:"s",id:24,period:2e3,phase:1e3}],out:[{type:"display",bits:4,pos:[1320,140],id:[132,133,134,135],radix:16},{type:"bar",pos:[1330,310],id:117,display:"h"},{type:"bar",pos:[1270,490],id:118,display:"v"},{type:"bar",pos:[1390,370],id:119,display:"v"},{type:"bar",pos:[1270,370],id:120,display:"v"},{type:"bar",pos:[1330,430],id:121,display:"h"},{type:"bar",pos:[1390,490],id:122,display:"v"},{type:"bar",pos:[1330,550],id:123,display:"h"}],gates:[{type:"NOT",pos:[1170,310],in:103,out:104},{type:"NOT",pos:[1170,350],in:105,out:106},{type:"NOT",pos:[1170,390],in:107,out:108},{type:"NOT",pos:[1170,430],in:109,out:110},{type:"NOT",pos:[1170,550],in:111,out:112},{type:"NOT",pos:[1170,510],in:113,out:114},{type:"NOT",pos:[1170,470],in:115,out:116},{type:"XOR",pos:[210,180],in:[0,1],out:2},{type:"AND",pos:[220,340],in:[3,4],out:5},{type:"XOR",pos:[200,420],in:[6,7],out:8},{type:"XOR",pos:[330,220],in:[9,10],out:11},{type:"XOR",pos:[340,280],in:[12,13],out:14},{type:"OR",pos:[320,480],in:[15,16],out:17},{type:"NOR",pos:[440,220],in:[18,19],out:20},{type:"XOR",pos:[450,290],in:[25,26],out:27},{type:"NOR",pos:[430,450],in:[31,32],out:33},{type:"NOR",pos:[560,410],in:[34,35],out:36},{type:"NOR",pos:[600,190],in:[37,38],out:39},{type:"NOR",pos:[540,360],in:[40,41],out:42},{type:"XOR",pos:[650,320],in:[43,44],out:45},{type:"OR",pos:[670,430],in:[46,47],out:48},{type:"XOR",pos:[770,490],in:[49,50],out:51},{type:"NOR",pos:[770,540],in:[52,53],out:54},{type:"NOR",pos:[800,390],in:[55,56],out:57},{type:"OR",pos:[960,250],in:[58,59],out:60},{type:"NOR",pos:[940,310],in:[61,62],out:63},{type:"AND",pos:[1050,270],in:[64,65],out:66},{type:"AND",pos:[950,380],in:[67,68],out:69},{type:"AND",pos:[950,440],in:[70,71],out:72},{type:"OR",pos:[1030,410],in:[73,74],out:75},{type:"XOR",pos:[1030,520],in:[76,77],out:78}],wires:[[104,117],[106,119],[108,122],[110,123],[112,121],[114,120],[116,118],[21,135],[22,134],[23,133],[24,132],[21,0],[23,1],[24,3],[22,4],[24,6],[21,7],[2,9],[22,10],[23,12],[5,13],[5,15],[8,16],[11,18],[14,19],[11,25],[8,26],[5,32],[14,31],[33,34],[21,35],[20,37],[2,38],[27,40],[8,41],[42,43],[21,44],[39,46],[17,47],[48,49],[21,50],[48,52],[33,53],[36,56],[45,55],[57,103],[39,58],[24,59],[60,64],[27,65],[66,109],[39,61],[45,62],[63,113],[69,73],[72,74],[75,105],[39,67],[24,68],[45,70],[22,71],[51,115],[20,111],[78,107],[72,76],[54,77]]},SevenSegmentBCDDisplay:{v:5,in:[{bits:4,pos:[50,80],id:[0,1,2,3],val:[0,1,0,1]}],out:[{type:"bar",pos:[560,100],id:4,display:"h"},{type:"bar",pos:[620,280],id:5,display:"v"},{type:"bar",pos:[500,160],id:6,display:"v"},{type:"bar",pos:[560,220],id:7,display:"h"},{type:"bar",pos:[560,340],id:8,display:"h"},{type:"bar",pos:[500,280],id:9,display:"v"},{type:"bar",pos:[620,160],id:10,display:"v"},{type:"bar",pos:[420,160],id:50,display:"v"},{type:"bar",pos:[420,280],id:51,display:"v"},{type:"display",bits:4,pos:[170,250],id:[11,23,24,25]}],ic:[{type:"decoder-7seg",pos:[280,60],in:[12,13,14,15],out:[16,17,18,19,20,21,22]},{type:"decoder-bcd4",pos:[180,80],in:[26,27,28,29],out:[30,31,32,33,34]}],wires:[[16,4],[17,10],[18,5],[19,8],[20,9],[21,6],[22,7],[0,11],[1,23],[2,24],[3,25],[0,26],[1,27],[2,28],[3,29],[30,12],[31,13],[32,14],[33,15],[34,50],[34,51]]},SixteenVsSevenSegmentDisplays:{v:5,in:[{bits:4,pos:[50,90],id:[74,75,76,77],val:[1,0,0,1]},{bits:4,pos:[50,170],id:[78,79,80,81],val:[1,1,0,0]}],out:[{type:"16seg",pos:[440,170],id:[57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73]},{type:"ascii",pos:[230,60],id:[82,83,84,85,86,87,88],additionalReprRadix:10},{type:"7seg",pos:[440,330],id:[93,94,95,96,97,98,99,100]}],gates:[{type:"OR",pos:[330,250],in:[90,91],out:92}],ic:[{type:"decoder-16seg",pos:[230,170],in:[34,35,36,37,38,39,40],out:[41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,89]},{type:"decoder-7seg",pos:[230,320],in:[101,102,103,104],out:[105,106,107,108,109,110,111]}],wires:[[74,82],[75,83],[76,84],[77,85],[78,86],[79,87],[80,88],[41,57],[42,58],[43,59],[44,60],[45,61],[46,62],[47,63],[48,64],[49,65],[50,66],[51,67],[52,68],[53,69],[54,70],[55,71],[56,72],[74,34],[75,35],[76,36],[77,37],[78,38],[79,39],[80,40],[89,90],[92,73],[81,91],[105,93],[106,94],[107,95],[108,96],[109,97],[110,98],[111,99],[74,101],[75,102],[76,103],[77,104],[81,100,{via:[[200,370]]}]]},NibbleAdder:{v:5,in:[{pos:[100,40],orient:"s",id:3,name:"A3",val:0},{pos:[200,40],orient:"s",id:0,name:"A2",val:0},{pos:[300,40],orient:"s",id:1,name:"A1",val:0},{pos:[400,40],orient:"s",id:2,name:"A0",val:0},{pos:[140,180],orient:"s",id:15,name:"B3",val:0},{pos:[240,180],orient:"s",id:14,name:"B2",val:0},{pos:[340,180],orient:"s",id:13,name:"B1",val:0},{pos:[440,180],orient:"s",id:12,name:"B0",val:0}],out:[{pos:[30,450],orient:"s",id:37,name:"S4"},{pos:[120,450],orient:"s",id:36,name:"S3"},{pos:[220,450],orient:"s",id:38,name:"S2"},{pos:[320,450],orient:"s",id:39,name:"S1"},{pos:[420,450],orient:"s",id:40,name:"S0"},{type:"display",bits:4,pos:[530,100],id:[4,5,6,7]},{type:"display",bits:4,pos:[530,240],id:[8,9,10,11]},{type:"display",bits:4,pos:[530,390],id:[41,42,43,44]}],ic:[{type:"adder",pos:[420,320],in:[16,17,18],out:[19,20]},{type:"adder",pos:[320,320],in:[21,22,23],out:[24,25]},{type:"adder",pos:[220,320],in:[26,27,28],out:[29,30]},{type:"adder",pos:[120,320],in:[31,32,33],out:[34,35]}],wires:[[12,8],[13,9],[14,10],[15,11],[2,4],[1,5],[0,6],[3,7],[20,23],[25,28],[30,33],[2,16],[12,17],[1,21],[13,22],[0,26],[14,27],[3,31],[15,32],[19,41],[24,42],[29,43],[34,44],[35,37],[34,36],[29,38],[24,39],[19,40]]},ALU:{v:5,in:[{pos:[290,60],orient:"s",id:16,name:"Op1",val:0},{pos:[330,60],orient:"s",id:17,name:"Op0",val:0},{pos:[50,140],id:18,val:0},{pos:[50,160],id:19,name:"A",val:0},{pos:[50,180],id:20,val:0},{pos:[50,200],id:21,val:0},{pos:[50,240],id:26,val:0},{pos:[50,260],id:27,name:"B",val:0},{pos:[50,280],id:28,val:0},{pos:[50,300],id:29,val:0}],out:[{pos:[420,320],id:38,name:"Zero"},{pos:[420,350],id:39,name:"oVerflow"},{type:"display",bits:4,pos:[110,60],orient:"n",id:[22,23,24,25],name:"A (non sign\xE9)"},{type:"display",bits:4,pos:[110,350],orient:"s",id:[30,31,32,33],name:"B (non sign\xE9)"},{type:"display",bits:4,pos:[420,250],id:[34,35,36,37],name:"Y (sign\xE9)",radix:-10},{type:"display",bits:4,pos:[420,150],id:[40,41,42,43],name:"Y (non sign\xE9)"},{type:"display",bits:4,pos:[210,60],orient:"n",id:[44,45,46,47],name:"A (sign\xE9)",radix:-10},{type:"display",bits:4,pos:[210,350],orient:"s",id:[48,49,50,51],name:"B (sign\xE9)",radix:-10}],ic:[{type:"alu",pos:[280,220],in:[0,1,2,3,4,5,6,7,8,9],out:[10,11,12,13,14,15]}],wires:[[16,9],[17,8],[21,3],[20,2],[19,1],[18,0],[18,22],[19,23],[20,24],[21,25],[26,4],[27,5],[28,6],[29,7],[26,30],[27,31],[28,32],[29,33],[10,34],[11,35],[12,36],[13,37],[15,38],[14,39],[10,40],[11,41],[12,42],[13,43],[18,44],[19,45],[20,46],[21,47],[26,48],[27,49],[28,50],[29,51]]},MiniAlu:{v:5,in:[{pos:[340,40],orient:"s",id:10,val:1},{pos:[470,40],orient:"s",id:11,val:1},{pos:[370,180],orient:"s",id:12,val:0},{pos:[500,180],orient:"s",id:13,val:1},{pos:[80,40],orient:"s",id:26,val:0},{pos:[210,40],orient:"s",id:27,val:0},{pos:[110,180],orient:"s",id:28,val:0},{pos:[240,180],orient:"s",id:34,val:0},{pos:[600,370],orient:"w",id:98,name:"Add/Sub",val:0}],out:[{pos:[600,690],id:49,name:"V"},{type:"display",bits:4,pos:[600,120],id:[18,19,20,21],name:"A"},{type:"display",bits:4,pos:[600,260],id:[22,23,24,25],name:"B"},{type:"display",bits:4,pos:[600,620],id:[45,46,47,48],name:"S"}],gates:[{type:"XOR",pos:[120,450],orient:"s",in:[86,87],out:88},{type:"XOR",pos:[250,450],orient:"s",in:[89,90],out:91},{type:"XOR",pos:[380,450],orient:"s",in:[92,93],out:94},{type:"XOR",pos:[510,450],orient:"s",in:[95,96],out:97}],ic:[{type:"adder",pos:[490,530],in:[0,1,2],out:[3,4]},{type:"adder",pos:[360,530],in:[5,6,7],out:[8,9]},{type:"adder",pos:[230,530],in:[35,36,37],out:[38,39]},{type:"adder",pos:[100,530],in:[40,41,42],out:[43,44]}],wires:[[4,7],[11,0],[10,5],[11,18],[10,19],[13,22],[12,23],[9,37],[39,42],[3,45],[8,46],[38,47],[43,48],[44,49,{via:[[50,690]]}],[27,35],[26,40],[28,87],[34,90],[34,24],[28,25],[27,20],[26,21],[12,93],[13,96],[97,1],[94,6],[91,36],[88,41],[98,2],[98,95],[98,92],[98,89],[98,86]]},LatchedAdder:{v:5,in:[{pos:[340,570],orient:"n",id:40,name:"Reset",val:0,isPushButton:!0},{pos:[40,220],id:41,val:0},{pos:[40,250],id:42,val:0},{pos:[40,280],id:43,val:0},{pos:[40,310],id:44,val:0},{pos:[280,570],orient:"n",id:45,name:"Horloge",val:0,isPushButton:!0},{pos:[190,400],orient:"n",id:60,name:"Add./soustr.",val:0}],out:[{pos:[550,380],id:61,name:"V"},{type:"display",bits:4,pos:[100,390],orient:"s",id:[50,51,52,53],name:"B"},{type:"display",bits:4,pos:[550,230],id:[46,47,48,49],name:"Acc."}],ic:[{type:"alu",pos:[180,210],in:[0,1,2,3,4,5,6,7,8,9],out:[10,11,12,13,14,15]},{type:"flipflop-d",pos:[390,100],in:[17,18,19,16],out:[20,21],state:0},{type:"flipflop-d",pos:[390,200],in:[23,24,25,22],out:[26,27],state:0},{type:"flipflop-d",pos:[390,300],in:[29,30,31,28],out:[32,33],state:0},{type:"flipflop-d",pos:[390,400],in:[35,36,37,34],out:[38,39],state:0},{type:"flipflop-d",pos:[390,500],in:[55,56,57,54],out:[58,59],state:0}],wires:[[10,16,{via:[[260,80]]}],[11,22,{via:[[260,180]]}],[12,28,{via:[[260,280]]}],[13,34,{via:[[260,380]]}],[40,37,{via:[[340,440]]}],[40,31,{via:[[340,340,"n"]]}],[40,25,{via:[[340,240,"n"]]}],[40,19,{via:[[340,140,"n"]]}],[20,0,{via:[[430,80],[430,50],[130,50],[130,130]]}],[26,1,{via:[[440,180],[440,40],[120,40],[120,150]]}],[32,2,{via:[[450,280],[450,30],[110,30],[110,170]]}],[38,3,{via:[[460,380,"n"],[460,20],[100,20],[100,190]]}],[41,4],[42,5],[43,6],[44,7],[45,35,{via:[[280,420]]}],[45,29,{via:[[280,320,"n"]]}],[45,23,{via:[[280,220,"n"]]}],[45,17,{via:[[280,120,"n"]]}],[41,50],[42,51],[43,52],[44,53],[20,46,{via:[[480,80]]}],[26,47,{via:[[480,180]]}],[32,48,{via:[[480,280]]}],[38,49,{via:[[480,380]]}],[60,8,{via:[[230,320,"n"],[230,110,"n"]]}],[40,57],[45,55,{via:[[280,520]]}],[14,54,{via:[[260,420,"s"],[260,480]]}],[58,61]]},LatchedCounter:{v:5,ic:[{type:"flipflop-d",pos:[170,160],in:[7,8,9,6],out:[10,11],state:0,trigger:"falling",showContent:!0},{type:"flipflop-d",pos:[300,160],in:[15,16,17,14],out:[18,19],state:0,trigger:"falling",showContent:!0},{type:"flipflop-d",pos:[440,160],in:[21,22,23,20],out:[24,25],state:0,trigger:"falling",showContent:!0},{type:"flipflop-d",pos:[580,160],in:[35,36,37,34],out:[38,39],state:0,trigger:"falling",showContent:!0}],in:[{pos:[100,180],id:12,name:"Horloge",val:0,isPushButton:!0},{pos:[100,240],id:41,name:"Reset",val:0,isPushButton:!0}],out:[{type:"display",bits:4,pos:[660,60],id:[26,27,28,29]}],wires:[[12,7],[10,15],[18,21],[19,14],[11,6],[25,20],[10,26,{via:[[400,30]]}],[18,27,{via:[[520,50]]}],[24,28],[39,34],[24,35],[38,29],[41,9],[41,17],[41,23],[41,37]]},Decoder2To4:{v:5,in:[{pos:[60,80],id:0,name:"S0",val:0},{pos:[60,220],id:1,name:"S1",val:0}],gates:[{type:"NOT",pos:[130,50],in:2,out:3},{type:"NOT",pos:[130,190],in:4,out:5},{type:"AND",pos:[280,60],in:[6,7],out:8},{type:"AND",pos:[280,120],in:[9,10],out:11},{type:"AND",pos:[280,180],in:[12,13],out:14},{type:"AND",pos:[280,240],in:[15,16],out:17},{type:"BUF",pos:[130,110],in:22,out:23},{type:"BUF",pos:[130,250],in:24,out:25}],out:[{pos:[370,60],id:18,name:"0"},{pos:[370,120],id:19,name:"1"},{pos:[370,180],id:20,name:"2"},{pos:[370,240],id:21,name:"3"}],wires:[[0,2],[1,4],[11,19],[17,21],[14,20],[8,18],[3,6],[5,7],[5,10],[3,12],[0,22],[1,24],[23,9],[23,15],[25,13],[25,16]]},Decoder3To8:{v:5,in:[{pos:[60,130],id:26,name:"S0",val:1},{pos:[60,290],id:27,name:"S1",val:1},{pos:[60,460],id:28,name:"S2",val:0}],gates:[{type:"NOT",pos:[130,90],in:30,out:31},{type:"NOT",pos:[130,250],in:32,out:33},{type:"NOT",pos:[130,420],in:34,out:35},{type:"AND",bits:3,pos:[340,120],in:[36,37,38],out:39},{type:"AND",bits:3,pos:[340,190],in:[40,41,42],out:43},{type:"AND",bits:3,pos:[340,260],in:[44,45,46],out:47},{type:"AND",bits:3,pos:[340,330],in:[48,49,50],out:51},{type:"AND",bits:3,pos:[340,400],in:[52,53,54],out:55},{type:"AND",bits:3,pos:[340,470],in:[56,57,58],out:59},{type:"AND",bits:3,pos:[340,540],in:[60,61,62],out:63},{type:"AND",bits:3,pos:[340,50],in:[64,65,66],out:67},{type:"BUF",pos:[130,170],in:76,out:77},{type:"BUF",pos:[130,330],in:78,out:79},{type:"BUF",pos:[130,500],in:80,out:81}],out:[{pos:[420,50],id:68,name:"0"},{pos:[420,120],id:69,name:"1"},{pos:[420,190],id:70,name:"2"},{pos:[420,260],id:71,name:"3"},{pos:[420,330],id:72,name:"4"},{pos:[420,400],id:73,name:"5"},{pos:[420,470],id:74,name:"6"},{pos:[420,540],id:75,name:"7"}],wires:[[26,30],[27,32],[28,34],[67,68],[39,69],[43,70],[47,71],[51,72],[55,73],[59,74],[63,75],[31,64],[33,65],[35,66],[26,76],[27,78],[28,80],[77,36],[33,37],[35,38],[31,40],[79,41],[35,42],[35,46],[79,45],[77,44],[31,48],[77,52],[31,56],[77,60],[33,49],[33,53],[79,57],[79,61],[81,50],[81,54],[81,58],[81,62]]},ParityGenerator:{v:5,in:[{pos:[70,180],id:0,name:"D1",val:0},{pos:[70,300],id:1,name:"D2",val:0},{pos:[70,360],id:2,name:"D3",val:0},{pos:[70,420],id:3,name:"D4",val:0}],out:[{pos:[530,60],id:4,name:"P1"},{pos:[530,120],id:5,name:"P2"},{pos:[530,180],id:6,name:"D1"},{pos:[530,240],id:7,name:"P3"},{pos:[530,300],id:8,name:"D2"},{pos:[530,360],id:9,name:"D3"},{pos:[530,420],id:10,name:"D4"}],gates:[{type:"XOR",pos:[460,240],in:[11,12],out:13},{type:"XOR",pos:[380,230],in:[14,15],out:16},{type:"XOR",pos:[340,120],in:[17,18],out:19},{type:"XOR",pos:[260,110],in:[20,21],out:22},{type:"XOR",pos:[300,60],in:[23,24],out:25},{type:"XOR",pos:[220,40],in:[26,27],out:28}],wires:[[3,10],[2,9],[1,8],[0,6],[22,17],[16,11],[28,23],[25,4],[19,5],[13,7],[3,18,{via:[[280,420],[280,130]]}],[3,12,{via:[[420,420]]}],[2,15,{via:[[340,360]]}],[1,14,{via:[[310,300],[310,220]]}],[2,21,{via:[[220,360]]}],[0,20,{via:[[190,180],[190,100]]}],[3,24,{via:[[150,420],[150,70]]}],[1,27,{via:[[120,300],[120,50]]}],[0,26,{via:[[100,30]]}]]},ShiftRegister:{v:5,in:[{pos:[110,130],id:0,name:"D",val:1},{pos:[100,210],id:1,name:"Horloge",val:0,isPushButton:!0},{pos:[100,260],id:38,name:"Reset",val:0,isPushButton:!0}],out:[{type:"display",bits:4,pos:[650,60],id:[39,40,41,42]}],ic:[{type:"flipflop-d",pos:[560,150],in:[21,22,23,20],out:[24,25],state:1,showContent:!0},{type:"flipflop-d",pos:[450,150],in:[15,16,17,14],out:[18,19],state:0,showContent:!0},{type:"flipflop-d",pos:[340,150],in:[9,10,11,8],out:[12,13],state:1,showContent:!0},{type:"flipflop-d",pos:[230,150],in:[3,4,5,2],out:[6,7],state:1,showContent:!0}],wires:[[6,8],[12,14],[18,20],[38,5,{via:[[230,260]]}],[38,11,{via:[[340,260]]}],[38,17,{via:[[450,260]]}],[38,23,{via:[[560,260]]}],[1,21,{via:[[490,210]]}],[1,15,{via:[[380,210]]}],[1,9,{via:[[270,210]]}],[1,3,{via:[[160,210]]}],[0,2],[24,39],[18,40,{via:[[530,50]]}],[12,41,{via:[[410,70]]}],[6,42,{via:[[300,90]]}]]},Muxes:{v:5,in:[{pos:[160,70],orient:"s",id:59,name:"S0",val:0},{pos:[160,340],orient:"s",id:64,name:"S0",val:0},{pos:[450,360],orient:"s",id:69,name:"S0",val:0},{bits:4,pos:[270,60],orient:"s",id:[0,1,2,3],val:[1,1,0,0]},{bits:4,pos:[460,70],orient:"s",id:[60,61,62,63],val:[0,0,0,0]},{bits:4,pos:[270,300],orient:"s",id:[65,66,67,68],val:[0,0,0,0]},{bits:4,pos:[110,180],id:[86,87,88,89],val:[0,0,0,0]},{bits:4,pos:[230,180],id:[90,91,92,93],val:[0,0,0,0]},{bits:4,pos:[400,170],id:[94,95,96,97],val:[0,0,0,0]},{bits:4,pos:[400,250],id:[98,99,100,101],val:[0,0,0,0]},{bits:4,pos:[110,420],id:[102,103,104,105],val:[0,0,0,0]},{bits:4,pos:[110,520],id:[106,107,108,109],val:[0,0,0,0]},{bits:4,pos:[400,540],id:[110,111,112,113],val:[0,0,0,0]},{bits:4,pos:[400,440],id:[114,115,116,117],val:[0,0,0,0]},{bits:4,pos:[230,400],id:[118,119,120,121],val:[0,0,0,0]},{bits:4,pos:[230,460],id:[122,123,124,125],val:[0,0,0,0]},{bits:4,pos:[230,520],id:[126,127,128,129],val:[0,0,0,0]},{bits:4,pos:[230,580],id:[130,131,132,133],val:[0,0,0,0]}],ic:[{type:"mux",from:2,to:1,pos:[160,160],in:[5,6,7],out:8},{type:"mux",from:4,to:1,pos:[290,180],in:[4,9,10,11,12,13],out:14},{type:"mux",from:8,to:1,pos:[470,210],in:[15,16,17,18,19,20,21,22,23,24,25],out:26},{type:"mux",from:4,to:2,pos:[160,470],in:[27,28,29,30,31],out:[32,33]},{type:"mux",from:8,to:2,pos:[290,490],in:[34,35,36,37,38,39,40,41,42,43],out:[44,45]},{type:"mux",from:8,to:4,pos:[450,490],in:[46,47,48,49,50,51,52,53,54],out:[55,56,57,58]},{type:"alu",pos:[630,450],in:[70,71,72,73,74,75,76,77,78,79],out:[80,81,82,83,84,85]}],wires:[[59,7],[0,12],[1,13],[60,23],[61,24],[62,25],[64,31],[65,42],[66,43],[69,54],[86,5],[87,6],[90,4],[91,9],[92,10],[93,11],[94,15],[95,16],[96,17],[97,18],[98,19],[99,20],[100,21],[101,22],[104,27],[105,28],[106,29],[107,30],[110,50],[111,51],[112,52],[113,53],[114,46],[115,47],[116,48],[117,49],[119,34],[120,35],[123,36],[124,37],[127,38],[128,39],[131,40],[132,41]]}};var Fn=(s=>(s[s.STATIC=0]="STATIC",s[s.TRYOUT=1]="TRYOUT",s[s.CONNECT=2]="CONNECT",s[s.DESIGN=3]="DESIGN",s[s.FULL=4]="FULL",s))(Fn||{}),el=4,sa=3,I4=3,Qe={lang:"lang",singleton:"singleton",mode:"mode",hidereset:"hidereset",name:"name",showonly:"showonly",showgatetypes:"showgatetypes",showdisconnectedpins:"showdisconnectedpins",showtooltips:"tooltips",src:"src",data:"data"},zc={name:void 0,showOnly:void 0,initParams:void 0,showGateTypes:!1,showDisconnectedPins:!1,wireStyle:$t.auto,hideWireColors:!1,hideInputColors:!1,hideOutputColors:!1,hideMemoryContent:!1,hideTooltips:!1,groupParallelWires:!1,propagationDelay:100,allowPausePropagation:!1,zoom:100},vm=xt.withProps()({edit:{cursor:null},move:{cursor:"move"},delete:{cursor:"not-allowed"}}),jt=class extends HTMLElement{constructor(){super();this.factory=new Xs(this);this.wireMgr=new Po(this);this.nodeMgr=new Wo;this.timeline=new oa(this);this.redrawMgr=new Ps;this.recalcMgr=new Go;this.moveMgr=new na(this);this.cursorMovementMgr=new ea(this);this.undoMgr=new ia(this);this.components=new Ho;this._isEmbedded=!1;this._isSingleton=!1;this._maxInstanceMode=sa;this._isDirty=!1;this._mode=I4;this._initialData=void 0;this._options=k({},zc);this._hideResetButton=!1;this._menu=void 0;this._currentMouseAction="edit";this._toolCursor=null;this._highlightedItems=void 0;this._nextAnimationFrameHandle=null;this.optionsHtml=void 0;this.userdata=void 0;this._baseDrawingScale=1;this._actualZoomFactor=1;this.mouseX=-1e3;this.mouseY=-1e3;this.root=this.attachShadow({mode:"open"}),this.root.appendChild(P4.content.cloneNode(!0));let e={rootDiv:this.elemWithId("logicEditorRoot"),canvasContainer:this.elemWithId("canvas-sim"),mainCanvas:this.elemWithId("mainCanvas"),leftToolbar:this.elemWithId("leftToolbar"),tooltipElem:this.elemWithId("tooltip"),tooltipContents:this.elemWithId("tooltipContents"),mainContextMenu:this.elemWithId("mainContextMenu"),optionsZone:this.elemWithId("optionsZone"),hiddenPath:this.elemWithId("hiddenPath"),fileChooser:this.elemWithId("fileChooser"),embedDialog:this.elemWithId("embedDialog"),embedUrl:this.elemWithId("embedUrl"),embedIframe:this.elemWithId("embedIframe"),embedWebcomp:this.elemWithId("embedWebcomp"),embedMarkdown:this.elemWithId("embedMarkdown")};this.html=e,cp.registerDialog(e.embedDialog)}static get allConnectedEditors(){return jt._allConnectedEditors}isMainEditor(){return!0}get editor(){return this}elemWithId(e){let r=this.root.querySelector(`#${e}`);if(r===null&&(r=document.querySelector(`#${e}`),r!==null&&console.log(`WARNING found elem with id ${e} in document rather than in shadow root`)),r===null)throw console.log("root",this.root),new Error(`Could not find element with id '${e}'`);return r}static get observedAttributes(){return[]}get mode(){return this._mode}get actualZoomFactor(){return this._actualZoomFactor}get isSingleton(){return this._isSingleton}get options(){return this._options}setPartialOptions(e){var s;let r=k(k({},zc),e);this._isSingleton&&(r.showOnly=this._options.showOnly),this._options=r;let i;(i=this.optionsHtml)!==void 0&&(this.setDocumentName(r.name),i.nameField.value=(s=r.name)!=null?s:"",i.hideWireColorsCheckbox.checked=r.hideWireColors,i.hideInputColorsCheckbox.checked=r.hideInputColors,i.hideOutputColorsCheckbox.checked=r.hideOutputColors,i.hideMemoryContentCheckbox.checked=r.hideMemoryContent,i.showGateTypesCheckbox.checked=r.showGateTypes,i.wireStylePopup.value=r.wireStyle,i.showDisconnectedPinsCheckbox.checked=r.showDisconnectedPins,i.hideTooltipsCheckbox.checked=r.hideTooltips,i.groupParallelWiresCheckbox.checked=r.groupParallelWires,i.propagationDelayField.valueAsNumber=r.propagationDelay,i.zoomLevelField.valueAsNumber=r.zoom,i.showUserDataLinkContainer.style.display=this.userdata!==void 0?"initial":"none"),this._actualZoomFactor=pc(r.zoom),this.redrawMgr.addReason("options changed",null)}setDocumentName(e){if(!this._isSingleton)return;let r="Logic";e===void 0?document.title=r:document.title=`${e} \u2013 ${r}`}nonDefaultOptions(){let e={},r=!1;for(let[i,s]of Object.entries(this._options)){let a=i;s!==zc[a]&&(e[a]=s,r=!0)}return r?e:void 0}runFileChooser(e,r){let i=this.html.fileChooser;i.setAttribute("accept",e),i.addEventListener("change",s=>{let a=this.html.fileChooser.files;a!==null&&a.length>0&&r(a[0])},{once:!0}),i.click()}setActiveTool(e,r){let i=e.getAttribute("tool");if(i!=null){if(vm.includes(i)){this.wrapHandler(()=>{this.setCurrentMouseAction(i)})();return}if(i==="save"){r.altKey&&this.editor.factory.hasCustomComponents()?vt.saveLibraryToFile(this):vt.saveCircuitToFile(this);return}if(i==="screenshot"){r.altKey?this.download(this.toSVG(!0),".svg"):this.download(this.toPNG(!0),".png");return}if(i==="open"){this.runFileChooser("text/plain|image/png|application/json",s=>{this.tryLoadFrom(s)});return}if(this.setCurrentMouseAction("edit"),i==="reset"){this.wrapHandler(()=>{this.tryLoadCircuitFromData()})();return}}}setToolCursor(e){this._toolCursor=e}setCanvasSize(){var u;let{canvasContainer:e}=this.html,r=e.clientWidth,i=e.clientHeight,s=(u=window.devicePixelRatio)!=null?u:1,a=this.html.mainCanvas;a.setAttribute("width",String(r*s)),a.setAttribute("height",String(i*s)),a.style.setProperty("width",r+"px"),a.style.setProperty("height",i+"px"),this._baseDrawingScale=s}connectedCallback(){let{rootDiv:e,mainCanvas:r}=this.html,i=this.getAttribute("style");i!==null&&e.setAttribute("style",e.getAttribute("style")+i),r.ondragenter=()=>!1,r.ondragover=()=>!1,r.ondragend=()=>!1,r.ondrop=s=>{var u;if(s.dataTransfer===null)return!1;s.preventDefault();let a=(u=s.dataTransfer.files)==null?void 0:u[0];if(a!==void 0)this.tryLoadFrom(a);else{let l=s.dataTransfer.items;if(l!==void 0){for(let p of l)if(p.kind==="string"&&(p.type==="application/json"||p.type==="text/plain")){p.getAsString(d=>{s.dataTransfer.dropEffect="copy",this.loadCircuitOrLibrary(d)});break}}}return!1},this.cursorMovementMgr.registerCanvasListenersOn(this.html.mainCanvas),jt._allConnectedEditors.length===0&&this.setupLang(),jt._allConnectedEditors.push(this),this.setup()}disconnectedCallback(){let e=jt._allConnectedEditors;e.splice(e.indexOf(this),1)}setupLang(){var a,u,l,p;let e=c(()=>{var f,m;let d=(m=(f=navigator.languages)==null?void 0:f[0])!=null?m:navigator.language;if(d.length>2)return d.substring(0,2);if(d.length===2)return d},"getNavigatorLanguage"),r=c(()=>localStorage.getItem(Qe.lang),"getSavedLang"),i=((p=(l=(u=(a=Gl(Qe.lang))!=null?a:this.getAttribute(Qe.lang))!=null?u:r())!=null?l:e())!=null?p:Cs).toLowerCase(),s=sd(i)?i:Cs;ad(s)}setup(){var je,We;this._isEmbedded=W0();let e=this.getAttribute(Qe.singleton);if(this._isSingleton=!this._isEmbedded&&e!==null&&!Aa(e),this._maxInstanceMode=this._isSingleton&&!this._isEmbedded?el:sa,this._isSingleton||this._isEmbedded){let X=c(Ie=>{let Te=Gl(Ie);Te!==void 0&&this.setAttribute(Ie,Te)},"transferUrlParamToAttribute");for(let Ie of[Qe.mode,Qe.showonly,Qe.showgatetypes,Qe.showdisconnectedpins,Qe.showtooltips,Qe.data,Qe.src,Qe.hidereset])X(Ie);let ee="user";new URL(window.location.href).searchParams.forEach((Ie,Te)=>{if(Te.startsWith(ee))if(Te=Te.substring(ee.length),Te.startsWith(".")&&(Te=Te.substring(1)),Te.length===0)this.userdata=Ie;else if(Te=Te[0].toLowerCase()+Te.substring(1),typeof this.userdata!="object"&&(this.userdata={}),Te in this.userdata){let Gt=this.userdata[Te];pe(Gt)?Gt.push(Ie):this.userdata[Te]=[Gt,Ie]}else this.userdata[Te]=Ie}),this.userdata!==void 0&&console.log("Custom user data: ",this.userdata)}if(this._isSingleton){let X=window.matchMedia("(prefers-color-scheme: dark)");X.onchange=()=>{xi(X.matches)},xi(X.matches),window.Logic.singleton=this,window.load=this.loadCircuitOrLibrary.bind(this),window.save=this.save.bind(this),window.highlight=this.highlight.bind(this),window.logicalTime=()=>this.timeline.logicalTime(),this.html.canvasContainer.appendChild(z(ke("user-select: none; position: absolute; bottom: 0; right: 0; padding: 5px 3px 2px 5px; color: rgba(128,128,128,0.2); border-radius: 10px 0 0 0; font-size: 69%; font-style: italic;"),x.Messages.DevelopedBy+" ",fi(ke("color: inherit"),jl("https://github.com/jppellet/Logic-Circuit-Simulator"),Kl("_blank"),"Jean-Philippe Pellet"),", ",fi(ke("color: inherit"),jl("https://www.hepl.ch/accueil/formation/unites-enseignement-et-recherche/medias-usages-numeriques-et-didactique-de-linformatique.html"),Kl("_blank"),"HEP Vaud")).render()),window.onbeforeunload=ee=>{this._isSingleton&&this._isDirty&&this.mode>=2&&(ee.preventDefault(),ee.returnValue=x.Messages.ReallyCloseWindow)},this.html.mainCanvas.focus()}let r=this.getAttribute(Qe.mode);r!==null&&(r=r.toUpperCase())in Fn&&(this._maxInstanceMode=Fn[r]);let i=this.getAttribute(Qe.showonly);i!==null&&(this._options.showOnly=i.toLowerCase().split(/[, +]+/).filter(X=>X.trim()));let s=this.getAttribute(Qe.showgatetypes);s!==null&&(this._options.showGateTypes=Wl(s));let a=this.getAttribute(Qe.showdisconnectedpins);a!==null&&(this._options.showDisconnectedPins=Wl(a));let u=this.getAttribute(Qe.showtooltips);u!==null&&(this._options.hideTooltips=!Aa(u)),this._hideResetButton=this.getAttribute(Qe.hidereset)!==null&&!Aa(this.getAttribute(Qe.hidereset));let l;if((l=this.getAttribute(Qe.data))!==null)this._initialData={_type:"compressed",str:l};else if((l=this.getAttribute(Qe.src))!==null)this._initialData={_type:"url",url:l};else{let X=c(()=>{let ee=this.findLightDOMChild("script");return ee!==null?(this._initialData={_type:"json",json:ee.innerHTML},ee.remove(),this.tryLoadCircuitFromData(),this.doRedraw(),!0):!1},"tryLoadFromLightDOM");setTimeout(()=>{X()||setTimeout(()=>{X()},100)})}let p=c((X,ee)=>{let Ge=this.elemWithId(X),[Ie,Te]=Re(ee)?[ee,void 0]:ee;Ge.insertAdjacentText("beforeend",Ie),Te!==void 0&&Ge.setAttribute("title",Te)},"setCaption");{let X=x.Palette;p("editToolButton",X.Design),p("deleteToolButton",X.Delete),p("moveToolButton",X.Move),p("saveToolButton",X.Download),p("screenshotToolButton",X.Screenshot),p("openToolButton",X.Open),p("resetToolButtonCaption",X.Reset),p("settingsTitle",x.Settings.Settings)}{let X=x.Dialogs.Share;p("shareDialogTitle",X.title),p("shareDialogUrl",X.URL),p("shareDialogIframe",X.EmbedInIframe),p("shareDialogWebComp",X.EmbedWithWebComp),p("shareDialogMarkdown",X.EmbedInMarkdown),p("shareDialogClose",x.Dialogs.Generic.Close)}this._menu=new Ys(this.html.leftToolbar,this._options.showOnly);let d=this.html.leftToolbar.querySelector("button.sim-component-button[data-type=rect]");d===null?console.log("ERROR: Could not find group button"):d.addEventListener("mousedown",this.wrapHandler(X=>{var Ge;let ee=((Ge=this.cursorMovementMgr.currentSelection)==null?void 0:Ge.previouslySelectedElements)||new Set;if(ee.size!==0){X.preventDefault(),X.stopImmediatePropagation();let Ie=nt.make(this);Ie.setSpawned(),Ie instanceof Xi?Ie.wrapContents(ee):console.log("ERROR: created component is not a LabelRect")}})),this.cursorMovementMgr.registerButtonListenersOn(this._menu.allFixedButtons(),!1);let f=this.root.querySelectorAll("button.sim-modification-tool");for(let X of f)X.addEventListener("click",ee=>{this.setActiveTool(X,ee)});if(this._maxInstanceMode>=4){let X=this.elemWithId("modeChangeMenu");z(at("btn-group-vertical"),z(ke("text-align: center; width: 100%; font-weight: bold; font-size: 80%; color: #666; padding: 2px;"),"Mode"),...[4,3,2,1,0].map(ee=>{let[[Ge,Ie],Te]=(()=>{switch(ee){case 4:{let mr=z(at("sim-mode-link"),vn(x.Settings.Settings),Qi("settings")).render();return mr.addEventListener("click",()=>{Dt(this.html.optionsZone,!0)}),[x.Modes.FULL,mr]}case 3:return[x.Modes.DESIGN,At];case 2:return[x.Modes.CONNECT,At];case 1:return[x.Modes.TRYOUT,At];case 0:return[x.Modes.STATIC,At]}})(),Gt=z(at("sim-mode-link"),vn("Copie un lien vers ce contenu dans ce mode"),Qi("link")).render();Gt.addEventListener("click",mr=>{this.shareSheetForMode(ee)});let Xe=z(at("btn btn-sm btn-outline-light sim-toolbar-button-right sim-mode-tool"),ke("display: flex; justify-content: space-between; align-items: center"),Ln("mode")(Fn[ee]),vn(Ie),Ge,Te,Gt).render();return Xe.addEventListener("click",this.wrapHandler(()=>this.setMode(ee))),Xe})).applyTo(X),Dt(X,!0)}let h=c(X=>{let ee=X.target;ee.focus(),ee.select(),X.preventDefault()},"selectAllListener");for(let X of[this.html.embedUrl,this.html.embedIframe,this.html.embedWebcomp,this.html.embedMarkdown])X.addEventListener("pointerdown",h),X.addEventListener("focus",h);let v=this.elemWithId("timelineControls"),D=c((X,[ee,Ge],Ie)=>{let Te=mi(at("btn btn-sm btn-outline-light sim-toolbar-button-right"),ee===void 0?ke("text-align: center"):At,vn(Ge),Qi(X,20,20),ee===void 0?qr("&nbsp;"):ee).render();return Te.addEventListener("click",this.wrapHandler(Ie)),Te},"makeRightControlButton"),b=D("play",x.ControlBar.TimelinePlay,()=>this.timeline.play()),C=D("pause",x.ControlBar.TimelinePause,()=>this.timeline.pause()),A=D("step",x.ControlBar.TimelineStep,()=>this.timeline.step());di(v,q(b,C,A)),Dt(v,!0);let w=c(({enablesPause:X,hasCallbacks:ee,isPaused:Ge,nextStepDesc:Ie})=>{X||this.options.allowPausePropagation&&ee?(Dt(b,Ge),Dt(C,!Ge),Dt(A,Ie!==void 0),A.title=x.ControlBar.TimelineStep[1]+`
`+(Ie!=null?Ie:"")):(Dt(b,!1),Dt(C,!1),Dt(A,!1))},"setTimelineButtonsVisible");this.timeline.reset(),this.timeline.onStateChanged=X=>w(X),w(this.timeline.state);let T=this.elemWithId("undoRedoControls"),R=D("undo",x.ControlBar.Undo,this.wrapHandler(()=>this.undoMgr.undo())),S=D("redo",x.ControlBar.Redo,this.wrapHandler(()=>this.undoMgr.redoOrRepeat())),F=c(X=>{Ul(R,X.canUndo),Ul(S,X.canRedoOrRepeat)},"setUndoButtonsVisible");di(T,q(R,S)),F({canUndo:!1,canRedoOrRepeat:!1}),this.undoMgr.onStateChanged=F;let O=this.html.optionsZone;(je=O.querySelector("#closeOptions"))==null||je.addEventListener("click",()=>{Dt(O,!1)});let L=c((X,[ee,Ge],Ie=!1)=>{let Te=bs(wr("checkbox")).render();this.options[X]===!0&&(Te.checked=!0),Te.addEventListener("change",this.wrapHandler(()=>{this._options[X]=Te.checked,this.redrawMgr.addReason("option changed: "+X,null)}));let Gt=z(ke("height: 20px"),id(Te,Yt(ke("margin-left: 4px"),Xt("title",Ge),ee))).render();return O.appendChild(Gt),Ie&&Dt(Gt,!1),Te},"makeCheckbox"),W=bs(wr("text"),ke("margin-left: 4px"),Xt("value",(We=this.options.name)!=null?We:""),Xt("placeholder","circuit"),Xt("title",x.Settings.NameOfDownloadedFile)).render();W.addEventListener("change",()=>{let X=W.value;this._options.name=X.length===0?void 0:X,this.setDocumentName(this._options.name)}),O.appendChild(z(ke("height: 20px; margin-bottom: 4px"),x.Settings.CircuitName,W).render());let se=L("hideWireColors",x.Settings.hideWireColors),ae=L("hideInputColors",x.Settings.hideInputColors),oe=L("hideOutputColors",x.Settings.hideOutputColors),Fe=L("hideMemoryContent",x.Settings.hideMemoryContent),He=L("showGateTypes",x.Settings.showGateTypes),it=L("showDisconnectedPins",x.Settings.showDisconnectedPins),ht=L("hideTooltips",x.Settings.hideTooltips),st=L("groupParallelWires",x.Settings.groupParallelWires,!0),bt=od(Ra(Xt("value",$t.auto),x.Settings.WireStyleAuto),Ra(Xt("value",$t.straight),x.Settings.WireStyleLine),Ra(Xt("value",$t.bezier),x.Settings.WireStyleCurve)).render();bt.addEventListener("change",this.wrapHandler(()=>{this._options.wireStyle=bt.value,this.redrawMgr.addReason("wire style changed",null)})),O.appendChild(z(ke("height: 20px"),x.Settings.wireStyle+" ",bt).render());let Pt=bs(wr("number"),ke("margin: 0 4px; width: 4em"),Xt("min","0"),Xt("step","50"),Xt("value",String(this.options.propagationDelay)),Xt("title",x.Settings.propagationDelay)).render();Pt.addEventListener("change",()=>{this._options.propagationDelay=Pt.valueAsNumber}),O.appendChild(z(ke("height: 20px"),x.Settings.propagationDelayField[0],Pt,x.Settings.propagationDelayField[1]).render());let Kt=bs(wr("number"),ke("margin: 0 2px 0 5px; width: 4em"),Xt("min","0"),Xt("step","10"),Xt("value",String(this.options.zoom)),Xt("title",x.Settings.zoomLevel)).render();Kt.addEventListener("change",this.wrapHandler(()=>{let X=Kt.valueAsNumber;this._options.zoom=X,this._actualZoomFactor=pc(X),this.redrawMgr.addReason("zoom level changed",null)})),O.appendChild(z(ke("height: 20px"),x.Settings.zoomLevelField[0],Kt,x.Settings.zoomLevelField[1]).render());let Cn=fi(x.Settings.showUserDataLink[1],ke("text-decoration: underline; cursor: pointer")).render();Cn.addEventListener("click",()=>{alert(x.Settings.userDataHeader+`

`+bm.default.stringify(this.userdata,void 0,4))});let Jt=z(ke("margin-top: 5px; display: none"),x.Settings.showUserDataLink[0],Cn).render();O.appendChild(Jt),this.optionsHtml={undoButton:R,redoButton:S,nameField:W,hideWireColorsCheckbox:se,hideInputColorsCheckbox:ae,hideOutputColorsCheckbox:oe,hideMemoryContentCheckbox:Fe,wireStylePopup:bt,showGateTypesCheckbox:He,showDisconnectedPinsCheckbox:it,hideTooltipsCheckbox:ht,groupParallelWiresCheckbox:st,propagationDelayField:Pt,zoomLevelField:Kt,showUserDataLinkContainer:Jt},this.setCanvasSize(),this.tryLoadCircuitFromData(),this.setModeFromString(this.getAttribute(Qe.mode)),this.setCanvasSize(),jt.installGlobalListeners(),this.doRedraw()}findLightDOMChild(e){let r=e.toUpperCase();for(let i of this.children)if(i.tagName===r)return i;return null}static installGlobalListeners(){if(jt._globalListenersInstalled)return;window.decompress=aa.decompressFromEncodedURIComponent,window.decodeOld=jt.decodeFromURLOld,window.formatString=z0,window.gallery=Dm,window.addEventListener("mousemove",i=>{for(let s of jt._allConnectedEditors){let a=s.html.canvasContainer;if(a!==void 0){let u=a.getBoundingClientRect();s.mouseX=i.clientX-u.left,s.mouseY=i.clientY-u.top}}},!0),window.addEventListener("resize",()=>{for(let i of jt._allConnectedEditors)i.html.canvasContainer!==void 0&&i.wrapHandler(()=>{i.setCanvasSize(),i.redrawMgr.addReason("window resized",null)})();r()});let e,r=c(()=>{e!==void 0&&(e.onchange=null);let i=`(resolution: ${window.devicePixelRatio}dppx)`;e=window.matchMedia(i),e.onchange=()=>{for(let s of jt._allConnectedEditors)s.wrapHandler(()=>{s.redrawMgr.addReason("devicePixelRatio changed",null)})();r()}},"registerPixelRatioListener");r(),document.body.addEventListener("themechanged",i=>{var a;let s=!!((a=i.detail)!=null&&a.is_dark_theme);xi(s)}),jt._globalListenersInstalled=!0}setMode(e){this.wrapHandler(()=>{let r=Fn[e];e>this._maxInstanceMode&&(e=this._maxInstanceMode,console.log(`Cannot switch to mode ${r} because we are capped by ${Fn[this._maxInstanceMode]}`),r=Fn[e]),this._mode=e,this.redrawMgr.addReason("mode changed",null),this.root.querySelectorAll(".sim-mode-tool").forEach(v=>{v.getAttribute("mode")===r?v.classList.add("active"):v.classList.remove("active")}),e<2&&this.setCurrentMouseAction("edit");let i=this._maxInstanceMode!==4?e>=3?"show":"hide":e>=3?"show":"inactive",s=e>=2,a=this.root.querySelectorAll("button.sim-modification-tool");for(let v of a)Dt(v,s);let u=e>=1&&!this._hideResetButton,l=e>=2,p=u||s||l,d=u&&!s,f=e<4;Dt(this.optionsHtml.undoButton,l),Dt(this.optionsHtml.redoButton,l),Dt(this.elemWithId("resetToolButton"),u),Dt(this.elemWithId("resetToolButtonCaption"),!d),Dt(this.elemWithId("resetToolButtonDummyCaption"),d),f&&Dt(this.html.optionsZone,!1);let m=this.html.leftToolbar;switch(i){case"hide":m.style.removeProperty("visibility"),m.style.display="none";break;case"show":m.style.removeProperty("visibility"),m.style.removeProperty("display");break;case"inactive":m.style.visibility="hidden",m.style.removeProperty("display");break}let h=this.elemWithId("rightToolbarContainer");Dt(h,p)})()}setModeFromString(e){let r=this._maxInstanceMode;e!==null&&(e=e.toUpperCase())in Fn&&(r=Fn[e]),this.setMode(r)}updateCustomComponentButtons(){this._menu!==void 0&&(this._menu.updateCustomComponentButtons(this.factory.customDefs()),this.cursorMovementMgr.registerButtonListenersOn(this._menu.allCustomButtons(),!0))}tryLoadFrom(e){if(e.type==="application/json"||e.type==="text/plain"){let r=new FileReader;r.onload=()=>{var s;let i=(s=r.result)==null?void 0:s.toString();i!==void 0&&this.loadCircuitOrLibrary(i)},r.readAsText(e,"utf-8")}else if(e.type==="image/png"){let r=new FileReader;r.onload=()=>{var s;let i=r.result;if(i instanceof ArrayBuffer){let a=new Uint8Array(i),l=(s=go.readMetadata(a).tEXt)==null?void 0:s.Description;Re(l)&&(this._initialData={_type:"compressed",str:l},this.wrapHandler(()=>{this.tryLoadCircuitFromData()})())}},r.readAsArrayBuffer(e)}else if(e.type==="image/svg+xml"){let r=new FileReader;r.onload=i=>{var a,u;let s=(u=(a=i.target)==null?void 0:a.result)==null?void 0:u.toString();if(s!==void 0){let l=document.createElement("div");l.innerHTML=s;let p=l.querySelector("svg metadata"),d=p==null?void 0:p.textContent;l.remove(),d!=null&&this.loadCircuitOrLibrary(d)}},r.readAsText(e,"utf-8")}else console.warn("Unsupported file type",e.type)}tryLoadCircuitFromData(){var r;if(this._initialData===void 0)return;if(this._initialData._type==="url"){let i=this._initialData.url;fetch(i,{mode:"cors"}).then(s=>s.text()).then(s=>{console.log(`Loaded initial data from URL '${i}'`),this._initialData={_type:"json",json:s},this.tryLoadCircuitFromData()});return}let e;if(this._initialData._type==="json")try{e=vt.loadCircuitOrLibrary(this,this._initialData.json)}catch(i){e=String(i)+" (JSON)"}else{let i;try{if(i=aa.decompressFromEncodedURIComponent(this._initialData.str),this._initialData.str.length!==0&&((r=i==null?void 0:i.length)!=null?r:0)===0)throw new Error("zero decoded length")}catch(s){e=String(s)+" (LZString)";try{i=jt.decodeFromURLOld(this._initialData.str),e=void 0}catch(a){}}e===void 0&&Re(i)&&(e=vt.loadCircuitOrLibrary(this,i),e===void 0&&(this._initialData={_type:"json",json:i}))}e!==void 0&&console.log("ERROR could not not load initial data: "+e)}loadCircuitOrLibrary(e){this.wrapHandler(r=>vt.loadCircuitOrLibrary(this,r))(e)}setDirty(e){this.mode>=2&&(this._isDirty=!0)}setDark(e){this.html.rootDiv.classList.toggle("dark",e)}tryDeleteDrawable(e){if(e instanceof he){let r=this.tryDeleteComponentsWhere(i=>i===e,!0);return Z.fromBoolean(r!==0)}else{if(e instanceof rr)return this.wireMgr.deleteWire(e);if(e instanceof Sn)return e.removeFromParent(),Z.SimpleChange}return Z.NoChange}tryDeleteComponentsWhere(e,r){let i=this.components.tryDeleteWhere(e,r);return i>0&&(this.cursorMovementMgr.clearPopperIfNecessary(),this.redrawMgr.addReason("component(s) deleted",null)),i}setCurrentMouseAction(e){this._currentMouseAction=e,this.setToolCursor(vm.props[e].cursor);let r=this.root.querySelectorAll(".sim-modification-tool");for(let i of r)i.getAttribute("tool")===e?i.classList.add("active"):i.classList.remove("active");this.cursorMovementMgr.setHandlersFor(e),this.redrawMgr.addReason("mouse action changed",null)}updateCursor(e){var r,i,s;this.html.canvasContainer.style.cursor=this.moveMgr.areDrawablesMoving()?"grabbing":(s=(i=this._toolCursor)!=null?i:(r=this.cursorMovementMgr.currentMouseOverComp)==null?void 0:r.cursorWhenMouseover(e))!=null?s:"default"}lengthOfPath(e){let r=this.html.hiddenPath;return r.setAttribute("d",e),r.getTotalLength()}offsetXYForContextMenu(e,r=!1){let i=this.html.mainCanvas,s,a;if("offsetX"in e&&e.offsetX===0&&e.offsetY===0&&e.target===i){let u=i.getBoundingClientRect();s=e.clientX-u.x,a=e.clientY-u.y}else[s,a]=this.offsetXY(e);return r&&(s=Math.round(s/H)*H,a=Math.round(a/H)*H),[s,a]}offsetXY(e){let[r,i]=(()=>{let a=this.html.mainCanvas,u=e.target;if("offsetX"in e){let l=a.getBoundingClientRect(),p=e.offsetX,d=e.offsetY;if(p===0&&d===0){let f=e;"_savedOffsetX"in f?(p=f._savedOffsetX,d=f._savedOffsetY,u=f._savedTarget):"layerX"in e&&(p=f.layerX+l.x,d=f.layerY+l.y)}if(u===a)return[p,d];{let f=u.getBoundingClientRect();return[Math.max(H*2,p+f.x-l.x),Math.max(H*2,d+f.y-l.y)]}}else{let l=u.getBoundingClientRect(),p=document.body.getBoundingClientRect(),d=e.changedTouches[0],f=d.pageX-(l.left-p.left),m=d.pageY-(l.top-p.top);if(u===a)return[f,m];{let h=a.getBoundingClientRect();return[Math.max(H*2,f+l.x-h.x),Math.max(H*2,m+l.y-h.y)]}}})(),s=this._actualZoomFactor;return[r/s,i/s]}offsetXYForComponent(e,r){let i=this.offsetXY(e);if(r.orient===ue.default)return i;let[s,a]=i,u=s-r.posX,l=a-r.posY;switch(r.orient){case"e":return i;case"w":return[r.posX-u,r.posY-l];case"s":return[r.posX-l,r.posY-u];case"n":return[r.posX+l,r.posY+u]}}guessAdequateCanvasSize(e){let r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;for(let d of this.components.all()){let f=d.posX,m=d.width,h=f-m/2,v=h+m;v>r&&(r=v),h<i&&(i=h);let D=d.posY,b=d.height,C=D-b/2,A=C+b;A>s&&(s=A),C<a&&(a=C)}i=Math.max(0,i);let u=r+i;isNaN(u)&&(u=300),a=Math.max(0,a);let l=a+s;isNaN(l)&&(l=150);let p=e?this._actualZoomFactor:1;return[p*u,p*l]}shareSheetForMode(e){return wo(this,null,function*(){this._mode>sa&&(this._mode=sa);let r=Fn[e].toLowerCase(),[i,s]=this.fullJsonStateAndCompressedForUri();console.log(`JSON:
`+i);let a=this.fullUrlForMode(e,s);this.html.embedUrl.value=a;let u=e===sa?"":`:mode: ${r}
`,l=this.guessAdequateCanvasSize(!0)[1],p=`\`\`\`{logic}
:height: ${l}
${u}
${i}
\`\`\``;this.html.embedMarkdown.value=p;let d=`<iframe style="width: 100%; height: ${l}px; border: 0" src="${a}"></iframe>`;this.html.embedIframe.value=d;let f=`<div style="width: 100%; height: ${l}px">
  <logic-editor mode="${Fn[e].toLowerCase()}">
    <script type="application/json">
      ${i.replace(/\n/g,`
      `)}
    <\/script>
  </logic-editor>
</div>`;this.html.embedWebcomp.value=f,this.saveToUrl(s),G0(this.html.embedDialog)||(ql(a)?console.log("  -> Copied!"):console.log("  -> Could not copy!"))})}saveCurrentStateToUrl(){let[e,r]=this.fullJsonStateAndCompressedForUri();console.log(`Saved to URL compressed version of:
`+e),this.saveToUrl(r)}save(){return vt.buildCircuitObject(this)}saveToUrl(e){this._isSingleton&&(history.pushState(null,"",this.fullUrlForMode(el,e)),this._isDirty=!1)}fullJsonStateAndCompressedForUri(){let e=vt.buildCircuitObject(this),r=vt.stringifyObject(e,!1);vt.removeShowOnlyFrom(e);let i=vt.stringifyObject(e,!0),s=aa.compressToEncodedURIComponent(i);return[r,s]}fullUrlForMode(e,r){let i=window.location,s=this._options.showOnly===void 0?"":`&${Qe.showonly}=${this._options.showOnly.join(",")}`,a=ud(),l=new URL(i.href).searchParams.get(Qe.lang)===a?`&${Qe.lang}=${a}`:"";return`${i.protocol}//${i.host}${i.pathname}?${Qe.mode}=${Fn[e].toLowerCase()}${l}${s}&${Qe.data}=${r}`}toBase64(e){return new Promise((r,i)=>{if(e==null){r(void 0);return}let s=new FileReader;s.onloadend=()=>{let a=s.result,u=a.substring(a.indexOf(",")+1);r(u)},s.readAsDataURL(e)})}toPNG(e,r){return wo(this,null,function*(){let i=yield new Promise(l=>{let[d,f]=this.guessAdequateCanvasSize(!1);r!==void 0&&(f=r),d*=3,f*=3;let m=new DOMMatrix("scale(3)"),h=document.createElement("canvas");h.width=d,h.height=f;let v=jt.getGraphics(h),D=Cd();D&&xi(!1),this.doDrawWithContext(v,d,f,m,m,!0,!0),D&&xi(!0),h.toBlob(l,"image/png"),h.remove()});if(i===null)return;if(!e)return i;let s=this.fullJsonStateAndCompressedForUri()[1],a=new Uint8Array(yield i.arrayBuffer()),u=go.extractChunks(a);return go.insertMetadata(u,{tEXt:{Description:s}}),new Blob([go.encodeChunks(u)],{type:"image/png"})})}toSVG(e){return wo(this,null,function*(){let r=e?vt.stringifyObject(vt.buildCircuitObject(this),!1):void 0,[i,s]=this.guessAdequateCanvasSize(!1),a=new DOMMatrix,u=new ir({width:i,height:s,metadata:r});this.doDrawWithContext(u,i,s,a,a,!0,!0);let l=u.getSerializedSvg();return Promise.resolve(new Blob([l],{type:"image/svg+xml"}))})}download(e,r){return wo(this,null,function*(){var a;let i=yield e;if(i===void 0)return;let s=((a=this.options.name)!=null?a:"circuit")+r;(0,ym.saveAs)(i,s)})}recalcPropagateAndDrawIfNeeded(){if(this._nextAnimationFrameHandle!==null)return;let e=this.recalcMgr.recalcAndPropagateIfNeeded();this.wireMgr.isAddingWire&&this.redrawMgr.addReason("adding a wire",null),this.redrawMgr.getReasonsAndClear()!==void 0&&(this.doRedraw(),this.redrawMgr.hasReasons()&&(this._nextAnimationFrameHandle=requestAnimationFrame(()=>{this._nextAnimationFrameHandle=null,this.recalcPropagateAndDrawIfNeeded()})))}highlight(e){if(e===void 0){this._highlightedItems=void 0;return}Re(e)&&(e=[e]);let r=[];for(let a of this.components.all())a.ref!==void 0&&e.includes(a.ref)&&r.push(a);let i=[];for(let a of this.wireMgr.wires)a.ref!==void 0&&e.includes(a.ref)&&i.push(a);if(r.length===0&&i.length===0){console.log(`Nothing to highlight for ref '${e}'`),this._highlightedItems=void 0;return}let s=this.timeline.unadjustedTime();this._highlightedItems={comps:r,wires:i,start:s},this.redrawMgr.addReason("highlighting component",null),this.recalcPropagateAndDrawIfNeeded()}redraw(){this.setCanvasSize(),this.redrawMgr.addReason("explicit redraw call",null),this.recalcPropagateAndDrawIfNeeded()}doRedraw(){let e=jt.getGraphics(this.html.mainCanvas),r=this.html.mainCanvas,i=this._baseDrawingScale,s=r.width/i,a=r.height/i,u=new DOMMatrix(`scale(${this._baseDrawingScale})`),l=u.scale(this._actualZoomFactor);this.doDrawWithContext(e,s,a,u,l,!1,!1)}doDrawWithContext(e,r,i,s,a,u,l){e.setTransform(s),e.lineCap="square",e.textBaseline="middle",e.fillStyle=Ke,l?e.clearRect(0,0,r,i):e.fillRect(0,0,r,i),e.setTransform(a);let p=c(w=>{let R=w.unrotatedWidth+15+15,S=w.unrotatedHeight+15+15;if(ue.isVertical(w.orient)){let F=R;R=S,S=F}return new DOMRect(w.posX-R/2,w.posY-S/2,R,S)},"highlightRectFor"),d=this._highlightedItems,f;if(d!==void 0){let S=this.timeline.unadjustedTime()-d.start,F=S<2e3?.4:.4*(1-(S-2e3)/200);if(F<=0)this._highlightedItems=void 0;else{e.beginPath();for(let O of d.comps){let L=p(O);e.moveTo(L.x,L.y),e.lineTo(L.right,L.y),e.lineTo(L.right,L.bottom),e.lineTo(L.x,L.bottom),e.closePath()}f=`rgba(238,241,0,${F})`,e.shadowColor=f,e.shadowBlur=20,e.shadowOffsetX=0,e.shadowOffsetY=0,e.fillStyle=f,e.fill(),e.shadowBlur=0,this.redrawMgr.addReason("highlight animation",null)}}if(this.moveMgr.areDrawablesMoving()){e.beginGroup("grid");let w=r/this._actualZoomFactor,T=i/this._actualZoomFactor,R=H;e.strokeStyle=qa,e.lineWidth=1,e.beginPath();for(let S=R;S<w;S+=R)e.moveTo(S,0),e.lineTo(S,i);for(let S=R;S<T;S+=R)e.moveTo(0,S),e.lineTo(r,S);e.stroke(),e.endGroup()}let h=this.moveMgr.getSingleMovingWaypoint();if(h!==void 0){e.beginGroup("guides");let w=h.getPrevAndNextAnchors();e.strokeStyle=Xa,e.lineWidth=1.5,e.beginPath();for(let T of w)e.moveTo(T.posX,0),e.lineTo(T.posX,i),e.moveTo(0,T.posY),e.lineTo(r,T.posY);e.stroke(),e.endGroup()}if(!u&&(this._mode>=2||this._maxInstanceMode===el)){if(e.beginGroup("border"),e.setTransform(s),e.strokeStyle=za,e.lineWidth=2,e.strokeRect(0,0,r,i),this._maxInstanceMode===el&&this._mode<this._maxInstanceMode){let w=this.guessAdequateCanvasSize(!0)[1];Os(e,0,w,r,w),e.fillStyle=Ga,e.fillRect(0,w,r,i-w)}e.setTransform(a),e.endGroup()}let v=this.timeline.logicalTime();e.strokeStyle=K;let D=this.cursorMovementMgr.currentMouseOverComp,b={drawTime:v,currentMouseOverComp:D,highlightedItems:d,highlightColor:f,currentSelection:void 0,anythingMoving:this.moveMgr.areDrawablesMoving()},C=this.cursorMovementMgr.currentSelection;b.currentSelection=C;let A=c(w=>{e.beginGroup(w.constructor.name);try{w.draw(e,b);for(let T of w.allNodes())T.draw(e,b)}finally{e.endGroup()}},"drawComp");e.beginGroup("background");for(let w of this.components.withZIndex(oo.Background))A(w);e.endGroup(),e.beginGroup("wires"),this.wireMgr.draw(e,b),e.endGroup(),e.beginGroup("components");for(let w of this.components.withZIndex(oo.Normal))A(w);e.endGroup(),e.beginGroup("overlays");for(let w of this.components.withZIndex(oo.Overlay))A(w);e.endGroup();let M;C!==void 0&&(M=C.currentlyDrawnRect)!==void 0&&(e.beginGroup("selection"),e.lineWidth=1.5,e.strokeStyle="rgb(100,100,255)",e.fillStyle="rgba(100,100,255,0.2)",e.beginPath(),e.rect(M.x,M.y,M.width,M.height),e.stroke(),e.fill(),e.endGroup())}cut(){console.log("cut")}copy(){if(this.cursorMovementMgr.currentSelection===void 0){ql(window.location.href);return}console.log("copy")}paste(){console.log("paste")}wrapHandler(e){return(...r)=>{let i=e(...r);return this.recalcPropagateAndDrawIfNeeded(),i}}static decodeFromURLOld(e){return decodeURIComponent(atob(e.replace(/-/g,"+").replace(/_/g,"/").replace(/%3D/g,"=")))}static getGraphics(e){let r=e.getContext("2d");return r.createPath=i=>new Path2D(i),r.beginGroup=()=>{},r.endGroup=()=>{},r}},nr=jt;c(nr,"LogicEditor"),nr._globalListenersInstalled=!1,nr._allConnectedEditors=[];var tl=class{constructor(){this.tests=new ra}highlight(n,e){Re(n)&&(n=[n]);for(let r of n){let i=document.getElementById("logic_"+r);if(i===null){console.log(`Cannot find logic diagram with reference '${r}'`);return}if(!(i instanceof nr)){console.log(`Element with id '${r}' is not a logic editor`);return}i.highlight(e)}}printUndoStack(){var n;(n=this.singleton)==null||n.undoMgr.dump()}};c(tl,"LogicStatic");var P4=(()=>{let o=document.createElement("template");o.innerHTML=Kc;let n=[Jc,Zc];return o.content.querySelector("#inlineStyle").innerHTML=n.join(`


`),o.content.querySelectorAll("i.svgicon").forEach(e=>{var s;let r=e,i=(s=r.dataset.icon)!=null?s:"question";Xf(i)?r.innerHTML=$f(i):console.log(`Unknown icon name '${i}'`)}),o})();window.Logic=new tl;window.customElements.define("logic-editor",nr);document.addEventListener("toggle",o=>{o.target instanceof HTMLDetailsElement&&o.target.open&&o.target.querySelectorAll("logic-editor").forEach(n=>{n instanceof nr&&n.redraw()})},!0);})();
//# sourceMappingURL=bundle.js.map
